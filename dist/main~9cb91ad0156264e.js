(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{108:function(t,e,r){"use strict";var n=r(29),o=r(23),i=r(17),a=r(37),s=r(30),u=r(107);function c(){return a.a.decorators.onLoad("build-map")}var p=function(){return(p=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function l(t,e,r,n){if("number"==typeof e||"string"==typeof e)e=Number(e),t.push(p(p({},r),{resourceId:e}));else if(Array.isArray(e)){var o=e[0],i=e[1];t.push(p(p(p({},r),{resourceId:o,id:i}),n))}else"object"==typeof e&&t.push(p(p(p({},r),e),n))}var f=r(68),h=r(109),y={target:"map",baseUrl:"",controls:["ZOOM","ATTRIBUTION"],controlsOptions:{ZOOM:{position:"top-left"},ATTRIBUTION:{position:"bottom-right",customAttribution:['<a href="http://nextgis.ru" target="_blank">Â©NextGIS</a>']}},pixelRadius:10};var d,v=(d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}d(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),m=function(){return(m=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},b=function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},_=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},g=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},w=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},O=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},L=function(t){function e(e,r){var o=t.call(this,function(t,e){var r=[new h.a];e.connector?e.connector&&(e.baseUrl=e.connector.options.baseUrl):e.connector=new f.a({baseUrl:e.baseUrl||"",auth:e.auth});var n=Object(i.d)(y,e);return n.connector&&r.push(new s.a({connector:n.connector,auth:n.auth,identification:n.identification})),{mapAdapter:t,starterKits:r,runtimeParams:e.runtimeParams}}(e,r))||this;return o.emitter=new n.EventEmitter,o.options={},o._ngwLayers={},r.connector&&(o.connector=r.connector),o.options=Object(i.d)(y,r),o._createWebMap().then((function(){var t=o.getContainer();t&&t.classList.add("ngw-map-container"),o._addControls()})),o}return v(e,t),e.prototype.fit=function(){var t=this.options,e=t.center,r=t.zoom,n=t.bounds;e?(this.setCenter(e),r&&this.setZoom(r)):n&&this.fitBounds(n)},e.prototype.addControl=function(e,r,n){return g(this,void 0,void 0,(function(){return w(this,(function(o){return[2,t.prototype.addControl.call(this,e,r,n)]}))}))},e.prototype.addNgwLayer=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a,u;return w(this,(function(c){switch(c.label){case 0:if(e=t.keyname,r=t.resourceId,n=t.resource,!e&&!r&&!n)throw new Error("resourceId or keyname is required parameter to add NGW layer");if(!this.options.baseUrl&&""!==this.options.baseUrl)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),o=s.a.utils.addNgwLayer(t,this,this.options.baseUrl,this.connector),[4,this.addLayer(o,m(m({visibility:!0},t),t.adapterOptions))];case 2:return i=c.sent(),a=i&&this.getLayerId(i),i&&a&&(this._ngwLayers[a]={layer:i,resourceId:i.resourceId},i.options.baseLayer&&this.getActiveBaseLayer()),[2,i];case 3:return u=c.sent(),console.error("can't add ngw layer",u),[3,4];case 4:return[2]}}))}))},e.prototype.getNgwLayerItem=function(t){return g(this,void 0,o.a,(function(){return w(this,(function(e){return[2,s.a.utils.getNgwLayerItem(m({connector:this.connector},t))]}))}))},e.prototype.getNgwLayerItems=function(t){return g(this,void 0,o.a,(function(){return w(this,(function(e){return[2,s.a.utils.getNgwLayerItems(m({connector:this.connector},t))]}))}))},e.prototype.getNgwLayerFeature=function(t){return g(this,void 0,o.a,(function(){return w(this,(function(e){return[2,s.a.utils.getNgwLayerFeature(m({connector:this.connector},t))]}))}))},e.prototype.getNgwLayerFeatures=function(t){return g(this,void 0,o.a,(function(){return w(this,(function(e){return[2,s.a.utils.getNgwLayerFeatures(m({connector:this.connector},t))]}))}))},e.prototype.getIdentifyGeoJson=function(t,e){return void 0===e&&(e=!1),g(this,void 0,o.a,(function(){return w(this,(function(r){return[2,s.a.utils.getIdentifyGeoJson({identify:t,connector:this.connector,multiple:e})]}))}))},e.prototype.getNgwLayers=function(){return g(this,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,this.onLoad()];case 1:return t.sent(),[2,this._ngwLayers]}}))}))},e.prototype.getNgwLayerByResourceId=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a,s,u;return w(this,(function(c){switch(c.label){case 0:for(r in e=[],this._ngwLayers)e.push(r);n=0,c.label=1;case 1:return n<e.length?(o=e[n],(i=this._ngwLayers[o]).resourceId!==t?[3,2]:[2,i&&i.layer]):[3,6];case 2:return i.layer.getIdentificationIds?[4,i.layer.getIdentificationIds()]:[3,4];case 3:if((a=c.sent())&&a.some((function(e){return e===t})))return[2,i.layer];c.label=4;case 4:if(i.layer.getDependLayers&&(s=i.layer.getDependLayers(),u=s.find((function(e){return e.item&&e.item.parentId===t}))))return[2,u.layer];c.label=5;case 5:return n++,[3,1];case 6:return[2]}}))}))},e.prototype.zoomToLayer=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a=this;return w(this,(function(u){switch(u.label){case 0:return e="string"==typeof t||"number"==typeof t?String(e):t.id,(r=e&&this._ngwLayers[e])?r.layer.getExtent?[4,r.layer.getExtent()]:[3,2]:[3,6];case 1:return(n=u.sent())&&this.fitBounds(n),[3,6];case 2:return o=void 0,r.layer.item?(o=r.layer.item,[3,5]):[3,3];case 3:return i=r.resourceId,[4,this.connector.get("resource.item",null,{id:i})];case 4:o=u.sent(),u.label=5;case 5:s.a.utils.getNgwResourceExtent(o,this.connector).then((function(t){t&&a.fitBounds(t)})),u.label=6;case 6:return[2]}}))}))},e.prototype.onLoad=function(e){return void 0===e&&(e="ngw-map:create"),t.prototype.onLoad.call(this,e)},e.prototype.removeLayer=function(e){var r=this.getLayer(e);if(r){var n=this.getLayerId(r);n&&delete this._ngwLayers[n],t.prototype.removeLayer.call(this,r)}},e.prototype.enableSelection=function(){var t=this;this.__selectFromNgwRaster||(this.__selectFromNgwRaster=function(e){return t._selectFromNgwRaster(e)},this.__selectFromNgwVector=function(e){return t._selectFromNgwVector(e)},this.emitter.on("click",this.__selectFromNgwRaster),this.emitter.on("layer:click",this.__selectFromNgwVector))},e.prototype.disableSelection=function(){this.__selectFromNgwRaster&&(this.emitter.off("click",this.__selectFromNgwRaster),this.emitter.off("click",this._selectFromNgwVector),this.__selectFromNgwRaster=void 0,this.__selectFromNgwVector=void 0)},e.prototype._isFitFromResource=function(){var t=this._initMapState;return!t.zoom||!t.center},e.prototype._createWebMap=function(){return g(this,void 0,void 0,(function(){var t,e,r,n,o,i,a,s,u=this;return w(this,(function(c){switch(c.label){case 0:return[4,this.create(m({},this.options))];case 1:c.sent(),this.options.qmsId&&(t=void 0,e=void 0,Array.isArray(this.options.qmsId)?(t=this.options.qmsId[0],e=this.options.qmsId[1]):t=Number(this.options.qmsId),r={qmsId:t},e&&(r.id=e),this.addBaseLayer("QMS",r).then((function(t){u.showLayer(t)}))),n=[],o=this._isFitFromResource(),this.options.webmapId&&l(n,this.options.webmapId,{fit:o}),this.options.resources&&Array.isArray(this.options.resources)&&this.options.resources.forEach((function(t){var e={};o||(e.fit=!1),l(n,t,{},e)})),i=0,a=n,c.label=2;case 2:return i<a.length?(s=a[i],[4,this.addNgwLayer(s)]):[3,5];case 3:c.sent(),c.label=4;case 4:return i++,[3,2];case 5:return this._emitStatusEvent("ngw-map:create",this),this.enableSelection(),[2]}}))}))},e.prototype._addControls=function(){var t=this;this.options.controls&&this.options.controls.forEach((function(e){var r=e,n={};"string"==typeof e&&t.options.controlsOptions&&t.options.controlsOptions[e]&&void 0!==(n=t.options.controlsOptions[e]).control&&(r=n.control);var o=n.position,i=O(n,["position"]);t.addControl(r,o||"top-left",i)})),this._emitStatusEvent("controls:create")},e.prototype._selectFromNgwVector=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a,s;return w(this,(function(u){return e=t.layer,r=e.item&&e.item.resource.id,n=t.feature,void 0!==r&&n&&(o=n.id)?(i={id:Number(o),fields:n.properties,label:"#"+r,layerId:Number(r),parent:"",geom:n.geometry},(s={featureCount:1})[r]={featureCount:1,features:[i]},a=s,this._emitStatusEvent("ngw:select",m(m({},a),{resources:[r],sourceType:"vector"})),[2,a]):[2]}))}))},e.prototype._selectFromNgwRaster=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a,u,c,p,l,f=this;return w(this,(function(h){switch(h.label){case 0:for(r in this._emitStatusEvent("ngw:preselect"),e=[],this._ngwLayers)(n=this._ngwLayers[r].layer).getIdentificationIds&&n.options.selectable&&e.push(n.getIdentificationIds());return[4,Promise.all(e)];case 1:return o=h.sent(),i=[],o.forEach((function(t){t&&t.forEach((function(t){return i.push(t)}))})),i.length?(a=this.options.pixelRadius||10,u=this.getCenter(),c=this.getZoom(),u&&c?(p=40075016.686*Math.abs(Math.cos(180*u[1]/Math.PI))/Math.pow(2,c+8),l=a*p*5e-4,[2,s.a.utils.sendIdentifyRequest(t,{layers:i,connector:this.connector,radius:l}).then((function(e){return f._emitStatusEvent("ngw:select",m(m({},e),{resources:i,sourceType:"raster",event:t})),e}))]):(this._emitStatusEvent("ngw:select",null),[2])):(this._emitStatusEvent("ngw:select",null),[2])}}))}))},e.utils=m(m(m({},a.a.utils),s.a.utils),{fixUrlStr:i.e,deepmerge:i.d}),e.decorators=m({onMapLoad:c},a.a.decorators),e.getIcon=u.a,b([a.a.decorators.onLoad("controls:create"),_("design:type",Function),_("design:paramtypes",[Object,String,Object]),_("design:returntype",Promise)],e.prototype,"addControl",null),b([c(),_("design:type",Function),_("design:paramtypes",[Object]),_("design:returntype",Promise)],e.prototype,"addNgwLayer",null),e}(a.a);e.a=L},109:function(t,e,r){"use strict";var n=r(17),o={tms:"TILE"};function i(t){return new Promise((function(e,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState&&200===o.status&&o.responseText)try{e(JSON.parse(o.responseText))}catch(t){r(t)}},o.open("GET",Object(n.e)(t),!0),o.send()}))}var a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},u=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function c(t,e){return void 0===e&&(e="https://qms.nextgis.com"),function(){function r(t,e){this.map=t,this.options=e,this.options.baseLayer=!0}return r.prototype.addLayer=function(c){return s(this,void 0,void 0,(function(){var s,p,l,f,h;return u(this,(function(u){switch(u.label){case 0:if(this.qms||!c.qmsId)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),s=this,[4,i(e+"/api/v1/geoservices/"+c.qmsId)];case 2:return s.qms=u.sent(),[3,4];case 3:return p=u.sent(),console.error(p),[3,4];case 4:return(l=this.qms)&&(f=o[l.type||"tms"],(h=t.mapAdapter.layerAdapters[f])&&(Object(n.f)(r,h,["showLayer","hideLayer"]),"TILE"===f))?(c=a(a({maxZoom:t.options.maxZoom,minZoom:t.options.minZoom},this.options),function(t){var e=("https:"===location.protocol?"https":"http")+"://";return{url:t.url.replace(/^(https?|ftp):\/\//,e),name:t.name,attribution:t.copyright_text,maxZoom:t.z_max,minZoom:t.z_min}}(l)),this.options=c,[2,new h(this.map,c).addLayer(c)]):[2]}}))}))},r}()}var p=function(){return(p=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},l=function(){function t(t){this.options={url:"https://qms.nextgis.com"},this.options=p(p({},this.options),t),this.url=this.options.url}return t.prototype.getLayerAdapters=function(){var t=this;return Promise.resolve([{name:"QMS",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}])},t.prototype._createAdapter=function(t){return c(t,this.url)},t.utils={createQmsAdapter:c},t}();e.a=l},143:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return f}));var n=r(23),o=r(29),i=r(197),a=r(144),s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},u=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},c=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},l="undefined"!=typeof window&&void 0!==window.document,f=function(){function e(t){this.options=t,this.emitter=new o.EventEmitter,this.routeStr="/api/component/pyramid/route",this._loadingQueue={},this._loadingStatus={},this._queriesCache={},this._keynamesCache={},this._resourceIdsCache={},this.options.route&&(this.routeStr=this.options.route)}return e.prototype.setNextGisWeb=function(t){this.logout(),this.options.baseUrl=t},e.prototype.connect=function(){return u(this,void 0,n.a,(function(){var t,e,r,n,o;return c(this,(function(i){switch(i.label){case 0:return this.route?[2,Promise.resolve(this.route)]:[3,1];case 1:return this.options.auth?(t=this.options.auth,e=t.login,r=t.password,e&&r?[4,this.getUserInfo({login:e,password:r})]:[3,3]):[3,3];case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,5,,6]),[4,this.makeQuery(this.routeStr,{},{})];case 4:return n=i.sent(),this.route=n,[2,n];case 5:throw o=i.sent(),new Error(o);case 6:return[2]}}))}))},e.prototype.login=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return this.logout(),[2,this.getUserInfo(t)]}))}))},e.prototype.logout=function(){this._rejectLoadingQueue(),this._loadingStatus={},this.options.auth=void 0,this.route=void 0,this.user=void 0,this.emitter.emit("logout")},e.prototype.getUserInfo=function(t){var e=this;if(this.user&&this.user.id)return n.a.resolve(this.user);t&&(this.options.auth=t);var r={headers:this.getAuthorizationHeaders(t)};return this.makeQuery("/api/component/auth/current_user",{},r).then((function(t){return e.user=t,e.emitter.emit("login",t),t})).catch((function(t){throw e.emitter.emit("login:error",t),t}))},e.prototype.getAuthorizationHeaders=function(t){var e=this.makeClientId(t);if(e)return{Authorization:"Basic "+e}},e.prototype.makeClientId=function(e){if(e=e||this.options.auth){var r=e.login,n=e.password,o=unescape(encodeURIComponent(r+":"+n));return l?window.btoa(o):t.from(o).toString("base64")}},e.prototype.getResource=function(t){return u(this,void 0,void 0,(function(){return c(this,(function(e){return"string"==typeof t?[2,this.getResourceByKeyname(t)]:"number"==typeof t?[2,this.getResourceById(t)]:[2]}))}))},e.prototype.getResourceByKeyname=function(t){return u(this,void 0,void 0,(function(){var e,r;return c(this,(function(n){switch(n.label){case 0:return(e=this._keynamesCache.keyname)?[3,2]:[4,this.get("resource.search",null,{keyname:t})];case 1:r=n.sent(),(e=r[0])&&(this._keynamesCache[t]=e,this._resourceIdsCache[e.resource.id]=e),n.label=2;case 2:return[2,e]}}))}))},e.prototype.getResourceById=function(t){return u(this,void 0,void 0,(function(){var e;return c(this,(function(r){switch(r.label){case 0:return(e=this._resourceIdsCache[t])?[3,2]:[4,this.get("resource.item",null,{id:t})];case 1:(e=r.sent())&&(this._resourceIdsCache[t]=e,e.resource.keyname&&(this._keynamesCache[e.resource.keyname]=e)),r.label=2;case 2:return[2,e]}}))}))},e.prototype.getResourceChildren=function(t){return u(this,void 0,void 0,(function(){var e,r,n;return c(this,(function(o){switch(o.label){case 0:if(e=t.resourceId,r=t.keyname,!t.keyname&&!t.resourceId&&!t.resource)throw new Error("No keyname or resourceId is set");return t.resource&&"string"==typeof t.resource&&(r=t.resource),r?[4,this.getResourceByKeyname(r)]:[3,2];case 1:n=o.sent(),e=n.resource.id,o.label=2;case 2:return[4,this.get("resource.collection",null,{parent:e})];case 3:return[2,o.sent()]}}))}))},e.prototype.request=function(t,e,r){return void 0===e&&(e={}),u(this,void 0,n.a,(function(){var o,i,s,u,l,f,h,y,d;return c(this,(function(c){switch(c.label){case 0:return[4,this.connect()];case 1:if(o=c.sent(),i=o&&o[t]){if(i=p(i),s=i.shift(),i.length){for(u={},l=0;l<i.length;l++)if(f=i[l],u[l]="{"+f+"}",void 0===e[f])throw new Error("`"+f+"` url api argument is not specified");s&&(s=Object(a.a)(s,u))}if(e){for(d in h=[],y=e.paramList,Array.isArray(y)&&(delete e.paramList,y.forEach((function(t){h.push(t[0]+"="+t[1])}))),e)-1===i.indexOf(d)&&h.push(d+"="+e[d]);h.length&&(s=s+"?"+h.join("&"))}if(s)return[2,this.makeQuery(s,e,r)];throw new Error("request url is not set")}return[2,n.a.resolve({})]}}))}))},e.prototype.post=function(t,e,r){return(e=e||{}).method="POST",e.nocache=!0,this.request(t,r,e)},e.prototype.get=function(t,e,r){return(e=e||{}).method="GET",e.nocache=!0,this.request(t,r,e)},e.prototype.patch=function(t,e,r){return(e=e||{}).method="PATCH",e.nocache=!0,this.request(t,r,e)},e.prototype.put=function(t,e,r){return(e=e||{}).method="PUT",e.nocache=!0,this.request(t,r,e)},e.prototype.delete=function(t,e,r){return(e=e||{}).method="DELETE",e.nocache=!0,this.request(t,r,e)},e.prototype.makeQuery=function(t,e,r){var o=this;if(void 0===r&&(r={}),t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=Object(a.a)(t,e)),t=t.replace(/([^:]\/)\/+/g,"$1"),r.cache&&this._queriesCache[t]?this._queriesCache[t]:!this._loadingStatus[t]||r.nocache?(this._loadingStatus[t]=!0,this._getJson(t,r).then((function(e){return o._loadingStatus[t]=!1,r.cache&&(o._queriesCache[t]=e),o._executeLoadingQueue(t,e),e})).catch((function(e){throw o._loadingStatus[t]=!1,o._executeLoadingQueue(t,e,!0),o.emitter.emit("error",e),e}))):(this._loadingStatus[t]=!1,new n.a((function(e,r){o._setLoadingQueue(t,e,r)})));throw new Error("No `url` parameter set for option "+name)},e.prototype._setLoadingQueue=function(t,e,r){this._loadingQueue[t]=this._loadingQueue[t]||{name:t,waiting:[]},this._loadingQueue[t].waiting.push({resolve:e,reject:r,timestamp:new Date})},e.prototype._rejectLoadingQueue=function(){for(var t in this._loadingQueue){this._loadingQueue[t].waiting.forEach((function(t){t.reject()})),delete this._loadingQueue[t]}},e.prototype._executeLoadingQueue=function(t,e,r){var n=this._loadingQueue[t];if(n){for(var o=0;o<n.waiting.length;o++){var i=n.waiting[o];r?i.reject&&i.reject():i.resolve(e)}n.waiting=[]}},e.prototype._getJson=function(t,e){var r=this,o=[];return e.responseType=e.responseType||"json",new n.a((function(n,a){r.user&&((e=e||{}).headers=s(s({},r.getAuthorizationHeaders()),e.headers)),Object(i.a)(t,n,e,a,o)}),(function(){o.forEach((function(t){return t()}))}))},e}()}).call(this,r(576).Buffer)},144:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=/\{ *([\w_-]+) *\}/g;function o(t,e){return t.replace(n,(function(t,r){var n=e[r];if(void 0===n)throw new Error("No value provided for letiable "+t);return"function"==typeof n&&(n=n(e)),n}))}},17:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"g",(function(){return o})),r.d(e,"e",(function(){return i})),r.d(e,"b",(function(){return a})),r.d(e,"f",(function(){return s})),r.d(e,"d",(function(){return u})),r.d(e,"c",(function(){return c}));var n=function(){function t(t){t&&this.copy(t)}return t.prototype.copy=function(t){try{navigator.clipboard?navigator.clipboard.writeText(t):window.clipboardData?window.clipboardData.setData("text",t):this.copyToClipboard(t),console.log("Copied to Clipboard")}catch(t){console.log("Please copy coupon manually")}},t.prototype.copyToClipboard=function(t){var e=document.createElement("input");e.value=t;try{document.body.appendChild(e),this.copyNodeContentsToClipboard(e)}finally{document.body.removeChild(e)}},t.prototype.copyNodeContentsToClipboard=function(t){t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")},t.copy=function(e){return new t(e)},t}();!function(){function t(t){this.emitter=t,this._eventsStatus={}}t.prototype.setEventStatus=function(t,e){this._eventsStatus[t]=e},t.prototype.onLoad=function(t){var e=this,r=(Array.isArray(t)?t:[t]).map((function(t){return new Promise((function(r){if(e.getEventStatus(t))r(e);else{var n=t;e.emitter.once(n,(function(){e.setEventStatus(t,!0),r(e)}))}}))}));return Promise.all(r).then((function(){return e}))},t.prototype.getEventStatus=function(t){var e=t,r=this._eventsStatus[e];return void 0!==r&&!!r}}();function o(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function i(t){return t.replace(/([^:]\/)\/+/g,"$1")}function a(t,e){e.forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e.prototype,r);n&&Object.defineProperty(t.prototype,r,n)}))}))}function s(t,e,r){r.forEach((function(r){var n=Object.getOwnPropertyDescriptor(e.prototype,r);n&&Object.defineProperty(t.prototype,r,n)}))}function u(t,e,r){void 0===r&&(r=!1);var n=Array.isArray(e),o=n&&[]||{};return n?r?(t=t||[],o=o.concat(t),e.forEach((function(e,n){void 0===o[n]?o[n]=e:"object"==typeof e?o[n]=u(t[n],e,r):-1===t.indexOf(e)&&o.push(e)}))):o=e:(t&&"object"==typeof t&&Object.keys(t).forEach((function(e){o[e]=t[e]})),Object.keys(e).forEach((function(n){"object"==typeof e[n]&&e[n]&&"object"==typeof t[n]&&"object"==typeof e[n]?o[n]=u(t[n],e[n],r):o[n]=e[n]}))),o}function c(t,e){void 0===e&&(e=10);var r=0;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];clearTimeout(r),r=window.setTimeout((function(){return t.apply(void 0,n)}),e)}}},197:function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n}));var o=new Function("try {return this===window;}catch(e){ return false;}")();n=o?r(580).default:r(581).default},201:function(t,e,r){"use strict";var n=r(6),o=r.n(n),i=r(29),a=r(17);function s(t,e,r){var n=new XMLHttpRequest;for(var o in n.open("GET",t),n.responseType="arraybuffer",r)n.setRequestHeader(o,r[o]);n.onload=function(){var t=new Uint8Array(this.response),r=new Blob([t],{type:"image/png"}),n=(window.URL||window.webkitURL).createObjectURL(r);e(n)},n.send()}var u,c=function(){function t(){}return t.prototype._removeTile=function(t){_super.prototype._removeTile.call(this,t)},t.prototype.createTile=function(t,e){var r=this.getTileUrl(t),n=document.createElement("img");return s(r,(function(t){n.src=t,e(null,n)}),this.options.headers),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n},t}(),p=(u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),l=function(t){function e(e,r){return t.call(this,e,r)||this}return p(e,t),e}(n.TileLayer);Object(a.b)(l,[c]);var f=function(){function t(t,e){if(this.map=t,this.options=e,this.pane="order-0",void 0!==e.order){var r="order-"+e.order,n=t.getPane(r);n||(n=t.createPane(r)),n.style.zIndex=String(100*e.order),this.pane=r}}return t.prototype.addLayer=function(t){},t}(),h=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=function(){return(y=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},d=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.addLayer=function(t){if(t){var e=t.url,r=d(t,["url"]);if(e){var o={pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom};return r.headers?new l(e,y(y({},o),{headers:r.headers})):new n.TileLayer(e,o)}}},e}(f),m=r(55),b={Point:"circle",LineString:"line",MultiPoint:"circle",Polygon:"fill",MultiLineString:"line",MultiPolygon:"fill",GeometryCollection:"fill"},_={stroke:!1,opacity:1},g={};for(var w in b){var O=b[w],L=g[O]||[];L.push(w),g[O]=L}function P(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=1+(e[t[r]]||0);var n="";for(var o in e){var i=n?e[n]:0;e[o]>i&&(n=o)}return n}function I(t,e){return-1!==(g[e]||[]).indexOf(t)}function x(t){var e=t.containerPoint;return{latLng:t.latlng,pixel:{left:e.x,top:e.y},source:t}}var k=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),E=function(){return(E=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},j=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},M=function(t){function e(e,r){var o=t.call(this,e,r)||this;return o.selected=!1,o._layers=[],o._selectedLayers=[],o._filteredLayers=[],o.layer=new n.FeatureGroup([],{pane:o.pane}),o}return k(e,t),e.prototype.addLayer=function(t){if(t)return this.options=t,this.paint=t.paint,this.selectedPaint=t.selectedPaint,t.paint=this.paint,t.data&&this.addData(t.data),this.layer},e.prototype.select=function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._selectLayer(t.layer)})):this.selected||(this.selected=!0,this.selectedPaint&&this.setPaintEachLayer(this.selectedPaint))},e.prototype.unselect=function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._unSelectLayer(t.layer)})):this.selected&&(this.selected=!1,this.paint&&this.setPaintEachLayer(this.paint))},e.prototype.getSelected=function(){return this._selectedLayers.map((function(t){return{feature:t.feature,layer:t}}))},e.prototype.getFiltered=function(){return this._filteredLayers},e.prototype.filter=function(t){var e=this;this._filterFun=t;var r=this.layer._map;r&&this.layer.remove();var n=[];return this._layers.forEach((function(r){var o=r.feature,i=r.layer;i&&(!t||t({feature:o,layer:i})?(e.layer.addLayer(i),n.push({feature:o,layer:i})):e.layer.removeLayer(i))})),this._filteredLayers=n,r&&this.layer.addTo(r),this._filteredLayers},e.prototype.cleanFilter=function(){this.filter()},e.prototype.getLayers=function(){return this._layers.map((function(t){var e=t.layer;return{feature:t.feature,layer:e,visible:e&&e._map}}))},e.prototype.clearLayer=function(t){if(t)for(var e=this._layers.length;e--;){var r=this._layers[e];r.feature&&t(r.feature)&&(this.layer.removeLayer(r.layer),this._layers.splice(e,1))}else this.layer.clearLayers(),this._layers=[]},e.prototype.setData=function(t){this.clearLayer(),this.addData(t)},e.prototype.addData=function(t){var e,r=this.options;if(r){if(t){var o=void 0;if(r.type)o=r.type;else{var i=function(t){var e;if("FeatureCollection"===t.type)e=P(t.features.map((function(t){return t.geometry.type})));else if("GeometryCollection"===t.type){e=P(t.geometries.map((function(t){return t.type})))}else e="Feature"===t.type?t.geometry.type:t.type;return e}(t);o=b[i]}if(this.type&&this.type!==o)return console.warn("no other data type than layer can be added"),!1;this.type=o,(t=function(t,e){if("FeatureCollection"===t.type)(r=t).features=r.features.filter((function(t){return I(t.geometry.type,e)}));else if("Feature"===t.type){if(!I(t.geometry.type,e))return!1}else if("GeometryCollection"===t.type){var r;(r=t).geometries=r.geometries.filter((function(t){return I(t.type,e)}))}return t}(t,o))&&(e=this.getGeoJsonOptions(r,o))}new n.GeoJSON(t||void 0,e)}},e.prototype.openPopup=function(t,e){var r=this;t&&this._layers.filter(t).forEach((function(t){r._openPopup(t.layer,e)}))},e.prototype.closePopup=function(t){var e=this;(t?this._layers.filter(t):this._layers).forEach((function(t){e._closePopup(t.layer)}))},e.prototype.updateTooltip=function(t){var e=this;t?this._updateTooltip(t):this.getLayers().forEach((function(t){return e._updateTooltip(t)}))},e.prototype._updateTooltip=function(t){var e=t.feature,r=t.layer;if(this.options.labelField&&e&&e.properties){r.unbindTooltip();var n=e.properties[this.options.labelField];void 0!==n&&r.bindTooltip(String(n),{permanent:!0}).openTooltip()}},e.prototype._openPopup=function(t,e){var r=t.feature,n=E({minWidth:300},e=e||{}),o=n.minWidth,i=n.autoPan,a=e&&e.createPopupContent?e.createPopupContent({layer:t,feature:r}):"";if(a){var s=t.bindPopup(a,{minWidth:o,autoPan:i});setTimeout((function(){s.openPopup()}),0)}},e.prototype._closePopup=function(t){t.closePopup().unbindPopup()},e.prototype.setPaintEachLayer=function(t){var e=this;this.layer.eachLayer((function(r){e.setPaint(r,t)}))},e.prototype.setPaint=function(t,e){var r=void 0;if(Object(m.b)(e)?r=e(t.feature):Object(m.a)(e)&&(r=e),r)if("circle"===this.type&&"icon"===r.type){var n=t,o=this.createDivIcon(r);n.setIcon(o)}else"setStyle"in t&&t.setStyle(this.preparePaint(r))},e.prototype.preparePaint=function(t){if("get-paint"!==t.type){var e="line"===this.type?[["color","strokeColor"],["opacity","strokeOpacity"],["weight","weight"]]:[["color","strokeColor"],["opacity","strokeOpacity"],["stroke","stroke"],["fillColor","fillColor"],["fillOpacity","fillOpacity"],["fill","fill"],["weight","weight"]],r={};return"radius"in t&&"number"==typeof t.radius&&(r.radius=t.radius),e.forEach((function(e){var n=e[0],o=e[1],i=t[o];void 0!==i&&Object.defineProperty(r,n,{enumerable:!0,value:i})})),r}return _},e.prototype.getGeoJsonOptions=function(t,e){var r=this,n=t.paint,o={};return(o="function"==typeof n?"circle"===e?{pointToLayer:function(t,e){var o=n(t);return r.createPaintToLayer(o)(t,e)}}:{style:function(t){return t?r.preparePaint(E(E({},_),n(t))):r.preparePaint(E(E({},_),{type:"path"}))}}:this.createPaintOptions(n,e)).onEachFeature=function(e,n){n.options.pane=r.pane,r._layers.push({feature:e,layer:n});var o=!0;r._filterFun&&(o=r._filterFun({feature:e,layer:n})),o&&(n.options.interactive=r.options.selectable||r.options.interactive,r.layer.addLayer(n),t.selectable&&(t.selectOnHover?(n.on("mouseover",(function(){r._selectLayer(n)})),n.on("mouseout",(function(){r._unSelectLayer(n)}))):n.on("click",(function(t){return r._onLayerClick(t)}),r)),r.options.popup&&r._openPopup(n,r.options.popupOptions),r._updateTooltip({layer:n,feature:e}))},o},e.prototype._onLayerClick=function(t){n.DomEvent.stopPropagation(t);var e=t.target,r=-1!==this._selectedLayers.indexOf(e);r?this.options&&this.options.unselectOnSecondClick&&(this._unSelectLayer(e),r=!1):(this._selectLayer(e),r=!0),this.options.onLayerClick&&this.options.onLayerClick({layer:this,feature:e.feature,selected:r,event:x(t),source:t})},e.prototype._selectLayer=function(t){var e=this;this.options&&!this.options.multiselect&&this._selectedLayers.forEach((function(t){return e._unSelectLayer(t)})),this._selectedLayers.push(t),this.selected=!0,this.options&&(this.options.selectedPaint&&this.setPaint(t,this.options.selectedPaint),this.options.popupOnSelect&&this._openPopup(t,this.options.popupOptions))},e.prototype._unSelectLayer=function(t){var e=this._selectedLayers.indexOf(t);-1!==e&&this._selectedLayers.splice(e,1),this.selected=this._selectedLayers.length>0,this.options&&(this.options.paint&&this.setPaint(t,this.options.paint),this.options.popupOnSelect&&this._closePopup(t))},e.prototype.createDivIcon=function(t){var e=j(t,[]);return new n.DivIcon(E({className:""},e))},e.prototype.createPaintToLayer=function(t){var e=this;if("icon"===t.type){var r=t.className,o=t.html;if(r||o)return function(r,o){var i=e.createDivIcon(t);return new n.Marker(o,{icon:i})}}else if("pin"===t.type)return function(t,e){return new n.Marker(e)};return function(r,o){var i=_;return new n.CircleMarker(o,e.preparePaint(E(E({},i),t)))}},e.prototype.createPaintOptions=function(t,e){var r={},n=t&&this.preparePaint(t)||{};return t&&(r.style=function(){return n}),"circle"===e?r.pointToLayer=this.createPaintToLayer(t):"line"===e&&(n.stroke=!0),r},e}(f),S=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C=function(t){function e(e){var r=t.call(this,e)||this,n=e&&e.customAttribution;if(n){var o=[];Array.isArray(n)?o=n:n&&(o=[n]),o.forEach((function(t){return r.addAttribution(t)}))}return r}return S(e,t),e}(n.Control.Attribution),T=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),A=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return T(e,t),e.prototype._initImage=function(){t.prototype._initImage.call(this);var e=this.options.headers;if(e){var r=this._image,n=r.src;r.src="",s(n,(function(t){r.src=t}),e)}},e}(o.a.ImageOverlay),N=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R=function(t){function e(e,r){var n=t.call(this,r)||this;n.defaultWmsParams={service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},n.options={crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18,pane:"tilePane",headers:null,viewPortBuffer:0},n._url=e;var i={},a={};for(var s in r)s in n.options?a[s]=r[s]:i[s]=r[s];return o.a.Util.setOptions(n,a),n.wmsParams=o.a.Util.extend({},n.defaultWmsParams,i),n}return N(e,t),e.prototype.setParams=function(t){o.a.Util.extend(this.wmsParams,t),this.update()},e.prototype.getAttribution=function(){return this.options.attribution||""},e.prototype.onAdd=function(){return this.update(),this},e.prototype.onRemove=function(t){return this._currentOverlay&&(t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl,this},e.prototype.getEvents=function(){return{moveend:this.update}},e.prototype.update=function(){var t=this;if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!==e){this._currentUrl=e;var r=this.options.viewPortBuffer||0,n=this._map.getBounds().pad(r),o=new A(e,n,{opacity:0,pane:this.options.pane,headers:this.options.headers});o.addTo(this._map),o.once("load",(function(){t._map&&(o._url===t._currentUrl?(t._currentOverlay&&t._map.removeLayer(t._currentOverlay),t._currentOverlay=o,o.setOpacity(void 0!==t.options.opacity?t.options.opacity:1),!0===t.options.isBack&&o.bringToBack(),!1===t.options.isBack&&o.bringToFront(),void 0!==t.options.zIndex&&o.setZIndex(t.options.zIndex)):t._map.removeLayer(o))}),this);var i=this.options,a=i.minZoom,s=i.maxZoom;(a&&this._map.getZoom()<a||s&&this._map.getZoom()>s)&&this._map.removeLayer(o)}}},e.prototype.setOpacity=function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)},e.prototype.bringToBack=function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()},e.prototype.bringToFront=function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()},e.prototype.setZIndex=function(t){this.options.zIndex=t,this._currentOverlay&&this._currentOverlay.setZIndex(t)},e.prototype.updateWmsParams=function(t){t||(t=this._map);var e=this.options.viewPortBuffer||0,r=t.getBounds().pad(e),n=t.getSize();if(0!==this.options.viewPortBuffer){var i=e+1;n.x=Math.ceil(n.x*i),n.y=Math.ceil(n.y*i)}var a=parseFloat(this.wmsParams.version),s=this.options.crs||t.options.crs,u=a>=1.3?"crs":"srs";if(s){var c=s.project(r.getNorthWest()),p=s.project(r.getSouthEast()),l={width:n.x,height:n.y};l[u]=s.code,l.bbox=(a>=1.3&&s===o.a.CRS.EPSG4326?[p.y,c.x,c.y,p.x]:[c.x,p.y,p.x,c.y]).join(","),o.a.Util.extend(this.wmsParams,l)}},e.prototype.getImageUrl=function(){var t=this.options.uppercase||!1,e=o.a.Util.getParamString(this.wmsParams,this._url,t);return this._url+e},e}(o.a.Layer),B=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),G=function(){return(G=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},U=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype.addLayer=function(t){var e=t&&t.url;if(e){var r=(t=G({transparent:!0},t)).updateWmsParams;if(this.layer=new R(e,G({pane:this.pane,headers:t.headers},t)),r){var n=this.layer.updateWmsParams;this.layer.updateWmsParams=function(t){n.call(this,t),this.wmsParams=r(this.wmsParams)}}return this.layer}},e}(f);function F(t,e){return void 0===e&&(e={}),new(n.Control.extend({onAdd:function(){var r=document.createElement("div"),o=t.onAdd();return r.classList.add("leaflet-control"),e.bar&&r.classList.add("leaflet-bar"),e.margin||e.bar||(r.style.marginBottom="0px",r.style.marginTop="0px",r.style.marginLeft="0px",r.style.marginRight="0px"),o&&r.appendChild(o),n.DomEvent.disableClickPropagation(r),r},onRemove:function(){t.onRemove()}}))}var q=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z=function(t){function e(e,r){return t.call(this,e,r)||this}return q(e,t),e}(n.TileLayer.WMS);Object(a.b)(Z,[c]);var D=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),W=function(){return(W=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},z=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return D(e,t),e.prototype.addLayer=function(t){if(t){var e=t.url,r=z(t,["url"]);if(e){var o={pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom,layers:t.layers,format:t.format};return r.headers?new Z(e,W(W({},o),{headers:r.headers})):new n.TileLayer.WMS(e,o)}}},e}(f),Q=function(){return(Q=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},H=function(){function t(){this.options={target:"map"},this.layerAdapters=t.layerAdapters,this.controlAdapters=t.controlAdapters,this.emitter=new i.EventEmitter,this._universalEvents=["zoomstart","zoom","zoomend","movestart","move","moveend"]}return t.prototype.create=function(t){if(this.options=Q({},t),this.options.target){var e=this.options,r=e.maxZoom,o=e.minZoom,i=e.zoom,a=e.center;this.map=new n.Map(this.options.target,{zoomControl:!1,attributionControl:!1,maxZoom:r,minZoom:o,zoom:i,center:a}),this.map.createPane("order-0").style.zIndex=String(0),this.emitter.emit("create",this),this._addMapListeners()}},t.prototype.destroy=function(){this.map&&this.map.remove()},t.prototype.getContainer=function(){return this.map&&this.map.getContainer()},t.prototype.setCursor=function(t){this.map&&(this.map.getContainer().style.cursor=t)},t.prototype.setView=function(t,e){var r=t[0],n=t[1];this.map&&(e?this.map.setView([n,r],e,{animate:!1}):this.setCenter([r,n]))},t.prototype.setCenter=function(t){var e=t[0],r=t[1];this.map&&this.map.panTo([r,e])},t.prototype.getCenter=function(){var t=this.map;if(t){var e=t.getBounds().getCenter();return[e.lng,e.lat]}},t.prototype.setZoom=function(t){this.map&&this.map.setZoom(t)},t.prototype.getZoom=function(){return this.map&&this.map.getZoom()||void 0},t.prototype.getBounds=function(){if(this.map){var t=this.map.getBounds(),e=t.getSouthWest(),r=t.getNorthEast();return[e.lng,e.lat,r.lng,r.lat]}},t.prototype.fitBounds=function(t){this.map&&this.map.fitBounds([[t[3],t[0]],[t[1],t[2]]])},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype.createControl=function(t,e){return F(t,e)},t.prototype.createButtonControl=function(t){return function(t){var e=document.createElement("a"),r=t.title||"";e.href="#",e.title=r,e.setAttribute("role","button"),e.setAttribute("aria-label",r),n.DomEvent.disableClickPropagation(e),n.DomEvent.on(e,"click",n.DomEvent.stop),t.html instanceof HTMLElement?e.appendChild(t.html):"string"==typeof t.html&&(e.innerHTML=t.html);var o=function(e){e.stopPropagation(),t.onClick()};return void 0!==t.onClick&&e.addEventListener("click",o),F({onAdd:function(){return e},onRemove:function(){var r=e.parentNode;r&&r.removeChild(e),void 0!==t.onClick&&e.removeEventListener("click",o)}},{bar:!0})}(t)},t.prototype.addControl=function(t,e){if(t.options.position=e.replace("-",""),this.map)return this.map.addControl(t),t},t.prototype.removeControl=function(t){this.map&&this.map.removeControl(t)},t.prototype.removeLayer=function(t){t&&t.remove&&t.remove()},t.prototype.showLayer=function(t){this.map&&t.addTo(this.map)},t.prototype.hideLayer=function(t){t.remove()},t.prototype.setLayerOpacity=function(t,e){t.setOpacity&&t.setOpacity(e)},t.prototype.setLayerOrder=function(t,e,r){},t.prototype.onMapClick=function(t){this.emitter.emit("click",x(t))},t.prototype.locate=function(t,e){var r=this.map;if(r&&(r.locate(t),e)){var n=e.locationfound,o=e.locationerror,i=function(t){var e=t,r=[e.latlng.lng,e.latlng.lat];n({lngLat:r})};void 0!==n&&r.on("locationfound",i,this),o&&r.on("locationerror",o,this);return{stop:function(){void 0!==n&&r.off("locationfound",i),o&&r.off("locationerror",o)}}}return{stop:function(){}}},t.prototype._addMapListeners=function(){var t=this,e=this.map;e&&(e.on("click",(function(e){t.onMapClick(e)})),this._universalEvents.forEach((function(r){e.on(r,(function(){return t.emitter.emit(r,t)}),e)})))},t.layerAdapters={IMAGE:U,TILE:v,GEOJSON:M,WMS:J},t.controlAdapters={ZOOM:n.Control.Zoom,ATTRIBUTION:C},t.Map=o.a,t}();e.a=H},202:function(t,e,r){"use strict";var n=function(){function t(){this._params={}}return t.prototype.get=function(t){return this.params()[t]},t.prototype.params=function(){var t={};return window.location.href.replace(/[?&]+(\w+)([^&]*)/gi,(function(e,r){return t[r]=!0,""})),window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,r,n){return t[r]=decodeURIComponent(n),""})),this._params=t,t},t.prototype.set=function(t,e){if(e){var r=void 0,n=encodeURIComponent(e);r=this.get(t)?location.search.replace(new RegExp("([?|&]"+t+"=)(.+?)(&|$)"),"$1"+n+"$3"):location.search.length?location.search+"&"+t+"="+n:"?"+t+"="+n;var o={};o[t]=e,this._params[t]=e;var i={state:{url:r,params:o},url:r};return this._pushState(i),i}return this.remove(t)},t.prototype.remove=function(t){var e,r=location.search,n=r.split("?")[0],o=-1!==r.indexOf("?")?r.split("?")[1]:"";if(""!==o){for(var i=(e=o.split("&")).length-1;i>=0;i-=1)e[i].split("=")[0]===t&&e.splice(i,1);n=n+"?"+e.join("&")}delete this._params[t];var a={state:{url:n,type:"remove"},url:n};return this._pushState(a),a},t.prototype._pushState=function(t){history&&history.replaceState(t.state,document.title,t.url)},t}();e.a=n},30:function(t,e,r){"use strict";var n=r(68),o=r(109),i=r(29),a=r(37),s=r(17),u=r(23),c=r(41),p=function(){return(p=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},l=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},f={srs:4326,geom_format:"geojson"};function h(t){var e=t.geom;return{id:t.id,type:"Feature",properties:t.fields,geometry:e}}function y(t){var e=p({},f);return t.connector.get("feature_layer.feature.item",null,p({id:t.resourceId,fid:t.featureId},e))}function d(t){return y(t).then((function(t){return h(t)}))}function v(t){var e=t.filterById[2],r="number"==typeof e?[e]:e.split(",").map((function(t){return Number(t)}));if("eq"!==t.filterById[1]&&"in"!==t.filterById[1])throw new Error("Unable to filter by object id. Except `eq` or `in` operator");var n=r.map((function(e){return y({connector:t.connector,resourceId:t.resourceId,featureId:e})}));return u.a.all(n)}function m(t){var e=p({},f),r=t.connector,n=t.limit,o=t.fields,i=t.intersects,a=t.orderBy,s=t.resourceId,u=t.paramList;return n&&(e.limit=n),o&&(e.fields=o.join()),i&&(e.intersects=i),u&&(e.paramList=u),a&&(e.order_by=a.join(",")),r.get("feature_layer.feature.collection",null,p({id:s},e))}function b(t){var e=t.filters;return e?function t(e,r,n){void 0===r&&(r=[]),void 0===n&&(n=[]);var o=e.filters,i=e.connector,a=e.resourceId,s="string"==typeof o[0]?o[0]:"all",f=o.filter((function(t){return Array.isArray(t)})),h=function(t){return["fld_"+t[0]+"__"+t[1],t[2]]};if("any"===s)f.forEach((function(o){"id"===o[0]&&r.push(v({filterById:o,connector:i,resourceId:a})),Object(c.a)(o)?r.push(m(p(p({},e),{paramList:l(n,[h(o)])}))):t(p(p({},e),{filters:o}),r,l(n))}));else if("all"===s){var y=f.find((function(t){return"id"===t[0]}));if(y)r.push(v({filterById:y,connector:i,resourceId:a}));else{var d=[],b=[];f.forEach((function(t){Object(c.a)(t)?d.push(h(t)):b.push(t)})),b.length?b.forEach((function(o){t(p(p({},e),{filters:o}),r,l(n,d))})):r.push(m(p(p({},e),{paramList:l(n,d)})))}}return u.a.all(r).then((function(t){var r=t.reduce((function(t,e){return t.concat(e)}),[]);return e.limit?r.splice(0,e.limit):r}))}(p(p({},t),{filters:e})):m(t).then((function(t){return e?t.filter((function(t){var r=t.fields;r&&Object(c.c)(r,e)})):t}))}function _(t){return b(t).then((function(t){var e=[];return t.forEach((function(t){e.push(h(t))})),{type:"FeatureCollection",features:e}}))}var g=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},w=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function O(t,e){return g(this,void 0,void 0,(function(){var r,n,o,i;return w(this,(function(a){switch(a.label){case 0:return r=t.resource,n=t.keyname,o=t.resourceId,r?"string"!=typeof r?[3,1]:(n=r,[3,4]):[3,4];case 1:return"number"!=typeof r?[3,2]:(o=r,[3,4]);case 2:return[4,O(r,e)];case 3:o=a.sent(),a.label=4;case 4:return o||!n?[3,6]:[4,e.getResourceByKeyname(n)];case 5:i=a.sent(),o=i.resource.id,a.label=6;case 6:return[2,o]}}))}))}var L=r(110);var P=["fields","intersects","limit","orderBy","strategy"];function I(t){var e={};return P.forEach((function(r){var n=t[r];void 0!==n&&(e[r]=n)})),e}var x,k=(x=function(t,e){return(x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}x(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),E=function(){return(E=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},j=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},M=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function S(t,e,r,n){var o,u;return j(this,void 0,void 0,(function(){var c,p,l,f,h,y,d,v,m=this;return M(this,(function(b){switch(b.label){case 0:return c=e.mapAdapter.layerAdapters.GEOJSON,l=!1,[4,O(t,r)];case 1:return h=b.sent(),(null===(u=null===(o=t.adapterOptions)||void 0===o?void 0:o.popupOptions)||void 0===u?void 0:u.fromProperties)&&(t.adapterOptions.popupOptions.createPopupContent=function(t){var e=t.feature;return e&&function(t,e){var r,n=Object(L.a)("div");if(e)null===(r=e.feature_layer)||void 0===r||r.fields.forEach((function(e){if(e.grid_visibility){var r=t.properties&&t.properties[e.keyname];if(r)Object(L.a)("div",null,n).innerHTML="<span>"+e.display_name+"</span>: "+r+"<span></span>"}}));else if(t.properties)for(var o in t.properties){Object(L.a)("div",null,n).innerHTML="<span>"+o+"</span>: "+t.properties[o]+"<span></span>"}return n}(e,n)}),y=function(t,e){return j(m,void 0,void 0,(function(){return M(this,(function(n){switch(n.label){case 0:return v(),f={filters:t,options:e},[4,p=_(E({resourceId:h,filters:t,connector:r},e))];case 1:return[2,n.sent()]}}))}))},d=!1,v=function(){p&&(p.cancel(),p=void 0)},[2,function(r){function o(){var t=null!==r&&r.apply(this,arguments)||this;return t.emitter=new i.EventEmitter,t}return k(o,r),o.prototype.addLayer=function(e){return j(this,void 0,void 0,(function(){var o;return M(this,(function(i){return void 0!==t.id&&(e.id=t.id),n&&n.vector_layer&&(e.type=It[n.vector_layer.geometry_type]),e.data&&0===Object.keys(e.data).length&&(e.data=void 0),o=r.prototype.addLayer.call(this,e),this.options.strategy=e.strategy||void 0,f={filters:e.propertiesFilter,options:I(e)},e.data||this.updateLayer(),"BBOX"===this.options.strategy&&this._addBboxEventListener(),[2,o]}))}))},o.prototype.beforeRemove=function(){d=!0,this._removeMoveEventListener(),this._removeBboxEventListener(),this.__disableMapMoveListener=void 0,this.__enableMapMoveListener=void 0,this.__onMapMove=void 0,v()},o.prototype.updateLayer=function(t){return j(this,void 0,void 0,(function(){var r;return M(this,(function(n){switch(n.label){case 0:return t=t||f||{},"BBOX"!==this.options.strategy?[3,2]:[4,e.onLoad()];case 1:n.sent(),t.options=t.options||{},t.options.intersects=this._getMapBbox(),n.label=2;case 2:return d?[2]:[4,y(t.filters,t.options)];case 3:return r=n.sent(),e.setLayerData(this,r),this.emitter.emit("updated"),[2]}}))}))},o.prototype.propertiesFilter=function(t,e){return j(this,void 0,void 0,(function(){var r;return M(this,(function(n){switch(n.label){case 0:return v(),this.filter&&l?(this.filter((function(e){return!e.feature||!e.feature.properties||a.a.utils.propertiesFilter(e.feature.properties,t)})),[3,3]):[3,1];case 1:return this.setData?(this.clearLayer&&this.clearLayer(),[4,y(t,e)]):[3,3];case 2:r=n.sent(),this.setData(r),n.label=3;case 3:return[2]}}))}))},o.prototype.removeFilter=function(){f=void 0,this.propertiesFilter([]),this.filter&&this.filter((function(){return!0}))},o.prototype._addBboxEventListener=function(){var t=this;this.__enableMapMoveListener=function(){t._removeMoveEventListener(),e.isLayerVisible(t)&&(t.updateLayer(),t._addMoveEventListener())},this.__disableMapMoveListener=function(){e.isLayerVisible(t)||t._removeMoveEventListener()},e.emitter.on("layer:show",this.__enableMapMoveListener),e.emitter.on("layer:hide",this.__disableMapMoveListener),this.__enableMapMoveListener()},o.prototype._removeBboxEventListener=function(){this.__enableMapMoveListener&&e.emitter.on("layer:show",this.__enableMapMoveListener),this.__disableMapMoveListener&&e.emitter.on("layer:hide",this.__disableMapMoveListener)},o.prototype._addMoveEventListener=function(){var t=this;this.__onMapMove=Object(s.c)((function(){return t.updateLayer()})),e.emitter.on("moveend",this.__onMapMove)},o.prototype._removeMoveEventListener=function(){this.__onMapMove&&e.emitter.off("moveend",this.__onMapMove)},o.prototype._getMapBbox=function(){var t=e.getBounds();if(t){var r=t[0],n=t[1],o=t[2],i=t[3];return"POLYGON(("+[[r,n],[o,n],[o,i],[r,i],[r,n]].map((function(t){var e=At(t[0],t[1]);return e[0]+" "+e[1]})).join(", ")+"))"}},o}(c)]}}))}))}function C(t,e,r){var n=t.adapter||"IMAGE",o=e.getLayerAdapters(),i=!o||o.IMAGE,a=t.resourceId;if(a){if("IMAGE"===n){if(i)return{url:r+"/api/component/render/image",resourceId:a,headers:t.headers,updateWmsParams:function(t){return Pt(t,a)}};n="TILE"}if("WMS"===n)return{url:r+"/api/resource/"+a+"/wms",format:"image/png",version:"1.1.1",layers:t.layers,headers:t.headers};if("MVT"===n)return{url:r+"/api/component/feature_layer/mvt?x={x}&y={y}&z={z}&resource="+a+"&simplification="+(t.simplification||0)};if("TERRAIN"===n)return{url:r+"/api/resource/"+a+"/terrain_provider",adapter:n};if("TILE"===n)return{url:r+"/api/component/render/tile?z={z}&x={x}&y={y}&resource="+a,adapter:n}}else console.log("Options `resourceId` not set")}var T=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),A=function(){return(A=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},N=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},R=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function B(t,e,r,n,o){return N(this,void 0,void 0,(function(){var i,a,s,u,c;return R(this,(function(p){switch(p.label){case 0:return i={wmsserver_service:"WMS",terrain_provider:"TERRAIN"},void 0!==(a=t.adapter||o&&i[o]||"IMAGE")&&(t.adapter=a),"IMAGE"===a&&(s=e.getLayerAdapters(),!s||s.IMAGE||(a="TILE")),(u=e.mapAdapter.layerAdapters[a])?[4,O(t,n)]:[3,2];case 1:return c=p.sent(),[2,function(n){function o(o,i){var a=n.call(this,o,i)||this;a.map=o,a.resourceId=c;var s=C(t,e,r);if(s)if(s.resourceId){var u=A(A({},s),{layers:String(s.resourceId),resourceId:s.resourceId});a.options=A(A({},a.options),u)}else{var p=s;a.options=A(A({},a.options),p)}return a}return T(o,n),o.prototype.addLayer=function(t){return n.prototype.addLayer.call(this,A(A({},this.options),t))},o.prototype.getIdentificationIds=function(){return N(this,void 0,void 0,(function(){var t;return R(this,(function(e){return(t=this.item&&this.item.resource.parent.id)?[2,[t]]:[2]}))}))},o}(u)];case 2:throw new Error(a+" not supported yet. Only TILE")}}))}))}function G(t,e,r,n){void 0===e&&(e=function(t){return!!t}),void 0===n&&(n=[]);var o=[];if(Array.isArray(t))o=t;else{e(t)&&n.push(t);var i=r(t);i&&(Array.isArray(i)?o=i:o.push(i))}for(var a=0;a<o.length;a++)o[a]&&G(o[a],e,r,n);return n}var U,F=function(){function t(t){this._children=[],this.item=t}return t.prototype.setParent=function(t){this._parent=t},t.prototype.addChild=function(t){this._children.push(t)},t.prototype.getParent=function(){return this._parent},t.prototype.getParents=function(t){var e=this.getParent();return e?G(e,t,(function(t){return t.tree.getParent()})):[]},t.prototype.getRoot=function(){for(var t=this.getParent(),e=t;t;)(t=t.tree.getParent())&&(e=t);return e},t.prototype.find=function(t){return G(this._children,t,(function(t){return t.tree.getChildren()}))[0]},t.prototype.all=function(t){return this.getDescendants(t)},t.prototype.getDescendants=function(t){return G(this._children,t,(function(t){return t.tree.getChildren()}))},t.prototype.getChildren=function(){return this._children},t}();try{U=r(29)}catch(t){}var q,Z=U&&U.EventEmitter,D=function(){function t(t,e,r){this.emitter=Z&&new Z,this._blocked=!1,this.item=e,this.options=Object.assign({},r),this.name=t,this._value=this.getProperty()}return t.prototype.getProperty=function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this,this.item):this.options.value},t.prototype.getParents=function(){return this.item.tree.getParents()||[]},t.prototype.getParent=function(){return this.item.tree.getParent()},t.prototype.isGroup=function(){return this.item.tree.getDescendants().length},t.prototype.isBlocked=function(){var t=this;if(void 0===this._blocked){var e=this.item.tree.getParents();if(e){var r=e.find((function(e){var r=e.properties&&e.properties.property(t.name);return!!r&&!r.get()}));this._blocked=!!r}else this._blocked=!1}return this._blocked},t.prototype.set=function(t,e){this._value=this._prepareValue(t),this.update(this._value,e),this._fireChangeEvent(this._value,e)},t.prototype.get=function(){return this.getValue()},t.prototype.update=function(t,e){this._callOnSet(t,e)},t.prototype.getContainer=function(){return this._container},t.prototype.destroy=function(){if(this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}this._removeEventsListener&&this._removeEventsListener()},t.prototype.getValue=function(){return void 0!==this._value?this._value:this.getProperty()},t.prototype._prepareValue=function(t){return t},t.prototype._callOnSet=function(t,e){this.options.onSet&&this.options.onSet.call(this,t,e,this.item)},t.prototype._fireChangeEvent=function(t,e){var r=this;this.emitter&&(t=void 0!==t?t:this.getValue(),this.emitter.emit("change",{value:t,options:e}),this.item.tree.getParents().forEach((function(n){var o=n.properties&&n.properties.property(r.name);o&&o.emitter.emit("change-tree",{value:t,options:e,item:r.item})})))},t}(),W=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),z=function(){return(z=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},J=function(t){function e(r,n,o){var i=t.call(this,r,n,z(z({},e.options),o))||this;return i.set(i.get()),i}return W(e,t),e.prototype.update=function(t,e){if(t){if(e&&e.bubble||this.options.bubble){this.unBlock(e);var r=this.getParent(),n=r&&r.properties&&r.properties.property(this.name);n&&n.set(t,Object.assign({},e,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(e)}else this._turnOff(e);(e&&e.propagation||this.options.propagation)&&this._propagation(t,e)},e.prototype.getHierarchyValue=function(){var t=this;return this.get()&&this.getParents().every((function(e){var r=e.properties&&e.properties.get(t.name);return r&&r.get()}))},e.prototype._prepareValue=function(t){return t},e.prototype._turnOff=function(t){this.options.turnOff&&this.options.turnOff.call(this,t),this._callOnSet(!1,t),this.options.hierarchy&&this.isGroup()&&this.blockChilds(t)},e.prototype._turnOn=function(t){this.options.turnOn&&this.options.turnOn.call(this,t),this._callOnSet(!0,t),this.options.hierarchy&&this.isGroup()&&this.unblockChilds(t)},e.prototype.block=function(t){this._blocked=!0,this._block(t)},e.prototype._block=function(t){this._turnOff(t)},e.prototype.unBlock=function(t){this._blocked=!1,this.getValue()&&this._unBlock(t)},e.prototype._unBlock=function(t){this._turnOn(t)},e.prototype.blockChilds=function(t){var e=this;this.item.tree.getDescendants().forEach((function(r){return e._blockChild(r,t)}))},e.prototype.unblockChilds=function(t){var e=this;this.item.tree.getChildren().forEach((function(r){return e._unBlockChild(r,t)}))},e.prototype._blockChild=function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.block&&r.block(e)},e.prototype._unBlockChild=function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.unBlock&&r.unBlock(e)},e.prototype._propagation=function(t,e){if(this.isGroup())for(var r=this.item.tree.getChildren(),n=0;n<r.length;n++){var o=r[n],i=o.properties&&o.properties.property(this.name);i&&i.set(t,z(z({},e),{propagation:!0,bubble:!1}))}},e.options={hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"},e}(D),Q=function(){return(Q=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},H=function(){function t(t,e){this.item=t,this.options={},this._properties={},this._propertiesList=[],e&&e.forEach(this._setPropertyHandler.bind(this))}return t.prototype.add=function(t){this._setPropertyHandler(t)},t.prototype._setPropertyHandler=function(e){var r=t.handlers,n=e.handler;if(!n&&e.type)switch(e.type){case"boolean":n=r.CheckProperty;break;case"string":n=r.BaseProperty;break;default:n=r.BaseProperty}if(n&&e.name){var o=Q({},e||{});this._properties[e.name]=new n(e.name,this.item,o),this._propertiesList.push(e.name)}},t.prototype.update=function(){this.list().forEach((function(t){t.update()}))},t.prototype.get=function(t){var e=this.property(t);if(e)return e.get()},t.prototype.set=function(t,e,r){var n=this.property(t);if(n)return n.set(e,r)},t.prototype.property=function(t){return this._properties[t]},t.prototype.list=function(){var t=this;return this._propertiesList.map((function(e){return t._properties[e]}))},t.prototype.destroy=function(){for(var t in this._properties){var e=this.property(t);e&&e.destroy&&e.destroy()}this._properties={},this._propertiesList=[]},t.handlers={CheckProperty:J},t}(),V=function(){return(V=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};try{q=r(29)}catch(t){}var $=q&&q.EventEmitter,Y=0,K=function(){function t(t){this.options={},this.id=Y,this.emitter=$&&new $,Y+=1,this.options=V({},t),this.tree=new F(this)}return t.prototype.initProperties=function(){this.properties=new H(this,this.options.properties)},t}(),X=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),tt=function(){return(tt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},et=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},rt=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},nt=function(t){function e(r,n,o,i){var a=t.call(this,tt(tt({},e.options),o))||this;if(a.webMap=r,a._rootDescendantsCount=0,i&&a.tree.setParent(i),a.item=n,"root"===a.item.item_type)a._rootDescendantsCount=a._sumUp(a.item.children);else{var s=a.tree.getRoot();s&&(a._rootDescendantsCount=s._rootDescendantsCount)}return a.initProperties(),a._init(n),a}return X(e,t),e.prototype.initItem=function(t){return et(this,void 0,void 0,(function(){var r,n,o,i,a,s,u,c,p,l=this;return rt(this,(function(f){switch(f.label){case 0:return r=t._layer,n=t,"group"!==t.item_type&&"root"!==t.item_type?[3,1]:(t.children&&t.children.length&&t.children.reverse().forEach((function(t){var r=new e(l.webMap,t,l.options,l);l.tree.addChild(r)})),[3,3]);case 1:return"layer"!==t.item_type?[3,3]:(o=t.adapter||t.layer_adapter.toUpperCase(),i=t.layer_max_scale_denom?this._mapScaleToZoomLevel(t.layer_max_scale_denom):this.webMap.options.maxZoom,a=t.layer_min_scale_denom?this._mapScaleToZoomLevel(t.layer_min_scale_denom):this.webMap.options.minZoom,s=tt(tt({maxZoom:i,minZoom:a,minScale:t.layer_min_scale_denom,maxScale:t.layer_max_scale_denom},t),{headers:this.options.headers}),this.options.order&&(u=this.options.drawOrderEnabled?this._rootDescendantsCount-t.draw_order_position:this.id,s.order=Number((0|this.options.order)+"."+u)),[4,this.webMap.addLayer(o,s)]);case 2:r=f.sent(),f.label=3;case 3:return r&&(n._layer=r,this.layer=r,this.properties&&"layer"===t.item_type&&t.layer_enabled&&this.properties.property("visibility").set(!0),"number"==typeof(c="layer"===t.item_type&&t.layer_transparency)&&(p=(100-c)/100,this.webMap.setLayerOpacity(r,p))),[2]}}))}))},e.prototype.bringToFront=function(){},e.prototype.fit=function(){"layer"===this.item.item_type&&console.log(this.item)},e.prototype._mapScaleToZoomLevel=function(t){return Bt(t)},e.prototype._init=function(t){return et(this,void 0,void 0,(function(){return rt(this,(function(e){switch(e.label){case 0:return[4,this.initItem(t)];case 1:return e.sent(),this.emitter.emit("init"),[2]}}))}))},e.prototype._sumUp=function(t,e){void 0===e&&(e=0);for(var r=0,n=t;r<n.length;r++){var o=n[r];"layer"===o.item_type?(e+=1,o.draw_order_position=o.draw_order_position||e):"group"===o.item_type&&(e=this._sumUp(o.children,e))}return e},e.options={properties:[{type:"boolean",name:"visibility",getProperty:function(t){if(t){if("group"===t.item.item_type)return!0;if("layer"===t.item.item_type)return t.item.layer_enabled;if("root"===t.item.item_type)return!0}return!1},onSet:function(t,e,r){r&&r.layer&&"layer"===r.item.item_type&&(t?r.webMap.showLayer(r.layer):r.webMap.hideLayer(r.layer),r.item.layer_enabled=t)}}]},e}(K),ot=function(){return(ot=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},it=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},at=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},st=function(){function t(t,e){this.map=t,this.options=e,this.pixelRadius=10,this.emitter=new i.EventEmitter;var r=e.resourceId;if(Array.isArray(r)?(this.resourceId=r[0],this.options.id=r[1]):this.resourceId=r,!this.resourceId)throw new Error("NGW `resourceId` is not defined")}return t.prototype.addLayer=function(t){return it(this,void 0,void 0,(function(){var e,r,n=this;return at(this,(function(o){switch(o.label){case 0:return this.options=ot(ot({},this.options),t),e=this,[4,this._getWebMapLayerItem()];case 1:return e.layer=o.sent(),this.options.identification?[4,this._getWebMapIds()]:[3,3];case 2:(r=o.sent())&&(this._webmapLayersIds=r,this.$$onMapClick=function(t){return n._onMapClick(t)},this.options.webMap.emitter.on("click",this.$$onMapClick)),o.label=3;case 3:return[2,this.layer]}}))}))},t.prototype.removeLayer=function(){var t=this.options.webMap.mapAdapter;this.$$onMapClick&&this.options.webMap.emitter.off("click",this.$$onMapClick),this.getDependLayers().forEach((function(e){"layer"in e&&t.removeLayer(e.layer.layer)})),this.$$onMapClick=void 0,delete this.options,delete this.layer,delete this.response,delete this._webmapLayersIds},t.prototype.showLayer=function(){this.layer&&this.layer.properties&&this.layer.properties.property("visibility").set(!0)},t.prototype.hideLayer=function(){this.layer&&this.layer.properties&&this.layer.properties.property("visibility").set(!1)},t.prototype.getExtent=function(){var t=this.response&&this.response.webmap;if(t)return Et(t)},t.prototype.getDependLayers=function(){return this.layer&&this.layer.tree.getDescendants()||[]},t.prototype.getIdentificationIds=function(){return it(this,void 0,void 0,(function(){var t,e;return at(this,(function(r){switch(r.label){case 0:return t=[],(e=this._webmapLayersIds)?[3,2]:[4,this._getWebMapIds()];case 1:e=r.sent(),this._webmapLayersIds=e,r.label=2;case 2:return e&&e.length&&this.getDependLayers().sort((function(t,e){return t.id-e.id})).forEach((function(e){var r=e.item,n=r.parentId;if(void 0!==n&&"layer"===r.item_type){var o=e.properties.property("visibility");o.get()&&!o.isBlocked()&&t.push(n)}})),[2,t]}}))}))},t.prototype._getWebMapLayerItem=function(){return it(this,void 0,void 0,(function(){var t,e=this;return at(this,(function(r){switch(r.label){case 0:return this.resourceId?[4,this.getWebMapConfig(this.resourceId)]:[3,2];case 1:if((t=r.sent())&&t.root_item)return[2,new Promise((function(r){var n={};if(e.options.connector&&e.options.connector.options.auth){var o=e.options.connector.getAuthorizationHeaders();o&&(n.headers=o)}n.order=e.options.order,n.drawOrderEnabled=t.draw_order_enabled;var i=new nt(e.options.webMap,t.root_item,n);i.emitter.on("init",(function(){return r(i)}))}))];r.label=2;case 2:return[2]}}))}))},t.prototype.getWebMapConfig=function(t){return it(this,void 0,void 0,(function(){var e,r;return at(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.options.connector.get("resource.item",null,{id:t})];case 1:return e=n.sent(),this.response=e,(r=e.webmap)?(this._updateItemsParams(r.root_item,this.options.webMap,e),[2,r]):[3,3];case 2:throw n.sent();case 3:return[2]}}))}))},t.prototype._updateItemsParams=function(t,e,r){var n=this;if(t)if("group"===t.item_type||"root"===t.item_type)t.children&&(t.children=t.children.map((function(t){return n._updateItemsParams(t,e,r)}))),"root"===t.item_type&&(t.display_name=r.resource.display_name);else if("layer"===t.item_type){var o=Object(s.e)(this.options.baseUrl+"/api/component/render/image"),i=t.layer_style_id;t.url=o,t.resourceId=i,t.updateWmsParams=function(t){return Pt(t,i)},t=ot(ot({},t),xt({adapter:t.layer_adapter.toUpperCase(),resourceId:i},e,this.options.baseUrl))}return t},t.prototype._getWebMapIds=function(){return it(this,void 0,void 0,(function(){var t,e,r,n=this;return at(this,(function(o){switch(o.label){case 0:return(t=this.layer)&&"root"===t.item.item_type?(e=t.tree.getDescendants(),r=[],e.forEach((function(t){var e=t.item;if("layer"===e.item_type){var o=e.layer_style_id,i=n.options.connector.get("resource.item",{},{id:o}).then((function(t){if(t){var r=Number(t.resource.parent.id);return e.parentId=r,r}}));r.push(i)}})),[4,Promise.all(r)]):[3,2];case 1:return[2,o.sent().filter((function(t){return void 0!==t}))];case 2:return[2]}}))}))},t.prototype._sendIdentifyRequest=function(t){var e=this;if(this._webmapLayersIds)return Nt(t,{layers:this._webmapLayersIds,connector:this.options.connector,radius:this.pixelRadius}).then((function(r){return e.emitter.emit("identify",{ev:t,data:r}),r}))},t.prototype._onMapClick=function(t){this._sendIdentifyRequest(t)},t}(),ut=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ct=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},pt=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var lt=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},ft=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ht=function(){function t(){}return t.prototype.getExtent=function(){return lt(this,void 0,void 0,(function(){var t;return ft(this,(function(e){switch(e.label){case 0:return this._extent?[2,this._extent]:this.item?(t=this,[4,Mt(this.item,this.connector).then()]):[3,2];case 1:return t._extent=e.sent(),[2,this._extent];case 2:return[2]}}))}))},t}(),yt=function(){return(yt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},dt=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},vt=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},mt=["mapserver_style","qgis_vector_style","qgis_raster_style","wmsserver_service","raster_style","terrain_provider"];function bt(t,e,r,n,o){return dt(this,void 0,void 0,(function(){var i,a;return vt(this,(function(s){switch(s.label){case 0:return[4,o.get("resource.collection",null,{parent:t})];case 1:return i=s.sent(),(a=i&&i[0])?[2,_t(yt(yt({},e),{resourceId:a.resource.id}),r,n,o)]:[2]}}))}))}function _t(t,e,r,n){return dt(this,void 0,void 0,(function(){var i,a,s,u,c,p;return vt(this,(function(l){switch(l.label){case 0:return l.trys.push([0,4,,5]),s=t.adapter,[4,O(t,n)];case 1:return(u=l.sent())?[4,n.get("resource.item",null,{id:u})]:[3,3];case 2:if(!(a=l.sent()))throw new Error("Can't add NGW layer because Resource item is not found");if(c=yt(yt({},t),{resourceId:u}),a.webmap)i=function(t,e,r,n){return ct(this,void 0,void 0,(function(){var o;return pt(this,(function(i){switch(i.label){case 0:return[4,O(t,n)];case 1:return o=i.sent(),[2,function(t){function i(i){return t.call(this,i,{webMap:e,resourceId:o,baseUrl:r,connector:n})||this}return ut(i,t),i}(st)]}}))}))}(c,e,r,n);else if(-1!==mt.indexOf(a.resource.cls))"GEOJSON"===s?(p=yt(yt({},t),{resourceId:a.resource.parent.id}),i=S(p,e,n,a)):i=B(c,e,r,n,a.resource.cls);else if("vector_layer"===a.resource.cls)if(void 0!==s&&"GEOJSON"!==s){if("MVT"!==s)return[2,bt(a.resource.id,c,e,r,n)];i=B(c,e,r,n,a.resource.cls)}else i=S(c,e,n,a);else{if("raster_layer"===a.resource.cls)return[2,bt(a.resource.id,c,e,r,n)];a.basemap_layer&&a.basemap_layer.qms&&(i=Promise.resolve(o.a.utils.createQmsAdapter(e))).then((function(t){if(t&&a&&a.basemap_layer&&a.basemap_layer.qms){var e=JSON.parse(a.basemap_layer.qms);t.prototype.qms=e,t.prototype.baseLayer=!0}}))}l.label=3;case 3:return[3,5];case 4:return l.sent(),[3,5];case 5:return i?[2,i.then((function(t){if(t){var e=t;return e.prototype.item=a,e.prototype.resourceId=null==a?void 0:a.resource.id,e.prototype.connector=n,r=e,[ht].forEach((function(t){Object.getOwnPropertyNames(t.prototype).forEach((function(e){var n=Object.getOwnPropertyDescriptor(t.prototype,e);n&&Object.defineProperty(r.prototype,e,n)}))})),e}var r}))]:[2]}}))}))}var gt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wt=function(){return(wt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Ot=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},Lt=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function Pt(t,e){return{resource:e,extent:t.bbox,size:t.width+","+t.height,timestamp:Date.now()}}var It={POINT:"circle",LINESTRING:"line",POLYGON:"fill",MULTIPOINT:"circle",MULTILINESTRING:"line",MULTIPOLYGON:"fill",POINTZ:"circle",LINESTRINGZ:"line",POLYGONZ:"fill",MULTIPOINTZ:"circle",MULTILINESTRINGZ:"line",MULTIPOLYGONZ:"fill"};function xt(t,e,r){return C(t,e,r)}function kt(t,e,r,n){var o=n.getAuthorizationHeaders();return o&&(t.headers=o),_t(t,e,r,n)}function Et(t){var e=t.extent_bottom,r=t.extent_left,n=t.extent_top,o=t.extent_right;if(e&&r&&n&&o){var i=[r,e,o,n];return i[3]>82&&(i[3]=82),i[1]<-82&&(i[1]=-82),i}}function jt(t,e){return e.get("layer.extent",name,{id:t}).then((function(t){if(t){var e=t.extent,r=e.maxLat,n=e.maxLon,o=e.minLat;return[e.minLon,o,n,r]}}))}function Mt(t,e){return Ot(this,void 0,void 0,(function(){var r;return Lt(this,(function(n){return t.webmap?[2,Et(t.webmap)]:-1!==(r=t.resource).cls.indexOf("style")?[2,e.get("resource.item",null,{id:r.parent.id}).then((function(t){return jt(t.resource.id,e)}))]:[2,jt(r.id,e)]}))}))}var St,Ct=Math.PI/180,Tt=180/Math.PI;function At(t,e){e=e>85.06?85.06:e<-85.06?-85.06:e;var r=20037508.34*t/180,n=Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180);return[r,n=20037508.34*n/180]}function Nt(t,e){var r=function(t,e,r,n){void 0===r&&(r=10),void 0===n&&(n=6);for(var o=r/3963*Tt,i=o/Math.cos(e*Ct),a=[],s=0;s<n+1;s++){var u=Math.PI*(s/(n/2)),c=t+i*Math.cos(u),p=e+o*Math.sin(u);a.push([c,p])}return a}(t.latLng.lng,t.latLng.lat,e.radius),n=[];r.forEach((function(t){var e=At(t[0],t[1]),r=e[0],o=e[1];n.push(r+" "+o)}));var o={geom:"POLYGON(("+n.join(", ")+"))",srs:3857,layers:e.layers};return e.connector.post("feature_layer.identify",{data:o})}function Rt(){if(void 0===St){var t=document.createElement("div");t.style.cssText="position: absolute;  left: -100%;  top: -100%;  width: 100cm;",document.body.appendChild(t);var e=t.offsetWidth;document.body.removeChild(t),St=e}return St}function Bt(t,e){if(void 0===e&&(e=104),e){var r=e;return function(t){return Math.log(t/256)/Math.LN2}(Rt()*function(t){return 12756274*Math.PI*Math.cos(t*Math.PI/180)}(r)/t)}return Math.round(Math.log(591657550.5/(t/2))/Math.log(2))}var Gt=function(){return(Gt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function Ut(t,e){var r;void 0===e&&(e=!1);var n=[],o=[];for(var i in t){var a=Number(i);isNaN(a)||n.push(a)}var s=t.resources;s&&n.sort((function(t,e){return s.indexOf(t)-s.indexOf(e)}));for(var u=0;u<n.length;u++){var c=t[i=n[u]].features,p=Number(i),l=c[0];if(l&&(r={featureId:l.id,resourceId:p},o.push(r),!e))break}return o}function Ft(t){var e=t.connector,r=t.identify;for(var n in r){var o=Number(n);if(!isNaN(o)){var i=r[n].features.find((function(t){return t.geom}));if(i&&i.geom){var a=i.geom;return h(Gt(Gt({},i),{geom:a}))}}}var s=Ut(r);if(s)return d(Gt({connector:e},s[0]))}var qt=function(){return(qt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Zt=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},Dt=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Wt=function(){function t(t){if(this.options=t,this.options.connector)this.url=this.options.connector.options.baseUrl||"",this.connector=this.options.connector;else{if(!this.options.baseUrl)throw new Error("url is not defined");this.url=this.options.baseUrl,this.connector=new n.a({baseUrl:this.url,auth:this.options.auth})}}return t.prototype.onLoadSync=function(t){return Zt(this,void 0,void 0,(function(){var e,r,n,o,i;return Dt(this,(function(a){switch(a.label){case 0:if(!this.options.resourceId||!this.url)return[3,4];if(!(e=[this.options.resourceId]).length)return[3,4];r=0,n=e,a.label=1;case 1:return r<n.length?(o=n[r],i={resourceId:o,connector:this.connector,baseUrl:this.url,webMap:t},[4,t.addLayer(st,qt({visibility:!0,fit:!0,identification:this.options.identification,pixelRadius:this.options.pixelRadius},i))]):[3,4];case 2:return[2,a.sent()];case 3:return r++,[3,1];case 4:return[2]}}))}))},t.prototype.getLayerAdapters=function(){return Promise.resolve([this._getLayerAdapter()])},t.prototype._getLayerAdapter=function(){var t=this;return{name:"WEBMAP",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}},t.prototype._createAdapter=function(t){var e,r=this.connector,n=this.url;return e={webMap:t,connector:r,baseUrl:n},function(t){function r(r,n){return n=wt(wt({},e),n),t.call(this,r,n)||this}return gt(r,t),r}(st)},t.utils={addNgwLayer:kt,getNgwResourceExtent:Mt,sendIdentifyRequest:Nt,pixelsInMeterWidth:Rt,getNgwLayerFeature:d,getNgwLayerFeatures:_,getNgwLayerItems:b,getNgwLayerItem:y,getIdentifyGeoJson:Ft,getIdentifyGeoJsonParams:Ut,createGeoJsonFeature:h,setScaleRatio:Bt},t.updateWmsParams=Pt,t.getLayerAdapterOptions=xt,t.addNgwLayer=kt,t}();e.a=Wt},41:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var n=r(17),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function i(t,e,r){if((e=String(e))===(t=String(t)))return!0;if(r&&e.toUpperCase()===t.toUpperCase())return!0;var o=("^"+Object(n.g)(e)+"$").replace(/%/g,".*").replace("_",".");return null!==new RegExp(o,r?"i":"").exec(t)}var a={gt:function(t,e){return t>e},lt:function(t,e){return t<e},ge:function(t,e){return t>=e},le:function(t,e){return t<=e},eq:function(t,e){return t===e},ne:function(t,e){return t!==e},in:function(t,e){return-1!==e.indexOf(t)},notin:function(t,e){return-1===e.indexOf(t)},like:function(t,e){return i(t,e)},ilike:function(t,e){return i(t,e,!0)}};function s(t){var e=t;return 3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]}function u(t,e){var r=o({},t.properties);return!!r&&(r.$id=t.id,c(r,e))}function c(t,e){var r="string"==typeof e[0]?e[0]:"all",n=function(e){if(s(e)){var r=e[0],n=e[1],o=e[2],i=a[n];if(i){if("like"===n||"ilike"===n){var u="",p=r.replace(/^%?(\w+)%?$/,(function(e,n){return u=t[n],r.replace(n,o)}));return i(u,p)}return i(t[r],o)}return!1}return c(t,e)},o=e.filter((function(t){return Array.isArray(t)}));return"any"===r?o.some(n):o.every(n)}},55:function(t,e,r){"use strict";function n(t){return"[object Object]"===Object.prototype.toString.call(t)}function o(t){return"function"==typeof t}r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return f}));var i=function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var a={get:function(t,e){var r=e[0];return t.properties&&t.properties[r]},match:function(t,e){var r=e[0],n=e.slice(1),o=r;Array.isArray(r)&&(o=s(t,r));for(var i=n.splice(-1,n.length%2)[0],a=0;a<n.length-1;a+=2){if(n[a]===o)return n[a+1]}return i}};function s(t,e){var r=e[0],n=e.slice(1),o=a[r];if(o)return o(t,n)}function u(t){return function(e){return s(e,t)}}var c=["iconSize","iconAnchor"];var p=r(41),l=function(){return(l=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function f(t,e,r){var a;if(o(t))return function(n){return f(t(n),e,r)};if(function(t){return!!Array.isArray(t)}(t))return function(n){return f((o={},i=[],t.forEach((function(t){t&&(Array.isArray(t)?i.push(t):o=t)})),function(t){var e=i.find((function(e){return Object(p.b)(t,e[0])}));return e?l(l({},o),e[1]):o})(n),e,r);var o,i};if("get-paint"===t.type){var s=function(t,e){if("function"==typeof t.from)return t.from(t.options);if("string"==typeof t.from&&e){var r=e[t.from];if(r)return r(t.options)}}(t,r);s&&(a=f(s,e,r))}else{if("icon"===t.type)return t;var h=function(t){var e,r=!1,n={};for(var o in t)if(-1===c.indexOf(o)){var a=o,s=t[a];e=s,Array.isArray(e)&&(r=!0,n[a]=u(s))}if(r)return function(e){var r={};for(var o in n)r[o]=n[o](e);return i(i({},t),r)}}(t);if(h)return function(t){return f(h(t),e,r)};(a=l({},t)).fill=void 0===a.fill||a.fill,a.stroke=void 0!==a.stroke?a.stroke:!a.fill||!(!a.strokeColor&&!a.strokeOpacity)}if(a){if(o(a))return a;n(a)&&(a=l(l({},e),a))}else a=l({},e);return"color"in a&&(a.strokeColor||(a.strokeColor=a.color),a.fillColor||(a.fillColor=a.color)),"opacity"in a&&(void 0===a.strokeOpacity&&(a.strokeOpacity=a.opacity),void 0===a.fillOpacity&&(a.fillOpacity=a.opacity)),a}},580:function(t,e,r){"use strict";function n(t,e,r,n,o){void 0===r&&(r={}),r.method=r.method||"GET";var i=new XMLHttpRequest;i.open(r.method||"GET",t,!0),"blob"===r.responseType&&(i.responseType=r.responseType);var a=function(t){void 0===t&&(t=!1);var o=t?n:e;if("blob"===r.responseType)o(i.response);else if(i.responseText)try{o(JSON.parse(i.responseText))}catch(t){o(i.responseText)}else n({message:""})};i.onreadystatechange=function(){4===i.readyState&&200===i.status||3===i.readyState&&201===i.status||3===i.readyState&&400===i.status||4===i.readyState&&500===i.status?a():4===i.readyState&&401===i.status?n(i.statusText):4===i.readyState&&n("request error")},i.onerror=function(t){n(t)},i.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;r.onProgress&&r.onProgress(e)}};var s,u=r.headers;if(u)for(var c in u){var p=u[c];"string"==typeof p&&i.setRequestHeader(c,p)}if(void 0!==r.withCredentials&&(i.withCredentials=r.withCredentials),r.file){if((s=new FormData).append("file",r.file),r.data)for(var l in s)s.append(l,s[l])}else s=r.data?"string"==typeof r.data?r.data:JSON.stringify(r.data):null;o&&o.push((function(){i.abort()})),i.send(s)}r.r(e),r.d(e,"default",(function(){return n}))},581:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return loadJSONNode}));var url=eval('require("url")'),http=eval('require("http")'),https=eval('require("https")'),adapterFor=function(t){return{"http:":http,"https:":https}[url.parse(t).protocol]};function loadJSONNode(t,e,r,n,o){return new Promise((function(e,n){var o=adapterFor(t);if(!o)throw new Error("Given URL '"+t+"' is not correct");o.get(t,r,(function(t){var r="";t.on("data",(function(t){r+=t})),t.on("end",(function(){e(JSON.parse(r))}))})).on("error",(function(t){n(t)}))})).then((function(t){return e&&e(t),t})).catch((function(t){if(!n)throw new Error(t);n(t)}))}},68:function(t,e,r){"use strict";var n=r(143);r(23);e.a=n.a}}]);