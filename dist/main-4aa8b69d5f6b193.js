/*! For license information please see main-4aa8b69d5f6b193.js.LICENSE.txt */
"use strict";(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[185],{8907:function(e,t,r){r.d(t,{q:function(){return i}}),r(2222);var n={brill:'<path d="m6 0-5 6 5 6 5-6z"/>',circle:'<circle cx="6" cy="6" r="6"/>',rect:'<rect width="12" height="12"/>',marker:'<path d="m6 0c-1.85 0-4 1.19-4 4.22 0 2.05 3.08 6.59 4 7.78 0.821-1.19 4-5.62 4-7.78 0-3.03-2.15-4.22-4-4.22z"/>',cross:'<path d="M 2.4,12 6,8.4 9.6,12 12,9.6 8.4,6 12,2.4 9.6,0 6,3.6 2.4,0 0,2.4 3.6,6 0,9.6 Z"/>',star:'<path d="m6 0.25 1.71 4.18 4.29-1.04e-4 -3.43 3.14 0.857 4.18-3.43-3.14-3.43 3.14 0.857-4.18-3.43-3.14 4.29-0.209z"/>',triangle:'<path d="m12 11.7h-12l6-11.2z"/>',plus:'<path d="m7.5 12v-4.5h4.5v-3h-4.5v-4.5h-3v4.5h-4.5v3h4.5v4.5z"/>',minus:'<path d="m12 7.5v-3h-12v3z"/>',asterisk:'<path d="m7.59 12v-3.27l2.83 1.64 1.58-2.74-2.85-1.64 2.83-1.64-1.56-2.74-2.83 1.64v-3.24h-3.17v3.24l-2.85-1.64-1.57 2.74 2.84 1.64-2.84 1.64 1.57 2.74 2.85-1.64v3.27z"/>'};function o(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,o=r/2,i='<svg\n    version="1.1"\n    xmlns="http://www.w3.org/2000/svg"\n    width="'.concat(e,'"\n    height="').concat(t,'"\n    viewBox="-').concat(o," -").concat(o," ").concat(e+r," ").concat(t+r,'"\n  >').concat(n,"</svg>"),u=new DOMParser,a=u.parseFromString(i,"image/svg+xml");return a.documentElement}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.shape||"circle",r=e.color||"blue",i=e.strokeColor||"white",u=e.size||12,a=u/2,c=12,s="number"==typeof e.stroke?e.stroke:.8,f=u/c,l=n[t]||"circle",p="string"==typeof l?l:l(e),y=o(u,u,s*f,p),h=y.firstChild,v="scale(".concat(f,")");h.setAttribute("fill",r),s&&(h.setAttribute("stroke",i),h.setAttribute("stroke-width",String(s))),h.setAttribute("transform",v);var b=new XMLSerializer;return{type:"icon",iconSize:[u,u],iconAnchor:[a,a],html:b.serializeToString(y),svg:y}}},6952:function(e,t,r){r.d(t,{ck:function(){return R}}),r(7941),r(2526),r(7327),r(5003),r(4747),r(9337),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(1038),r(7042),r(8309);var n=r(4034);function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"item",void 0),u(this,"_children",[]),u(this,"_parent",void 0),this.item=t}var t,r;return t=e,(r=[{key:"setParent",value:function(e){this._parent=e}},{key:"addChild",value:function(e){this._children.push(e)}},{key:"getParent",value:function(){return this._parent}},{key:"getParents",value:function(e){var t=this.getParent();return t?(0,n.Zm)(t,e,(function(e){return e.tree.getParent()})):[]}},{key:"getRoot",value:function(){for(var e=this.getParent(),t=e;e;)(e=e.tree.getParent())&&(t=e);return t}},{key:"find",value:function(e){return(0,n.Ql)(this._children,e,(function(e){return e.tree.getChildren()}))}},{key:"every",value:function(e){return(0,n.qL)(this._children,e,(function(e){return e.tree.getChildren()}))}},{key:"some",value:function(e){return(0,n.cC)(this._children,e,(function(e){return e.tree.getChildren()}))}},{key:"all",value:function(e){return this.getDescendants(e)}},{key:"getDescendants",value:function(e){return(0,n.Zm)(this._children,e,(function(e){return e.tree.getChildren()}))}},{key:"getChildren",value:function(){return function(e){if(Array.isArray(e))return o(e)}(e=this._children)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();var e}}])&&i(t.prototype,r),e}(),c=(r(1249),r(9601),r(8304),r(489),r(2419),r(9826),r(7187));function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(n);if(o){var r=d(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return b(this,e)});function u(e,t,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e,t,y(y({},u.options),r))).set(n.get()),n}return t=u,(r=[{key:"update",value:function(e,t){if(e){if(t&&t.bubble||this.options.bubble){this.unBlock(t);var r=this.getParent(),n=r&&r.properties&&r.properties.property(this.name);n&&n.set(e,Object.assign({},t,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(t)}else this._turnOff(t);(t&&t.propagation||this.options.propagation)&&this._propagation(e,t)}},{key:"getHierarchyValue",value:function(){var e=this;return this.get()&&this.getParents().every((function(t){var r=t.properties&&t.properties.get(e.name);return r&&r.get()}))}},{key:"_prepareValue",value:function(e){return e}},{key:"_turnOff",value:function(e){this.options.turnOff&&this.options.turnOff.call(this,e),this._callOnSet(!1,e),this.options.hierarchy&&this.isGroup()&&this.blockChild(e)}},{key:"_turnOn",value:function(e){this.options.turnOn&&this.options.turnOn.call(this,e),this._callOnSet(!0,e),this.options.hierarchy&&this.isGroup()&&this.unblockChild(e)}},{key:"block",value:function(e){this._blocked=!0,this._block(e)}},{key:"_block",value:function(e){this._turnOff(e)}},{key:"unBlock",value:function(e){this._blocked=!1,this.getValue()&&this._unBlock(e)}},{key:"_unBlock",value:function(e){this._turnOn(e)}},{key:"blockChild",value:function(e){var t=this;this.item.tree.getDescendants().forEach((function(r){return t._blockChild(r,e)}))}},{key:"unblockChild",value:function(e){var t=this;this.item.tree.getChildren().forEach((function(r){return t._unBlockChild(r,e)}))}},{key:"_blockChild",value:function(e,t){var r=e.properties&&e.properties.property(this.name);r&&r.block&&r.block(t)}},{key:"_unBlockChild",value:function(e,t){var r=e.properties&&e.properties.property(this.name);r&&r.unBlock&&r.unBlock(t)}},{key:"_propagation",value:function(e,t){if(this.isGroup())for(var r=this.item.tree.getChildren(),n=0;n<r.length;n++){var o=r[n],i=o.properties&&o.properties.property(this.name);i&&i.set(e,y(y({},t),{propagation:!0,bubble:!1}))}}}])&&h(t.prototype,r),u}(function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"options",void 0),f(this,"emitter",new c.EventEmitter),f(this,"name",void 0),f(this,"item",void 0),f(this,"_blocked",!1),f(this,"_container",void 0),f(this,"_value",void 0),f(this,"_removeEventsListener",void 0),this.item=r,this.options=Object.assign({},n),this.name=t,this._value=this.getProperty()}var t,r;return t=e,(r=[{key:"getProperty",value:function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this,this.item):this.options.value}},{key:"getParents",value:function(){return this.item.tree.getParents()||[]}},{key:"getParent",value:function(){return this.item.tree.getParent()}},{key:"isGroup",value:function(){return this.item.tree.getDescendants().length}},{key:"isBlocked",value:function(){var e=this;if(void 0===this._blocked){var t=this.item.tree.getParents();if(t){var r=t.find((function(t){var r=t.properties&&t.properties.property(e.name);return!!r&&!r.get()}));this._blocked=!!r}else this._blocked=!1}return this._blocked}},{key:"set",value:function(e,t){this._value=this._prepareValue(e),this.update(this._value,t),this._fireChangeEvent(this._value,t)}},{key:"get",value:function(){return this.getValue()}},{key:"update",value:function(e,t){this._callOnSet(e,t)}},{key:"getContainer",value:function(){return this._container}},{key:"destroy",value:function(){if(this._container){var e=this._container.parentNode;e&&e.removeChild(this._container)}this._removeEventsListener&&this._removeEventsListener()}},{key:"getValue",value:function(){return void 0!==this._value?this._value:this.getProperty()}},{key:"_prepareValue",value:function(e){return e}},{key:"_callOnSet",value:function(e,t){this.options.onSet&&this.options.onSet.call(this,e,t,this.item)}},{key:"_fireChangeEvent",value:function(e,t){var r=this;this.emitter&&(e=void 0!==e?e:this.getValue(),this.emitter.emit("change",{value:e,options:t}),this.item.tree.getParents().forEach((function(n){var o=n.properties&&n.properties.property(r.name);o&&o.emitter.emit("change-tree",{value:e,options:t,item:r.item})})))}}])&&s(t.prototype,r),e}());function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}m(g,"options",{hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"});var P=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.item=t,_(this,"options",{}),_(this,"_properties",{}),_(this,"_propertiesList",void 0),this._propertiesList=[],r&&r.forEach(this._setPropertyHandler.bind(this))}var t,r;return t=e,(r=[{key:"add",value:function(e){this._setPropertyHandler(e)}},{key:"_setPropertyHandler",value:function(t){var r=e.handlers,n=t.handler;if(!n&&t.type)switch(t.type){case"boolean":n=r.CheckProperty;break;case"string":n=r.BaseProperty;break;default:n=r.BaseProperty}if(n&&t.name){var o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){_(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t||{});this._properties[t.name]=new n(t.name,this.item,o),this._propertiesList.push(t.name)}}},{key:"update",value:function(){this.list().forEach((function(e){e.update()}))}},{key:"get",value:function(e){var t=this.property(e);if(t)return t.get()}},{key:"set",value:function(e,t,r){var n=this.property(e);if(n)return n.set(t,r)}},{key:"property",value:function(e){return this._properties[e]}},{key:"list",value:function(){var e=this;return this._propertiesList.map((function(t){return e._properties[t]}))}},{key:"destroy",value:function(){for(var e in this._properties){var t=this.property(e);t&&t.destroy&&t.destroy()}this._properties={},this._propertiesList=[]}}])&&w(t.prototype,r),e}();function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}_(P,"handlers",{CheckProperty:g});var E=0,R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),S(this,"options",{}),S(this,"properties",void 0),S(this,"tree",void 0),S(this,"id",E),E+=1,this.options=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t),this.tree=new a(this)}var t,r;return t=e,(r=[{key:"initProperties",value:function(){this.properties=new P(this,this.options.properties)}}])&&k(t.prototype,r),e}()},5020:function(e,t,r){r.d(t,{Z:function(){return gt}}),r(1249),r(4916),r(5306),r(4747),r(7941),r(2526),r(7327),r(5003),r(9337),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(7042),r(8309),r(1038);var n=r(7187),o=r(5243),i=(r(2772),{Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon",GeometryCollection:"polygon"}),u={stroke:!1,opacity:1},a={};for(var c in i){var s=i[c],f=a[s]||[];f.push(c),a[s]=f}function l(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=1+(t[e[r]]||0);var n="";for(var o in t){var i=n?t[n]:0;t[o]>i&&(n=o)}return n}function p(e,t){return-1!==(a[t]||[]).indexOf(e)}function y(e){var t=e.containerPoint,r=e.latlng,n=r.lat;return{latLng:r,lngLat:[r.lng,n],pixel:{left:t.x,top:t.y},source:e}}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,n=o.Control.extend({onAdd:function(){var n=document.createElement("div"),i=e.onAdd(r);return n.classList.add("leaflet-control"),t.bar&&n.classList.add("leaflet-bar"),t.margin||t.bar||(n.style.marginBottom="0px",n.style.marginTop="0px",n.style.marginLeft="0px",n.style.marginRight="0px"),i&&n.appendChild(i),o.DomEvent.disableClickPropagation(n),n},onRemove:function(){e.onRemove()}});return new n}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(8304),r(489),r(2419);var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=m(t);if(r){var o=m(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return d(this,e)});function o(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),t=n.call(this,e);var r=e&&e.customAttribution;if(r){var i=[];Array.isArray(r)?i=r:r&&(i=[r]),i.forEach((function(e){return t.addAttribution(e)}))}return t}return o}(o.Control.Attribution),O=(r(5666),r(561),r(4553),r(9826),r(9601),r(8674),r(1344)),w=r(9443);function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=function(){function e(t,r){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.map=t,this.options=r,P(this,"layer",void 0),P(this,"pane","order-0"),void 0!==r.order){var n="order-"+r.order,o=t.getPane(n);o||(o=t.createPane(n)),o.style.zIndex=String(Math.round(100*r.order)),this.pane=n}}var t,r;return t=e,(r=[{key:"addLayer",value:function(e){}}])&&_(t.prototype,r),e}();function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(e);!(u=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(e,t)||x(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?E(Object(r),!0).forEach((function(t){U(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r,n,o,i,u){try{var a=e[i](u),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,o)}function T(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=x(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}function x(e,t){if(e){if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return I(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(h,e);var t,r,n,a,c,s,f=(c=h,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=M(c);if(s){var r=M(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return B(this,e)});function h(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,h),U(I(r=f.call(this,e,t)),"layer",void 0),U(I(r),"selected",!1),U(I(r),"paint",void 0),U(I(r),"selectedPaint",void 0),U(I(r),"type",void 0),U(I(r),"_layers",[]),U(I(r),"_selectedLayers",[]),U(I(r),"_filteredLayers",[]),U(I(r),"_filterFun",void 0),U(I(r),"_openedPopup",[]),U(I(r),"$updateTooltip",(0,O.Ds)((function(){r.updateTooltip()}),300)),U(I(r),"$unselect",(function(){r.unselect()})),r.layer=new o.FeatureGroup([],{pane:r.pane}),r}return t=h,(r=[{key:"addLayer",value:function(e){return this.options=e,this.paint=e.paint,this.selectedPaint=e.selectedPaint,e.paint=this.paint,e.data&&this.addData(e.data),this._addMapListener(),this.layer}},{key:"beforeRemove",value:function(){this._removeMapListener()}},{key:"select",value:function(e){var t=this;e?this._layers.filter(e).forEach((function(e){t._selectLayer(e,"api")})):this.selected||(this.selected=!0,this.selectedPaint&&this.setPaintEachLayer(this.selectedPaint))}},{key:"unselect",value:function(e){var t=this;if(e)this._layers.filter(e).forEach((function(e){t._unSelectLayer(e)}));else if(this.selected){var r,n=T(this._openedPopup);try{for(n.s();!(r=n.n()).done;){var o=r.value;this._removePopup(o[0])}}catch(e){n.e(e)}finally{n.f()}this.paint&&this.setPaintEachLayer(this.paint),this._selectedLayers.length=0,this.selected=!1}}},{key:"getSelected",value:function(){return this._selectedLayers.map((function(e){return{feature:e.feature,layer:e}}))}},{key:"getFiltered",value:function(){return this._filteredLayers}},{key:"filter",value:function(e){var t=this;this._filterFun=e;var r=this.layer._map;r&&this.layer.remove();var n=[];return this._layers.forEach((function(r){var o=r.feature,i=r.layer;i&&(!e||e({feature:o,layer:i})?(t.layer.addLayer(i),n.push({feature:o,layer:i})):t.layer.removeLayer(i))})),this._filteredLayers=n,r&&this.layer.addTo(r),this._filteredLayers}},{key:"cleanFilter",value:function(){this.filter()}},{key:"getLayers",value:function(){var e=this;return this._layers.map((function(t){var r=t.layer;return{feature:t.feature,layer:r,visible:r&&!!r._map,target:e}}))}},{key:"clearLayer",value:function(e){if(this.unselect(),e)for(var t=this._layers.length;t--;){var r=this._layers[t];if(r){var n=r.feature,o=r.layer;n&&o&&e(n)&&(this.layer.removeLayer(o),this._layers.splice(t,1))}}else this.layer.clearLayers(),this._layers=[]}},{key:"setData",value:function(e){this.clearLayer(),this.addData(e)}},{key:"addData",value:function(e){var t,r,n=this.options;if(n){if(e){var u;if(n.type)u=n.type;else{var a="FeatureCollection"===(r=e).type?l(r.features.map((function(e){return e.geometry.type}))):"GeometryCollection"===r.type?l(r.geometries.map((function(e){return e.type}))):"Feature"===r.type?r.geometry.type:r.type;u=i[a]}if(this.type&&this.type!==u)return void console.warn("no other data type than layer can be added");this.type=u,(e=function(e,t){if("FeatureCollection"===e.type){var r=e;r.features=r.features.filter((function(e){return p(e.geometry.type,t)}))}else if("Feature"===e.type){if(!p(e.geometry.type,t))return!1}else if("GeometryCollection"===e.type){var n=e;n.geometries=n.geometries.filter((function(e){return p(e.type,t)}))}return e}(e,u))&&(t=this.getGeoJsonOptions(n,u))}new o.GeoJSON(e||void 0,t)}}},{key:"openPopup",value:function(e,t){var r=this;e&&this._layers.filter(e).forEach((function(e){r._openPopup(e,t,"api")}))}},{key:"closePopup",value:function(e){var t=this;(e?this._openedPopup.filter((function(t){return e(t[2])})):this._openedPopup).forEach((function(e){t._removePopup(e[0])}))}},{key:"updateTooltip",value:function(e){var t=this;e?this._updateTooltip(e):this.getLayers().forEach((function(e){return t._updateTooltip({feature:e.feature,layer:e.layer})}))}},{key:"getExtent",value:function(){var e=this.layer.getBounds(),t=e.getNorthEast(),r=e.getSouthWest();if(t&&r)return[r.lng,r.lat,t.lng,t.lat]}},{key:"_updateTooltip",value:function(e){var t=e.feature,r=e.layer;if(t&&r&&t.properties&&this.options.labelField){r.unbindTooltip();var n=t.properties[this.options.labelField];if(void 0!==n){var o=!this.options.labelOnHover;r.bindTooltip(String(n),{permanent:o,sticky:!1})}}}},{key:"_openPopup",value:(n=regeneratorRuntime.mark((function e(t){var r,n,o,i,u,a,c,s,f,l,p,y,h,v,b,d,m,g,O,w=this,_=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=_.length>1&&void 0!==_[1]?_[1]:{},n=_.length>2?_[2]:void 0,o=_.length>3?_[3]:void 0,i=t.feature,u=t.layer,a=R({minWidth:300},r),c=a.minWidth,s=a.autoPan,f=a.maxWidth,l=a.closeButton,p=null!=l?l:!this.options.selectOnHover,h=[],v=function(e){h.push(e)},b=function(){y&&w._removePopup(y)},!r.createPopupContent){e.next=15;break}return e.next=12,r.createPopupContent({layer:u,feature:i,target:this,type:n,close:b,onClose:v});case 12:e.t0=e.sent,e.next=16;break;case 15:e.t0=r.popupContent;case 16:(d=e.t0)&&u&&(y=u.bindPopup(d,{minWidth:c,autoPan:s,maxWidth:f,closeButton:p,closeOnClick:!1,autoClose:!1}),(null===(m=null===(g=this.options.popupOptions)||void 0===g?void 0:g.unselectOnClose)||void 0===m||m)&&(O=u.getPopup())&&O.once("remove",(function(){b()}),this),this._openedPopup.push([y,h,t]),setTimeout((function(){y.openPopup(o)}),0));case 18:case"end":return e.stop()}}),e,this)})),a=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function u(e){C(i,r,o,u,a,"next",e)}function a(e){C(i,r,o,u,a,"throw",e)}u(void 0)}))},function(e){return a.apply(this,arguments)})},{key:"_removePopup",value:function(e){if(this.map){e.closePopup().unbindPopup();var t=this._openedPopup.findIndex((function(t){return t[0]===e}));if(-1!==t){var r,n,o,i=null===(r=null===(n=this.options.popupOptions)||void 0===n?void 0:n.unselectOnClose)||void 0===r||r,u=S(this._openedPopup[t],3),a=u[1],c=u[2],s=T(a);try{for(s.s();!(o=s.n()).done;)(0,o.value)(c)}catch(e){s.e(e)}finally{s.f()}a.length=0,i&&this._unSelectLayer(c),this._openedPopup.splice(t,1)}}}},{key:"setPaintEachLayer",value:function(e){var t=this;this._layers.forEach((function(r){t.setPaint(r,e)}))}},{key:"setPaint",value:function(e,t){var r=void 0,n=e.layer,o=e.feature;if(n&&o&&((0,w.UY)(t)?r=t(o):(0,w.GY)(t)&&(r=t),r))if("point"===this.type&&"icon"===r.type){var i=n,u=this.createDivIcon(r);i.setIcon(u)}else"setStyle"in n&&n.setStyle(this.preparePaint(r))}},{key:"preparePaint",value:function(e){if("get-paint"!==e.type){var t="line"===this.type?[["color","strokeColor"],["opacity","strokeOpacity"],["weight","weight"]]:[["color","strokeColor"],["opacity","strokeOpacity"],["stroke","stroke"],["fillColor","fillColor"],["fillOpacity","fillOpacity"],["fill","fill"],["weight","weight"]],r={};return"radius"in e&&"number"==typeof e.radius&&(r.radius=e.radius),t.forEach((function(t){var n=S(t,2),o=n[0],i=n[1],u=e[i];void 0!==u&&Object.defineProperty(r,o,{enumerable:!0,value:u})})),r}return u}},{key:"getGeoJsonOptions",value:function(e,t){var r=this,n=e.paint,o={};return"function"==typeof n?"point"===t?o.pointToLayer=function(e,t){var o=n(e);return r.createPaintToLayer(o)(e,t)}:o={style:function(e){return e?r.preparePaint(R(R({},u),n(e))):r.preparePaint(R(R({},u),{},{type:"path"}))}}:o=this.createPaintOptions(n,t),o.onEachFeature=function(e,t){t.options.pane=r.pane,r._layers.push({feature:e,layer:t});var n=!0;if(r._filterFun&&(n=r._filterFun({feature:e,layer:t})),n){var o=r.options,i=o.popup,u=o.popupOptions,a=o.selectable,c=o.interactive,s=o.selectOnHover;t.options.interactive=!(0,O.ri)(c)||c,r.layer.addLayer(t),a&&(s?(t.on("mouseover",(function(){r._selectLayer({feature:e,layer:t},"hover")})),t.on("mouseout",(function(){r._unSelectLayer({feature:e,layer:t})}))):t.on("click",(function(e){return r._selectOnLayerClick(e)}),r)),r._handleMouseEvents(t),i&&r._openPopup({layer:t,feature:e},u,"api"),r._updateTooltip({layer:t,feature:e})}},o}},{key:"_handleMouseEvents",value:function(e){var t=this,r=function(e){var r=e.target;return{layer:t,feature:r.feature,event:y(e),source:e}},n=this.options,o=n.onClick,i=n.onLayerClick,u=n.onMouseOut,a=n.onMouseOver,c=o||i;c&&e.on("click",(function(e){var n;c(R({selected:(n=e.target,-1!==t._selectedLayers.indexOf(n))},r(e)))}),this),u&&e.on("mouseout",(function(e){u(r(e))}),this),a&&e.on("mouseover",(function(e){a(r(e))}),this)}},{key:"_selectOnLayerClick",value:function(e){o.DomEvent.stopPropagation(e);var t=e.target,r={layer:t,feature:t.feature},n=!!this._selectedLayers.find((function(e){return e.layer===t}));n?this.options&&this.options.unselectOnSecondClick&&(this._unSelectLayer(r),n=!1):(this._selectLayer(r,"click",e.latlng),n=!0)}},{key:"_selectLayer",value:function(e,t,r){var n=this;this.map._addUnselectCb((function(){n._unSelectLayer(e)})),this.options&&!this.options.multiselect&&this._selectedLayers.forEach((function(e){return n._unSelectLayer(e)})),this._selectedLayers.push(e),this.selected=!0;var o=this.options,i=o.selectedPaint,u=o.popupOnSelect,a=o.popupOptions;i&&e.layer&&this.setPaint(e,i),u&&this._openPopup(e,a,t,r),this.options.onSelect&&this.options.onSelect({type:t,layer:this,features:e.feature?[e.feature]:[]})}},{key:"_unSelectLayer",value:function(e){var t=this._selectedLayers.indexOf(e);-1!==t&&(this._selectedLayers.splice(t,1),this.options&&(this.options.paint&&this.setPaint(e,this.options.paint),this.options.popupOnSelect&&e.layer&&this._removePopup(e.layer))),this.selected=this._selectedLayers.length>0}},{key:"createDivIcon",value:function(e){var t=Object.assign({},e);return new o.DivIcon(R({className:""},t))}},{key:"createPaintToLayer",value:function(e){var t=this;if(e&&e.type)if("icon"===e.type){var r=e.className,n=e.html;if(r||n)return function(r,n){var i=t.createDivIcon(e);return new o.Marker(n,{icon:i})}}else if("pin"===e.type)return function(e,t){return new o.Marker(t)};return function(r,n){var i=u;return new o.CircleMarker(n,t.preparePaint(R(R({},i),e)))}}},{key:"createPaintOptions",value:function(e,t){var r={},n=e&&this.preparePaint(e)||{};return e&&(r.style=function(){return n}),"point"===t?r.pointToLayer=this.createPaintToLayer(e):"line"===t&&(n.stroke=!0),r}},{key:"_addMapListener",value:function(){var e=this.map;if(e){var t=this.options,r=t.labelField,n=t.labelOnHover,o=t.unselectOnClick;(null==o||o)&&e.on("click",this.$unselect),r&&!n&&(e.on("zoomend",this.$updateTooltip),e.on("moveend",this.$updateTooltip))}}},{key:"_removeMapListener",value:function(){this.map.off("zoomend",this.$updateTooltip),this.map.off("moveend",this.$updateTooltip),this.map.off("click",this.$unselect)}}])&&D(t.prototype,r),h}(j);function F(e,t,r){var n=new XMLHttpRequest;for(var o in n.open("GET",e),n.responseType="arraybuffer",r)n.setRequestHeader(o,r[o]);return n.onload=function(){var e=new Uint8Array(this.response),r=new Blob([e],{type:"image/png"}),n=(window.URL||window.webkitURL).createObjectURL(r);t(n)},n.send(),function(){n.abort()}}function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t,r){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=V(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return q(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(2222),r(4678),r(9600),r(4819),r(2472),r(2990),r(8927),r(3105),r(5035),r(4345),r(7174),r(2846),r(4731),r(7209),r(6319),r(8867),r(7789),r(3739),r(9368),r(4483),r(2056),r(3462),r(678),r(7462),r(3824),r(5021),r(2974),r(5016),r(285);var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=V(n);if(o){var r=V(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return W(this,e)});function u(e,t,r){var n,o,a,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),c=[],(a="_abort")in(o=q(n=i.call(this,e,t,r)))?Object.defineProperty(o,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[a]=c,n}return t=u,(r=[{key:"cancelLoad",value:function(){this._abort&&(this._abort.forEach((function(e){return e()})),this._abort=[])}},{key:"_initImage",value:function(){N(V(u.prototype),"_initImage",this).call(this);var e=this.options.headers;if(e){var t=this._image,r=t.src;t.src="",this._abort.push(F(r,(function(e){t.src=e}),e))}}}])&&G(t.prototype,r),u}(o.ImageOverlay);function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e,t){if(t&&("object"===J(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return K(e)}function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(a,e);var t,r,n,i,u=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ee(n);if(i){var r=ee(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return X(this,e)});function a(e,t){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),te(K(r=u.call(this,t)),"defaultWmsParams",{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1}),te(K(r),"options",{crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18,pane:"tilePane",headers:null,viewPortBuffer:0,setViewDelay:100}),te(K(r),"wmsParams",void 0),te(K(r),"_url",void 0),te(K(r),"_currentUrl",void 0),te(K(r),"_currentOverlay",void 0),r._url=e;var n,i={},c={};for(n in t)n in r.options?c[n]=t[n]:i[n]=t[n];return o.Util.setOptions(K(r),c),r.wmsParams=o.Util.extend({},r.defaultWmsParams,i),r}return t=a,(r=[{key:"setParams",value:function(e){o.Util.extend(this.wmsParams,e),this.update()}},{key:"getAttribution",value:function(){return this.options.attribution||""}},{key:"onAdd",value:function(){return this.update(),this}},{key:"onRemove",value:function(e){return this._currentOverlay&&(this._currentOverlay.cancelLoad(),e.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl,this}},{key:"getEvents",value:function(){return{moveend:(0,O.Ds)(this.update,this.options.setViewDelay)}}},{key:"update",value:function(){var e=this;if(this._map){this.updateWmsParams();var t=this.getImageUrl();if(this._currentUrl!==t){this._currentUrl=t;var r=this.options.viewPortBuffer||0,n=this._map.getBounds().pad(r),o=new $(t,n,{opacity:0,pane:this.options.pane,headers:this.options.headers});o.addTo(this._map),this._currentOverlay&&this._currentOverlay.cancelLoad(),o.once("load",(function(){e._map&&(o._url===e._currentUrl?(e._currentOverlay&&e._map.removeLayer(e._currentOverlay),e._currentOverlay=o,o.setOpacity(void 0!==e.options.opacity?e.options.opacity:1),!0===e.options.isBack&&o.bringToBack(),!1===e.options.isBack&&o.bringToFront(),void 0!==e.options.zIndex&&o.setZIndex(e.options.zIndex)):e._map.removeLayer(o))}),this);var i=this.options,u=i.minZoom,a=i.maxZoom;(u&&this._map.getZoom()<u||a&&this._map.getZoom()>a)&&this._map.removeLayer(o)}}}},{key:"setOpacity",value:function(e){this.options.opacity=e,this._currentOverlay&&this._currentOverlay.setOpacity(e)}},{key:"bringToBack",value:function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()}},{key:"bringToFront",value:function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()}},{key:"setZIndex",value:function(e){this.options.zIndex=e,this._currentOverlay&&this._currentOverlay.setZIndex(e)}},{key:"updateWmsParams",value:function(e){e||(e=this._map);var t=this.options.viewPortBuffer||0,r=e.getBounds().pad(t),n=e.getSize();if(0!==this.options.viewPortBuffer){var i=t+1;n.x=Math.ceil(n.x*i),n.y=Math.ceil(n.y*i)}var u=parseFloat(this.wmsParams.version),a=this.options.crs||e.options.crs,c=u>=1.3?"crs":"srs";if(a){var s=a.project(r.getNorthWest()),f=a.project(r.getSouthEast()),l={width:n.x,height:n.y};l[c]=a.code,l.bbox=(u>=1.3&&a===o.CRS.EPSG4326?[f.y,s.x,s.y,f.x]:[s.x,f.y,f.x,s.y]).join(","),o.Util.extend(this.wmsParams,l)}}},{key:"getImageUrl",value:function(){var e=this.options.uppercase||!1,t=o.Util.getParamString(this.wmsParams,this._url,e);return this._url+t}}])&&Q(t.prototype,r),a}(o.Layer);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach((function(t){pe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ue(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e,t){if(t&&("object"===ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fe(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ye=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=le(n);if(o){var r=le(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return se(this,e)});function u(){var e;ue(this,u);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return pe(fe(e=i.call.apply(i,[this].concat(r))),"layer",void 0),e}return t=u,(r=[{key:"addLayer",value:function(e){var t=e&&e.url;if(t){var r=(e=ie({transparent:!0},e)).updateWmsParams;if(this.layer=new re(t,ie(ie({pane:this.pane,headers:e.headers,setViewDelay:e.setViewDelay},e),e.params)),r){var n=this.layer.updateWmsParams;this.layer.updateWmsParams=function(e){n.call(this,e),this.wmsParams=r(this.wmsParams)}}return this.layer}}}])&&ae(t.prototype,r),u}(j);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function de(e,t){return(de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function me(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ge(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e){return function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&de(e,t)}(a,e);var t,r,n,i,u=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Oe(n);if(i){var r=Oe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return me(this,e)});function a(){var e;ve(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=u.call.apply(u,[this].concat(r))).options.setViewDelay&&(e._update=(0,O.Ds)((function(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(t=o.GridLayer.prototype._update).call.apply(t,[ge(e)].concat(n))}),e.options.setViewDelay)),e}return t=a,(r=[{key:"createTile",value:function(e,t){var r=this.getTileUrl(e),n=document.createElement("img");return n.abort=F(r,(function(e){n.src=e,t(null,n)}),this.options.headers),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n}},{key:"_abortLoading",value:function(){var e=this._tiles,t=this._tileZoom;for(var r in e)if(e[r].coords.z!==t){var n=e[r].el;n.onload=o.Util.falseFn,n.onerror=o.Util.falseFn,n.complete||(n.abort&&n.abort(),n.src=o.Util.emptyImageUrl,o.DomUtil.remove(n),delete e[r])}}}])&&be(t.prototype,r),a}(e)}function _e(e){return(_e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e,t){if(t&&("object"===_e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Se=we(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=ke(t);if(r){var o=ke(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return je(this,e)});function o(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=n.call(this,e,t),Object.assign(r.options,t),r}return o}(o.TileLayer));function Ee(e){return(Ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Re=["url"];function Ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(r),!0).forEach((function(t){xe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function xe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function De(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Be(e,t){if(t&&("object"===Ee(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(a,e);var t,r,n,i,u=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ie(n);if(i){var r=Ie(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Be(this,e)});function a(){return Le(this,a),u.apply(this,arguments)}return t=a,(r=[{key:"addLayer",value:function(e){if(e){var t=e.url,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,Re);if(t){var n=Te({pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom},r.nativeOptions);return r.subdomains&&(n.subdomains=r.subdomains),r.headers?new Se(t,Te(Te({},n),{},{headers:r.headers,setViewDelay:r.setViewDelay})):new o.TileLayer(t,n)}}}}])&&De(t.prototype,r),a}(j);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fe(e,t){if(t&&("object"===Ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ge=we(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=ze(t);if(r){var o=ze(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return Fe(this,e)});function o(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),n.call(this,e,t)}return o}(o.TileLayer.WMS));function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var He=["url"];function We(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?We(Object(r),!0).forEach((function(t){Ve(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):We(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Je(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Qe(e,t){return(Qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e,t){if(t&&("object"===Ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Xe(e){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qe(e,t)}(a,e);var t,r,n,i,u=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Xe(n);if(i){var r=Xe(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ye(this,e)});function a(){return $e(this,a),u.apply(this,arguments)}return t=a,(r=[{key:"addLayer",value:function(e){if(e){var t=e.url,r=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,He);if(t){var n={pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom,layers:e.layers,format:e.format};return r.headers?new Ge(t,qe(qe({},n),{},{headers:r.headers})):new o.TileLayer.WMS(t,n)}}}}])&&Je(t.prototype,r),a}(j);function et(e){return(et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(r),!0).forEach((function(t){nt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function nt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ut(e,t,r){return(ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=st(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(r):o.value}})(e,t,r||e)}function at(e,t){return(at=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e,t){if(t&&("object"===et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function st(e){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&at(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=st(n);if(o){var r=st(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return ct(this,e)});function u(){return ot(this,u),i.apply(this,arguments)}return t=u,(r=[{key:"addLayer",value:function(e){return ut(st(u.prototype),"addLayer",this).call(this,rt(rt({},e),{},{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}))}}])&&it(t.prototype,r),u}(Me);function lt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(e);!(u=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(e,t)||pt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){if(e){if("string"==typeof e)return yt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yt(e,t):void 0}}function yt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ht(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(r),!0).forEach((function(t){dt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ht(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var mt=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),dt(this,"options",{target:"map"}),dt(this,"layerAdapters",e.layerAdapters),dt(this,"controlAdapters",e.controlAdapters),dt(this,"emitter",new n.EventEmitter),dt(this,"map",void 0),dt(this,"_unselectCb",[]),dt(this,"_universalEvents",["move","zoom","moveend","zoomend","zoomstart","movestart"])}var t,r;return t=e,(r=[{key:"create",value:function(e){var t=this;if(this.options=vt({},e),this.options.target){var r=this.options,n=r.zoom,i=r.center,u=r.maxZoom,a=r.minZoom,c=r.maxBounds,s=r.mapAdapterOptions;this.map=new o.Map(this.options.target,vt({attributionControl:!1,zoomControl:!1,maxBounds:c&&[[c[1],c[0]],[c[3],c[2]]],maxZoom:u,minZoom:a,center:i&&[i[1],i[0]],zoom:n},s));var f=this.map.createPane("order-0");this.map._addUnselectCb=function(e){t._addUnselectCb(e)},f.style.zIndex=String(0),this.emitter.emit("create",this),this._addMapListeners()}}},{key:"destroy",value:function(){this.map&&this.map.remove()}},{key:"getContainer",value:function(){return this.map&&this.map.getContainer()}},{key:"getControlContainer",value:function(){var e=this.map&&this.map._controlContainer;if(e)return e;throw new Error("Leaflet Map is not initialized yet")}},{key:"setCursor",value:function(e){this.map&&(this.map.getContainer().style.cursor=e)}},{key:"setView",value:function(e,t){var r=lt(e,2),n=r[0],o=r[1];this.map&&("number"==typeof t?this.map.setView([o,n],t,{animate:!1}):this.setCenter([n,o]))}},{key:"setCenter",value:function(e){var t=lt(e,2),r=t[0],n=t[1];this.map&&this.map.panTo([n,r])}},{key:"getCenter",value:function(){var e=this.map;if(e){var t=e.getBounds().getCenter();return[t.lng,t.lat]}}},{key:"setZoom",value:function(e){this.map&&this.map.setZoom(e)}},{key:"getZoom",value:function(){return this.map&&this.map.getZoom()||void 0}},{key:"getBounds",value:function(){if(this.map){var e=this.map.getBounds(),t=e.getSouthWest(),r=e.getNorthEast();return[t.lng,t.lat,r.lng,r.lat]}}},{key:"fitBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.map){var r=t.maxZoom,n=t.offset,o=t.padding,i={};r&&(i.maxZoom=r),o&&(i.padding=[o,o]),n&&(i.padding=n),this.map.fitBounds([[e[3],e[0]],[e[1],e[2]]],i)}}},{key:"getLayerAdapter",value:function(t){return e.layerAdapters[t]}},{key:"createControl",value:function(e,t){return h(e,t,this)}},{key:"createButtonControl",value:function(e){return function(e,t){var r=document.createElement("a"),n=e.title||"";r.href="#",r.title=n,r.setAttribute("role","button"),r.setAttribute("aria-label",n),o.DomEvent.disableClickPropagation(r),o.DomEvent.on(r,"click",o.DomEvent.stop),e.html instanceof HTMLElement?r.appendChild(e.html):"string"==typeof e.html&&(r.innerHTML=e.html);var i=function(t){t.stopPropagation(),e.onClick()};return h({onAdd:function(){return void 0!==e.onClick&&r.addEventListener("click",i),r},onRemove:function(){var t=r.parentNode;t&&t.removeChild(r),void 0!==e.onClick&&r.removeEventListener("click",i)}},{bar:!0},t)}(e,this)}},{key:"addControl",value:function(e,t){if(e.options.position=t.replace("-",""),this.map)return this.map.addControl(e),e}},{key:"removeControl",value:function(e){this.map&&this.map.removeControl(e)}},{key:"removeLayer",value:function(e){e&&e.remove&&e.remove()}},{key:"showLayer",value:function(e){this.map&&e.addTo(this.map)}},{key:"hideLayer",value:function(e){e.remove()}},{key:"setLayerOpacity",value:function(e,t){"setOpacity"in e&&e.setOpacity(t)}},{key:"setLayerOrder",value:function(e,t,r){}},{key:"onMapClick",value:function(e){var t=y(e);this.emitter.emit("preclick",t),this.emitter.emit("click",t)}},{key:"locate",value:function(e,t){var r=this.map;if(r&&(r.locate(e),t)){var n=t.locationfound,o=t.locationerror,i=function(e){var t=e,r=[t.latlng.lng,t.latlng.lat];n({lngLat:r})};return void 0!==n&&r.on("locationfound",i,this),o&&r.on("locationerror",o,this),{stop:function(){void 0!==n&&r.off("locationfound",i),o&&r.off("locationerror",o)}}}return{stop:function(){}}}},{key:"_addUnselectCb",value:function(e){var t,r=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=pt(e))){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}(this._unselectCb);try{for(r.s();!(t=r.n()).done;)(0,t.value)()}catch(e){r.e(e)}finally{r.f()}this._unselectCb.length=0,this._unselectCb.push(e)}},{key:"_addMapListeners",value:function(){var e=this,t=this.map;t&&(t.on("click",(function(t){e.onMapClick(t)})),this._universalEvents.forEach((function(r){t.on(r,(function(){return e.emitter.emit(r,e)}),t)})))}}])&&bt(t.prototype,r),e}();dt(mt,"layerAdapters",{GEOJSON:Z,IMAGE:ye,TILE:Me,WMS:Ke,OSM:ft}),dt(mt,"controlAdapters",{ZOOM:o.Control.Zoom,ATTRIBUTION:g}),dt(mt,"Map",o.Map);var gt=mt},7869:function(e,t,r){r.d(t,{Z:function(){return ce}}),r(2222),r(1539),r(9714),r(7941),r(2526),r(7327),r(5003),r(4747),r(9337);var n=r(7187),o=r(1521),i=r(1344),u=r(3746);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){var t="function"==typeof Map?new Map:void 0;return(f=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return l(e,arguments,h(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)})(e)}function l(e,t,r){return(l=p()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&y(o,r.prototype),o}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(2772),r(8674),r(9601),r(8304),r(489),r(2419),r(6992),r(1532),r(8783),r(3948),r(1817),r(2165);var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,e);var t,r,n=(t=o,r=p(),function(){var e,n=h(t);if(r){var o=h(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return c(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),v(s(t=n.call(this)),"name","NgwError"),v(s(t),"title",void 0),v(s(t),"message",void 0),v(s(t),"detail",void 0),v(s(t),"exception",void 0),v(s(t),"status_code",void 0),v(s(t),"data",void 0),v(s(t),"guru_meditation",void 0),Object.assign(s(t),e),Object.setPrototypeOf(s(t),o.prototype),t}return o}(f(Error));function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){var t="function"==typeof Map?new Map:void 0;return(O=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return w(e,arguments,j(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),P(n,e)})(e)}function w(e,t,r){return(w=_()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&P(o,r.prototype),o}).apply(null,arguments)}function _(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k,S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(o,e);var t,r,n=(t=o,r=_(),function(){var e,n=j(t);if(r){var o=j(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return m(this,e)});function o(e){var t,r,i,u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),u="NetworkError",(i="name")in(r=g(t=n.call(this)))?Object.defineProperty(r,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):r.name=u,Object.setPrototypeOf(g(t),o.prototype),t.message="Unable to request ".concat(e,".\n    Possibly invalid NGW URL entered or CORS not configured to get request from ").concat(location.origin),t}return o}(O(Error));k=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;r.method=r.method||"GET";var i=new XMLHttpRequest;i.open(r.method||"GET",e,!0),"blob"===r.responseType&&(i.responseType=r.responseType);var u=function(){try{return JSON.parse(i.responseText)}catch(e){return i.responseText}},a=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=e?n:t;"blob"===r.responseType?o(i.response):i.responseText?o(u()):n({message:""})};i.onload=function(){-1!==[401,403,404,500].indexOf(i.status)&&n(new b(u())),a()},i.onerror=function(t){0===i.status?n(new S(e)):n(t)},i.upload.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;r.onProgress&&r.onProgress(t,e)}};var c,s=r.headers;if(s)for(var f in s){var l=s[f];"string"==typeof l&&i.setRequestHeader(f,l)}if(void 0!==r.withCredentials&&(i.withCredentials=r.withCredentials),r.file){if((c=new FormData).append("file",r.file),r.data)for(var p in c)c.append(p,c[p])}else c=r.data?"string"==typeof r.data?r.data:JSON.stringify(r.data):null;o&&o((function(){i.abort()})),i.send(c)},r(4916),r(5306);var E=/\{ *([\w_-]+) *\}/g;function R(e,t){return e.replace(E,(function(e,r){var n=t[r];if(void 0===n)throw new Error("No value provided for letiable "+e);return"function"==typeof n&&(n=n(t)),n}))}function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return L(e)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=D(t);if(r){var o=D(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return x(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),A(L(t=n.call(this,e)),"name","ResourceNotFoundError"),A(L(t),"exception","nextgisweb.resource.exception.ResourceNotFound"),Object.setPrototypeOf(L(t),o.prototype),t}return o}(b);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){return(M=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t){if(t&&("object"===I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Z(e)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M(e,t)}(o,e);var t,r,n=(t=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,n=F(t);if(r){var o=F(this).constructor;e=Reflect.construct(n,arguments,o)}else e=n.apply(this,arguments);return U(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),z(Z(t=n.call(this,e)),"name","InsufficientPermissionsError"),z(Z(t),"exception","nextgisweb.core.exception.InsufficientPermissions"),Object.setPrototypeOf(Z(t),o.prototype),t}return o}(b),N=(r(9826),r(561),[]);function H(e){N.push(e)}function W(e){return"[object Object]"===Object.prototype.toString.call(e)}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(e);!(u=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);u=!0);}catch(e){a=!0,o=e}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t=t?t+"__":"";var r={};return Object.entries(e).forEach((function(e){var n=q(e,2),o=n[0],u=n[1];if(W(u)){var a=$(u,o);Object.assign(r,a)}else(0,i.ri)(u)&&(r[t+o]=u)})),r}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(7042),r(8309),r(1038),r(9720);var K=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.connector=t,X(this,"cache",new u.Z)}var t,r;return t=e,(r=[{key:"getOne",value:function(e,t){var r=this;return(new u.Z).add("resource",(function(){return"string"==typeof e?r._fetchResourceBy({keyname:e},t):"number"==typeof e?r._fetchResourceById(e,t):W(e)?r._fetchResourceBy(e,t):o.Z.resolve(void 0)}),{resource:e})}},{key:"getOneOrFail",value:function(e){return this.getOne(e).then((function(e){if(e)return e;throw new B}))}},{key:"getId",value:function(e){return"number"==typeof e?o.Z.resolve(e):"string"==typeof e||W(e)?this.getOne(e).then((function(e){if(e)return e.resource.id})):o.Z.resolve(void 0)}},{key:"getIdOrFail",value:function(e){return this.getId(e).then((function(e){if(void 0===e)throw new Error;return e}))}},{key:"getMany",value:function(e,t){var r=this;return this._resourceCacheFilter(e).then((function(n){if(!n.length){var i={};return e.keyname?i.keyname=e.keyname:Object.assign(i,$(e)),r.connector.get("resource.search",t,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){X(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({serialization:"full"},i)).then((function(e){return e&&e.forEach((function(e){r.cache.add("resource.item",o.Z.resolve(e),{id:e.resource.id})})),e}))}return n}))}},{key:"getParent",value:function(e){var t=this;return this.connector.getResource(e).then((function(e){return e?t.connector.getResource(e.resource.parent.id):o.Z.resolve(void 0)}))}},{key:"getChildrenOf",value:function(e){var t=this;return this.getId(e).then((function(e){return t.connector.get("resource.collection",{cache:!0},{parent:e}).then((function(e){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return J(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){a=!0,i=e},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;t.cache.add("resource.item",o.Z.resolve(i),{id:i.resource.id})}}catch(e){n.e(e)}finally{n.f()}return e}))}))}},{key:"update",value:function(e,t){var r=this;return this.getId(e).then((function(e){if(void 0!==e)return r.connector.put("resource.item",{data:t},{id:e})}))}},{key:"delete",value:function(e){var t=this;return this.getId(e).then((function(e){if(void 0!==e)return t.connector.delete("resource.item",null,{id:e}).then((function(){t.cache.delete("resource.item",{id:e})}))}))}},{key:"_fetchResourceById",value:function(e,t){var r=this;return this.cache.add("resource.item",(function(){return r.connector.get("resource.item",t,{id:e})}),{id:e}).catch((function(e){if(!(e instanceof B))throw e}))}},{key:"_fetchResourceBy",value:function(e,t){return this.getMany(e,t).then((function(e){return e[0]}))}},{key:"_resourceCacheFilter",value:function(e){return o.Z.all(this.cache.matchAll("resource.item")).then((function(t){return t.filter((function(t){if(t)return e.keyname&&t.resource.keyname?e.keyname===t.resource.keyname:(0,i.ri)(e.id)&&(0,i.ri)(t.resource.id)?e.id===t.resource.id:(r=e,n=t.resource,(0,i.vr)(r,n));var r,n})),[]}))}}])&&Y(t.prototype,r),e}();function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function te(e){var t=e.params;return new o.Z((function(r,n){e.connector.connect().then((function(o){var i,u=o&&o[e.name];if(u){var a=(i=u,u=function(e){if(Array.isArray(e))return ee(e)}(i)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(i)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ee(e,t):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).shift();if(u.length){for(var c={},s=0;s<u.length;s++){var f=u[s];if(c[s]="{"+f+"}",void 0===t[f])throw new Error("`"+f+"` url api argument is not specified")}a&&(a=R(a,c))}if(t){var l=[],p=t.paramList;for(var y in Array.isArray(p)&&(delete t.paramList,p.forEach((function(e){l.push("".concat(e[0],"=").concat(e[1]))}))),t)-1===u.indexOf(y)&&l.push("".concat(y,"=").concat(t[y]));l.length&&(a=a+"?"+l.join("&"))}a?r(e.connector.makeQuery(a,t,e.requestOptions)):n(new Error("request url is not set"))}else r(void 0)})).catch((function(e){n(e)}))}))}function re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?re(Object(r),!0).forEach((function(t){ie(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(9600);var ue=0,ae=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,ie(this,"id",ue++),ie(this,"emitter",new n.EventEmitter),ie(this,"user",void 0),ie(this,"resources",void 0),ie(this,"routeStr","/api/component/pyramid/route");var r=function(e){return N.find((function(t){if(t.options.baseUrl===e.baseUrl){if(!e.auth)return!0;if(t.options.auth)return(0,i.vr)(t.options.auth,e.auth)}}))}(t);if(r)return r;this.options.route&&(this.routeStr=this.options.route),this.resources=new K(this),H(this)}var t,r,a;return t=e,a=[{key:"create",value:function(e){return new this(e)}}],(r=[{key:"setNgw",value:function(e){this.logout(),this.options.baseUrl=e,H(this)}},{key:"connect",value:function(){var e=this,t=new u.Z,r=this.options.auth;return t.add("route",(function(){return new o.Z((function(t,n){var o=function(){return e.makeQuery(e.routeStr,{},{}).then((function(e){t(e)})).catch((function(e){n(e)}))};if(r){var i=r.login,u=r.password;if(i&&u)return e.getUserInfo({login:i,password:u}).then((function(){o()})).catch((function(e){return n(e)}))}return o()}))}),{id:this.id,auth:r,baseUrl:this.options.baseUrl})}},{key:"login",value:function(e){return this.logout(),H(this),this.getUserInfo(e)}},{key:"logout",value:function(){var e,t;e=this,-1!==(t=N.indexOf(e))&&N.splice(t,1),this.options.auth=void 0,this.user=void 0,this.emitter.emit("logout"),this.resources.cache.clean()}},{key:"getUserInfo",value:function(e){var t=this;if(this.user&&this.user.id)return o.Z.resolve(this.user);e&&(this.options.auth=e);var r={headers:this.getAuthorizationHeaders(e)};return this.makeQuery("/api/component/auth/current_user",{},r).then((function(e){return t.user=e,t.emitter.emit("login",e),e})).catch((function(e){throw t.emitter.emit("login:error",e),e}))}},{key:"getAuthorizationHeaders",value:function(e){var t=this.makeClientId(e);if(t)return{Authorization:"Basic "+t}}},{key:"makeClientId",value:function(e){if(e=e||this.options.auth){var t=e,r=t.login,n=t.password,o=unescape(encodeURIComponent("".concat(r,":").concat(n)));return window.btoa(o)}}},{key:"apiRequest",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.method,a=n.headers,c=n.withCredentials,s=n.responseType,f=(0,i.dY)(r),l=function(){return te({name:e,params:f,requestOptions:n,connector:t})};if(n.cache&&"GET"===o){var p=new u.Z;return p.add(e,l,ne({params:f},(0,i.dY)({headers:a,withCredentials:c,responseType:s,baseUrl:this.options.baseUrl,auth:this.options.auth})))}return l()}},{key:"post",value:function(e,t,r){return(t=t||{}).method="POST",this.apiRequest(e,r,t)}},{key:"get",value:function(e,t,r){return(t=t||{}).method="GET",this.apiRequest(e,r,t)}},{key:"patch",value:function(e,t,r){return(t=t||{}).method="PATCH",this.apiRequest(e,r,t)}},{key:"put",value:function(e,t,r){return(t=t||{}).method="PUT",this.apiRequest(e,r,t)}},{key:"delete",value:function(e,t,r){return(t=t||{}).method="DELETE",this.apiRequest(e,r,t)}},{key:"makeQuery",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e=(this.options.baseUrl?this.options.baseUrl:"")+e)return t&&(e=R(e,t)),e=(0,i.nH)(e),this._loadData(e,r);throw new Error("Empty `url` not allowed")}},{key:"getResource",value:function(e){return this.resources.getOne(e)}},{key:"getResourceOrFail",value:function(e){return this.resources.getOneOrFail(e)}},{key:"getResourceBy",value:function(e){return this.resources.getOne(e)}},{key:"getResourceByKeyname",value:function(e){return this.resources.getOne(e)}},{key:"getResourceById",value:function(e){return this.resources.getOne(e)}},{key:"getResourceId",value:function(e){return this.resources.getId(e)}},{key:"getResourceIdOrFail",value:function(e){return this.resources.getIdOrFail(e)}},{key:"getResourcesBy",value:function(e){return this.resources.getMany(e)}},{key:"getResourceParent",value:function(e){return this.resources.getParent(e)}},{key:"getResourceChildren",value:function(e){return this.resources.getChildrenOf(e)}},{key:"updateResource",value:function(e,t){return this.resources.update(e,t)}},{key:"deleteResource",value:function(e){return this.resources.delete(e)}},{key:"_loadData",value:function(e,t){var r=this;return t.responseType=t.responseType||"json",new o.Z((function(n,o,i){r.user&&((t=t||{}).headers=ne(ne({},r.getAuthorizationHeaders()),t.headers)),k(e,n,t,o,i)})).catch((function(e){if(e instanceof o.Z.CancelError);else{var t=r._handleHttpError(e);if(t)throw t}}))}},{key:"_handleHttpError",value:function(e){if(e&&e instanceof b){if("nextgisweb.resource.exception.ResourceNotFound"===e.exception)throw new B(e);if("nextgisweb.core.exception.InsufficientPermissions"===e.exception)throw new G(e)}return e}}])&&oe(t.prototype,r),a&&oe(t,a),e}();ie(ae,"errors",{NgwError:b,ResourceNotFoundError:B});var ce=ae}}]);
//# sourceMappingURL=main-4aa8b69d5f6b193.js.map