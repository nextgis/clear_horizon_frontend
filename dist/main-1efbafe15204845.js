"use strict";(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[252],{9256:function(e,t,r){r.d(t,{y9:function(){return Me}}),r(5666),r(1539),r(8674),r(489),r(2419),r(7941),r(2526),r(1817),r(2443),r(2165),r(6992),r(8783),r(3948),r(8309),r(4747),r(2222),r(561),r(2707),r(2479),r(1249),r(7327),r(6699),r(2023),r(9826),r(6755),r(4916),r(5306),r(5003),r(9337),r(7042),r(1038);var n=r(9443),o=r(8133);function i(e){for(var t,r={},n=0;n<e.length;n++)r[e[n]]=1+(r[e[n]]||0);for(var o in r){var i=void 0!==t?r[t]:0;r[o]>(i||0)&&(t=o)}return t}var a={polygon:"path",line:"path",point:"circle"},s={Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon"};function u(e){if(e.data){var t=s[(o=e.data,"FeatureCollection"===o.type?i(o.features.map((function(e){return e.geometry.type}))):"GeometryCollection"===o.type?i(o.geometries.map((function(e){return e.type}))):"Feature"===o.type?o.geometry.type:o.type)],r=e.paint;r&&(0,n.GY)(r)&&(r.type=r.type?r.type:"polygon"===t||"line"===t?"path":"html"in r||"className"in r?"icon":a[t]),e.type=e.type||t}var o;return e}r(9714),r(9720);var c=r(7187),l=r(390),f=r(584),p=r(8651),y=r(1521),h=r(3614);function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"backspace",8),d(this,"tab",9),d(this,"enter",13),d(this,"shift",16),d(this,"ctrl",17),d(this,"alt",18),d(this,"pause/break",19),d(this,"caps_lock",20),d(this,"escape",27),d(this,"page_up",33),d(this,"page_down",34),d(this,"end",35),d(this,"home",36),d(this,"left_arrow",37),d(this,"up_arrow",38),d(this,"right_arrow",39),d(this,"down_arrow",40),d(this,"insert",45),d(this,"delete",46),d(this,"left_window_key",91),d(this,"right_window_key",92),d(this,"select_key",93),d(this,"numpad_0",96),d(this,"numpad_1",97),d(this,"numpad_2",98),d(this,"numpad_3",99),d(this,"numpad_4",100),d(this,"numpad_5",101),d(this,"numpad_6",102),d(this,"numpad_7",103),d(this,"numpad_8",104),d(this,"numpad_9",105),d(this,"multiply",106),d(this,"add",107),d(this,"subtract",109),d(this,"decimal_point",110),d(this,"divide",111),d(this,"f1",112),d(this,"f2",113),d(this,"f3",114),d(this,"f4",115),d(this,"f5",116),d(this,"f6",117),d(this,"f7",118),d(this,"f8",119),d(this,"f9",120),d(this,"f10",121),d(this,"f11",122),d(this,"f12",123),d(this,"num_lock",144),d(this,"scroll_lock",145),d(this,"semi-colon",186),d(this,"equal_sign",187),d(this,",",188),d(this,"-",189),d(this,".",190),d(this,"/",191),d(this,"`",192),d(this,"[",219),d(this,"\\",220),d(this,"]",221),d(this,"'",222)};function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"keyCodeAlias",new v),b(this,"keys",{}),b(this,"_windowOnFocus",void 0),b(this,"_keysPressed",void 0),b(this,"_keysReleased",void 0),this._windowOnFocus=this.windowOnFocus.bind(this),this._keysPressed=this.keysPressed.bind(this),this._keysReleased=this.keysReleased.bind(this),this.addKeyboardEventsListener()}var t,r;return t=e,(r=[{key:"pressed",value:function(e){var t=this.keyCodeAlias[e];return!!t&&this.keys[t]}},{key:"addKeyboardEventsListener",value:function(){"undefined"!=typeof window&&(window.addEventListener("focus",this._windowOnFocus,!1),window.addEventListener("keydown",this._keysPressed,!1),window.addEventListener("keyup",this._keysReleased,!1))}},{key:"removeKeyboardEventsListener",value:function(){"undefined"!=typeof window&&(window.removeEventListener("focus",this._windowOnFocus,!1),window.removeEventListener("keydown",this._keysPressed,!1),window.removeEventListener("keyup",this._keysReleased,!1))}},{key:"keysPressed",value:function(e){e.stopPropagation(),this.keys[e.keyCode]||(this.keys[e.keyCode]=!0)}},{key:"keysReleased",value:function(e){e.stopPropagation(),this.keys[e.keyCode]=!1}},{key:"windowOnFocus",value:function(){this.keys={}}}])&&m(t.prototype,r),e}();function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(6977),r(3123),r(9653);var _=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webMap=t,w(this,"name",void 0),w(this,"event",void 0),w(this,"value",void 0),r&&(r.value&&this.setValue(r.value),r.name&&(this.name=r.name),r.event&&(this.event=r.event))}var t,r;return t=e,(r=[{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e}}])&&k(t.prototype,r),e}();function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},C(e,t)}function P(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(n);if(o){var r=A(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return P(this,e)});function a(){var e;x(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return E(S(e=i.call.apply(i,[this].concat(r))),"name","center"),E(S(e),"event","moveend"),e}return t=a,(r=[{key:"getValue",value:function(){return this.webMap.getCenter()}},{key:"setValue",value:function(e){this.webMap.setCenter(e)}},{key:"toString",value:function(e){var t=e.map((function(e){return e.toFixed(5)}));return t[0]+"_"+t[1]}},{key:"parse",value:function(e){return e.split("_").map(Number)}}])&&O(t.prototype,r),a}(_);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e,t){return B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},B(e,t)}function z(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return F(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var V=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=I(n);if(o){var r=I(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return z(this,e)});function a(){var e;T(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Z(F(e=i.call.apply(i,[this].concat(r))),"name","zoom"),Z(F(e),"event","zoomend"),e}return t=a,(r=[{key:"getValue",value:function(){var e=this.webMap.getZoom();return void 0!==e?Math.round(e):void 0}},{key:"setValue",value:function(e){this.webMap.setZoom(e)}},{key:"toString",value:function(e){return String(e)}},{key:"parse",value:function(e){return Number(e)}}])&&M(t.prototype,r),a}(_);function D(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=J(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function J(e,t){if(e){if("string"==typeof e)return G(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?G(e,t):void 0}}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function N(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function K(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){N(i,n,o,a,s,"next",e)}function s(e){N(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Q(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function H(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var U=0,Y={minZoom:0,maxZoom:20,paint:{color:"blue",opacity:.4,strokeOpacity:1,stroke:!0,radius:8,weight:1},selectedPaint:{color:"darkblue",opacity:.4,strokeOpacity:1,stroke:!0,radius:12,weight:1},create:!0},W=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),H(this,"options",Y),H(this,"emitter",new c.EventEmitter),H(this,"keys",e.keys),H(this,"mapAdapter",void 0),H(this,"runtimeParams",[]),H(this,"getPaintFunctions",e.getPaintFunctions),H(this,"mapState",[j,V]),H(this,"id",U++),H(this,"_initMapState",{}),H(this,"_starterKits",void 0),H(this,"_mapState",[]),H(this,"_extent",void 0),H(this,"_eventsStatus",{}),H(this,"_coordFromMapClickPromise",void 0),H(this,"_mapEvents",{}),this.mapAdapter=t.mapAdapter,this._starterKits=t.starterKits||[],t&&(this.options=(0,l.v)(Y||{},t)),this.options.runtimeParams&&(this.runtimeParams=this.options.runtimeParams),this._addEventsListeners(),this.options.tileJson&&this._setTileJsonOptions(this.options.tileJson),this.options.create&&this.create()}var t,r,n,o,i,a;return t=e,r=[{key:"getId",value:function(){return this.id}},{key:"create",value:(a=K(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getEventStatus("create")){e.next=6;break}return e.next=3,this._setInitMapState(this.mapState);case 3:return e.next=5,this._setupMap();case 5:this._emitStatusEvent("create",this);case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setRuntimeParams",value:function(e){this.runtimeParams.push(e)}},{key:"destroy",value:function(){this._removeEventListeners(),function(e){for(var t in e)delete e[t]}(this._emitStatusEvent),this.mapAdapter.destroy&&this.mapAdapter.destroy()}},{key:"getState",value:function(){var e={};return this._mapState.forEach((function(t){e[t.name]=t.getValue()})),e}},{key:"getRuntimeParams",value:function(){var e=this,t={};return this._mapState.forEach((function(r){var n,o=D(e.runtimeParams);try{for(o.s();!(n=o.n()).done;){var i=n.value.get(r.name);if(void 0!==i){t[r.name]=r.parse(i);break}}}catch(e){o.e(e)}finally{o.f()}})),t}},{key:"getContainer",value:function(){if(this.mapAdapter.getContainer)return this.mapAdapter.getContainer();if(this.options.target){if(this.options.target instanceof HTMLElement)return this.options.target;if("string"==typeof this.options.target){var e=document.getElementById(this.options.target);if(e)return e}}}},{key:"setCursor",value:function(e){this.mapAdapter.setCursor&&this.mapAdapter.setCursor(e)}},{key:"getCursor",value:function(){if(this.mapAdapter.getCursor)return this.mapAdapter.getCursor();var e=this.getContainer();return e?e.style.cursor:void 0}},{key:"setCenter",value:function(e){return this.mapAdapter.setCenter(e),this}},{key:"getCenter",value:function(){return this.mapAdapter.getCenter()}},{key:"getBounds",value:function(){if(this.mapAdapter.getBounds)return this.mapAdapter.getBounds()}},{key:"getBoundsPolygon",value:function(){var e=this.getBounds();if(e)return(0,f.pv)(e)}},{key:"setZoom",value:function(e){return this.mapAdapter.setZoom(e),this}},{key:"getZoom",value:function(){var e=this.mapAdapter.getZoom();if("number"==typeof e)return e;throw Error("Unable to get zoom level. Perhaps the map is not have been initialized yet")}},{key:"zoomIn",value:function(){if(this.mapAdapter.zoomIn)this.mapAdapter.zoomIn();else{var e=this.getZoom();if(e){var t=e+1;this.setZoom(t)}}}},{key:"zoomOut",value:function(){if(this.mapAdapter.zoomOut)this.mapAdapter.zoomOut();else{var e=this.getZoom();if(e){var t=e-1;this.setZoom(t)}}}},{key:"setView",value:function(e,t){this.mapAdapter.setView&&e&&(0,p.r)(t)?this.mapAdapter.setView(e,t):(e&&this.mapAdapter.setCenter(e),(0,p.r)(t)&&this.mapAdapter.setZoom(t))}},{key:"fitBounds",value:function(e,t){return e.every((function(e){return(0,p.r)(e)}))&&(e[1]<-85.06&&(e[1]=-85.06),e[3]>85.06&&(e[3]=85.06),this.mapAdapter.fitBounds(e,t)),this}},{key:"getEventStatus",value:function(e){var t=e,r=this._eventsStatus[t];return null!=r&&r}},{key:"onLoad",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"create";return new Promise((function(r){e.getEventStatus(t)?r(e):e.emitter.once(t,(function(){r(e)}))}))}},{key:"onMapLoad",value:function(e){var t=this;return new Promise((function(r){var n,o=function(){var n=t.mapAdapter;e&&e(n),n&&r(n)},i=null===(n=t.mapAdapter.isLoaded)||void 0===n||n;t.mapAdapter.map&&i?o():t.mapAdapter.emitter.once("create",(function(){o()}))}))}},{key:"getLayerAdapters",value:function(){return this.mapAdapter.layerAdapters}},{key:"getLayerAdapter",value:function(e){return this.mapAdapter.layerAdapters[e]}},{key:"locate",value:function(e,t){return this.mapAdapter&&this.mapAdapter.locate?this.mapAdapter.locate(e,t):{stop:function(){return{}}}}},{key:"stopGetCoordFromMapClick",value:function(){this._coordFromMapClickPromise&&this._coordFromMapClickPromise.cancel()}},{key:"getCoordFromMapClick",value:function(){var e=this;return this._coordFromMapClickPromise?this.getCoordFromMapClick():(this._coordFromMapClickPromise=new y.Z((function(t,r,n){var o=e.getCursor()||"grab";e._removeEventListeners({include:["click"]}),e.setCursor("crosshair");var i=function(){e.setCursor(o),e._addEventsListeners({include:["click"]}),e.mapAdapter.emitter.off("click",a),e._coordFromMapClickPromise=void 0},a=function(e){i(),(0,h.V)(e),t(e.lngLat)};e.mapAdapter.emitter.once("click",a),n(i)})),this._coordFromMapClickPromise)}},{key:"_emitStatusEvent",value:function(e,t){var r=e;this._eventsStatus[r]=!0,this.emitter.emit(r,t)}},{key:"_addLayerProviders",value:(i=K(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"_onLoadSync",value:(o=K(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"_setupMap",value:(n=K(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mapAdapter){e.next=2;break}throw new Error("WebMap `mapAdapter` option is not set");case 2:return e.next=4,this.mapAdapter.create(this.options);case 4:return this._zoomToInitialExtent(),e.next=7,this._addLayerProviders();case 7:return e.next=9,this._onLoadSync();case 9:return this._emitStatusEvent("build-map",this.mapAdapter),e.abrupt("return",this);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_setTileJsonOptions",value:function(e){e.center&&(this.options.center=e.center),e.bounds&&(this.options.bounds=e.bounds),(0,p.r)(e.maxzoom)&&(this.options.maxZoom=e.maxzoom,this.options.zoom=e.maxzoom),(0,p.r)(e.minzoom)&&(this.options.minZoom=e.minzoom,this.options.zoom=e.minzoom),(0,p.r)(e.maxzoom)&&(0,p.r)(e.minzoom)&&(this.options.zoom=(e.maxzoom+e.minzoom)/2)}},{key:"_zoomToInitialExtent",value:function(){var e=this.options,t=e.center,r=e.zoom,n=e.bounds;this._extent?this.fitBounds(this._extent):t&&r?this.setView(t,r):n&&this.fitBounds(n)}},{key:"_setInitMapState",value:function(e){var t,r=D(e);try{for(r.s();!(t=r.n()).done;){var n=new(0,t.value)(this);this._mapState.push(n);var o,i=D(this.runtimeParams);try{for(i.s();!(o=i.n()).done;){var a=o.value.get(n.name);if(void 0!==a){var s=n.parse(a);this._initMapState[n.name]=s,Object.defineProperty(this.options,n.name,{value:s,configurable:!0,enumerable:!0});break}}}catch(e){i.e(e)}finally{i.f()}}}catch(e){r.e(e)}finally{r.f()}}},{key:"_addEventsListeners",value:function(e){var t=this,r=["preclick","click","zoomstart","zoom","zoomend","movestart","move","moveend"];e&&e.include&&(r=r.filter((function(t){return e.include.includes(t)}))),r.forEach((function(e){t._mapEvents[e]=function(r){if(t.runtimeParams.length){var n=t._mapState.find((function(t){return t.event===e}));if(n){var o=n.toString(n.getValue());t.runtimeParams.forEach((function(e){e.set(n.name,o)}))}}t._eventsStatus&&t.emitter.emit(e,r)};var r=t._mapEvents[e];r&&t.mapAdapter.emitter.on(e,r)}))}},{key:"_removeEventListeners",value:function(e){var t=this,r=Object.entries(this._mapEvents);e&&e.include&&(r=r.filter((function(t){return e.include.includes(t[0])}))),r.forEach((function(e){var r,n,o=(n=2,function(e){if(Array.isArray(e))return e}(r=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}(r,n)||J(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];a&&t.mapAdapter.emitter.removeListener(i,a)}))}}],r&&Q(t.prototype,r),e}();function $(e){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$(e)}function q(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return X(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?X(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(r),!0).forEach((function(t){ce(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function re(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function ne(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){re(i,n,o,a,s,"next",e)}function s(e){re(i,n,o,a,s,"throw",e)}a(void 0)}))}}function oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ie(e,t){return ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ie(e,t)}function ae(e,t){if(t&&("object"===$(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return se(e)}function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}function ce(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}H(W,"keys",new g),H(W,"getPaintFunctions",void 0);var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(v,e);var t,r,i,a,s,c,l,f,y,h,d=(y=v,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ue(y);if(h){var r=ue(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return ae(this,e)});function v(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),ce(se(t=d.call(this,e)),"_layersIdCounter",1),ce(se(t),"_layersOrderCounter",1),ce(se(t),"_baselayers",[]),ce(se(t),"_layers",{}),ce(se(t),"_selectedLayers",[]);var r=t.options.tileJson;return r&&t.emitter.once("build-map",(function(){return t.addTileJsonLayer(r)})),t}return t=v,r=[{key:"fitLayer",value:(f=ne(regeneratorRuntime.mark((function e(t,r){var n,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getLayer(t),!(o=n&&(n.getBounds||n.getExtent))){e.next=7;break}return e.next=5,o.call(n);case 5:(i=e.sent)&&this.fitBounds(i,r);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"isBaseLayer",value:function(e){var t=this.getLayer(e);if(t&&t.id)return-1!==this._baselayers.indexOf(t.id)}},{key:"getBaseLayers",value:function(){var e=this,t=[];return this._baselayers.forEach((function(r){var n=e._layers[r];n&&t.push(n)})),t}},{key:"getBaseLayersIds",value:function(){return this._baselayers}},{key:"getLayer",value:function(e){return"string"==typeof e?this._layers[e]:e}},{key:"getLayerId",value:function(e){var t=this.getLayer(e);if(t&&t.options)return t.options.id;throw new Error("No id for layer")}},{key:"getLayers",value:function(){return Object.keys(this._layers)}},{key:"allLayers",value:function(){return this._layers}},{key:"orderedLayers",value:function(){return Object.values(this._layers).sort((function(e,t){return e.order&&t.order?e.order-t.order:0}))}},{key:"findLayer",value:function(e){for(var t in this._layers){var r=this._layers[t];if(e(r))return r}}},{key:"isLayerVisible",value:function(e){var t=this.getLayer(e);return!(!t||void 0===t.options.visibility)&&t.options.visibility}},{key:"addBaseLayer",value:(l=ne(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.addLayer(t,te(te({},r),{},{baselayer:!0}),void 0);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"addLayer",value:(c=ne(regeneratorRuntime.mark((function e(t){var r,n,o,i,a,s,u,c,l,f,y,h,d,v,m,b,g,k,w,_=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_.length>1&&void 0!==_[1]?_[1]:{},o=_.length>2?_[2]:void 0,i=this._layersIdCounter++,a=(0,p.r)(o)?o:void 0!==n.order?n.order:this.reserveOrder(),"string"!=typeof t){e.next=8;break}s=this.getLayerAdapter(t),e.next=16;break;case 8:if("function"!=typeof t){e.next=12;break}s=t,e.next=16;break;case 12:if(!("then"in t)){e.next=16;break}return e.next=15,t;case 15:s=e.sent;case 16:if(u=n,this._updateGeoJsonOptions(u),c=this.options,l=c.maxZoom,f=c.minZoom,n=te({id:String(i),order:a,maxZoom:l,minZoom:f},n),y=null===(r=n.visibility)||void 0===r||r,n.visibility=!1,n.baselayer&&(n.order=0),this.options.onBeforeAddLayer&&(h=this.options.onBeforeAddLayer({options:n,adapter:s}))&&(h.options&&(n=h.options),h.adapter&&(s=h.adapter)),void 0===s){e.next=64;break}return(v=new s(this.mapAdapter.map,n)).options=te(te({},n),v.options),v.options.baselayer&&(n.baselayer=!0,n.order=0,v.options.order=0),v.options.id&&(m=String(v.options.id),this._layers[m]=v),this._emitLayerEvent("layer:preadd",m||"",v),e.next=32,this.onMapLoad();case 32:return v.map=this.mapAdapter.map,e.next=35,v.addLayer(v.options);case 35:if(b=e.sent,v.layer=b,v.id=v.options.id||String(i),v.options.id=v.id,n.baselayer&&(v.options.order=0),v.order=null!==(d=v.options.order)&&void 0!==d?d:a,m&&delete this._layers[m],m=String(v.id),!this._layers[m]){e.next=45;break}throw Error("layer with id '".concat(m,"' already exist"));case 45:if(!m){e.next=52;break}if(this._layers[m]=v,u.filter&&this.filterLayer(v,u.filter),n.baselayer&&this._baselayers.push(m),!y){e.next=52;break}return e.next=52,this.showLayer(m);case 52:if(void 0!==(g=n.opacity)&&g<=1&&this.setLayerOpacity(v,g),k=b&&(v.getBounds||v.getExtent),!n.fit||!k){e.next=62;break}return e.next=58,k.call(v);case 58:if(!(w=e.sent)){e.next=62;break}return e.next=62,this.fitBounds(w);case 62:return this._emitLayerEvent("layer:add",m,v),e.abrupt("return",v);case 64:return e.abrupt("return",Promise.reject("No adapter"));case 65:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"addLayerFromAsyncAdapter",value:(s=ne(regeneratorRuntime.mark((function e(t,r,n){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n||void 0!==r.order?r.order:this.reserveOrder(),i=t(),e.next=5,i;case 5:if(!(a=e.sent)){e.next=8;break}return e.abrupt("return",this.addLayer(a,r,o));case 8:return e.abrupt("return",Promise.reject("No adapter"));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"removeLayers",value:function(e){for(var t in this._layers){var r=!0;e&&(r=e(t,this._layers[t])),r&&(this.removeLayer(t),delete this._layers[t])}}},{key:"reserveOrder",value:function(){return this._layersOrderCounter++}},{key:"removeOverlays",value:function(){this.removeLayers((function(e,t){return!(t&&t.options&&t.options.baselayer)}))}},{key:"removeLayer",value:function(e){var t=this.getLayer(e),r=t&&this.getLayerId(t);if(t&&r){if(this.emitter.emit("layer:preremove",t),t.beforeRemove&&t.beforeRemove(),t.removeLayer?t.removeLayer():this.mapAdapter.removeLayer(t.layer),t.options&&t.options.baselayer){var n=this._baselayers.indexOf(r);n&&this._baselayers.splice(n,1)}delete this._layers[r],this.emitter.emit("layer:remove",t)}}},{key:"addGeoJsonLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(e=e||{}).multiselect=void 0!==e.multiselect&&e.multiselect,e.unselectOnSecondClick=void 0===e.unselectOnSecondClick||e.unselectOnSecondClick,t||(e=u(e)),e.paint=e.paint||{},this.addLayer(t||"GEOJSON",e)}},{key:"addFeatureLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.addGeoJsonLayer(e)}},{key:"addTileLayer",value:function(e,t){return this.addLayer("TILE",te(te({},t),{},{url:e}))}},{key:"addImageLayer",value:function(e,t){return this.addLayer("IMAGE",te(te({},t),{},{url:e}))}},{key:"showLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toggleLayer(e,!0,t)}},{key:"hideLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toggleLayer(e,!1,t)}},{key:"toggleLayer",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.getLayer(e),i=o&&o.options.visibility,a=void 0!==t?t:!i,s=void 0!==n.silent&&n.silent,u=function(){var e=ne(regeneratorRuntime.mark((function e(t){var n,o,i,u,c,l,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=String(t.id),o=a?"layer:preshow":"layer:prehide",i=a?"layer:show":"layer:hide",s||(r._emitLayerEvent(o,n,t),r._emitLayerEvent("layer:pretoggle",n,t)),!a||!r.mapAdapter){e.next=36;break}if(u=t.options.baselayer?0:t.options.order,!t.options.baselayer||!r._baselayers.length){e.next=25;break}c=r._baselayers.filter((function(e){return e!==t.id&&r.isLayerVisible(e)})),l=q(c),e.prev=9,l.s();case 11:if((f=l.n()).done){e.next=17;break}return p=f.value,e.next=15,r.hideLayer(p);case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),l.e(e.t0);case 22:return e.prev=22,l.f(),e.finish(22);case 25:if(!t.showLayer){e.next=30;break}return e.next=28,t.showLayer.call(t,t.layer);case 28:e.next=33;break;case 30:if(void 0===t.layer){e.next=33;break}return e.next=33,r.mapAdapter.showLayer(t.layer);case 33:void 0!==u&&r.mapAdapter.setLayerOrder(t.layer,u,r._layers),e.next=44;break;case 36:if(!t.hideLayer){e.next=41;break}return e.next=39,t.hideLayer.call(t,t.layer);case 39:e.next=44;break;case 41:if(void 0===t.layer){e.next=44;break}return e.next=44,r.mapAdapter.hideLayer(t.layer);case 44:s||(r._emitLayerEvent(i,n,t),r._emitLayerEvent("layer:toggle",n,t)),t.options.visibility=a;case 46:case"end":return e.stop()}}),e,null,[[9,19,22,25]])})));return function(t){return e.apply(this,arguments)}}();return o&&o.options.visibility!==a?this.onMapLoad().then((function(){return u(o)})):Promise.resolve()}},{key:"updateLayer",value:function(e){var t=this,r=this.getLayer(e);if(r){if(r.updateLayer)return Promise.resolve(r.updateLayer());if(this.isLayerVisible(r))return this.hideLayer(r,{silent:!0}).then((function(){return t.showLayer(r,{silent:!0})}))}return Promise.resolve()}},{key:"setLayerOpacity",value:function(e,t){var r=this.getLayer(e);r&&(r.setOpacity?r.setOpacity(t):this.mapAdapter.setLayerOpacity&&this.mapAdapter.setLayerOpacity(r.layer,t))}},{key:"selectLayer",value:function(e,t){var r=this.getLayer(e);if(r){var n=r;n&&n.select&&n.select(t);var o=this.getLayerId(r);o&&this._selectedLayers.push(o)}}},{key:"unSelectLayer",value:function(e,t){var r=this.getLayer(e);if(r){var n=r&&r;n.unselect&&n.unselect(t);var o=this.getLayerId(r);if(o){var i=this._selectedLayers.indexOf(o);-1!==i&&this._selectedLayers.splice(i,1)}}}},{key:"unSelectLayers",value:function(){for(var e,t=0,r=Object.values(this.allLayers());t<r.length;t++)(e=r[t]).unselect&&e.unselect()}},{key:"filterLayer",value:function(e,t){var r=this.getLayer(e);return r.filter?r.filter(t):[]}},{key:"propertiesFilter",value:function(e,t,r){var n=this.getLayer(e);if(n){var i=n;i.propertiesFilter?i.propertiesFilter(t,r):i.filter&&this.filterLayer(i,(function(e){return!e.feature||!e.feature.properties||(0,o.Ml)(e.feature.properties,t)}))}}},{key:"removeLayerFilter",value:function(e){var t=this.getLayer(e);t.removeFilter?t.removeFilter():t.filter&&t.filter((function(){return!0}))}},{key:"setLayerData",value:function(e,t){var r=this.getLayer(e);if(r){if(r.setData)return r.setData(t);if(r.clearLayer&&r.addData)return r.clearLayer(),r.addData(t)}return Promise.resolve()}},{key:"addLayerData",value:function(e,t){var r=this.getLayer(e);r.addData&&r.addData(t)}},{key:"clearLayerData",value:function(e,t){var r=this.getLayer(e);r&&r.clearLayer&&r.clearLayer(t)}},{key:"getAttributions",value:function(e){var t=[];for(var r in this._layers){var n=this._layers[r],o=!(void 0===e.onlyVisible||e.onlyVisible)||n.options.visibility;if(o&&e.onlyBaselayer&&(o=this._baselayers.includes(r)),o){var i=n.options&&n.options.attribution;i&&t.push(i)}}return t}},{key:"getActiveBaseLayer",value:function(){var e=this,t=this.getBaseLayers().find((function(t){return e.isLayerVisible(t)}));if(t)return this.getLayer(t)}},{key:"addTileJsonLayer",value:function(e){var t=e.tiles[0];return this.addLayer("TILE",{url:t,maxZoom:e.maxzoom,minZoom:e.minzoom,subdomains:e.scheme,attribution:e.attribution})}},{key:"_onLayerClick",value:(a=ne(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.layer.id,this._emitLayerEvent("layer:click",r||"",t),e.abrupt("return",Promise.resolve(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_onLayerSelect",value:(i=ne(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._emitLayerEvent("layer:select",t.layer.id||"",t),e.abrupt("return",Promise.resolve(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_updateGeoJsonOptions",value:function(e){var t=this,r=e.onSelect,o=e.onLayerSelect,i=e.onClick,a=e.onLayerClick,s=e.onMouseOut,u=e.onMouseOver,c=i||a;e.onClick=function(e){return c&&c(e),t._onLayerClick(e)},e.onMouseOut=function(e){var r=e.layer.id;s&&s(e),(0,p.r)(r)&&t._emitLayerEvent("layer:mouseout",r,e)},e.onMouseOver=function(e){var r=e.layer.id;u&&u(e),(0,p.r)(r)&&t._emitLayerEvent("layer:mouseover",r,e)};var l=r||o;e.onSelect=function(e){return l&&l(e),t._onLayerSelect(e)},e.nativePaint||(this.options.paint&&(e.paint=(0,n.Yx)(e.paint||{},this.options.paint,this.getPaintFunctions)),e.selectedPaint&&this.options.selectedPaint&&(e.selectedPaint=(0,n.Yx)(e.selectedPaint,this.options.selectedPaint,this.getPaintFunctions)))}},{key:"_emitLayerEvent",value:function(e,t,r){if((0,p.r)(t)&&e.startsWith("layer:")){var n=e.replace("layer:","layer-"+t+":");this.emitter.emit(n,r)}this.emitter.emit(e,r)}}],r&&oe(t.prototype,r),v}(W);function fe(e,t){var r=document.createElement("div"),n=!1;t.getStatus?n=t.getStatus():t.status&&(n=t.status);var o=t.title||"",i=t.html;function a(){o&&(r.title="string"==typeof o?o:n?o.on:o.off,r.setAttribute("aria-label",r.title))}function s(e){e instanceof HTMLElement?(r.innerHTML="",r.appendChild(e)):"string"==typeof e&&(r.innerHTML=e)}function u(){i&&("string"==typeof i||i instanceof HTMLElement?s(i):s(n?i.on:i.off),r.setAttribute("aria-label",r.title))}function c(e,t){e.split(" ").forEach((function(e){t?r.classList.add(e):r.classList.remove(e)}))}function l(){t.addClassOn&&c(t.addClassOn,n),t.addClassOff&&c(t.addClassOff,!n)}a(),u(),t.addClass&&c(t.addClass,!0),l();var f=function(e){void 0!==e&&(n=e),u(),a(),l()},p=function(e){if(n=void 0!==e?e:!n,t.onClick){var r=t.onClick(n);Promise.resolve(r).then((function(){return f()})).catch((function(){return n=!n}))}else f()},y=e({html:r,onClick:p});return y.onClick=p,y.changeStatus=f,y}function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function ye(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function he(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ye(i,n,o,a,s,"next",e)}function s(e){ye(i,n,o,a,s,"throw",e)}a(void 0)}))}}function de(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function me(e,t){return me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},me(e,t)}function be(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ge(e)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e){return ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ke(e)}function we(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(f,e);var t,r,n,o,i,a,s,u,c,l=(u=f,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ke(u);if(c){var r=ke(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return be(this,e)});function f(){var e;de(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return we(ge(e=l.call.apply(l,[this].concat(r))),"_loadControlQueue",{"top-right":[],"bottom-right":[],"top-left":[],"bottom-left":[]}),we(ge(e),"_isControlLoading",{"top-right":!1,"bottom-right":!1,"top-left":!1,"bottom-left":!1}),e}return t=f,r=[{key:"addControl",value:(s=he(regeneratorRuntime.mark((function e(t,r,n){var o,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null!==(o=r)&&void 0!==o?o:"top-left",!(i="string"==typeof t?this.getControl(t,n):t)){e.next=4;break}return e.abrupt("return",new Promise((function(e){var t=function(){var t=he(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i;case 2:n=t.sent,o=a.mapAdapter.addControl(n,r),e(o);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();a._setControlQueue(r,t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"createControl",value:(a=he(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onLoad("build-map");case 2:if(!this.mapAdapter.createControl){e.next=4;break}return e.abrupt("return",this.mapAdapter.createControl(t,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"createButtonControl",value:(i=he(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onLoad("build-map");case 2:if(!this.mapAdapter.createButtonControl){e.next=4;break}return e.abrupt("return",this.mapAdapter.createButtonControl(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createToggleControl",value:(o=he(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onLoad("build-map");case 2:if(!this.mapAdapter.createToggleControl){e.next=6;break}return e.abrupt("return",this.mapAdapter.createToggleControl(t));case 6:if(!this.mapAdapter.createButtonControl){e.next=8;break}return e.abrupt("return",fe(this.mapAdapter.createButtonControl,t));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"removeControl",value:function(e){var t=this;"remove"in e?e.remove():this.mapAdapter.removeControl&&Promise.resolve(e).then((function(e){t.mapAdapter.removeControl(e)}))}},{key:"getControl",value:function(e,t){var r=this.mapAdapter.controlAdapters[e];if(r)return new r(t);var n=f.controls[e];return n?n(this,t):void 0}},{key:"getControlContainer",value:function(){if(this.mapAdapter.getControlContainer)return this.mapAdapter.getControlContainer()}},{key:"_setControlQueue",value:function(e,t){this._loadControlQueue[e].push(t),this._isControlLoading[e]||this._applyControls(e)}},{key:"_applyControls",value:(n=he(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._loadControlQueue[t].length){e.next=9;break}return this._isControlLoading[t]=!0,r=this._loadControlQueue[t][0],e.next=5,r();case 5:this._loadControlQueue[t].splice(0,1),this._applyControls(t),e.next=10;break;case 9:this._isControlLoading[t]=!1;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}],r&&ve(t.prototype,r),f}(le);we(_e,"controls",{CONTROL:function(e,t){return e.createControl(t.control,t.options)},BUTTON:function(e,t){return e.createButtonControl(t)},TOGGLE:function(e,t){return e.createToggleControl(t)}});var Le={};function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}var Oe=["position"];function Ce(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function Pe(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){Ce(i,n,o,a,s,"next",e)}function s(e){Ce(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t){return Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ae(e,t)}function Ee(e,t){if(t&&("object"===xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return je(e)}function je(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e){return Re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Re(e)}function Te(e){var t;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)}var Me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(c,e);var t,r,n,o,i,a,s,u=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Re(a);if(s){var r=Re(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ee(this,e)});function c(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this,e))._addControls(),r=t.id,n=je(t),Le[r]=n,t}return t=c,r=[{key:"_addLayerProviders",value:(i=Pe(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a,s,u,c,l,f,p,y,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,o=Te(this._starterKits);case 4:return e.next=6,o.next();case 6:if(!(t=!(i=e.sent).done)){e.next=47;break}if(!(a=i.value).getLayerAdapters){e.next=44;break}return e.next=11,a.getLayerAdapters.call(a);case 11:if(!(s=e.sent)){e.next=44;break}u=!1,c=!1,e.prev=15,f=Te(s);case 17:return e.next=19,f.next();case 19:if(!(u=!(p=e.sent).done)){e.next=28;break}return y=p.value,e.next=23,y.createAdapter(this);case 23:(h=e.sent)&&(this.mapAdapter.layerAdapters[y.name]=h);case 25:u=!1,e.next=17;break;case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(15),c=!0,l=e.t0;case 34:if(e.prev=34,e.prev=35,!u||null==f.return){e.next=39;break}return e.next=39,f.return();case 39:if(e.prev=39,!c){e.next=42;break}throw l;case 42:return e.finish(39);case 43:return e.finish(34);case 44:t=!1,e.next=4;break;case 47:e.next=53;break;case 49:e.prev=49,e.t1=e.catch(2),r=!0,n=e.t1;case 53:if(e.prev=53,e.prev=54,!t||null==o.return){e.next=58;break}return e.next=58,o.return();case 58:if(e.prev=58,!r){e.next=61;break}throw n;case 61:return e.finish(58);case 62:return e.finish(53);case 63:case"end":return e.stop()}}),e,this,[[2,49,53,63],[15,30,34,44],[35,,39,43],[54,,58,62]])}))),function(){return i.apply(this,arguments)})},{key:"_onLoadSync",value:(o=Pe(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,o=Te(this._starterKits);case 4:return e.next=6,o.next();case 6:if(!(t=!(i=e.sent).done)){e.next=20;break}if(!(a=i.value).onLoadSync){e.next=17;break}return e.prev=9,e.next=12,a.onLoadSync.call(a,this);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.error(e.t0);case 17:t=!1,e.next=4;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e.catch(2),r=!0,n=e.t1;case 26:if(e.prev=26,e.prev=27,!t||null==o.return){e.next=31;break}return e.next=31,o.return();case 31:if(e.prev=31,!r){e.next=34;break}throw n;case 34:return e.finish(31);case 35:return e.finish(26);case 36:case"end":return e.stop()}}),e,this,[[2,22,26,36],[9,14],[27,,31,35]])}))),function(){return o.apply(this,arguments)})},{key:"_addControls",value:function(){var e=this;this.options.controls&&this.options.controls.forEach((function(t){var r=t,n={};"string"==typeof t&&e.options.controlsOptions&&e.options.controlsOptions[t]&&void 0!==(n=e.options.controlsOptions[t]).control&&(r=n.control);var o=n,i=o.position,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(o,Oe);e.addControl(r,i||"top-left",a)})),this._emitStatusEvent("controls:create")}}],n=[{key:"get",value:function(e){return function(e){return Le[e]}(e)}}],r&&Se(t.prototype,r),n&&Se(t,n),c}(_e)}}]);
//# sourceMappingURL=main-1efbafe15204845.js.map