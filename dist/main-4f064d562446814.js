(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[42],{204:function(e,t,n){"use strict";n(5666);var r=n(2539),o=(n(1539),n(8674),n(7941),n(2526),n(7327),n(5003),n(4747),n(9337),n(2479),n(2222),n(9600),n(1249),n(8309),n(7042),n(1038),n(8783),n(1817),n(2165),n(6992),n(3948),n(2010)),i=n.n(o),a=n(6826),s=n(757),c=n(8907),u=n(5020),l=n(5502),f=(n(9720),n(8956)),p=n.n(f);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=y(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){d(i,r,o,a,s,"next",e)}function s(e){d(i,r,o,a,s,"throw",e)}a(void 0)}))}}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(4916),n(5306),n(4603),n(9714);var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),_(this,"ngwMap",void 0),_(this,"_resourceItems",{})}var t,n,r,o,i;return t=e,(n=[{key:"setNgwMap",value:function(e){this.ngwMap=e}},{key:"createPopupContent",value:function(e,t){var n=document.createElement("div"),r=document.createElement("div");r.className="properties";var o=Object.entries(e.properties).map((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||y(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{key:r[0],value:r[1]}}));if(r.innerHTML=this.createPropertiesHtml(o),t){var i=document.createElement("div");i.appendChild(r),n.innerHTML="Загрузка",this.updateElementContent(i,t,e).then((function(){n.innerHTML="",n.appendChild(i)}))}else n.appendChild(r);return n}},{key:"createPropertiesHtml",value:function(e){var t="";return e.forEach((function(e){var n=e.key,r=e.value;"object"===v(r)&&r&&("year"in r?r=[r.day,r.month,r.year].join("."):"hour"in r&&(r=[r.hour,r.minute].join(":"))),t+='\n      <div class="columns is-mobile">\n        <div class="column is-two-fifths">'.concat(n,'</div>\n        <div class="column">').concat(function(e){return"string"==typeof e&&(t=e,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t))?'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>"):e;var t}(r),"</div>\n      </div>\n      ")})),t}},{key:"updateElementContent",value:(i=m(regeneratorRuntime.mark((function e(t,n,r){var o,i,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getResourceItem(n);case 2:return(o=e.sent).feature_layer&&(i=[],o.feature_layer.fields.forEach((function(e){if(e.grid_visibility){var t=r.properties[e.keyname];t&&i.push({key:e.display_name,value:t})}})),a=this.createPropertiesHtml(i),(s=t.getElementsByClassName("properties")[0])&&(s.innerHTML=a)),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return i.apply(this,arguments)})},{key:"_addPhotos",value:(o=m(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,s,c,u,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=document.createElement("div")).className="carousel attachment",a=h(n),e.prev=3,a.s();case 5:if((s=a.n()).done){e.next=20;break}return c=s.value,(u=document.createElement("figure")).className="image is-".concat(300,"x").concat(300),e.next=13,this._loadImage(c,{width:300,height:300,id:r,fid:o});case 13:l=e.sent,(f=document.createElement("img")).src=l,u.appendChild(f),i.appendChild(u);case 18:e.next=5;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(3),a.e(e.t0);case 25:return e.prev=25,a.f(),e.finish(25);case 28:t.appendChild(i),p().attach(i);case 30:case"end":return e.stop()}}),e,this,[[3,22,25,28]])}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"_getResourceItem",value:(r=m(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._resourceItems[t]){e.next=5;break}return e.next=3,this.ngwMap.connector.get("resource.item",null,{id:t});case 3:n=e.sent,this._resourceItems[t]=n;case 5:return e.abrupt("return",this._resourceItems[t]);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_loadImage",value:function(e,t){var n=this;return new Promise((function(r,o){var i=t.width,a=t.height,s="/api/resource/"+t.id+"/feature/"+t.fid+"/attachment/".concat(e.id,"/image")+(i&&a?"?size=".concat(i,"x").concat(a):"");n.ngwMap.connector.makeQuery(s,{},{responseType:"blob"}).then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){r(t.result)}})).catch((function(e){o(e)}))}))}}])&&g(t.prototype,n),e}(),k=n(6273),M=n.n(k);function O(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j="Загрузка данных...",E=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,P(this,"_container",document.createElement("div")),P(this,"_content",void 0),P(this,"_toggle",void 0),P(this,"status",void 0),this.status=void 0===this.options.open||this.options.open,this._updateContainer(),this.options.parent&&this.options.parent.appendChild(this.getContainer())}var t,n,r,o;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"open",value:function(){!this._content||this._content.innerHTML&&this._content.innerHTML!==j||this._updateContent(),this._toggle&&(this._toggle.innerHTML=this._getToggleButtonHtml("fas fa-chevron-up")),this.status=!0}},{key:"close",value:function(){this._cleanContent(),this._toggle&&(this._toggle.innerHTML=this._getToggleButtonHtml("fas fa-chevron-down")),this.status=!1}},{key:"toggle",value:function(){this.status?this.close():this.open()}},{key:"_getToggleButtonHtml",value:function(e){return'\n    <a class="button is-small">\n    <span class="icon is-small">\n      <i class="'.concat(e,'"></i>\n    </span>\n    </a>\n    ')}},{key:"_updateContainer",value:function(){if(this._container.innerHTML="",this.options.title){var e=this._createHeader();this._container.appendChild(e)}var t=document.createElement("div");t.innerHTML=j,t.className="panel-content",this._content=t,this._container.appendChild(t),this.status?this.open():this.close()}},{key:"_createHeader",value:function(){var e=this,t=document.createElement("div");t.className="level is-mobile panel-header";var n=document.createElement("div");n.className="level-left";var r=document.createElement("div");r.className="level-item panel-header__title",r.innerHTML=this.options.title||"",n.appendChild(r);var o=document.createElement("div");o.className="level-right";var i=document.createElement("div");return i.className="level-item panel-header__toggle",o.appendChild(i),i.onclick=function(){e.toggle()},this._toggle=i,t.appendChild(n),t.appendChild(o),t}},{key:"_cleanContent",value:function(){this._content&&(this._content.innerHTML="")}},{key:"_updateContent",value:(r=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cleanContent(),!this._content){e.next=11;break}if("function"!=typeof this.options.content){e.next=8;break}return e.next=5,this.options.content();case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=this.options.content;case 9:t=e.t0,this._content.appendChild(t);case 11:return e.abrupt("return",this._content);case 12:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){O(i,n,o,a,s,"next",e)}function s(e){O(i,n,o,a,s,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}])&&C(t.prototype,n),e}(),L=n(9256);function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var x=function(){function e(t){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=void 0,(n="_container")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r;var o=this._createTreeItem(t);o&&(this._container=o)}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createTreeBranch",value:function(e){var t=this,n=document.createElement("div");return n.className="tree-container__item-children",e.forEach((function(e){if(e.item){var r=t._createTreeItem(e);r&&n.appendChild(r)}})),n}},{key:"_createTreeItem",value:function(e){var t=e.item;if(!t)return!1;var n=document.createElement("div");if(n.className="tree-container__item",t.display_name){var r=document.createElement("input");r.setAttribute("type","checkbox");var o="layer"!==t.item_type||t.layer_enabled;r.checked=o;var i=e.properties.property("visibility");i&&(i.emitter.on("change",(function(e){r.checked=e.value})),r.onclick=function(){i.set(r.checked,{propagation:L.y9.keys.pressed("ctrl")})});var a=document.createElement("span");a.innerHTML=t.display_name,n.appendChild(r),n.appendChild(a)}if("group"===t.item_type||"root"===t.item_type&&t.children.length){var s=e.tree.getChildren(),c=this._createTreeBranch(s.reverse());n.appendChild(c)}return n}}])&&S(t.prototype,n),e}();function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,T(this,"ngwMap",void 0),T(this,"_container",void 0),T(this,"_baseMapsContainer",void 0),this.ngwMap=t.ngwMap,this._container=this._createContainer(),this.ngwMap.emitter.on("layer:add",(function(e){n.ngwMap.isBaseLayer(e)&&n._updateBaseMapContainer()}))}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var e=document.createElement("div");e.className="basemaps-contentainer panel-content-padding control";var t=document.createElement("div");return t.className="basemaps-contentainer__layers",this._baseMapsContainer=t,e.appendChild(t),this._updateBaseMapContainer(),e}},{key:"_updateBaseMapContainer",value:function(){var e=this;this._baseMapsContainer&&(this._baseMapsContainer.innerHTML=""),this._createBaseMapItem(),this.ngwMap.getBaseLayers().forEach((function(t){var n=e.ngwMap.getLayer(t);n&&e._createBaseMapItem(n)}))}},{key:"_createBaseMapItem",value:function(e){var t=this,n=document.createElement("div");n.className="control";var r=document.createElement("label");r.className="radio basemap-container__item";var o=document.createElement("input");o.setAttribute("type","radio"),o.setAttribute("name","basemap"),o.checked=!!e&&this.ngwMap.isLayerVisible(e),o.onclick=function(){if(e&&e.id)t.ngwMap.toggleLayer(e.id,o.checked);else{var n=t.ngwMap.getActiveBaseLayer();n&&t.ngwMap.hideLayer(n)}};var i=e&&(e.name||e.options.name)||"Blank",a=document.createTextNode(i);r.appendChild(o),r.appendChild(a),n.appendChild(r),this._baseMapsContainer&&this._baseMapsContainer.appendChild(n)}}])&&D(t.prototype,n),e}(),I=(n(9826),n(5243));function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,B(this,"ngwMap",void 0),B(this,"_container",void 0),this.ngwMap=t.ngwMap,this._container=this._createContainer()}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var e=this,t=document.createElement("div");t.className="bookmarks-contentainer panel-content-padding ";var n=document.createElement("div");return n.className="bookmarks-contentainer__layers",this.options.bookmarks.forEach((function(n){e.ngwMap.connector.get("resource.item",null,{id:n.id}).then((function(r){if(r.feature_layer){var o=r.feature_layer.fields.find((function(e){return e.label_field}));o&&e.ngwMap.fetchNgwLayerItems({resourceId:n.id}).then((function(n){n.forEach((function(n){var r=e._createBookmarkItem(n,o.keyname);t.appendChild(r)}))}))}}))})),t.appendChild(n),t}},{key:"_createBookmarkItem",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",r=document.createElement("div");r.className="tree-container__item bookmark";var o=document.createElement("div"),i=e.fields[n];return o.innerHTML=String(i),o.onclick=function(){var n=new I.GeoJSON(e.geom),r=t.ngwMap.mapAdapter.map;r&&r.fitBounds(n.getBounds())},r.appendChild(o),r}}])&&R(t.prototype,n),e}();function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms",n=e.getTime();return"s"===t?n/1e3:e.toISOString()}n(8304),n(489),n(2419),n(4819),n(9653);var F=n(8527),U=n(8809),z=[[24,"1 день"],[48,"2 дня"],[72,"3 дня"],[96,"4 дня"],[120,"5 дней"],[144,"6 дней"],[168,"неделя"]],q=new Date;function Z(e,t){var n=t?t.getTime():Date.now();return[n-1e3*Number(e)*60*60,n].map((function(e){return new Date(e)}))}function $(e,t,n){var r=t.props,o=r.timeUnit,i=r.dateField;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"s";return Z(e,arguments.length>2?arguments[2]:void 0).map((function(e){return"ISO"===t?new Date(e).toISOString():"s"===t?Math.ceil(e.getTime())/1e3:e.getTime()}))}(e,o,n).map((function(e,t){return[i,t?"le":"ge",e]}))}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t,n){return(re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}setInterval((function(){q=new Date}),36e5),n(3123),n(3210);var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(s,e);var t,n,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae(o);if(i){var n=ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ie(this,e)});function s(){return te(this,s),a.apply(this,arguments)}return t=s,(n=[{key:"_createContainer",value:function(){var e=re(ae(s.prototype),"_createContainer",this).call(this),t=this._createCalendar();return e.insertBefore(t,e.firstChild),e}},{key:"_createCalendar",value:function(){var e=this,t=document.createElement("div"),n=this.options.fires,r=[];return n.forEach((function(t){var n=t.id;if(n){var o=new Promise((function(t){e.onLayerAdd(n,t)}));r.push(o)}})),Promise.all(r).then((function(n){var r=e._buildCalendarBlock(n,e.options.dateRange,e.options.defaultDateRange);t.appendChild(r)})),t}},{key:"_buildCalendarBlock",value:function(e,t,n){var o=X(t,2),i=o[0],a=o[1],s=X(n,2),c=s[0],u=s[1],l={timedelta:this.options.timedelta,onChange:function(t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Y(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=o.options.props||{},a=i.dateField,s=i.timeUnit;if(a){var c=[];t.start&&c.push([a,"ge",H(t.start,s)]),t.end&&c.push([a,"le",H(t.end,s)]),o.propertiesFilter&&o.propertiesFilter(c)}}}catch(e){r.e(e)}finally{r.f()}}};return i&&(l.minDate=i),c&&(l.startDate=c),a&&(l.maxDate=a),u&&(l.endDate=u),function(e){var t=document.createElement("div");t.className="field is-horizontal",t.innerHTML='\n    <div class="field">\n        <input class="input input-from is-small" type="text" >\n    </div>\n\n    <div class="select is-small">\n      <select class="select-input">\n        '.concat(z.map((function(t){return"<option ".concat(e.timedelta===t[0]?"selected":""," value=").concat(t[0],">").concat(t[1],"</option>")})),"\n      </select>\n    </div>\n    ");var n=t.querySelector(".select-input"),o=t.querySelector(".input.input-from"),i=e.onChange,a=e.maxDate,s=e.minDate,c=e.startDate,u=e.endDate,l=new Date,f=(0,r.Ds)((function(e){e.start&&e.end&&i(e)})),p=c&&u?[c,u]:void 0,h=(0,F.Z)(o,{mode:"range",locale:U.Russian,allowInput:!0,maxDate:a||l,minDate:s,defaultDate:p,onChange:function(e){var t=G(e,2),r=t[0],o=t[1];n.value="",f({start:r,end:o})}});return n.onchange=function(){var e=G(Z(Number(n.value),u),2),t=e[0],r=e[1];h.setDate([t,r]),f({start:t,end:r})},t}(l)}}])&&ne(t.prototype,n),s}(function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,Q(this,"ngwMap",void 0),Q(this,"_container",void 0),this.ngwMap=t.ngwMap,this._container=this._createContainer()}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var e=document.createElement("div");e.className="fires-contentainer panel-content-padding ";var t=document.createElement("div");t.className="fires-contentainer__layers";var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.options.fires);try{for(r.s();!(n=r.n()).done;){var o=n.value;this._createFireItem(o,t)}}catch(e){r.e(e)}finally{r.f()}return e.appendChild(t),e}},{key:"onLayerAdd",value:function(e,t){var n=this,r=this.options.ngwMap,o=r&&r.getLayer(e);if(o)t(o);else{this.ngwMap.emitter.on("layer:add",(function r(o){o.id===e&&(t(o),n.ngwMap.emitter.off("layer:add",r))}))}}},{key:"_createFireItem",value:function(e,t){var n=this,o=document.createElement("div");o.className="tree-container__item";var i=e.id;if((0,r.ri)(i)){var a=document.createElement("div");a.innerHTML="загрузка...",t.appendChild(a),this.onLayerAdd(i,(function(t){return function(t){var r=t.item;if(a.innerHTML="",r){var s=document.createElement("input");s.setAttribute("type","checkbox"),s.checked=!0,s.onclick=function(){n.ngwMap.toggleLayer(i,s.checked)};var c=document.createElement("span"),u=r.resource.display_name.split("__")[0];c.innerHTML=u.replace("fires","").trim();var l=n._createSymbol(e);o.appendChild(s),o.appendChild(l),o.appendChild(c),a.appendChild(o)}}(t)}))}}},{key:"_createSymbol",value:function(e){var t,n=document.createElement("span");n.className="item-symbol";var r=(null===(t=e.adapterOptions)||void 0===t?void 0:t.paint).color;return"string"==typeof r&&(n.style.color=r,n.style.borderColor=r,n.style.backgroundColor=r),n}}])&&V(t.prototype,n),e}());function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e){var t=e.connector,n=e.layer,r=n.resource;if(n&&r&&t){var o,i,a=(null===(o=n.adapterOptions)||void 0===o||null===(i=o.props)||void 0===i?void 0:i.dateField)||"field_9";return t.getResourceIdOrFail(r).then((function(e){var n={resourceId:e,fields:[a],geom:!1,connector:t,limit:1},r=[(0,s.nm)(fe(fe({},n),{},{orderBy:[a]}))];return Promise.all(r).then((function(e){var t=ce(e,2);return[ce([t[0],t[1]].map((function(e){var t,n=e&&e[0];if(n){var r=n.fields[a];if(r)return t=r,new Date(t.year,t.month-1,t.day)}})),1)[0],q]}))}))}return Promise.resolve([void 0,void 0])}function de(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){be(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ge={target:"tree"},_e=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actionMap=t,be(this,"options",void 0),be(this,"sidebar",void 0),be(this,"_container",void 0),be(this,"_target",void 0),be(this,"ngwLayers",void 0),this.options=ve(ve({},ge),n),"string"==typeof this.options.target){var r=document.getElementById(this.options.target);if(!r)throw new Error("No element with ID #".concat(this.options.target," in document for webmap tree"));this._target=r}else this.options.target instanceof HTMLElement&&(this._target=this.options.target);this.sidebar=new(M())(this._target,{closeButton:!1,position:"left",autoPan:!1}),this.sidebar.addTo(this.actionMap.ngwMap.mapAdapter.map),this.ngwLayers=this.options.ngwLayers,this._container=this._createContainer(),this.options.status||this.hide(),this._target&&this._target.appendChild(this._container)}var t,n,r,o;return t=e,(n=[{key:"show",value:function(){this._container.classList.remove("hidden"),this.sidebar.show()}},{key:"hide",value:function(){this.sidebar.hide(),this._container.classList.add("hidden")}},{key:"_createContainer",value:function(){var e=this,t=document.createElement("div");return t.className="tree-container",void 0!==this.options.width&&(t.style.width=this.options.width+"px"),(this.options.userFires||this.options.fires)&&new E({title:"Пожары",content:function(){return e._createUserFiresContainer()},parent:t}),new E({title:"Базовые слои",content:function(){return e._createNgwLayers()},open:!1,parent:t}),new E({title:"Подложки",content:function(){return e._createBasemapsContainer()},open:!1,parent:t}),new E({title:"Закладки",content:function(){return e._createBookmarksContainer()},open:!1,parent:t}),t}},{key:"_createNgwLayers",value:function(){var e=document.createElement("div");for(var t in e.className="webmap-tree-container",this.ngwLayers){var n=this.ngwLayers[t],r=new x(n.layer.layer).getContainer();r&&e.appendChild(r)}return e}},{key:"_createBookmarksContainer",value:function(){var e=document.createElement("div"),t=this.options.bookmarks;if(t){var n=new N({bookmarks:t,ngwMap:this.options.ngwMap});e.appendChild(n.getContainer())}return e}},{key:"_createUserFiresContainer",value:(r=regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,s,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.createElement("div"),n=this.options,r=n.fires,o=n.userFires,i=[void 0,void 0],!r&&!o){e.next=15;break}if(a=[],!o||!o.id){e.next=10;break}return a.push(o),e.next=9,he({layer:o,connector:this.options.ngwMap.connector});case 9:i=e.sent;case 10:r&&r.forEach((function(e){return a.push(e)})),s=this.actionMap.options.timedelta||24,c=Z(s,q),u=new se({fires:a,ngwMap:this.options.ngwMap,dateRange:i,defaultDateRange:c,timedelta:this.actionMap.options.timedelta||72}),t.appendChild(u.getContainer());case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){de(i,n,o,a,s,"next",e)}function s(e){de(i,n,o,a,s,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"_createBasemapsContainer",value:function(){var e=document.createElement("div");if(this.options.fires){var t=new A({ngwMap:this.options.ngwMap});e.appendChild(t.getContainer())}return e}}])&&ye(t.prototype,n),e}(),we=(n(6977),n(7187));function ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Pe=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Me(this,e),this.actionMap=t,Ce(this,"html",'<i class="fas fa-map-pin btn-control-icon "></i>'),Ce(this,"title",{off:"Полученить координаты с карты",on:"Выключить режим получения координат с карты"}),Ce(this,"addClass","toggle-control webmap-tree-control"),Ce(this,"addClassOn","active"),Ce(this,"status",!1),Ce(this,"emitter",new we.EventEmitter),Ce(this,"_toggle",void 0),Ce(this,"__onMapClick",void 0),Ce(this,"_layer",void 0),this._toggle=r.toggle,this.actionMap.ngwMap.addLayer("GEOJSON",{id:"show-coordinate-click",visibility:!0,paint:{radius:6},popup:!0,popupOptions:{createPopupContent:function(e){if(e.feature)return n._createPopupContent(e.feature.geometry.coordinates.map((function(e){return e.toFixed(5)})))}}}).then((function(e){e&&(n._layer=e)}))}var t,n;return t=e,(n=[{key:"onClick",value:function(e){this.toggleControl(e)}},{key:"show",value:function(){var e=this;this.actionMap.ngwMap.setCursor("crosshair"),this._removeClickListener(),this.__onMapClick=function(t){return e._onMapClick(t)},this.actionMap.ngwMap.emitter.on("click",this.__onMapClick)}},{key:"hide",value:function(){this.actionMap.ngwMap.setCursor("default"),this._removeClickListener(),this.actionMap.ngwMap.clearLayerData(this._layer)}},{key:"_removeClickListener",value:function(){this.__onMapClick&&(this.actionMap.ngwMap.emitter.off("click",this.__onMapClick),this.__onMapClick=void 0)}},{key:"_onMapClick",value:function(e){var t={type:"Feature",properties:{},geometry:{type:"Point",coordinates:e.lngLat}};this.actionMap.ngwMap.setLayerData(this._layer,t)}},{key:"toggleControl",value:function(e){(e=void 0!==e?e:!this.status)?this.show():this.hide(),this.status=e,this._toggle&&this._toggle(e),this.emitter.emit("status",this.status)}},{key:"_createPopupContent",value:function(e){var t,n,o=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ke(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1],s=document.createElement("div"),c="".concat(a,", ").concat(i);return s.innerHTML='\n    <span>Широта/Долгота:</span>\n    <span class="lat-lng-coord"> '.concat(c,'</span>\n    <a href="#" class="copy-to-clipboard">\n    <i class="far fa-clipboard"></i>\n    </a>'),s.getElementsByClassName("copy-to-clipboard")[0].onclick=function(){r.TU.copy(c)},s}}])&&Oe(t.prototype,n),e}(),je={en:{linearMeasurement:"Distance measurement",areaMeasurement:"Area measurement",start:"Start",meter:"m",kilometer:"km",squareMeter:"m²",squareKilometers:"km²"},ru:{linearMeasurement:"Измерение расстояния",areaMeasurement:"Измерение площади",start:"Старт",meter:"м",kilometer:"км",squareMeter:"м²",squareKilometers:"км²"}};function Ee(e){return e*(Math.PI/180)}function Le(e){return Math.pow(e,2)}function Se(e,t){return e<1e3?xe(e,0)+" "+t.meter:xe(e/1e3,2)+" "+t.kilometer}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=",",r=e<0?"-":"",o=Math.abs(+e||0),i=parseInt(o.toFixed(t),10)+"",a=i.length>3?i.length%3:0;return[r,a?i.substr(0,a)+n:"",i.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+n),t?"."+Math.abs(o-Number(i)).toFixed(t).slice(2):""].join("")}function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ae(e,t){return(Ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?Re(e):t}function Re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(1058);var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ae(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Be(r);if(o){var n=Be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ie(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ne(Re(t=i.call(this,e)),"options",{latlng:null,content:"",className:""}),Ne(Re(t),"_map",void 0),Ne(Re(t),"_offset",new I.Point(0,30)),Ne(Re(t),"_container",void 0),Ne(Re(t),"_contentNode",void 0),Ne(Re(t),"_closeButton",void 0),Ne(Re(t),"_containerBottom",void 0),Ne(Re(t),"_containerLeft",void 0),I.Util.setOptions(Re(t),e),t.options.offset&&(t._offset=t.options.offset),t}return t=a,(n=[{key:"onAdd",value:function(e){return this._map=e,this._container||this._initLayout(),this._container&&e.getPanes().popupPane.appendChild(this._container),e.on("viewreset",this._updatePosition,this),I.Browser.any3d&&e.on("zoomanim",this._zoomAnimation,this),this._update(),this}},{key:"addTo",value:function(e){return e.addLayer(this),this}},{key:"onRemove",value:function(e){return this._container&&e.getPanes().popupPane.removeChild(this._container),e.off("viewreset",this._updatePosition,this),e.off("zoomanim",this._zoomAnimation,this),this._map=null,this}},{key:"setLatLng",value:function(e){return this.options.latlng=(0,I.latLng)(e),this._updatePosition(),this}},{key:"setContent",value:function(e){return this.options.content=e,this._updateContent(),this}},{key:"enableClose",value:function(){return this._closeButton=I.DomUtil.create("span","close",this._container),this._closeButton.innerHTML='<svg class="icon" viewBox="0 0 40 40"><path stroke="#FF0000" stroke-width="3" d="M 10,10 L 30,30 M 30,10 L 10,30" /></svg>',this._closeButton}},{key:"_initLayout",value:function(){this._container=I.DomUtil.create("div",this.options.className),this._contentNode=I.DomUtil.create("div","content",this._container)}},{key:"_update",value:function(){this._map&&(this._updateContent(),this._updatePosition())}},{key:"_updateContent",value:function(){this._contentNode&&this.options.content&&("string"==typeof this.options.content?this._contentNode.innerHTML=this.options.content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this.options.content)))}},{key:"_updatePosition",value:function(){if(this.options.latlng&&this._container){var e=this._map.latLngToLayerPoint(this.options.latlng),t=I.Browser.any3d,n=this._offset;t&&I.DomUtil.setPosition(this._container,e),this._containerBottom=-n.y-(t?0:e.y),this._containerLeft=n.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}}},{key:"_zoomAnimation",value:function(e){if(this._container){var t=this._map._latLngToNewLayerPoint(this.options.latlng,e.zoom,e.center);I.DomUtil.setPosition(this._container,t)}}}])&&Te(t.prototype,n),a}(I.Layer);function Fe(e){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ze(e,t){return(ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qe(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?Ze(e):t}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ze(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$e(r);if(o){var n=$e(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return qe(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ge(Ze(n=i.call(this,e)),"options",{color:"#FF0080",model:"distance",messages:je.en}),Ge(Ze(n),"_map",void 0),Ge(Ze(n),"_measureHandler",void 0),Ge(Ze(n),"_finished",void 0),Ge(Ze(n),"_startMove",void 0),Ge(Ze(n),"_measurementStarted",void 0),Ge(Ze(n),"_lastPoint",void 0),Ge(Ze(n),"_totalDistance",0),Ge(Ze(n),"_trail",{overlays:[],points:[]}),Ge(Ze(n),"_directPath",void 0),Ge(Ze(n),"_measurePath",void 0),n._map=e,n._measureHandler=Ze(n),n._finished=!1,I.Util.setOptions(Ze(n),t),n}return t=a,(n=[{key:"setModel",value:function(e){return this.options.model=e,this}},{key:"addHooks",value:function(){this._activeMeasure()}},{key:"removeHooks",value:function(){this._disableMeasure()}},{key:"_activeMeasure",value:function(){this._measureHandler._measurementStarted&&this._measureHandler._finishMeasure(),this._measurementStarted?this._finishMeasure():this._enableMeasure()}},{key:"_onMouseClick",value:function(e){var t=e.latlng||this._map.mouseEventToLatLng(e);if(!this._lastPoint||!t.equals(this._lastPoint)){if(this._trail.points.length>0){var n=this._trail.points;n.push(t);var r=n.length;this._totalDistance+=(o=n[r-2],i=n[r-1],a=Ee(o.lat),c=(s=Ee(i.lat))-a,u=Ee(i.lng-o.lng),l=Le(Math.sin(c/2))+Math.cos(a)*Math.cos(s)*Le(Math.sin(u/2)),12756274*Math.asin(Math.sqrt(l))),this._addMeasurePoint(t),this._addMarker(t),"area"!==this.options.model&&this._addLable(t,Se(this._totalDistance,this.options.messages),"leaflet-measure-lable")}else this._totalDistance=0,this._addMeasurePoint(t),this._addMarker(t),"area"!==this.options.model&&this._addLable(t,this.options.messages.start,"leaflet-measure-lable"),this._trail.points.push(t);var o,i,a,s,c,u,l;this._lastPoint=t,this._startMove=!1}}},{key:"_onMouseMove",value:function(e){var t=e.latlng;this._directPath&&this._trail.points.length>0&&(this._startMove?this._directPath.setLatLngs(this._trail.points.concat(t)):(this._directPath.setLatLngs([t]),this._startMove=!0))}},{key:"_enableMeasure",value:function(){this._trail={overlays:[],points:[]};var e=this._map;I.DomUtil.addClass(e.getContainer(),"leaflet-measure-map"),e.contextMenu&&e.contextMenu.disable(),this._measurementStarted=!0,e.on("click",this._onMouseClick,this),e.on("dblclick",this._finishMeasure,this),e.on("contextmenu",this._finishMeasure,this),e.doubleClickZoom.disable(),e.on("mousemove",this._onMouseMove,this),e.fire("measure:start")}},{key:"_disableMeasure",value:function(){var e=this._map;I.DomUtil.removeClass(e.getContainer(),"leaflet-measure-map"),e.contextMenu&&e.contextMenu.enable(),e.off("click",this._onMouseClick,this),e.off("dblclick",this._finishMeasure,this),e.off("contextmenu",this._finishMeasure,this),e.off("mousemove",this._onMouseMove,this),e.doubleClickZoom.enable(),this._measurementStarted=this._startMove=!1,this._finished||this._clearOverlay.call(this),e.fire("measure:stop")}},{key:"_finishMeasure",value:function(e){var t,n,r;this._trail.points.length>0&&(this._trail.points.length>1?(!this._directPath||e&&"contextmenu"!==e.type||this._directPath.setLatLngs(this._trail.points),this._lastPoint&&("area"===this.options.model?this._addLable(this._lastPoint,(t=this._trail.points,n=this.options.messages,(r=Math.round(function(e){for(var t=6378137,n=0,r=e.length,o=e[r-1].lng,i=e[r-1].lat,a=0;a<r;a++){var s=e[a].lng,c=e[a].lat;n+=Ee(s-o)*(2+Math.sin(Ee(i))+Math.sin(Ee(c))),o=s,i=c}return Math.abs(n*t*t/2)}(t)))<1e6?xe(r,0)+" "+n.squareMeter:xe(r/1e6,2)+" "+n.squareKilometers),"leaflet-measure-lable",!0):this._addLable(this._lastPoint,Se(this._totalDistance,this.options.messages),"leaflet-measure-lable",!0)),this._directPath&&this._map.removeLayer(this._directPath),this._finished=!0):this._clearOverlay.call(this)),this.disable()}},{key:"_resetDirectPath",value:function(e){var t;this._directPath?this._directPath.addLatLng(e):(t="area"===this.options.model?new I.Polygon([e],{weight:2,color:this.options.color,dashArray:[5,5],fillOpacity:0,interactive:!1}):new I.Polyline([e],{weight:2,color:this.options.color,dashArray:[5,5],interactive:!1}),this._map.addLayer(t),this._trail.overlays.push(t),this._directPath=t)}},{key:"_addMeasurePoint",value:function(e){var t;this._measurePath?this._measurePath.addLatLng(e):(t="area"===this.options.model?new I.Polygon([e],{weight:2,color:this.options.color,fillColor:this.options.color,fillOpacity:.5,interactive:!1}):new I.Polyline([e],{weight:2,color:this.options.color,interactive:!1}),this._map.addLayer(t),this._trail.overlays.push(t),this._measurePath=t),this._resetDirectPath(e)}},{key:"_addMarker",value:function(e){var t=new I.CircleMarker(e,{color:this.options.color,opacity:1,weight:1,fillColor:"#FFFFFF",fill:!0,fillOpacity:1,radius:3,interactive:!1});this._map.addLayer(t),this._trail.overlays.push(t)}},{key:"_addLable",value:function(e,t,n,r){var o=this,i=new He({latlng:e,content:t,className:n});if(this._map.addLayer(i),this._trail.overlays.push(i),r){var a=i.enableClose();I.DomEvent.on(a,"click",(function(e){I.DomEvent.stopPropagation(e),o._clearOverlay()}),this)}}},{key:"_clearOverlay",value:function(){var e,t=this._trail.overlays,n=0;for(e=t.length;n<e;n++)this._map.removeLayer(t[n])}}])&&Ue(t.prototype,n),a}(I.Handler);function Je(e){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(Object(n),!0).forEach((function(t){nt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t){return(Xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ye(e,t){return!t||"object"!==Je(t)&&"function"!=typeof t?et(e):t}function et(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tt(e){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=tt(r);if(o){var n=tt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ye(this,e)});function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),nt(et(t=i.call(this,e)),"options",{position:"topright",title:"Measurement",collapsed:!0,color:"#FF0080",locale:"en",messages:je.en}),nt(et(t),"_map",void 0),nt(et(t),"_container",void 0),nt(et(t),"_link",void 0),nt(et(t),"_contents",void 0),nt(et(t),"_measureHandler",void 0),I.Util.setOptions(et(t),e);var n=e.locale;if(n&&"en"!==n){var r=je[n];r?t.options.messages=Qe(Qe({},je),r):console.error("Measure control has no messages for "+t.options.locale+" locale")}return t}return t=a,(n=[{key:"onAdd",value:function(e){return this._map=e,this._container||this._initLayout()}},{key:"disableMeasure",value:function(){this._measureHandler&&(this._measureHandler.disable(),this._measureHandler=void 0)}},{key:"_buildContainer",value:function(){return this._container=I.DomUtil.create("div","leaflet-control-measure leaflet-bar leaflet-control"),this._contents=I.DomUtil.create("div","leaflet-measure-contents",this._container),this._link=I.DomUtil.create("a","leaflet-measure-toggle",this._container),this._link.title=this.options.title||"Measurement",this._link.href="#",this._buildItems(),this._container}},{key:"_buildItems",value:function(){var e=I.DomUtil.create("ul","leaflet-measure-actions",this._contents),t=I.DomUtil.create("li","leaflet-measure-action",e),n=I.DomUtil.create("a","start",t);n.innerText=this.options.messages.linearMeasurement,n.href="#",I.DomEvent.disableClickPropagation(n),I.DomEvent.on(n,"click",this._enableMeasureLine,this),t=I.DomUtil.create("li","leaflet-measure-action",e);var r=I.DomUtil.create("a","leaflet-measure-action start",t);r.innerText=this.options.messages.areaMeasurement,r.href="#",I.DomEvent.disableClickPropagation(r),I.DomEvent.on(r,"click",this._enableMeasureArea,this)}},{key:"_initLayout",value:function(){var e=this._buildContainer();return I.DomEvent.disableClickPropagation(e),I.DomEvent.disableScrollPropagation(e),this.options.collapsed?I.DomEvent.on(e,{mouseenter:this._expand,mouseleave:this._collapse},this):this._expand(),e}},{key:"_enableMeasureLine",value:function(e){I.DomEvent.stopPropagation(e),this.disableMeasure(),this._map&&(this._measureHandler=new Ke(this._map,{model:"distance",color:this.options.color,messages:this.options.messages}),this._measureHandler.enable())}},{key:"_enableMeasureArea",value:function(e){I.DomEvent.stopPropagation(e),this.disableMeasure(),this._map&&(this._measureHandler=new Ke(this._map,{model:"area",color:this.options.color,messages:this.options.messages}),this._measureHandler.enable())}},{key:"_expand",value:function(){return this._link&&this._container&&(this._link.style.display="none",I.DomUtil.addClass(this._container,"leaflet-measure-expanded")),this}},{key:"_collapse",value:function(){return this._link&&this._container&&(this._link.style.display="block",I.DomUtil.removeClass(this._container,"leaflet-measure-expanded")),this}}])&&We(t.prototype,n),a}(I.Control),ot=[];function it(e,t){ot.push({name:e,stop:t})}function at(e){ot.forEach((function(t){t.name!==e&&t.stop()}))}function st(e){var t=new rt({locale:"ru"});e.addControl(t,"top-left"),e.onLoad().then((function(){var n=e.mapAdapter.map;n&&(n.on("measure:start",(function(){at("measure"),e.disableSelection()})),n.on("measure:stop",(function(){e.setCursor("default"),e.enableSelection()}))),it("measure",(function(){t.disableMeasure()}))}))}function ct(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){mt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function ht(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){pt(i,r,o,a,s,"next",e)}function s(e){pt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var vt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,mt(this,"ngwMap",void 0),mt(this,"tree",void 0),mt(this,"treeControl",void 0),mt(this,"authControl",void 0),mt(this,"popup",void 0),mt(this,"_promises",{}),this.popup=new w}var t,n,r,o,f,p,h,d;return t=e,(n=[{key:"create",value:(d=ht(regeneratorRuntime.mark((function e(t){var n,r,o,i,s,f,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ft({},t.mapOptions),r=t.basemaps,o=t.fires,i=t.userFires,s=new a.Z8(ft({mapAdapter:new u.Z,controls:[],minZoom:4,runtimeParams:[new l.Z]},n)),this.ngwMap=s,s.setCursor("default"),this.popup.setNgwMap(s),r&&s.onLoad().then((function(){return r.forEach((function(e,t){s.addBaseLayer("QMS",ft(ft({},e),{},{visibility:0===t}))}))})),s.getPaintFunctions={base:c.q},s.addControl("ZOOM","top-left"),this._createLocateControl(),s.addControl("ATTRIBUTION","bottom-right",{customAttribution:['<a href="https://nextgis.com" target="_blank">©NextGIS</a>']}),st(s),this._createShareControl(),e.next=15,s.getNgwLayers();case 15:return f=e.sent,p=[],Object.values(f).forEach((function(e){var t=e.layer.item&&e.layer.item.webmap&&e.layer.item.webmap.bookmark_resource;t&&p.push(t)})),e.next=20,this._addUserFires(t.userFires);case 20:return e.next=22,this._addFires(t.fires);case 22:this._createGetCoordinateControl(),this._addTreeControl({ngwLayers:f,fires:o,userFires:i,bookmarks:p}),this._addEventsListeners();case 25:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"_locate",value:function(){var e=this;this.ngwMap.locate({setView:!1},{locationfound:function(t){var n=t.lngLat;e.ngwMap.setCenter(n)}})}},{key:"_createAuthControl",value:(h=ht(regeneratorRuntime.mark((function e(t){var n,r,o,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=document.getElementsByClassName("js-auth-btn")[0],r=function(){return!(!i.ngwMap.connector||!i.ngwMap.connector.user)},o=function(){t.logout(),window.location.reload()},n.innerHTML=r()?"Выйти":"Войти",n.style.display="block",n.addEventListener("click",o);case 6:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})},{key:"_createShareControl",value:function(){var e=this,t=document.getElementsByClassName("js-modal")[0],n=document.getElementsByClassName("js-modal-close")[0],r=document.getElementsByClassName("js-share-modal-content")[0],o=document.getElementsByClassName("js-share-input")[0];n.addEventListener("click",(function(){r.innerHTML="",t.classList.remove("is-active")}));var a=this.ngwMap.createButtonControl({html:'<i class="fas fa-share-alt btn-control-icon "></i>',onClick:function(){var n,a;n=location.href,a=e._createShareModalContent(n),o.value=n,r.innerHTML=a,i().update(),t.classList.add("is-active")}});this.ngwMap.addControl(a,"bottom-right")}},{key:"_createGetCoordinateControl",value:(p=ht(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Pe(this,{toggle:function(e){e?(at("coordinate"),r.ngwMap.disableSelection()):r.ngwMap.enableSelection()}}),e.next=3,this.ngwMap.createToggleControl(t);case 3:n=e.sent,this.ngwMap.addControl(n,"top-left"),it("coordinate",(function(){return n.onClick(!1)}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return p.apply(this,arguments)})},{key:"_createLocateControl",value:function(){var e=this,t=this.ngwMap.createButtonControl({html:'<i class="fas fa-location-arrow btn-control-icon"></i>',title:"Найти меня на карте",onClick:function(){return e._locate()}});this.ngwMap.addControl(t,"top-left")}},{key:"_createShareModalContent",value:function(e){return'<div class="buttons share-btn js-share-btn" data-url="'.concat(e,'" data-title="" data-desc="">\n      ').concat([{id:"tw",name:"Twitter",icon:"fab fa-twitter"},{id:"vk",name:"VK",icon:"fab fa-vk"},{id:"fb",name:"Facebook",icon:"fab fa-facebook-square"}].map((function(e){return'<a class="button is-primary" data-id="'.concat(e.id,'">\n                    <span class="icon">\n                        <i class="').concat(e.icon,'"></i>\n                    </span>\n                    <span>').concat(e.name,"</span>\n                </a>")})).join(""),"\n    </div>")}},{key:"_addUserFires",value:(f=ht(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(r=t.adapterOptions&&t.adapterOptions.paint?t.adapterOptions.paint:{},this.ngwMap.addNgwLayer({resource:t.resource,id:t.id,adapterOptions:ft(ft(ft({},t.adapterOptions),{},{paint:ft(ft({},r),{},{stroke:!0,fillOpacity:.6,radius:5}),selectable:!0,selectedPaint:ft(ft({},r),{},{stroke:!0,fillOpacity:.9,radius:7})},n),{},{propertiesFilter:$(this.options.timedelta||24,t.adapterOptions,q)})}));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"_addFires",value:(o=ht(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=18;break}n=ct(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return o=r.value,e.next=8,this._addUserFires(o);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return o.apply(this,arguments)})},{key:"_addTreeControl",value:(r=ht(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementsByClassName("js-sidebar")[0],r=function(){return n.classList.contains("is-active")},o=function(){return n.classList.add("is-active")},i=function(){return n.classList.remove("is-active")},e.next=6,this.ngwMap.onLoad();case 6:this.tree=new _e(this,ft(ft({},t),{},{ngwMap:this.ngwMap})),a=function(e){(e=void 0!==e?e:r())?(at("tree"),s.tree&&s.tree.show(),o()):(s.tree&&s.tree.hide(),i())},n.addEventListener("click",(function(){a()})),setTimeout((function(){a()}),500),it("tree",(function(){return a(!1)}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_clean",value:function(){this._promises.getFeaturePromise&&this._promises.getFeaturePromise.cancel&&this._promises.getFeaturePromise.cancel(),this.ngwMap.removeLayer("highlight")}},{key:"_highlighNgwLayer",value:function(e){var t=this;this._clean();var n=(0,s.RP)(e)[0];if(n){var r=n.resourceId;this.ngwMap.fetchIdentifyItem(e,{extensions:["attachment"]}).then((function(e){e&&e.toGeojson().then((function(o){t.ngwMap.addLayer("GEOJSON",{id:"highlight",data:o,visibility:!0,paint:{color:"green",stroke:!0,fillOpacity:"0.8"},selectOnHover:!0,popup:!0,popupOptions:{createPopupContent:function(o){if(o.feature){var i=t.popup.createPopupContent(o.feature,r);return e.extensions.attachment&&e.extensions.attachment.length&&t.popup._addPhotos(i,e.extensions.attachment,n.resourceId,n.featureId),i}}}})}))}))}}},{key:"_addEventsListeners",value:function(){var e=this;this.ngwMap.emitter.on("click",(function(){e.ngwMap.cancelPromises("identify","select")})),this.ngwMap.emitter.on("ngw:select",(function(t){return t&&e._highlighNgwLayer(t)}))}}])&&dt(t.prototype,n),e}();function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){kt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function _t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}document.addEventListener("DOMContentLoaded",(function(){var e=Array.prototype.slice.call(document.querySelectorAll(".navbar-burger"),0);e.length>0&&e.forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.target,n=document.getElementById(t);e.classList.toggle("is-active"),n&&n.classList.toggle("is-active")}))}))}));var Mt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_t(this,e),this.options=t,kt(this,"actionMap",void 0),this.actionMap=new vt(t)}var t,n,r,o;return t=e,(n=[{key:"create",value:(r=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.options=bt(bt({},this.options),t),this.showContent(),e.next=4,this.actionMap.create(this.options);case 4:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){gt(i,n,o,a,s,"next",e)}function s(e){gt(i,n,o,a,s,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})},{key:"showContent",value:function(){var e=document.getElementById("app"),t=document.getElementById("app-loading");t&&(t.style.display="none"),e&&(e.style.display="block")}}])&&wt(t.prototype,n),e}(),Ot={};try{Ot=n(1761).Z}catch(e){console.warn("Config file is not funded, run with default settings")}new Mt((0,r.vb)({mapOptions:{target:"map",bounds:[36.59,43.385,49.374,50.214]},timedelta:72},Ot)).create()}},function(e){"use strict";e.O(0,[426,956,884,34,80,12,243,385,185,888,365,471,189,692],(function(){return 204,e(e.s=204)})),e.O()}]);
//# sourceMappingURL=main-4f064d562446814.js.map