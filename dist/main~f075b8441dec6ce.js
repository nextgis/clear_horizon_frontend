(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{106:function(t,e,r){"use strict";r.d(e,"a",(function(){return p}));var n,o=r(215),i=r(26),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},u=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(t){function e(r,n,o,i){var a=t.call(this,s(s({},e.options),o))||this;if(a.webMap=r,a._rootDescendantsCount=0,i&&a.tree.setParent(i),a.item=n,"root"===a.item.item_type)a._rootDescendantsCount=a._sumUp(a.item.children);else{var c=a.tree.getRoot();c&&(a._rootDescendantsCount=c._rootDescendantsCount)}return a.initProperties(),a._init(n),a}return a(e,t),e.prototype.initItem=function(t){return c(this,void 0,void 0,(function(){var r,n,o,i,a,c,p,l,f,h=this;return u(this,(function(u){switch(u.label){case 0:return r=t._layer,n=t,"group"!==t.item_type&&"root"!==t.item_type?[3,1]:(t.children&&t.children.length&&t.children.reverse().forEach((function(t){var r=new e(h.webMap,t,h.options,h);h.tree.addChild(r)})),[3,3]);case 1:return"layer"!==t.item_type?[3,3]:(o=t.adapter||t.layer_adapter.toUpperCase(),i=t.layer_max_scale_denom?this._mapScaleToZoomLevel(t.layer_max_scale_denom):this.webMap.options.maxZoom,a=t.layer_min_scale_denom?this._mapScaleToZoomLevel(t.layer_min_scale_denom):this.webMap.options.minZoom,c=s(s({maxZoom:i,minZoom:a,minScale:t.layer_min_scale_denom,maxScale:t.layer_max_scale_denom},t),{headers:this.options.headers}),this.options.order&&(p=this._rootDescendantsCount-t.draw_order_position,c.order=this.options.order+.1*p),[4,this.webMap.addLayer(o,c)]);case 2:r=u.sent(),u.label=3;case 3:return r&&(n._layer=r,this.layer=r,this.properties&&"layer"===t.item_type&&t.layer_enabled&&this.properties.property("visibility").set(!0),"number"==typeof(l="layer"===t.item_type&&t.layer_transparency)&&(f=(100-l)/100,this.webMap.setLayerOpacity(r,f))),[2]}}))}))},e.prototype.bringToFront=function(){},e.prototype.fit=function(){"layer"===this.item.item_type&&console.log(this.item)},e.prototype._mapScaleToZoomLevel=function(t){return Object(i.i)(t)},e.prototype._init=function(t){return c(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.initItem(t)];case 1:return e.sent(),this.emitter.emit("init"),[2]}}))}))},e.prototype._sumUp=function(t,e){void 0===e&&(e=0);for(var r=0,n=t;r<n.length;r++){var o=n[r];"layer"===o.item_type?(e+=1,o.draw_order_position=o.draw_order_position||e):"group"===o.item_type&&(e=this._sumUp(o.children,e))}return e},e.options={properties:[{type:"boolean",name:"visibility",getProperty:function(t){if(t){if("group"===t.item.item_type)return!0;if("layer"===t.item.item_type)return t.item.layer_enabled;if("root"===t.item.item_type)return!0}return!1},onSet:function(t,e,r){r&&r.layer&&"layer"===r.item.item_type&&(t?r.webMap.showLayer(r.layer):r.webMap.hideLayer(r.layer),r.item.layer_enabled=t)}}]},e}(o.default)},107:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(108),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=function(){function t(t,e){this.item=t,this.options={},this._properties={},this._propertiesList=[],e&&e.forEach(this._setPropertyHandler.bind(this))}return t.prototype.add=function(t){this._setPropertyHandler(t)},t.prototype._setPropertyHandler=function(e){var r=t.handlers,n=e.handler;if(!n&&e.type)switch(e.type){case"boolean":n=r.CheckProperty;break;case"string":n=r.BaseProperty;break;default:n=r.BaseProperty}if(n&&e.name){var i=o({},e||{});this._properties[e.name]=new n(e.name,this.item,i),this._propertiesList.push(e.name)}},t.prototype.update=function(){this.list().forEach((function(t){t.update()}))},t.prototype.get=function(t){var e=this.property(t);if(e)return e.get()},t.prototype.set=function(t,e,r){var n=this.property(t);if(n)return n.set(e,r)},t.prototype.property=function(t){return this._properties[t]},t.prototype.list=function(){var t=this;return this._propertiesList.map((function(e){return t._properties[e]}))},t.prototype.destroy=function(){for(var t in this._properties){var e=this.property(t);e&&e.destroy&&e.destroy()}this._properties={},this._propertiesList=[]},t.handlers={CheckProperty:n.a},t}()},108:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n,o=r(109),i=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t){function e(r,n,o){var i=t.call(this,r,n,a(a({},e.options),o))||this;return i.set(i.get()),i}return i(e,t),e.prototype.update=function(t,e){if(t){if(e&&e.bubble||this.options.bubble){this.unBlock(e);var r=this.getParent(),n=r&&r.properties&&r.properties.property(this.name);n&&n.set(t,Object.assign({},e,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(e)}else this._turnOff(e);(e&&e.propagation||this.options.propagation)&&this._propagation(t,e)},e.prototype.getHierarchyValue=function(){var t=this;return this.get()&&this.getParents().every((function(e){var r=e.properties&&e.properties.get(t.name);return r&&r.get()}))},e.prototype._prepareValue=function(t){return t},e.prototype._turnOff=function(t){this.options.turnOff&&this.options.turnOff.call(this,t),this._callOnSet(!1,t),this.options.hierarchy&&this.isGroup()&&this.blockChilds(t)},e.prototype._turnOn=function(t){this.options.turnOn&&this.options.turnOn.call(this,t),this._callOnSet(!0,t),this.options.hierarchy&&this.isGroup()&&this.unblockChilds(t)},e.prototype.block=function(t){this._blocked=!0,this._block(t)},e.prototype._block=function(t){this._turnOff(t)},e.prototype.unBlock=function(t){this._blocked=!1,this.getValue()&&this._unBlock(t)},e.prototype._unBlock=function(t){this._turnOn(t)},e.prototype.blockChilds=function(t){var e=this;this.item.tree.getDescendants().forEach((function(r){return e._blockChild(r,t)}))},e.prototype.unblockChilds=function(t){var e=this;this.item.tree.getChildren().forEach((function(r){return e._unBlockChild(r,t)}))},e.prototype._blockChild=function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.block&&r.block(e)},e.prototype._unBlockChild=function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.unBlock&&r.unBlock(e)},e.prototype._propagation=function(t,e){if(this.isGroup())for(var r=this.item.tree.getChildren(),n=0;n<r.length;n++){var o=r[n],i=o.properties&&o.properties.property(this.name);i&&i.set(t,a(a({},e),{propagation:!0,bubble:!1}))}},e.options={hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"},e}(o.a)},109:function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return i}));try{n=r(32)}catch(t){}var o=n&&n.EventEmitter,i=function(){function t(t,e,r){this.emitter=o&&new o,this._blocked=!1,this.item=e,this.options=Object.assign({},r),this.name=t,this._value=this.getProperty()}return t.prototype.getProperty=function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this,this.item):this.options.value},t.prototype.getParents=function(){return this.item.tree.getParents()||[]},t.prototype.getParent=function(){return this.item.tree.getParent()},t.prototype.isGroup=function(){return this.item.tree.getDescendants().length},t.prototype.isBlocked=function(){var t=this;if(void 0===this._blocked){var e=this.item.tree.getParents();if(e){var r=e.find((function(e){var r=e.properties&&e.properties.property(t.name);return!!r&&!r.get()}));this._blocked=!!r}else this._blocked=!1}return this._blocked},t.prototype.set=function(t,e){this._value=this._prepareValue(t),this.update(this._value,e),this._fireChangeEvent(this._value,e)},t.prototype.get=function(){return this.getValue()},t.prototype.update=function(t,e){this._callOnSet(t,e)},t.prototype.getContainer=function(){return this._container},t.prototype.destroy=function(){if(this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}this._removeEventsListener&&this._removeEventsListener()},t.prototype.getValue=function(){return void 0!==this._value?this._value:this.getProperty()},t.prototype._prepareValue=function(t){return t},t.prototype._callOnSet=function(t,e){this.options.onSet&&this.options.onSet.call(this,t,e,this.item)},t.prototype._fireChangeEvent=function(t,e){var r=this;this.emitter&&(t=void 0!==t?t:this.getValue(),this.emitter.emit("change",{value:t,options:e}),this.item.tree.getParents().forEach((function(n){var o=n.properties&&n.properties.property(r.name);o&&o.emitter.emit("change-tree",{value:t,options:e,item:r.item})})))},t}()},111:function(t,e,r){"use strict";var n=r(140);r(23),r(211);e.default=n.a},112:function(t,e,r){"use strict";var n=r(144);r(208);e.default=n.a},113:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n={brill:'<path d="m6 0-5 6 5 6 5-6z"/>',circle:'<circle cx="6" cy="6" r="6"/>',rect:'<rect width="12" height="12"/>',marker:'<path d="m6 0c-1.85 0-4 1.19-4 4.22 0 2.05 3.08 6.59 4 7.78 0.821-1.19 4-5.62 4-7.78 0-3.03-2.15-4.22-4-4.22z"/>',cross:'<path d="M 2.4,12 6,8.4 9.6,12 12,9.6 8.4,6 12,2.4 9.6,0 6,3.6 2.4,0 0,2.4 3.6,6 0,9.6 Z"/>',star:'<path d="m6 0.25 1.71 4.18 4.29-1.04e-4 -3.43 3.14 0.857 4.18-3.43-3.14-3.43 3.14 0.857-4.18-3.43-3.14 4.29-0.209z"/>',triangle:'<path d="m12 11.7h-12l6-11.2z"/>',plus:'<path d="m7.5 12v-4.5h4.5v-3h-4.5v-4.5h-3v4.5h-4.5v3h4.5v4.5z"/>',minus:'<path d="m12 7.5v-3h-12v3z"/>',asterisk:'<path d="m7.59 12v-3.27l2.83 1.64 1.58-2.74-2.85-1.64 2.83-1.64-1.56-2.74-2.83 1.64v-3.24h-3.17v3.24l-2.85-1.64-1.57 2.74 2.84 1.64-2.84 1.64 1.57 2.74 2.85-1.64v3.27z"/>'},o=.8;function i(t){void 0===t&&(t={});var e=t.shape||"circle",r=t.color||"blue",i=t.strokeColor||"white",a=t.size||12,s=a/2,c="number"==typeof t.stroke?t.stroke:o,u=a/12,p=n[e]||"circle",l=function(t,e,r,n){void 0===r&&(r=0);var o=r/2,i='<svg\n    version="1.1"\n    xmlns="http://www.w3.org/2000/svg"\n    width="'+t+'"\n    height="'+e+'"\n    viewBox="-'+o+" -"+o+" "+(t+r)+" "+(e+r)+'"\n  >'+n+"</svg>";return(new DOMParser).parseFromString(i,"image/svg+xml").documentElement}(a,a,c*u,"string"==typeof p?p:p(t)),f=l.firstChild,h="scale("+u+")";return f.setAttribute("fill",r),c&&(f.setAttribute("stroke",i),f.setAttribute("stroke-width",String(c))),f.setAttribute("transform",h),{type:"icon",iconSize:[a,a],iconAnchor:[s,s],html:(new XMLSerializer).serializeToString(l)}}},139:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){this._params={}}return t.prototype.get=function(t){return this.params()[t]},t.prototype.params=function(){var t={};return window.location.href.replace(/[?&]+(\w+)([^&]*)/gi,(function(e,r){return t[r]=!0,""})),window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,r,n){return t[r]=decodeURIComponent(n),""})),this._params=t,t},t.prototype.set=function(t,e){if(e){var r=void 0,n=encodeURIComponent(e);r=this.get(t)?location.search.replace(new RegExp("([?|&]"+t+"=)(.+?)(&|$)"),"$1"+n+"$3"):location.search.length?location.search+"&"+t+"="+n:"?"+t+"="+n;var o={};o[t]=e,this._params[t]=e;var i={state:{url:r,params:o},url:r};return this._pushState(i),i}return this.remove(t)},t.prototype.remove=function(t){var e,r=location.search,n=r.split("?")[0],o=-1!==r.indexOf("?")?r.split("?")[1]:"";if(""!==o){for(var i=(e=o.split("&")).length-1;i>=0;i-=1)e[i].split("=")[0]===t&&e.splice(i,1);n=n+"?"+e.join("&")}delete this._params[t];var a={state:{url:n,type:"remove"},url:n};return this._pushState(a),a},t.prototype._pushState=function(t){history&&history.replaceState(t.state,document.title,t.url)},t}()},140:function(t,e,r){"use strict";var n=r(32),o=r(29),i=r(23),a=r(33),s=r(21),c=r(113);function u(){return i.default.decorators.onLoad("build-map")}var p=r(112),l=function(){return(l=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function f(t,e,r,n){if("number"==typeof e||"string"==typeof e)e=Number(e),t.push(l(l({},r),{resourceId:e}));else if(Array.isArray(e)){var o=e[0],i=e[1];t.push(l(l(l({},r),{resourceId:o,id:i}),n))}else"object"==typeof e&&t.push(l(l(l({},r),e),n))}var h={target:"map",baseUrl:"",controls:["ZOOM","ATTRIBUTION"],controlsOptions:{ZOOM:{position:"top-left"},ATTRIBUTION:{position:"bottom-right",customAttribution:['<a href="http://nextgis.ru" target="_blank">Â©NextGIS</a>']}},pixelRadius:10};r.d(e,"a",(function(){return O}));var y,d=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),v=function(){return(v=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},m=function(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},b=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},g=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},_=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},w=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},O=function(t){function e(e,r){var i=t.call(this,function(t,e){var r=[new p.default];!e.connector&&e.baseUrl?e.connector=new a.default({baseUrl:e.baseUrl,auth:e.auth}):e.connector&&(e.baseUrl=e.connector.options.baseUrl);var n=Object(o.b)(h,e);return n.connector&&r.push(new s.default({connector:n.connector,auth:n.auth,identification:n.identification})),{mapAdapter:t,starterKits:r,runtimeParams:e.runtimeParams}}(e,r))||this;return i.emitter=new n.EventEmitter,i.options={},i._ngwLayers={},r.connector&&(i.connector=r.connector),i.options=Object(o.b)(h,r),i._createWebMap().then((function(){var t=i.getContainer();t&&t.classList.add("ngw-map-container"),i._addControls()})),i}var r,l,y;return d(e,t),e.prototype.fit=function(){var t=this.options,e=t.center,r=t.zoom,n=t.bounds;e?(this.setCenter(e),r&&this.setZoom(r)):n&&this.fitBounds(n)},e.prototype.addControl=function(e,r,n){return g(this,void 0,void 0,(function(){return _(this,(function(o){return[2,t.prototype.addControl.call(this,e,r,n)]}))}))},e.prototype.addNgwLayer=function(t){return g(this,void 0,Promise,(function(){var e,r,n,o;return _(this,(function(i){switch(i.label){case 0:if(!t.resourceId&&!t.keyname)throw new Error("resourceId or keyname is required parameter to add NGW layer");if(!this.options.baseUrl&&""!==this.options.baseUrl)return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),e=s.default.utils.addNgwLayer(t,this,this.options.baseUrl,this.connector),[4,this.addLayer(e,v(v({visibility:!0},t),t.adapterOptions))];case 2:return r=i.sent(),n=r&&this.getLayerId(r),r&&n&&(this._ngwLayers[n]={layer:r,resourceId:r.resourceId},r.options.baseLayer&&this.getActiveBaseLayer()),[2,r];case 3:return o=i.sent(),console.error("can't add ngw layer",o),[3,4];case 4:return[2]}}))}))},e.prototype.getNgwLayerItem=function(t){return g(this,void 0,a.CancelablePromise,(function(){return _(this,(function(e){return[2,s.default.utils.getNgwLayerItem(v({connector:this.connector},t))]}))}))},e.prototype.getNgwLayerItems=function(t){return g(this,void 0,a.CancelablePromise,(function(){return _(this,(function(e){return[2,s.default.utils.getNgwLayerItems(v({connector:this.connector},t))]}))}))},e.prototype.getNgwLayerFeature=function(t){return g(this,void 0,a.CancelablePromise,(function(){return _(this,(function(e){return[2,s.default.utils.getNgwLayerFeature(v({connector:this.connector},t))]}))}))},e.prototype.getNgwLayerFeatures=function(t){return g(this,void 0,a.CancelablePromise,(function(){return _(this,(function(e){return[2,s.default.utils.getNgwLayerFeatures(v({connector:this.connector},t))]}))}))},e.prototype.getIdentifyGeoJson=function(t,e){return void 0===e&&(e=!1),g(this,void 0,a.CancelablePromise,(function(){return _(this,(function(r){return[2,s.default.utils.getIdentifyGeoJson({identify:t,connector:this.connector,multiple:e})]}))}))},e.prototype.getNgwLayers=function(){return g(this,void 0,Promise,(function(){return _(this,(function(t){switch(t.label){case 0:return[4,this.onLoad()];case 1:return t.sent(),[2,this._ngwLayers]}}))}))},e.prototype.getNgwLayerByResourceId=function(t){return g(this,void 0,Promise,(function(){var e,r,n,o,i,a,s,c;return _(this,(function(u){switch(u.label){case 0:for(r in e=[],this._ngwLayers)e.push(r);n=0,u.label=1;case 1:return n<e.length?(o=e[n],(i=this._ngwLayers[o]).resourceId!==t?[3,2]:[2,i&&i.layer]):[3,6];case 2:return i.layer.getIdentificationIds?[4,i.layer.getIdentificationIds()]:[3,4];case 3:if((a=u.sent())&&a.some((function(e){return e===t})))return[2,i.layer];u.label=4;case 4:if(i.layer.getDependLayers&&(s=i.layer.getDependLayers(),c=s.find((function(e){return e.item&&e.item.parentId===t}))))return[2,c.layer];u.label=5;case 5:return n++,[3,1];case 6:return[2]}}))}))},e.prototype.zoomToLayer=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a=this;return _(this,(function(c){switch(c.label){case 0:return e="string"==typeof t||"number"==typeof t?String(e):t.id,(r=e&&this._ngwLayers[e])?r.layer.getExtent?[4,r.layer.getExtent()]:[3,2]:[3,6];case 1:return(n=c.sent())&&this.fitBounds(n),[3,6];case 2:return o=void 0,r.layer.item?(o=r.layer.item,[3,5]):[3,3];case 3:return i=r.resourceId,[4,this.connector.get("resource.item",null,{id:i})];case 4:o=c.sent(),c.label=5;case 5:s.default.utils.getNgwResourceExtent(o,this.connector).then((function(t){t&&a.fitBounds(t)})),c.label=6;case 6:return[2]}}))}))},e.prototype.onLoad=function(e){return void 0===e&&(e="ngw-map:create"),t.prototype.onLoad.call(this,e)},e.prototype.removeLayer=function(e){var r=this.getLayer(e);if(r){var n=this.getLayerId(r);n&&delete this._ngwLayers[n],t.prototype.removeLayer.call(this,r)}},e.prototype.enableSelection=function(){var t=this;this.__selectFromNgwRaster||(this.__selectFromNgwRaster=function(e){return t._selectFromNgwRaster(e)},this.__selectFromNgwVector=function(e){return t._selectFromNgwVector(e)},this.emitter.on("click",this.__selectFromNgwRaster),this.emitter.on("layer:click",this.__selectFromNgwVector))},e.prototype.disableSelection=function(){this.__selectFromNgwRaster&&(this.emitter.off("click",this.__selectFromNgwRaster),this.emitter.off("click",this._selectFromNgwVector),this.__selectFromNgwRaster=void 0,this.__selectFromNgwVector=void 0)},e.prototype._isFitFromResource=function(){var t=this._initMapState;return!t.zoom||!t.center},e.prototype._createWebMap=function(){return g(this,void 0,void 0,(function(){var t,e,r,n,o,i,a,s,c=this;return _(this,(function(u){switch(u.label){case 0:return[4,this.create(v({},this.options))];case 1:return u.sent(),this.options.qmsId?(t=void 0,e=void 0,Array.isArray(this.options.qmsId)?(t=this.options.qmsId[0],e=this.options.qmsId[1]):t=Number(this.options.qmsId),r={qmsId:t},e&&(r.id=e),[4,this.addBaseLayer("QMS",r).then((function(t){c.showLayer(t)}))]):[3,3];case 2:u.sent(),u.label=3;case 3:n=[],o=this._isFitFromResource(),this.options.webmapId&&f(n,this.options.webmapId,{fit:o}),this.options.resources&&Array.isArray(this.options.resources)&&this.options.resources.forEach((function(t){var e={};o||(e.fit=!1),f(n,t,{},e)})),i=0,a=n,u.label=4;case 4:return i<a.length?(s=a[i],[4,this.addNgwLayer(s)]):[3,7];case 5:u.sent(),u.label=6;case 6:return i++,[3,4];case 7:return this._emitStatusEvent("ngw-map:create",this),this.enableSelection(),[2]}}))}))},e.prototype._addControls=function(){var t=this;this.options.controls&&this.options.controls.forEach((function(e){var r=e,n={};"string"==typeof e&&t.options.controlsOptions&&t.options.controlsOptions[e]&&void 0!==(n=t.options.controlsOptions[e]).control&&(r=n.control);var o=n.position,i=w(n,["position"]);t.addControl(r,o||"top-left",i)})),this._emitStatusEvent("controls:create")},e.prototype._selectFromNgwVector=function(t){return g(this,void 0,Promise,(function(){var e,r,n,o,i,a,s;return _(this,(function(c){return e=t.layer,r=e.item&&e.item.resource.id,n=t.feature,void 0!==r&&n&&(o=n.id)?(i={id:Number(o),fields:n.properties,label:"#"+r,layerId:Number(r),parent:"",geom:n.geometry},(s={featureCount:1})[r]={featureCount:1,features:[i]},a=s,this._emitStatusEvent("ngw:select",v(v({},a),{resources:[r],sourceType:"vector"})),[2,a]):[2]}))}))},e.prototype._selectFromNgwRaster=function(t){return g(this,void 0,void 0,(function(){var e,r,n,o,i,a,c,u,p,l,f=this;return _(this,(function(h){switch(h.label){case 0:for(r in e=[],this._ngwLayers)(n=this._ngwLayers[r].layer).getIdentificationIds&&n.options.selectable&&e.push(n.getIdentificationIds());return[4,Promise.all(e)];case 1:return o=h.sent(),i=[],o.forEach((function(t){t&&t.forEach((function(t){return i.push(t)}))})),i.length&&(a=this.options.pixelRadius||10,c=this.getCenter(),u=this.getZoom(),c&&u)?(p=40075016.686*Math.abs(Math.cos(180*c[1]/Math.PI))/Math.pow(2,u+8),l=a*p*5e-4,[2,s.default.utils.sendIdentifyRequest(t,{layers:i,connector:this.connector,radius:l}).then((function(e){return f._emitStatusEvent("ngw:select",v(v({},e),{resources:i,sourceType:"raster",event:t})),e}))]):[2]}}))}))},e.utils=v(v(v({},i.default.utils),s.default.utils),{fixUrlStr:o.c,deepmerge:o.b}),e.decorators=v({onMapLoad:u},i.default.decorators),e.getIcon=c.a,m([i.default.decorators.onLoad("controls:create"),b("design:type",Function),b("design:paramtypes",[Object,"function"==typeof(r=void 0!==i.ControlPositions&&i.ControlPositions)?r:Object,Object]),b("design:returntype",Promise)],e.prototype,"addControl",null),m([u(),b("design:type",Function),b("design:paramtypes",["function"==typeof(l=void 0!==s.AddNgwLayerOptions&&s.AddNgwLayerOptions)?l:Object]),b("design:returntype","function"==typeof(y="undefined"!=typeof Promise&&Promise)?y:Object)],e.prototype,"addNgwLayer",null),e}(i.default)},141:function(t,e,r){"use strict";function n(t,e,r,o){void 0===e&&(e=function(t){return!!t}),void 0===o&&(o=[]);var i=[];if(Array.isArray(t))i=t;else{e(t)&&o.push(t);var a=r(t);a&&(Array.isArray(a)?i=a:i.push(a))}for(var s=0;s<i.length;s++)i[s]&&n(i[s],e,r,o);return o}var o=function(){function t(t){this._children=[],this.item=t}return t.prototype.setParent=function(t){this._parent=t},t.prototype.addChild=function(t){this._children.push(t)},t.prototype.getParent=function(){return this._parent},t.prototype.getParents=function(t){var e=this.getParent();return e?n(e,t,(function(t){return t.tree.getParent()})):[]},t.prototype.getRoot=function(){for(var t=this.getParent(),e=t;t;)(t=t.tree.getParent())&&(e=t);return e},t.prototype.find=function(t){return n(this._children,t,(function(t){return t.tree.getChildren()}))[0]},t.prototype.all=function(t){return this.getDescendants(t)},t.prototype.getDescendants=function(t){return n(this._children,t,(function(t){return t.tree.getChildren()}))},t.prototype.getChildren=function(){return this._children},t}(),i=r(107);r.d(e,"a",(function(){return p}));var a,s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};try{a=r(32)}catch(t){}var c=a&&a.EventEmitter,u=0,p=function(){function t(t){this.options={},this.id=u,this.emitter=c&&new c,u+=1,this.options=s({},t),this.tree=new o(this)}return t.prototype.initProperties=function(){this.properties=new i.a(this,this.options.properties)},t}()},142:function(t,e,r){"use strict";var n=r(51);var o=/\{ *([\w_-]+) *\}/g;function i(t,e){return t.replace(o,(function(t,r){var n=e[r];if(void 0===n)throw new Error("No value provided for letiable "+t);return"function"==typeof n&&(n=n(e)),n}))}var a=r(32);r.d(e,"a",(function(){return l}));var s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},u=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},l=function(){function t(t){this.options=t,this.emitter=new a.EventEmitter,this.routeStr="/api/component/pyramid/route",this._loadingQueue={},this._loadingStatus={},this._keynames={},this.options.route&&(this.routeStr=this.options.route)}return t.prototype.setNextGisWeb=function(t){this.logout(),this.options.baseUrl=t},t.prototype.connect=function(){return c(this,void 0,n.a,(function(){var t,e,r,n=this;return u(this,(function(o){switch(o.label){case 0:return this.route?[2,Promise.resolve(this.route)]:[3,1];case 1:return this.options.auth?(t=this.options.auth,e=t.login,r=t.password,e&&r?[4,this.getUserInfo({login:e,password:r})]:[3,3]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.makeQuery(this.routeStr,{},{}).then((function(t){return n.route=t,t}))];case 4:return[2,o.sent()]}}))}))},t.prototype.login=function(t){return c(this,void 0,void 0,(function(){return u(this,(function(e){return this.logout(),[2,this.getUserInfo(t)]}))}))},t.prototype.logout=function(){this._rejectLoadingQueue(),this._loadingStatus={},this.options.auth=void 0,this.route=void 0,this.user=void 0,this.emitter.emit("logout")},t.prototype.getUserInfo=function(t){var e=this;if(this.user&&this.user.id)return n.a.resolve(this.user);t&&(this.options.auth=t);var r={headers:this.getAuthorizationHeaders(t)};return this.makeQuery("/api/component/auth/current_user",{},r).then((function(t){return e.user=t,e.emitter.emit("login",t),t})).catch((function(t){throw e.emitter.emit("login:error",t),t}))},t.prototype.getAuthorizationHeaders=function(t){var e=this.makeClientId(t);if(e)return{Authorization:"Basic "+e}},t.prototype.makeClientId=function(t){if(t=t||this.options.auth){var e=t.login,r=t.password;return window.btoa(unescape(encodeURIComponent(e+":"+r)))}},t.prototype.getResourceByKeyname=function(t){return c(this,void 0,void 0,(function(){var e,r;return u(this,(function(n){switch(n.label){case 0:return(e=this._keynames.keyname)?[3,2]:[4,this.get("resource.search",null,{keyname:t})];case 1:r=n.sent(),(e=r[0])&&(this._keynames[t]=e),n.label=2;case 2:return[2,e]}}))}))},t.prototype.getResourceChildren=function(t){return c(this,void 0,Promise,(function(){var e,r;return u(this,(function(n){switch(n.label){case 0:if(e=t.resourceId,!t.keyname&&!t.resourceId)throw new Error("No keyname or resourceId is set");return t.keyname?[4,this.getResourceByKeyname(t.keyname)]:[3,2];case 1:r=n.sent(),e=r.resource.id,n.label=2;case 2:return[4,this.get("resource.collection",null,{parent:e})];case 3:return[2,n.sent()]}}))}))},t.prototype.request=function(t,e,r){return void 0===e&&(e={}),c(this,void 0,n.a,(function(){var o,a,s,c,l,f,h,y;return u(this,(function(u){switch(u.label){case 0:return[4,this.connect()];case 1:if(o=u.sent(),a=o&&o[t]){if(a=p(a),s=a.shift(),a.length){for(c={},l=0;l<a.length;l++)if(f=a[l],c[l]="{"+f+"}",void 0===e[f])throw new Error("`"+f+"` url api argument is not specified");s&&(s=i(s,c))}if(e){for(y in h=[],e)-1===a.indexOf(y)&&h.push(y+"="+e[y]);h.length&&(s=s+"?"+h.join("&"))}if(s)return[2,this.makeQuery(s,e,r)];throw new Error("request url is not set")}return[2,n.a.resolve({})]}}))}))},t.prototype.post=function(t,e,r){return(e=e||{}).method="POST",e.nocache=!0,this.request(t,r,e)},t.prototype.get=function(t,e,r){return(e=e||{}).method="GET",e.nocache=!0,this.request(t,r,e)},t.prototype.patch=function(t,e,r){return(e=e||{}).method="PATCH",e.nocache=!0,this.request(t,r,e)},t.prototype.put=function(t,e,r){return(e=e||{}).method="PUT",e.nocache=!0,this.request(t,r,e)},t.prototype.delete=function(t,e,r){return(e=e||{}).method="DELETE",e.nocache=!0,this.request(t,r,e)},t.prototype.makeQuery=function(t,e,r){var o=this;if(void 0===r&&(r={}),t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=i(t,e)),t=t.replace(/([^:]\/)\/+/g,"$1"),!this._loadingStatus[t]||r.nocache?(this._loadingStatus[t]=!0,this._getJson(t,r).then((function(e){return o._loadingStatus[t]=!1,o._executeLoadingQueue(t,e),e})).catch((function(e){throw o._loadingStatus[t]=!1,o._executeLoadingQueue(t,e,!0),o.emitter.emit("error",e),e}))):(this._loadingStatus[t]=!1,new n.a((function(e,r){o._setLoadingQueue(t,e,r)})));throw new Error("No `url` parameter set for option "+name)},t.prototype._setLoadingQueue=function(t,e,r){this._loadingQueue[t]=this._loadingQueue[t]||{name:t,waiting:[]},this._loadingQueue[t].waiting.push({resolve:e,reject:r,timestamp:new Date})},t.prototype._rejectLoadingQueue=function(){for(var t in this._loadingQueue){this._loadingQueue[t].waiting.forEach((function(t){t.reject()})),delete this._loadingQueue[t]}},t.prototype._executeLoadingQueue=function(t,e,r){var n=this._loadingQueue[t];if(n){for(var o=0;o<n.waiting.length;o++){var i=n.waiting[o];r?i.reject&&i.reject():i.resolve(e)}n.waiting=[]}},t.prototype._getJson=function(t,e){var r=this,o=[];return e.responseType=e.responseType||"json",new n.a((function(n,i){r.user&&((e=e||{}).headers=s(s({},r.getAuthorizationHeaders()),e.headers)),function(t,e,r,n,o){void 0===r&&(r={}),r.method=r.method||"GET";var i=new XMLHttpRequest;i.open(r.method||"GET",t,!0),"blob"===r.responseType&&(i.responseType=r.responseType);var a=function(t){void 0===t&&(t=!1);var o=t?n:e;if("blob"===r.responseType)o(i.response);else if(i.responseText)try{o(JSON.parse(i.responseText))}catch(t){o(i.responseText)}else n({message:""})};i.onreadystatechange=function(){4===i.readyState&&200===i.status||3===i.readyState&&201===i.status?a():3===i.readyState&&400===i.status?a():4===i.readyState&&500===i.status?a():4===i.readyState&&401===i.status?n(i.statusText):4===i.readyState&&n("request error")},i.onerror=function(t){n(t)},i.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;r.onProgress&&r.onProgress(e)}};var s,c=r.headers;if(c)for(var u in c){var p=c[u];"string"==typeof p&&i.setRequestHeader(u,p)}if(void 0!==r.withCredentials&&(i.withCredentials=r.withCredentials),r.file){if((s=new FormData).append("file",r.file),r.data)for(var l in s)s.append(l,s[l])}else s=r.data?"string"==typeof r.data?r.data:JSON.stringify(r.data):null;o&&o.push((function(){i.abort()})),i.send(s)}(t,n,e,i,o)}),(function(){o.forEach((function(t){return t()}))}))},t}()},143:function(t,e,r){"use strict";var n=r(33),o=r(26),i=r(41),a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t,e){var r;void 0===e&&(e=!1);var n=[],o=[];for(var i in t){var a=Number(i);isNaN(a)||n.push(a)}var s=t.resources;s&&n.sort((function(t,e){return s.indexOf(t)-s.indexOf(e)}));for(var c=0;c<n.length;c++){var u=t[i=n[c]].features,p=Number(i),l=u[0];if(l&&(r={featureId:l.id,resourceId:p},o.push(r),!e))break}return o}function c(t){var e=t.connector,r=t.identify;for(var n in r){var o=Number(n);if(!isNaN(o)){var c=r[n].features.find((function(t){return t.geom}));if(c&&c.geom){var u=c.geom;return Object(i.a)(a(a({},c),{geom:u}))}}}var p=s(r);if(p)return Object(i.b)(a({connector:e},p[0]))}var u=r(54);r.d(e,"a",(function(){return h}));var p=function(){return(p=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},l=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},f=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},h=function(){function t(t){if(this.options=t,this.options.connector)this.url=this.options.connector.options.baseUrl,this.connector=this.options.connector;else{if(!this.options.baseUrl)throw new Error("url is not defined");this.url=this.options.baseUrl,this.connector=new n.default({baseUrl:this.url,auth:this.options.auth})}}return t.prototype.onLoadSync=function(t){return l(this,void 0,void 0,(function(){var e,r,n,o,i;return f(this,(function(a){switch(a.label){case 0:if(!this.options.resourceId||!this.url)return[3,4];if(!(e=[this.options.resourceId]).length)return[3,4];r=0,n=e,a.label=1;case 1:return r<n.length?(o=n[r],i={resourceId:o,connector:this.connector,baseUrl:this.url,webMap:t},[4,t.addLayer(u.a,p({visibility:!0,fit:!0,identification:this.options.identification,pixelRadius:this.options.pixelRadius},i))]):[3,4];case 2:return[2,a.sent()];case 3:return r++,[3,1];case 4:return[2]}}))}))},t.prototype.getLayerAdapters=function(){return Promise.resolve([this._getLayerAdapter()])},t.prototype._getLayerAdapter=function(){var t=this;return{name:"WEBMAP",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}},t.prototype._createAdapter=function(t){var e=this.connector,r=this.url;return Object(o.c)({webMap:t,connector:e,baseUrl:r})},t.utils={addNgwLayer:o.a,getNgwResourceExtent:o.e,sendIdentifyRequest:o.h,pixelsInMeterWidth:o.g,getNgwLayerFeature:i.b,getNgwLayerFeatures:i.c,getNgwLayerItems:i.e,getNgwLayerItem:i.d,getIdentifyGeoJson:c,getIdentifyGeoJsonParams:s,createGeoJsonFeature:i.a,setScaleRatio:o.i},t.updateWmsParams=o.j,t.getLayerAdapterOptions=o.d,t.addNgwLayer=o.a,t}()},144:function(t,e,r){"use strict";var n=r(29),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},a=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s={tms:"TILE"};function c(t){return new Promise((function(e,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState&&200===o.status&&o.responseText)try{e(JSON.parse(o.responseText))}catch(t){r(t)}},o.open("GET",Object(n.c)(t),!0),o.send()}))}function u(t,e){return void 0===e&&(e="https://qms.nextgis.com"),function(){function r(t,e){this.map=t,this.options=e,this.options.baseLayer=!0}return r.prototype.addLayer=function(r){return i(this,void 0,Promise,(function(){var n,i,u,p;return a(this,(function(a){switch(a.label){case 0:return this.qms||!r.qmsId?[3,2]:(n=this,[4,c(e+"/api/v1/geoservices/"+r.qmsId)]);case 1:n.qms=a.sent(),a.label=2;case 2:return(i=this.qms)&&(u=s[i.type||"tms"],(p=t.mapAdapter.layerAdapters[u])&&"TILE"===u)?(r=o(o({maxZoom:t.options.maxZoom,minZoom:t.options.minZoom},this.options),function(t){var e=("https:"===location.protocol?"https":"http")+"://";return{url:t.url.replace(/^(https?|ftp):\/\//,e),name:t.name,attribution:t.copyright_text,maxZoom:t.z_max,minZoom:t.z_min}}(i)),this.options=r,[2,new p(this.map,r).addLayer(r)]):[2]}}))}))},r}()}r.d(e,"a",(function(){return l}));var p=function(){return(p=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},l=function(){function t(t){this.options={url:"https://qms.nextgis.com"},this.options=p(p({},this.options),t),this.url=this.options.url}return t.prototype.getLayerAdapters=function(){var t=this;return Promise.resolve([{name:"QMS",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}])},t.prototype._createAdapter=function(t){return u(t,this.url)},t.utils={createQmsAdapter:u},t}()},203:function(t,e){},204:function(t,e){},205:function(t,e){},206:function(t,e){},207:function(t,e){},208:function(t,e){},209:function(t,e){},21:function(t,e,r){"use strict";var n=r(143),o=r(210);r.o(o,"AddNgwLayerOptions")&&r.d(e,"AddNgwLayerOptions",(function(){return o.AddNgwLayerOptions}));r(54),r(106);e.default=n.a},210:function(t,e){},211:function(t,e,r){"use strict";r(21)},212:function(t,e){},215:function(t,e,r){"use strict";var n=r(141);r(209),r(109),r(108),r(107);e.default=n.a},216:function(t,e,r){"use strict";var n=r(139);r(212);e.default=n.a},220:function(t,e,r){"use strict";var n=r(7),o=r.n(n),i=r(32);function a(t,e,r){var n=new XMLHttpRequest;for(var o in n.open("GET",t),n.responseType="arraybuffer",r)n.setRequestHeader(o,r[o]);n.onload=function(){var t=new Uint8Array(this.response),r=new Blob([t],{type:"image/png"}),n=(window.URL||window.webkitURL).createObjectURL(r);e(n)},n.send()}var s,c=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(e,r){return t.call(this,e,r)||this}return c(e,t),e.prototype._removeTile=function(e){t.prototype._removeTile.call(this,e)},e.prototype.createTile=function(t,e){var r=this.getTileUrl(t),n=document.createElement("img");return a(r,(function(t){n.src=t,e(null,n)}),this.options.headers),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n},e}(n.TileLayer),p=function(){function t(t,e){if(this.map=t,this.options=e,this.pane="order-0",void 0!==e.order){var r="order-"+e.order,n=t.getPane(r);n||(n=t.createPane(r)),n.style.zIndex=String(100*e.order),this.pane=r}}return t.prototype.addLayer=function(t){},t}(),l=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),f=function(){return(f=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},h=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.addLayer=function(t){if(t){var e=t.url,r=h(t,["url"]);if(e){var o={pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom};return r.headers?new u(e,f(f({},o),{headers:r.headers})):new n.TileLayer(e,o)}}},e}(p),d={Point:"circle",LineString:"line",MultiPoint:"circle",Polygon:"fill",MultiLineString:"line",MultiPolygon:"fill",GeometryCollection:"fill"},v={stroke:!1,opacity:1},m={};for(var b in d){var g=d[b],_=m[g]||[];_.push(b),m[g]=_}function w(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=1+(e[t[r]]||0);var n="";for(var o in e){var i=n?e[n]:0;e[o]>i&&(n=o)}return n}function O(t,e){return-1!==(m[e]||[]).indexOf(t)}function P(t){var e=t.containerPoint;return{latLng:t.latlng,pixel:{left:e.x,top:e.y},source:t}}var L=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),I=function(){return(I=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},x=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},k=function(t){function e(e,r){var o=t.call(this,e,r)||this;return o.selected=!1,o._layers=[],o._selectedLayers=[],o._filteredLayers=[],o.layer=new n.FeatureGroup([],{pane:o.pane}),o}return L(e,t),e.prototype.addLayer=function(t){if(t)return this.options=t,this.paint=t.paint,this.selectedPaint=t.selectedPaint,t.paint=this.paint,t.data&&this.addData(t.data),this.layer},e.prototype.select=function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._selectLayer(t.layer)})):this.selected||(this.selected=!0,this.selectedPaint&&this.setPaintEachLayer(this.selectedPaint))},e.prototype.unselect=function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._unSelectLayer(t.layer)})):this.selected&&(this.selected=!1,this.paint&&this.setPaintEachLayer(this.paint))},e.prototype.getSelected=function(){return this._selectedLayers.map((function(t){return{feature:t.feature,layer:t}}))},e.prototype.getFiltered=function(){return this._filteredLayers},e.prototype.filter=function(t){var e=this;this._filterFun=t;var r=this.layer._map;r&&this.layer.remove();var n=[];return this._layers.forEach((function(r){var o=r.feature,i=r.layer;i&&(!t||t({feature:o,layer:i})?(e.layer.addLayer(i),n.push({feature:o,layer:i})):e.layer.removeLayer(i))})),this._filteredLayers=n,r&&this.layer.addTo(r),this._filteredLayers},e.prototype.cleanFilter=function(){this.filter()},e.prototype.getLayers=function(){return this._layers.map((function(t){var e=t.layer;return{feature:t.feature,layer:e,visible:e&&e._map}}))},e.prototype.clearLayer=function(t){if(t)for(var e=this._layers.length;e--;){var r=this._layers[e];r.feature&&t(r.feature)&&(this.layer.removeLayer(r.layer),this._layers.splice(e,1))}else this.layer.clearLayers(),this._layers=[]},e.prototype.setData=function(t){this.clearLayer(),this.addData(t)},e.prototype.addData=function(t){var e,r=this.options;if(r){if(t){var o=void 0;if(r.type)o=r.type;else{var i=function(t){var e;if("FeatureCollection"===t.type)e=w(t.features.map((function(t){return t.geometry.type})));else if("GeometryCollection"===t.type){e=w(t.geometries.map((function(t){return t.type})))}else e="Feature"===t.type?t.geometry.type:t.type;return e}(t);o=d[i]}if(this.type&&this.type!==o)return console.warn("no other data type than layer can be added"),!1;this.type=o,(t=function(t,e){if("FeatureCollection"===t.type)t.features=t.features.filter((function(t){return O(t.geometry.type,e)}));else if("Feature"===t.type){if(!O(t.geometry.type,e))return!1}else"GeometryCollection"===t.type&&(t.geometries=t.geometries.filter((function(t){return O(t.type,e)})));return t}(t,o))&&(e=this.getGeoJsonOptions(r,o))}new n.GeoJSON(t||void 0,e)}},e.prototype.openPopup=function(t,e){var r=this;t&&this._layers.filter(t).forEach((function(t){r._openPopup(t.layer,e)}))},e.prototype.closePopup=function(t){var e=this;(t?this._layers.filter(t):this._layers).forEach((function(t){e._closePopup(t.layer)}))},e.prototype.updateTooltip=function(t){var e=this;t?this._updateTooltip(t):this.getLayers().forEach((function(t){return e._updateTooltip(t)}))},e.prototype._updateTooltip=function(t){var e=t.feature,r=t.layer;if(this.options.labelField&&e&&e.properties){r.unbindTooltip();var n=e.properties[this.options.labelField];void 0!==n&&r.bindTooltip(String(n),{permanent:!0}).openTooltip()}},e.prototype._openPopup=function(t,e){var r=t.feature,n=I({minWidth:300},e=e||{}),o=n.minWidth,i=n.autoPan,a=e&&e.createPopupContent?e.createPopupContent({layer:t,feature:r}):"";if(a){var s=t.bindPopup(a,{minWidth:o,autoPan:i});setTimeout((function(){s.openPopup()}),0)}},e.prototype._closePopup=function(t){t.closePopup().unbindPopup()},e.prototype.setPaintEachLayer=function(t){var e=this;this.layer.eachLayer((function(r){e.setPaint(r,t)}))},e.prototype.setPaint=function(t,e){var r;if(r="function"==typeof e?e(t.feature):e,"circle"===this.type&&"icon"===r.type){var n=t,o=this.createDivIcon(r);n.setIcon(o)}else"setStyle"in t&&t.setStyle(this.preparePaint(r))},e.prototype.preparePaint=function(t){if("get-paint"!==t.type){var e="line"===this.type?[["color","strokeColor"],["opacity","strokeOpacity"],["weight","weight"]]:[["color","strokeColor"],["opacity","strokeOpacity"],["stroke","stroke"],["fillColor","fillColor"],["fillOpacity","fillOpacity"],["fill","fill"],["weight","weight"]],r={};return"radius"in t&&(r.radius=t.radius),e.forEach((function(e){var n=e[0],o=e[1],i=t[o];void 0!==i&&Object.defineProperty(r,n,{enumerable:!0,value:i})})),r}return v},e.prototype.getGeoJsonOptions=function(t,e){var r=this,n=t.paint,o={};return(o="function"==typeof n?"circle"===e?{pointToLayer:function(t,e){var o=n(t);return r.createPaintToLayer(o)(t,e)}}:{style:function(t){return t?r.preparePaint(I(I({},v),n(t))):r.preparePaint(I(I({},v),{type:"path"}))}}:this.createPaintOptions(n,e)).onEachFeature=function(e,n){n.options.pane=r.pane,r._layers.push({feature:e,layer:n});var o=!0;r._filterFun&&(o=r._filterFun({feature:e,layer:n})),o&&(n.options.interactive=r.options.selectable||r.options.interactive,r.layer.addLayer(n),t.selectable&&(t.selectOnHover?(n.on("mouseover",(function(){r._selectLayer(n)})),n.on("mouseout",(function(){r._unSelectLayer(n)}))):n.on("click",(function(t){return r._onLayerClick(t)}),r)),r.options.popup&&r._openPopup(n,r.options.popupOptions),r._updateTooltip({layer:n,feature:e}))},o},e.prototype._onLayerClick=function(t){n.DomEvent.stopPropagation(t);var e=t.target,r=-1!==this._selectedLayers.indexOf(e);r?this.options&&this.options.unselectOnSecondClick&&(this._unSelectLayer(e),r=!1):(this._selectLayer(e),r=!0),this.options.onLayerClick&&this.options.onLayerClick({layer:this,feature:e.feature,selected:r,event:P(t),source:t})},e.prototype._selectLayer=function(t){var e=this;this.options&&!this.options.multiselect&&this._selectedLayers.forEach((function(t){return e._unSelectLayer(t)})),this._selectedLayers.push(t),this.selected=!0,this.options&&(this.options.selectedPaint&&this.setPaint(t,this.options.selectedPaint),this.options.popupOnSelect&&this._openPopup(t,this.options.popupOptions))},e.prototype._unSelectLayer=function(t){var e=this._selectedLayers.indexOf(t);-1!==e&&this._selectedLayers.splice(e,1),this.selected=this._selectedLayers.length>0,this.options&&(this.options.paint&&this.setPaint(t,this.options.paint),this.options.popupOnSelect&&this._closePopup(t))},e.prototype.createDivIcon=function(t){var e=x(t,[]);return new n.DivIcon(I({className:""},e))},e.prototype.createPaintToLayer=function(t){var e=this;if("icon"===t.type){var r=t.className,o=t.html;if(r||o)return function(r,o){var i=e.createDivIcon(t);return new n.Marker(o,{icon:i})}}return function(r,o){var i=v;return new n.CircleMarker(o,e.preparePaint(I(I({},i),t)))}},e.prototype.createPaintOptions=function(t,e){var r={},n=t&&this.preparePaint(t)||{};return t&&(r.style=function(){return n}),"circle"===e?r.pointToLayer=this.createPaintToLayer(t):"line"===e&&(n.stroke=!0),r},e}(p),E=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),C=function(t){function e(e){var r=t.call(this,e)||this,n=e&&e.customAttribution;if(n){var o=[];Array.isArray(n)?o=n:n&&(o=[n]),o.forEach((function(t){return r.addAttribution(t)}))}return r}return E(e,t),e}(n.Control.Attribution),j=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),S=function(t){function e(e,r,n){return t.call(this,e,r,n)||this}return j(e,t),e.prototype._initImage=function(){t.prototype._initImage.call(this);var e=this.options.headers;if(e){var r=this._image,n=r.src;r.src="",a(n,(function(t){r.src=t}),e)}},e}(o.a.ImageOverlay),T=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),A=function(t){function e(e,r){var n=t.call(this,r)||this;n.defaultWmsParams={service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},n.options={crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18,pane:"tilePane",headers:null,viewPortBuffer:0},n._url=e;var i={},a={};for(var s in r)s in n.options?a[s]=r[s]:i[s]=r[s];return o.a.Util.setOptions(n,a),n.wmsParams=o.a.Util.extend({},n.defaultWmsParams,i),n}return T(e,t),e.prototype.setParams=function(t){o.a.Util.extend(this.wmsParams,t),this.update()},e.prototype.getAttribution=function(){return this.options.attribution||""},e.prototype.onAdd=function(){return this.update(),this},e.prototype.onRemove=function(t){return this._currentOverlay&&(t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl,this},e.prototype.getEvents=function(){return{moveend:this.update}},e.prototype.update=function(){var t=this;if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!==e){this._currentUrl=e;var r=this.options.viewPortBuffer||0,n=this._map.getBounds().pad(r),o=new S(e,n,{opacity:0,pane:this.options.pane,headers:this.options.headers});o.addTo(this._map),o.once("load",(function(){t._map&&(o._url===t._currentUrl?(t._currentOverlay&&t._map.removeLayer(t._currentOverlay),t._currentOverlay=o,o.setOpacity(void 0!==t.options.opacity?t.options.opacity:1),!0===t.options.isBack&&o.bringToBack(),!1===t.options.isBack&&o.bringToFront(),void 0!==t.options.zIndex&&o.setZIndex(t.options.zIndex)):t._map.removeLayer(o))}),this);var i=this.options,a=i.minZoom,s=i.maxZoom;(a&&this._map.getZoom()<a||s&&this._map.getZoom()>s)&&this._map.removeLayer(o)}}},e.prototype.setOpacity=function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)},e.prototype.bringToBack=function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()},e.prototype.bringToFront=function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()},e.prototype.setZIndex=function(t){this.options.zIndex=t,this._currentOverlay&&this._currentOverlay.setZIndex(t)},e.prototype.updateWmsParams=function(t){t||(t=this._map);var e=this.options.viewPortBuffer||0,r=t.getBounds().pad(e),n=t.getSize();if(0!==this.options.viewPortBuffer){var i=e+1;n.x=Math.ceil(n.x*i),n.y=Math.ceil(n.y*i)}var a=parseFloat(this.wmsParams.version),s=this.options.crs||t.options.crs,c=a>=1.3?"crs":"srs";if(s){var u=s.project(r.getNorthWest()),p=s.project(r.getSouthEast()),l={width:n.x,height:n.y};l[c]=s.code,l.bbox=(a>=1.3&&s===o.a.CRS.EPSG4326?[p.y,u.x,u.y,p.x]:[u.x,p.y,p.x,u.y]).join(","),o.a.Util.extend(this.wmsParams,l)}},e.prototype.getImageUrl=function(){var t=this.options.uppercase||!1,e=o.a.Util.getParamString(this.wmsParams,this._url,t);return this._url+e},e}(o.a.Layer),M=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),N=function(){return(N=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.addLayer=function(t){var e=t&&t.url;if(e){var r=(t=N({transparent:!0},t)).updateWmsParams;if(this.layer=new A(e,N({pane:this.pane,headers:t.headers},t)),r){var n=this.layer.updateWmsParams;this.layer.updateWmsParams=function(t){n.call(this,t),this.wmsParams=r(this.wmsParams)}}return this.layer}},e}(p);function R(t,e){return void 0===e&&(e={}),new(n.Control.extend({onAdd:function(){var r=document.createElement("div"),o=t.onAdd();return r.classList.add("leaflet-control"),e.bar&&r.classList.add("leaflet-bar"),e.margin||e.bar||(r.style.marginBottom="0px",r.style.marginTop="0px",r.style.marginLeft="0px",r.style.marginRight="0px"),r.appendChild(o),n.DomEvent.disableClickPropagation(r),r},onRemove:function(){t.onRemove()}}))}var U=function(){return(U=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},G=function(){function t(){this.options={target:"map"},this.layerAdapters=t.layerAdapters,this.controlAdapters=t.controlAdapters,this.emitter=new i.EventEmitter,this._universalEvents=["zoomstart","zoom","zoomend","movestart","move","moveend"]}return t.prototype.create=function(t){if(this.options=U({},t),this.options.target){var e=this.options,r=e.maxZoom,o=e.minZoom,i=e.zoom;this.map=new n.Map(this.options.target,{zoomControl:!1,attributionControl:!1,maxZoom:r,minZoom:o,zoom:i}),this.emitter.emit("create",this),this.map.createPane("order-0").style.zIndex=String(0),this._addMapListeners()}},t.prototype.destroy=function(){this.map&&this.map.remove()},t.prototype.getContainer=function(){return this.map&&this.map.getContainer()},t.prototype.setCursor=function(t){this.map&&(this.map.getContainer().style.cursor=t)},t.prototype.setView=function(t,e){var r=t[0],n=t[1];this.map&&(e?this.map.setView([n,r],e,{animate:!1}):this.setCenter([r,n]))},t.prototype.setCenter=function(t){var e=t[0],r=t[1];this.map&&this.map.panTo([r,e])},t.prototype.getCenter=function(){var t=this.map;if(t){var e=t.getBounds().getCenter();return[e.lng,e.lat]}},t.prototype.setZoom=function(t){this.map&&this.map.setZoom(t)},t.prototype.getZoom=function(){return this.map&&this.map.getZoom()||void 0},t.prototype.getBounds=function(){if(this.map){var t=this.map.getBounds(),e=t.getSouthWest(),r=t.getNorthEast();return[e.lng,e.lat,r.lng,r.lat]}},t.prototype.fit=function(t){this.map&&this.map.fitBounds([[t[3],t[0]],[t[1],t[2]]])},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype.createControl=function(t,e){return R(t,e)},t.prototype.createButtonControl=function(t){return function(t){var e=document.createElement("a"),r=t.title||"";e.href="#",e.title=r,e.setAttribute("role","button"),e.setAttribute("aria-label",r),n.DomEvent.disableClickPropagation(e),n.DomEvent.on(e,"click",n.DomEvent.stop),t.html instanceof HTMLElement?e.appendChild(t.html):"string"==typeof t.html&&(e.innerHTML=t.html);var o=function(e){e.stopPropagation(),t.onClick()};return void 0!==t.onClick&&e.addEventListener("click",o),R({onAdd:function(){return e},onRemove:function(){var r=e.parentNode;r&&r.removeChild(e),void 0!==t.onClick&&e.removeEventListener("click",o)}},{bar:!0})}(t)},t.prototype.addControl=function(t,e){if(t.options.position=e.replace("-",""),this.map)return this.map.addControl(t),t},t.prototype.removeControl=function(t){this.map&&this.map.removeControl(t)},t.prototype.removeLayer=function(t){t.remove()},t.prototype.showLayer=function(t){this.map&&t.addTo(this.map)},t.prototype.hideLayer=function(t){t.remove()},t.prototype.setLayerOpacity=function(t,e){t.setOpacity&&t.setOpacity(e)},t.prototype.setLayerOrder=function(t,e,r){},t.prototype.onMapClick=function(t){this.emitter.emit("click",P(t))},t.prototype.locate=function(t,e){var r=this.map;if(r&&(r.locate(t),e)){var n=e.locationfound,o=e.locationerror,i=function(t){var e=t,r=[e.latlng.lng,e.latlng.lat];n({lngLat:r})};void 0!==n&&r.on("locationfound",i,this),o&&r.on("locationerror",o,this);return{stop:function(){void 0!==n&&r.off("locationfound",i),o&&r.off("locationerror",o)}}}return{stop:function(){}}},t.prototype._addMapListeners=function(){var t=this,e=this.map;e&&(e.on("click",(function(e){t.onMapClick(e)})),this._universalEvents.forEach((function(r){e.on(r,(function(){return t.emitter.emit(r,t)}),e)})))},t.layerAdapters={IMAGE:B,TILE:y,GEOJSON:k},t.controlAdapters={ZOOM:n.Control.Zoom,ATTRIBUTION:C},t.Map=o.a,t}();e.a=G},221:function(t,e,r){"use strict";r(23);var n=r(217),o=(r(583),r(584),function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)}),i='\n  <a href="#">\n    <svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n      <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z">\n      </path>\n      <path d="M0 0h24v24H0z" fill="none"></path>\n    </svg>\n  </a>\n',a=function(){function t(e){this.options={template:"\n      <p>This is dialog!</p>\n    ",closeBtn:!0,closeBtnTemplate:i},this._dialog=document.createElement("dialog"),t.dialogs.push(this),this._dialog.className="dialog-component",this.options=o(o({},this.options),e),this._parent=this.options.parent||document.body,this._isNativeDialog=!!this._dialog.showModal,this._isNativeDialog||(n.a.registerDialog(this._dialog),this._dialog.classList.add("polyfilled")),this.options.closeBtn&&(this._closeBtn=this._createCloseBtn()),this._content=document.createElement("div"),this._dialog.appendChild(this._content),this.updateContent(),this._parent&&this._parent.appendChild(this._dialog),this._addEventsListeners()}return t.prototype.getContainer=function(){return this._dialog},t.prototype.show=function(){this._dialog.showModal()},t.prototype.close=function(){this._dialog.close()},t.prototype.destroy=function(){this.close(),this._dialog.remove()},t.prototype.updateContent=function(t){!t&&this.options.template&&(t=this.options.template),t&&this._addContent(t,this._content)},t.prototype._createCloseBtn=function(){var t=this,e=this.options.closeBtnTemplate;if(e){var r=document.createElement("div");return r.className="dialog-component__close",this._dialog.appendChild(r),this._addContent(e,r),r.addEventListener("click",(function(e){e.stopPropagation(),t.close()})),r}},t.prototype._addContent=function(t,e){"string"==typeof t?e.innerHTML=t:t instanceof HTMLElement&&(e.innerHTML="",e.appendChild(t))},t.prototype._addEventsListeners=function(){var t=this;this._closeBtn&&this._closeBtn.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.close()})),this.options.openers&&[].forEach.call(this.options.openers,(function(e){e.onclick=function(e){e.preventDefault(),t.show()}})),this._dialog.addEventListener("close",(function(){})),this._dialog.addEventListener("cancel",(function(){}))},t.dialogs=[],t.clean=function(){t.dialogs.forEach((function(t){return t.destroy()}))},t}();e.a=a},26:function(t,e,r){"use strict";var n,o=r(112),i=r(23),a=r(41),s=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),c=function(){return(c=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},u=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},p=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function l(t,e,r){return u(this,void 0,void 0,(function(){var n,o,l,f,h,y=this;return p(this,(function(d){return n=e.mapAdapter.layerAdapters.GEOJSON,!1,l=function(e,n){return u(y,void 0,void 0,(function(){return p(this,(function(i){switch(i.label){case 0:return[4,o=Object(a.c)(c({resourceId:t.resourceId,filters:e,connector:r},n))];case 1:return[2,i.sent()]}}))}))},f=function(){o&&(o.cancel(),o=void 0)},h=function(e){var r={data:e};return t.id&&(r.id=t.id),i.default.utils.updateGeoJsonAdapterOptions(r)},[2,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.addLayer=function(e){return u(this,void 0,void 0,(function(){var r,n,o;return p(this,(function(i){switch(i.label){case 0:return r={},e.data?[3,2]:[4,l(e.propertiesFilter,{limit:e.limit})];case 1:r=i.sent(),i.label=2;case 2:return n=h(r),(o=c(c({},e),n)).data&&0===Object.keys(o.data).length&&(o.data=void 0),[2,t.prototype.addLayer.call(this,o)]}}))}))},e.prototype.beforeRemove=function(){f()},e.prototype.propertiesFilter=function(t,e){return u(this,void 0,void 0,(function(){var r;return p(this,(function(n){switch(n.label){case 0:return f(),this.filter,[3,1];case 1:return this.setData?(this.clearLayer&&this.clearLayer(),[4,l(t,e)]):[3,3];case 2:r=n.sent(),this.setData(r),n.label=3;case 3:return[2]}}))}))},e.prototype.removeFilter=function(){this.propertiesFilter([]),this.filter&&this.filter((function(){return!0}))},e}(n)]}))}))}var f=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),h=function(){return(h=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},y=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},d=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function v(t,e,r){return y(this,void 0,Promise,(function(){var n,o;return d(this,(function(i){if("IMAGE"===(n=t.adapter||"IMAGE")&&(o=e.getLayerAdapters(),!o||o.IMAGE||(n="TILE")),"IMAGE"===n||"TILE"===n||"MVT"===n)return[2,function(n){function o(o,i){var a=n.call(this,o,i)||this;a.map=o,a.resourceId=t.resourceId;var s=N(t,e,r);if(s)if(s.resourceId){var c=h(h({},s),{resourceId:s.resourceId});a.options=h(h({},a.options),c)}else{var u=s;a.options=h(h({},a.options),u)}return a}return f(o,n),o.prototype.addLayer=function(t){return n.prototype.addLayer.call(this,h(h({},this.options),t))},o.prototype.getIdentificationIds=function(){return y(this,void 0,void 0,(function(){var t;return d(this,(function(e){return(t=this.item&&this.item.resource.parent.id)?[2,[t]]:[2]}))}))},o}(e.mapAdapter.layerAdapters[n])];throw new Error(n+" not supported yet. Only TILE")}))}))}var m=r(54),b=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),g=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},_=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var w=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},O=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},P=function(){function t(){}return t.prototype.getExtent=function(){return w(this,void 0,Promise,(function(){var t;return O(this,(function(e){switch(e.label){case 0:return this._extent?[2,this._extent]:this.item?(t=this,[4,G(this.item,this.connector).then()]):[3,2];case 1:return t._extent=e.sent(),[2,this._extent];case 2:return[2]}}))}))},t}(),L=function(){return(L=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},I=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},x=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},k=["mapserver_style","qgis_vector_style","raster_style"];function E(t,e,r,n,o){return I(this,void 0,void 0,(function(){var i,a;return x(this,(function(s){switch(s.label){case 0:return[4,o.get("resource.collection",null,{parent:t})];case 1:return i=s.sent(),(a=i&&i[0])?[2,C(L(L({},e),{resourceId:a.resource.id}),r,n,o)]:[2]}}))}))}function C(t,e,r,n){return I(this,void 0,Promise,(function(){var i,a,s,c,u,p,f;return x(this,(function(h){switch(h.label){case 0:return h.trys.push([0,5,,6]),s=t.adapter,(c=t.resourceId)||!t.keyname?[3,2]:[4,n.getResourceByKeyname(t.keyname)];case 1:u=h.sent(),c=u.resource.id,h.label=2;case 2:return c?[4,n.get("resource.item",null,{id:c})]:[3,4];case 3:if(!(a=h.sent()))throw new Error("Can't add NGW layer because Resource item is not found");if(p=L(L({},t),{resourceId:c}),a.webmap)i=function(t,e,r,n){return g(this,void 0,Promise,(function(){return _(this,(function(o){return[2,function(o){function i(i){return o.call(this,i,{webMap:e,resourceId:t.resourceId,baseUrl:r,connector:n})||this}return b(i,o),i}(m.a)]}))}))}(p,e,r,n);else if(-1!==k.indexOf(a.resource.cls))"GEOJSON"===s?(f=L(L({},t),{resourceId:a.resource.parent.id}),i=l(f,e,n)):i=v(p,e,r);else if("vector_layer"===a.resource.cls)if(void 0!==s&&"GEOJSON"!==s){if("MVT"!==s)return[2,E(a.resource.id,p,e,r,n)];i=v(p,e,r)}else i=l(p,e,n);else{if("raster_layer"===a.resource.cls)return[2,E(a.resource.id,p,e,r,n)];a.basemap_layer&&a.basemap_layer.qms&&(i=Promise.resolve(o.default.utils.createQmsAdapter(e))).then((function(t){if(t&&a&&a.basemap_layer&&a.basemap_layer.qms){var e=JSON.parse(a.basemap_layer.qms);t.prototype.qms=e,t.prototype.baseLayer=!0}}))}h.label=4;case 4:return[3,6];case 5:return h.sent(),[3,6];case 6:return i?[2,i.then((function(t){if(t){var e=t;return e.prototype.item=a,e.prototype.connector=n,H(e,[P]),e}}))]:[2]}}))}))}r.d(e,"j",(function(){return M})),r.d(e,"d",(function(){return N})),r.d(e,"a",(function(){return B})),r.d(e,"f",(function(){return R})),r.d(e,"e",(function(){return G})),r.d(e,"h",(function(){return Z})),r.d(e,"c",(function(){return W})),r.d(e,"g",(function(){return Q})),r.d(e,"b",(function(){return H})),r.d(e,"i",(function(){return J}));var j=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),S=function(){return(S=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},T=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},A=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function M(t,e){return{resource:e,extent:t.bbox,size:t.width+","+t.height,timestamp:Date.now()}}function N(t,e,r){var n=t.adapter||"IMAGE",o=e.getLayerAdapters(),i=!o||o.IMAGE;if("IMAGE"===n){if(i)return{url:r+"/api/component/render/image",resourceId:t.resourceId,headers:t.headers,updateWmsParams:function(e){return M(e,t.resourceId)}};n="TILE"}return"MVT"===n?{url:r+"/api/component/feature_layer/mvt?x={x}&y={y}&z={z}&resource="+t.resourceId+"&simplification="+(t.simplification||0)}:"TILE"===n?{url:r+"/api/component/render/tile?z={z}&x={x}&y={y}&resource="+t.resourceId,adapter:n}:void 0}function B(t,e,r,n){var o=n.getAuthorizationHeaders();return o&&(t.headers=o),C(t,e,r,n)}function R(t){var e=t.extent_bottom,r=t.extent_left,n=t.extent_top,o=t.extent_right;if(e&&r&&n&&o){var i=[r,e,o,n];return i[3]>82&&(i[3]=82),i[1]<-82&&(i[1]=-82),i}}function U(t,e){return e.get("layer.extent",name,{id:t}).then((function(t){if(t){var e=t.extent,r=e.maxLat,n=e.maxLon,o=e.minLat;return[e.minLon,o,n,r]}}))}function G(t,e){return T(this,void 0,Promise,(function(){var r;return A(this,(function(n){return t.webmap?[2,R(t.webmap)]:-1!==(r=t.resource).cls.indexOf("style")?[2,e.get("resource.item",null,{id:r.parent.id}).then((function(t){return U(t.resource.id,e)}))]:[2,U(r.id,e)]}))}))}var F,D=Math.PI/180,z=180/Math.PI,q=3963;function Z(t,e){var r=function(t,e,r,n){void 0===r&&(r=10),void 0===n&&(n=6);for(var o=r/q*z,i=o/Math.cos(e*D),a=[],s=0;s<n+1;s++){var c=Math.PI*(s/(n/2)),u=t+i*Math.cos(c),p=e+o*Math.sin(c);a.push([u,p])}return a}(t.latLng.lng,t.latLng.lat,e.radius),n=[];r.forEach((function(t){var e=function(t,e){var r=20037508.34*t/180,n=Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180);return[r,n=20037508.34*n/180]}(t[0],t[1]),r=e[0],o=e[1];n.push(r+" "+o)}));var o={geom:"POLYGON(("+n.join(", ")+"))",srs:3857,layers:e.layers};return e.connector.post("feature_layer.identify",{data:o})}function W(t){return function(e){function r(r,n){return n=S(S({},t),n),e.call(this,r,n)||this}return j(r,e),r}(m.a)}function Q(){if(void 0===F){var t=document.createElement("div");t.style.cssText="position: absolute;  left: -100%;  top: -100%;  width: 100cm;",document.body.appendChild(t);var e=t.offsetWidth;document.body.removeChild(t),F=e}return F}function H(t,e){e.forEach((function(e){Object.getOwnPropertyNames(e.prototype).forEach((function(r){var n=Object.getOwnPropertyDescriptor(e.prototype,r);n&&Object.defineProperty(t.prototype,r,n)}))}))}function J(t,e){if(void 0===e&&(e=104),e){var r=e;return function(t){return Math.log(t/256)/Math.LN2}(Q()*function(t){return 12756274*Math.PI*Math.cos(t*Math.PI/180)}(r)/t)}return Math.round(Math.log(591657550.5/(t/2))/Math.log(2))}},29:function(t,e,r){"use strict";var n={};function o(t,e,r){var n=window.document.createElement(t);return void 0!==e&&(n.className=e),r&&r.appendChild(n),n}r.r(n),r.d(n,"create",(function(){return o}));var i=function(){function t(t){t&&this.copy(t)}return t.prototype.copy=function(t){try{navigator.clipboard?navigator.clipboard.writeText(t):window.clipboardData?window.clipboardData.setData("text",t):this.copyToClipboard(t),console.log("Copied to Clipboard")}catch(t){console.log("Please copy coupon manually")}},t.prototype.copyToClipboard=function(t){var e=document.createElement("input");e.value=t;try{document.body.appendChild(e),this.copyNodeContentsToClipboard(e)}finally{document.body.removeChild(e)}},t.prototype.copyNodeContentsToClipboard=function(t){t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")},t.copy=function(e){return new t(e)},t}();r.d(e,"c",(function(){return a})),r.d(e,"b",(function(){return s})),r.d(e,"a",(function(){return i}));function a(t){return t.replace(/([^:]\/)\/+/g,"$1")}function s(t,e,r){void 0===r&&(r=!1);var n=Array.isArray(e),o=n&&[]||{};return n?r?(t=t||[],o=o.concat(t),e.forEach((function(e,n){void 0===o[n]?o[n]=e:"object"==typeof e?o[n]=s(t[n],e,r):-1===t.indexOf(e)&&o.push(e)}))):o=e:(t&&"object"==typeof t&&Object.keys(t).forEach((function(e){o[e]=t[e]})),Object.keys(e).forEach((function(n){"object"==typeof e[n]&&e[n]&&"object"==typeof t[n]&&"object"==typeof e[n]?o[n]=s(t[n],e[n],r):o[n]=e[n]}))),o}},33:function(t,e,r){"use strict";var n=r(142),o=r(51);r.d(e,"CancelablePromise",(function(){return o.a}));r(203),r(204),r(205),r(206),r(207);e.default=n.a},41:function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"d",(function(){return s})),r.d(e,"b",(function(){return c})),r.d(e,"e",(function(){return u})),r.d(e,"c",(function(){return p}));var n=r(33),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i={srs:4326,geom_format:"geojson"};function a(t){var e=t.geom;return{id:t.id,type:"Feature",properties:t.fields,geometry:e}}function s(t){var e=o({},i);return t.connector.get("feature_layer.feature.item",null,o({id:t.resourceId,fid:t.featureId},e))}function c(t){return s(t).then((function(t){return a(t)}))}function u(t){var e=o({},i),r=t.connector,a=t.filters,c=t.limit,u=t.intersects,p=t.resourceId;if(a){var l=a.find((function(t){return"id"===t[0]}));if(l)return function(t){var e=t.filterById[2],r="number"==typeof e?[e]:e.split(",").map((function(t){return Number(t)}));if("eq"!==t.filterById[1]&&"in"!==t.filterById[1])throw new Error("Unable to filter by object id. Except `eq` or `in` operator");var o=r.map((function(e){return s({connector:t.connector,resourceId:t.resourceId,featureId:e})}));return n.CancelablePromise.all(o)}({filterById:l,connector:r,resourceId:p});a.forEach((function(t){var r=t[0],n=t[1],o=t[2];e["fld_"+r+"__"+n]=""+o}))}return c&&(e.limit=c),u&&(e.intersects=u),r.get("feature_layer.feature.collection",null,o({id:p},e))}function p(t){return u(t).then((function(t){var e=[];return t.forEach((function(t){e.push(a(t))})),{type:"FeatureCollection",features:e}}))}},51:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=function(t,e,r,n){try{t(r(n))}catch(t){e(t)}},o=function(){function t(t,e){this.onCancel=e,this._canceled=!1,this._promise=new Promise(t)}return t.resolve=function(e){return new t((function(t){return t(e)}))},t.reject=function(e){return new t((function(t,r){return r(e)}))},t.all=function(e){return new t((function(t,r){Promise.all(e).then(t).catch(r)}))},t.prototype.then=function(e,r){var o=this,i=new t((function(t,a){o._promise&&o._promise.then((function(r){o._canceled&&i.cancel(),e&&!o._canceled?n(t,a,e,r):t(r)}),(function(e){o._canceled&&i.cancel(),r&&!o._canceled?n(t,a,r,e):a(e)}))}),(function(){o.cancel()}));return i},t.prototype.catch=function(t){return this.then(void 0,t)},t.prototype.cancel=function(t){return this._canceled=!0,t&&this._promise&&this._promise.catch(t),this.onCancel&&this.onCancel(),this._destroy(),this},t.prototype.finally=function(t){return this._promise?this._promise.finally(t):Promise.reject(t)},t.prototype._destroy=function(){this.onCancel=void 0,this._promise=void 0},t}()},54:function(t,e,r){"use strict";r.d(e,"a",(function(){return p}));var n=r(29),o=r(26),i=r(106),a=r(32),s=function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function s(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}c((n=n.apply(t,e||[])).next())}))},u=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(){function t(t,e){this.map=t,this.options=e,this.pixelRadius=10,this.emitter=new a.EventEmitter;var r=e.resourceId;if(Array.isArray(r)?(this.resourceId=r[0],this.options.id=r[1]):this.resourceId=r,!this.resourceId)throw new Error("NGW `resourceId` is not defined")}return t.prototype.addLayer=function(t){return c(this,void 0,Promise,(function(){var e,r,n=this;return u(this,(function(o){switch(o.label){case 0:return this.options=s(s({},this.options),t),e=this,[4,this._getWebMapLayerItem()];case 1:return e.layer=o.sent(),this.options.identification?[4,this._getWebMapIds()]:[3,3];case 2:(r=o.sent())&&(this._webmapLayersIds=r,this.$$onMapClick=function(t){return n._onMapClick(t)},this.options.webMap.emitter.on("click",this.$$onMapClick)),o.label=3;case 3:return[2,this.layer]}}))}))},t.prototype.removeLayer=function(){var t=this.options.webMap.mapAdapter;this.$$onMapClick&&this.options.webMap.emitter.off("click",this.$$onMapClick),this.getDependLayers().forEach((function(e){"layer"in e&&t.removeLayer(e.layer.layer)})),this.$$onMapClick=void 0,delete this.options,delete this.layer,delete this.response,delete this._webmapLayersIds},t.prototype.showLayer=function(){this.layer&&this.layer.properties&&this.layer.properties.property("visibility").set(!0)},t.prototype.hideLayer=function(){this.layer&&this.layer.properties&&this.layer.properties.property("visibility").set(!1)},t.prototype.getExtent=function(){var t=this.response&&this.response.webmap;if(t)return Object(o.f)(t)},t.prototype.getDependLayers=function(){return this.layer&&this.layer.tree.getDescendants()||[]},t.prototype.getIdentificationIds=function(){return c(this,void 0,void 0,(function(){var t,e;return u(this,(function(r){switch(r.label){case 0:return t=[],(e=this._webmapLayersIds)?[3,2]:[4,this._getWebMapIds()];case 1:e=r.sent(),this._webmapLayersIds=e,r.label=2;case 2:return e&&e.length&&this.getDependLayers().sort((function(t,e){return t.id-e.id})).forEach((function(e){var r=e.item,n=r.parentId;if(void 0!==n&&"layer"===r.item_type){var o=e.properties.property("visibility");o.get()&&!o.isBlocked()&&t.push(n)}})),[2,t]}}))}))},t.prototype._getWebMapLayerItem=function(){return c(this,void 0,Promise,(function(){var t,e=this;return u(this,(function(r){switch(r.label){case 0:return this.resourceId?[4,this.getWebMapConfig(this.resourceId)]:[3,2];case 1:if((t=r.sent())&&t.root_item)return[2,new Promise((function(r){var n={};if(e.options.connector&&e.options.connector.options.auth){var o=e.options.connector.getAuthorizationHeaders();o&&(n.headers=o)}n.order=e.options.order;var a=new i.a(e.options.webMap,t.root_item,n);a.emitter.on("init",(function(){return r(a)}))}))];r.label=2;case 2:return[2]}}))}))},t.prototype.getWebMapConfig=function(t){return c(this,void 0,void 0,(function(){var e,r;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.options.connector.get("resource.item",null,{id:t})];case 1:return e=n.sent(),this.response=e,(r=e.webmap)?(this._updateItemsParams(r.root_item,this.options.webMap,e),[2,r]):[3,3];case 2:throw n.sent();case 3:return[2]}}))}))},t.prototype._updateItemsParams=function(t,e,r){var i=this;if(t)if("group"===t.item_type||"root"===t.item_type)t.children&&(t.children=t.children.map((function(t){return i._updateItemsParams(t,e,r)}))),"root"===t.item_type&&(t.display_name=r.resource.display_name);else if("layer"===t.item_type){var a=Object(n.c)(this.options.baseUrl+"/api/component/render/image"),c=t.layer_style_id;t.url=a,t.resourceId=c,t.updateWmsParams=function(t){return Object(o.j)(t,c)},t=s(s({},t),Object(o.d)({adapter:t.layer_adapter.toUpperCase(),resourceId:c},e,this.options.baseUrl))}return t},t.prototype._getWebMapIds=function(){return c(this,void 0,Promise,(function(){var t,e,r,n=this;return u(this,(function(o){switch(o.label){case 0:return(t=this.layer)&&"root"===t.item.item_type?(e=t.tree.getDescendants(),r=[],e.forEach((function(t){var e=t.item;if("layer"===e.item_type){var o=e.layer_style_id,i=n.options.connector.get("resource.item",{},{id:o}).then((function(t){if(t){var r=Number(t.resource.parent.id);return e.parentId=r,r}}));r.push(i)}})),[4,Promise.all(r)]):[3,2];case 1:return[2,o.sent().filter((function(t){return void 0!==t}))];case 2:return[2]}}))}))},t.prototype._sendIdentifyRequest=function(t){var e=this;if(this._webmapLayersIds)return Object(o.h)(t,{layers:this._webmapLayersIds,connector:this.options.connector,radius:this.pixelRadius}).then((function(r){return e.emitter.emit("identify",{ev:t,data:r}),r}))},t.prototype._onMapClick=function(t){this._sendIdentifyRequest(t)},t}()},584:function(t,e,r){},594:function(t){t.exports=JSON.parse('{"mapOptions":{"target":"map","bounds":[45,46,47,49],"baseUrl":"http://clear-horizon.nextgis.com","resources":[{"selectable":true,"resourceId":"1","fit":true}]},"basemaps":[{"qmsId":1135},{"qmsId":487}],"fires":[{"resourceId":103,"id":"MODIS","color":"red"},{"resourceId":105,"id":"VIIRS","color":"orange"}]}')},596:function(t,e,r){t.exports=r(595)}}]);