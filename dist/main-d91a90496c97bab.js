/*! For license information please see main-d91a90496c97bab.js.LICENSE.txt */
"use strict";(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[376],{17285:function(t,e,n){n(47042),n(41539),n(54747),document.addEventListener("DOMContentLoaded",(function(){var t=Array.prototype.slice.call(document.querySelectorAll(".navbar-burger"),0);t.length>0&&t.forEach((function(t){t.addEventListener("click",(function(){var e=t.dataset.target,n=document.getElementById(e);t.classList.toggle("is-active"),n&&n.classList.toggle("is-active")}))}))}))},91194:function(t,e,n){n.d(e,{C:function(){return Ye}}),n(41539),n(54747),n(26833),n(92222),n(21249),n(96649),n(96078),n(82526),n(41817),n(9653),n(69070),n(88674),n(47941),n(57327),n(38880),n(49337),n(33321),n(32165),n(66992),n(78783),n(33948),n(72443),n(39341),n(73706),n(10408),n(30489),n(68304),n(47042),n(91038),n(74916);var r=n(72010),o=n.n(r),i=n(19653),a=n(78907),c=n(35453),u=n(55502),s=n(61521),l=(n(69720),n(15306),n(68956)),f=n.n(l);n(24603),n(39714),n(41637);var p=n(9588);function h(t){var e=t.valueType,n=t.lastHours,r=t.sensorId,o=t.start,i=t.end,a={sensor_id:r};e&&(a.value_type=e),n?a.lasthours=String(n):(o&&(a.start=o.toISOString()),i&&(a.end=i.toISOString()));var c=p.lX;return fetch("".concat(c,"api/v1/measurements?").concat(new URLSearchParams(a).toString()),{method:"GET"}).then((function(t){return t.json()}))}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(){y=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new P(o||[]);return r(a,"_invoke",{value:k(t,n,c)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var f={};function p(){}function h(){}function v(){}var m={};u(m,i,(function(){return this}));var b=Object.getPrototypeOf,g=b&&b(b(E([])));g&&g!==e&&n.call(g,i)&&(m=g);var w=v.prototype=p.prototype=Object.create(m);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function o(r,i,a,c){var u=l(t[r],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==d(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function k(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=j(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function j(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,j(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=l(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return h.prototype=v,r(w,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:h,configurable:!0}),h.displayName=u(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},_(O.prototype),u(O.prototype,a,(function(){return this})),t.AsyncIterator=O,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new O(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=E,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function v(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function m(t){return b.apply(this,arguments)}function b(){var t;return t=y().mark((function t(e){var r,o,i,a,c,u,s;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.feature,i=document.createElement("div"),void 0===(a=null===(r=o.properties)||void 0===r?void 0:r.SID_T)){t.next=24;break}return t.next=6,h({sensorId:a,lastHours:24});case 6:if(!(c=t.sent).length){t.next=21;break}return u=document.createElement("canvas"),c.reverse(),t.next=12,Promise.all([n.e(148),n.e(713),n.e(339),n.e(890),n.e(68),n.e(838),n.e(69),n.e(381),n.e(700)]).then(n.bind(n,86961));case 12:return t.next=14,Promise.all([n.e(148),n.e(713),n.e(85)]).then(n.bind(n,9085));case 14:new(0,t.sent.Chart)(u,{data:{datasets:["P1","P2"].map((function(t){return{type:"line",label:t,data:c.filter((function(e){return e.value_type===t})).map((function(t){return{x:new Date(t.datetime).getTime(),y:t.value}}))}}))},options:{scales:{x:{type:"time",time:{unit:"hour"}}}}}),i.appendChild(u),t.next=24;break;case 21:(s=document.createElement("div")).innerHTML="Данные для приёмника #".concat(a," за последние '24 часа' не найдены"),i.appendChild(s);case 24:return t.abrupt("return",i);case 25:case"end":return t.stop()}}),t)})),b=function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){v(i,r,o,a,c,"next",t)}function c(t){v(i,r,o,a,c,"throw",t)}a(void 0)}))},b.apply(this,arguments)}function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=_(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function _(t,e){if(t){if("string"==typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function k(){k=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new P(o||[]);return r(a,"_invoke",{value:O(t,n,c)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var f={};function p(){}function h(){}function d(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(E([])));m&&m!==e&&n.call(m,i)&&(y=m);var b=d.prototype=p.prototype=Object.create(y);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function _(t,e){function o(r,i,a,c){var u=l(t[r],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==w(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function O(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=j(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function j(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,j(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=l(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function E(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return h.prototype=d,r(b,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:h,configurable:!0}),h.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},g(_.prototype),u(_.prototype,a,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new _(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=E,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function j(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function L(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){j(i,r,o,a,c,"next",t)}function c(t){j(i,r,o,a,c,"throw",t)}a(void 0)}))}}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,E(r.key),r)}}function P(t,e,n){return(e=E(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E(t){var e=function(t,e){if("object"!==w(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===w(e)?e:String(e)}var x=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),P(this,"ngwMap",void 0),P(this,"_resourceItems",{})}var e,n,r,o,i,a;return e=t,n=[{key:"setNgwMap",value:function(t){this.ngwMap=t}},{key:"createSensorPopupContent",value:(a=L(k().mark((function t(e){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",m(e));case 1:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"createPopupContent",value:function(t,e,n){var r=document.createElement("div"),o=t.properties,i=document.createElement("div");if(o){i.className="properties";var a=Object.entries(o).map((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,n)||_(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return{key:r[0],value:r[1]}}));i.innerHTML=this.createPropertiesHtml(a)}if(e){var c=document.createElement("div");c.appendChild(i),r.innerHTML="Загрузка",this.updateElementContent(c,e,t).then((function(){r.innerHTML="",r.appendChild(c)})),n&&n.length&&this._addPhotos(r,n,e,Number(t.id))}else r.appendChild(i);return r}},{key:"createPropertiesHtml",value:function(t){var e="";return t.forEach((function(t){var n=t.key,r=t.value;"object"===w(r)&&r&&("year"in r?r=[r.day,r.month,r.year].join("."):"hour"in r&&(r=[r.hour,r.minute].join(":"))),e+='\n      <div class="columns is-mobile">\n        <div class="column is-two-fifths">'.concat(n,'</div>\n        <div class="column">').concat(function(t){return"string"==typeof t&&(e=t,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e))?'<a href="'.concat(t,'" target="_blank">').concat(t,"</a>"):t;var e}(r),"</div>\n      </div>\n      ")})),e}},{key:"updateElementContent",value:(i=L(k().mark((function t(e,n,r){var o,i,a,c;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getResourceItem(n);case 2:return(o=t.sent).feature_layer&&(i=[],o.feature_layer.fields.forEach((function(t){if(t.grid_visibility){var e=r.properties[t.keyname];e&&("string"==typeof e&&(e=e.replace(/\w+(;)\w+/g,(function(t,e){return t.replace(e,e+" ")}))),i.push({key:t.display_name,value:e}))}})),a=this.createPropertiesHtml(i),(c=e.getElementsByClassName("properties")[0])&&(c.innerHTML=a)),t.abrupt("return",o);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return i.apply(this,arguments)})},{key:"_addPhotos",value:(o=L(k().mark((function t(e,n,r,o){var i,a,c,u,s,l,p;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(i=document.createElement("div")).className="carousel attachment",a=g(n),t.prev=3,a.s();case 5:if((c=a.n()).done){t.next=22;break}return u=c.value,(s=document.createElement("figure")).className="image is-".concat(300,"x").concat(300),s.style.maxHeight="300px",s.style.maxWidth="300px",t.next=15,this._loadImage(u,{width:300,height:300,id:r,fid:o});case 15:l=t.sent,(p=document.createElement("img")).src=l,s.appendChild(p),i.appendChild(s);case 20:t.next=5;break;case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(3),a.e(t.t0);case 27:return t.prev=27,a.f(),t.finish(27);case 30:e.appendChild(i),f().attach(i);case 32:case"end":return t.stop()}}),t,this,[[3,24,27,30]])}))),function(t,e,n,r){return o.apply(this,arguments)})},{key:"_getResourceItem",value:(r=L(k().mark((function t(e){var n;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._resourceItems[e]){t.next=5;break}return t.next=3,this.ngwMap.connector.get("resource.item",null,{id:e});case 3:n=t.sent,this._resourceItems[e]=n;case 5:return t.abrupt("return",this._resourceItems[e]);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"_loadImage",value:function(t,e){var n=this;return new Promise((function(r,o){var i=e.width,a=e.height,c="/api/resource/"+e.id+"/feature/"+e.fid+"/attachment/".concat(t.id,"/image")+(i&&a?"?size=".concat(i,"x").concat(a):"");n.ngwMap.connector.makeQuery(c,{},{responseType:"blob"}).then((function(t){var e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){r(e.result)}})).catch((function(t){o(t)}))}))}}],n&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),C=n(86273),M=n.n(C);function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function N(){N=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new L(o||[]);return r(a,"_invoke",{value:_(t,n,c)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var f={};function p(){}function h(){}function d(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==e&&n.call(m,i)&&(y=m);var b=d.prototype=p.prototype=Object.create(y);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(r,i,a,c){var u=l(t[r],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==T(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=O(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function O(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=l(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=d,r(b,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:h,configurable:!0}),h.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},g(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function D(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function I(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,F(r.key),r)}}function A(t,e,n){return(e=F(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F(t){var e=function(t,e){if("object"!==T(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==T(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===T(e)?e:String(e)}var B="Загрузка данных...",H=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,A(this,"_container",document.createElement("div")),A(this,"_content",void 0),A(this,"_toggle",void 0),A(this,"status",void 0),this.status=void 0===this.options.open||this.options.open,this._updateContainer(),this.options.parent&&this.options.parent.appendChild(this.getContainer())}var e,n,r,o;return e=t,n=[{key:"getContainer",value:function(){return this._container}},{key:"open",value:function(){!this._content||this._content.innerHTML&&this._content.innerHTML!==B||this._updateContent(),this._toggle&&(this._toggle.innerHTML=this._getToggleButtonHtml("fas fa-chevron-up")),this.status=!0}},{key:"close",value:function(){this._cleanContent(),this._toggle&&(this._toggle.innerHTML=this._getToggleButtonHtml("fas fa-chevron-down")),this.status=!1}},{key:"toggle",value:function(){this.status?this.close():this.open()}},{key:"_getToggleButtonHtml",value:function(t){return'\n    <a class="button is-small">\n    <span class="icon is-small">\n      <i class="'.concat(t,'"></i>\n    </span>\n    </a>\n    ')}},{key:"_updateContainer",value:function(){if(this._container.innerHTML="",this.options.title){var t=this._createHeader();this._container.appendChild(t)}var e=document.createElement("div");e.innerHTML=B,e.className="panel-content",this._content=e,this._container.appendChild(e),this.status?this.open():this.close()}},{key:"_createHeader",value:function(){var t=this,e=document.createElement("div");e.className="level is-mobile panel-header";var n=document.createElement("div");n.className="level-left";var r=document.createElement("div");r.className="level-item panel-header__title",r.innerHTML=this.options.title||"",n.appendChild(r);var o=document.createElement("div");o.className="level-right";var i=document.createElement("div");return i.className="level-item panel-header__toggle",o.appendChild(i),i.onclick=function(){t.toggle()},this._toggle=i,e.appendChild(n),e.appendChild(o),e}},{key:"_cleanContent",value:function(){this._content&&(this._content.innerHTML="")}},{key:"_updateContent",value:(r=N().mark((function t(){var e;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._cleanContent(),!this._content){t.next=11;break}if("function"!=typeof this.options.content){t.next=8;break}return t.next=5,this.options.content();case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0=this.options.content;case 9:e=t.t0,this._content.appendChild(e);case 11:return t.abrupt("return",this._content);case 12:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){D(i,n,o,a,c,"next",t)}function c(t){D(i,n,o,a,c,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})}],n&&I(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),G=n(89256);function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function U(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,z(r.key),r)}}function z(t){var e=function(t,e){if("object"!==R(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===R(e)?e:String(e)}var q=function(){function t(e){var n,r,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=void 0,(r=z(r="_container"))in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o;var i=this._createTreeItem(e);i&&(this._container=i)}var e,n;return e=t,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createTreeBranch",value:function(t){var e=this,n=document.createElement("div");return n.className="tree-container__item-children",t.forEach((function(t){if(t.item){var r=e._createTreeItem(t);r&&n.appendChild(r)}})),n}},{key:"_createTreeItem",value:function(t){var e=t.item;if(!e)return!1;var n=document.createElement("div");if(n.className="tree-container__item",e.display_name){var r=document.createElement("input");r.setAttribute("type","checkbox");var o=t.properties.property("visibility");r.checked=!!o.get(),o&&(o.emitter.on("change",(function(t){r.checked=t.value})),r.onclick=function(){o.set(r.checked,{propagation:G.y9.keys.pressed("ctrl")})});var i=document.createElement("span");i.innerHTML=e.display_name,n.appendChild(r),n.appendChild(i)}if("group"===e.item_type||"root"===e.item_type&&e.children.length){var a=t.tree.getChildren(),c=this._createTreeBranch(a.reverse());n.appendChild(c)}return n}}])&&U(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function Z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,K(r.key),r)}}function $(t,e,n){return(e=K(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function K(t){var e=function(t,e){if("object"!==Y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Y(e)?e:String(e)}var V=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,$(this,"ngwMap",void 0),$(this,"_container",void 0),$(this,"_baseMapsContainer",void 0),this.ngwMap=e.ngwMap,this._container=this._createContainer(),this.ngwMap.emitter.on("layer:add",(function(t){n.ngwMap.isBaseLayer(t)&&n._updateBaseMapContainer()}))}var e,n;return e=t,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var t=document.createElement("div");t.className="basemaps-contentainer panel-content-padding control";var e=document.createElement("div");return e.className="basemaps-contentainer__layers",this._baseMapsContainer=e,t.appendChild(e),this._updateBaseMapContainer(),t}},{key:"_updateBaseMapContainer",value:function(){var t=this;this._baseMapsContainer&&(this._baseMapsContainer.innerHTML=""),this._createBaseMapItem(),this.ngwMap.getBaseLayers().forEach((function(e){var n=t.ngwMap.getLayer(e);n&&t._createBaseMapItem(n)}))}},{key:"_createBaseMapItem",value:function(t){var e=this,n=document.createElement("div");n.className="control";var r=document.createElement("label");r.className="radio basemap-container__item";var o=document.createElement("input");o.setAttribute("type","radio"),o.setAttribute("name","basemap"),o.checked=!!t&&this.ngwMap.isLayerVisible(t),o.onclick=function(){if(t&&t.id)e.ngwMap.toggleLayer(t.id,o.checked);else{var n=e.ngwMap.getActiveBaseLayer();n&&e.ngwMap.hideLayer(n)}};var i=t&&(t.name||t.options.name)||"Blank",a=document.createTextNode(i);r.appendChild(o),r.appendChild(a),n.appendChild(r),this._baseMapsContainer&&this._baseMapsContainer.appendChild(n)}}])&&Z(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),J=(n(69826),n(45243));function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function W(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,tt(r.key),r)}}function X(t,e,n){return(e=tt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tt(t){var e=function(t,e){if("object"!==Q(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Q(e)?e:String(e)}var et=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,X(this,"ngwMap",void 0),X(this,"_container",void 0),this.ngwMap=e.ngwMap,this._container=this._createContainer()}var e,n;return e=t,n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var t=this,e=document.createElement("div");e.className="bookmarks-contentainer panel-content-padding ";var n=document.createElement("div");return n.className="bookmarks-contentainer__layers",this.options.bookmarks.forEach((function(n){t.ngwMap.connector.get("resource.item",null,{id:n.id}).then((function(r){if(r.feature_layer){var o=r.feature_layer.fields.find((function(t){return t.label_field}));o&&t.ngwMap.fetchNgwLayerItems({resourceId:n.id}).then((function(n){n.forEach((function(n){var r=t._createBookmarkItem(n,o.keyname);e.appendChild(r)}))}))}}))})),e.appendChild(n),e}},{key:"_createBookmarkItem",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",r=document.createElement("div");r.className="tree-container__item bookmark";var o=document.createElement("div"),i=t.fields[n];return o.innerHTML=String(i),o.onclick=function(){var n=new J.GeoJSON(t.geom),r=e.ngwMap.mapAdapter.map;r&&r.fitBounds(n.getBounds())},r.appendChild(o),r}}],n&&W(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function nt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms",n=t.getTime();return"s"===e?n/1e3:t.toISOString()}n(12419),n(74819);var rt=n(78527),ot=n(88809);function it(t,e){var n=e?e.getTime():Date.now();return[n-1e3*Number(t)*60*60,n].map((function(t){return new Date(t)}))}function at(t,e,n){var r=e.props,o=r.timeUnit,i=r.dateField,a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"s";return it(t,arguments.length>2?arguments[2]:void 0).map((function(t){return"ISO"===e?new Date(t).toISOString():"s"===e?Math.ceil(t.getTime())/1e3:t.getTime()}))}(t,o,n);return a.map((function(t,e){return[i,e?"le":"ge",t]}))}var ct=n(7450);function ut(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return st(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?st(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function st(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n(73210);var lt=n(48651);function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,yt(r.key),r)}}function dt(t,e,n){return(e=yt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yt(t){var e=function(t,e){if("object"!==ft(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===ft(e)?e:String(e)}var vt=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,dt(this,"ngwMap",void 0),dt(this,"_container",void 0),this.ngwMap=e.ngwMap,this._container=this._createContainer()}var e,n;return e=t,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var t=document.createElement("div");t.className="fires-contentainer panel-content-padding ";var e=document.createElement("div");e.className="fires-contentainer__layers";var n,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(this.options.layers);try{for(r.s();!(n=r.n()).done;){var o=n.value;this._createFireItem(o,e)}}catch(t){r.e(t)}finally{r.f()}return t.appendChild(e),t}},{key:"onLayerAdd",value:function(t,e){var n=this,r=this.options.ngwMap,o=r&&r.getLayer(t);if(o)e(o);else{this.ngwMap.emitter.on("layer:add",(function r(o){o.id===t&&(e(o),n.ngwMap.emitter.off("layer:add",r))}))}}},{key:"_createFireItem",value:function(t,e){var n=this,r=document.createElement("div");r.className="tree-container__item";var o=t.id;if((0,lt.r)(o)){var i=document.createElement("div");i.innerHTML="загрузка...",e.appendChild(i),this.onLayerAdd(o,(function(e){return function(e){var a=e.item;if(i.innerHTML="",a){var c=document.createElement("input");c.setAttribute("type","checkbox"),c.checked=!0,c.onclick=function(){n.ngwMap.toggleLayer(o,c.checked)};var u=document.createElement("span"),s=a.resource.display_name.split("__")[0];u.innerHTML=s.replace("fires","").trim();var l=n._createSymbol(t);r.appendChild(c),r.appendChild(l),r.appendChild(u),i.appendChild(r)}}(e)}))}}},{key:"_createSymbol",value:function(t){var e,n=document.createElement("span");if(n.className="item-symbol",null!==(e=t.adapterOptions)&&void 0!==e&&e.paint){var r,o=null===(r=t.adapterOptions)||void 0===r?void 0:r.paint,i=o.color,a=o.stroke,c=o.strokeColor;"string"==typeof i&&(n.style.color=i,n.style.backgroundColor=i),a&&"string"==typeof c&&(n.style.borderColor=c)}return n}}])&&ht(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function bt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||gt(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(t,e){if(t){if("string"==typeof t)return wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(t,e):void 0}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function _t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==mt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===mt(o)?o:String(o)),r)}var o}function Ot(){return Ot="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=jt(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},Ot.apply(this,arguments)}function kt(t,e){return kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},kt(t,e)}function jt(t){return jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jt(t)}var Lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kt(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=jt(r);if(o){var n=jt(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),i.apply(this,arguments)}return e=a,(n=[{key:"_createContainer",value:function(){var t=Ot(jt(a.prototype),"_createContainer",this).call(this),e=this._createCalendar();return t.insertBefore(e,t.firstChild),t}},{key:"_createCalendar",value:function(){var t=this,e=document.createElement("div"),n=this.options.layers,r=[];return n.forEach((function(e){var n=e.id;if(n){var o=new Promise((function(e){t.onLayerAdd(n,e)}));r.push(o)}})),Promise.all(r).then((function(n){var r=t._buildCalendarBlock(n,t.options.dateRange,t.options.defaultDateRange);e.appendChild(r)})),e}},{key:"_buildCalendarBlock",value:function(t,e,n){var r=this,o=bt(e,2),i=o[0],a=o[1],c=bt(n,2),u=c[0],s=c[1],l={timedelta:this.options.timedelta,onChange:function(e){var n,o=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=gt(t))){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(t);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=i.options.props||{},c=a.dateField,u=a.timeUnit;if(c){var s=[];e.start&&s.push([c,"ge",nt(e.start,u)]),e.end&&s.push([c,"le",nt(e.end,u)]),i.propertiesFilter&&i.propertiesFilter(s)}}}catch(t){o.e(t)}finally{o.f()}r.options.onDateChange&&r.options.onDateChange()}};return i&&(l.minDate=i),u&&(l.startDate=u),a&&(l.maxDate=a),s&&(l.endDate=s),function(t){var e=t.onChange,n=t.maxDate,r=t.minDate,o=t.startDate,i=t.endDate,a=t.timedelta,c=document.createElement("div");c.className="field is-horizontal",c.innerHTML='\n  <button class="button calendar-open calendar-control-btn is-small">\n    <i class="fa fa-calendar" aria-hidden="true"></i>\n  </button>\n    <div class="field">\n        <input class="input input-from is-small" type="text" >\n    </div>\n\n    <div class="select is-small">\n      <select class="select-input">\n        '.concat(p.Ly.map((function(t){return"<option ".concat(a===t[0]?"selected":""," value=").concat(t[0],">").concat(t[1],"</option>")})),'\n      </select>\n    </div>\n    <button class="button calendar-clean calendar-control-btn is-small">✖</button>\n    ');var u=c.querySelector(".select-input"),s=c.querySelector(".input.input-from"),l=c.querySelector(".calendar-clean"),f=c.querySelector(".calendar-open"),h=new Date,d=(0,ct.D)((function(t){t.start&&t.end&&e(t)})),y=o&&i?[o,i]:void 0,v=(0,rt.Z)(s,{mode:"range",locale:ot.Russian,allowInput:!0,maxDate:n||h,minDate:r,defaultDate:y,onChange:function(t){var e=ut(t,2),n=e[0],r=e[1];u.value="",m(),d({start:n,end:r})}}),m=function(){l.style.display=Number(u.value)===a?"none":"block"};m();var b=function(t){m();var e=ut(it(t,i),2),n=e[0],r=e[1];v.setDate([n,r]),d({start:n,end:r})};return f.onclick=function(t){t.stopPropagation(),t.preventDefault(),v.isOpen?v.close():v.open()},l.onclick=function(){u.value=String(a),b(a)},u.onchange=function(){m(),b(Number(u.value))},c}(l)}}])&&_t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(vt),St=n(89528);function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function Et(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ct(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Mt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ct(Object(n),!0).forEach((function(e){Tt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Tt(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==Pt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Pt(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nt(t){var e=t.connector,n=t.layer,r=n.resource;if(n&&r&&e){var o,i,a=(null===(o=n.adapterOptions)||void 0===o||null===(i=o.props)||void 0===i?void 0:i.dateField)||"field_9";return e.getResourceIdOrFail(r).then((function(t){var n={resourceId:t,fields:[a],geom:!1,connector:e,limit:1},r=[(0,St.n)(Mt(Mt({},n),{},{orderBy:[a]}))];return Promise.all(r).then((function(t){var e=Et(t,2);return[Et([e[0],e[1]].map((function(t){var e,n=t&&t[0];if(n){var r=n.fields[a];if(r)return e=r,new Date(e.year,e.month-1,e.day)}})),1)[0],p.Kp]}))}))}return Promise.resolve([void 0,void 0])}function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function It(){It=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new L(o||[]);return r(a,"_invoke",{value:_(t,n,c)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var f={};function p(){}function h(){}function d(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==e&&n.call(m,i)&&(y=m);var b=d.prototype=p.prototype=Object.create(y);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(r,i,a,c){var u=l(t[r],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==Dt(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=O(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function O(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=l(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=d,r(b,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:h,configurable:!0}),h.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},g(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function At(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Ft(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){At(i,r,o,a,c,"next",t)}function c(t){At(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Bt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bt(Object(n),!0).forEach((function(e){Rt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ut(r.key),r)}}function Rt(t,e,n){return(e=Ut(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ut(t){var e=function(t,e){if("object"!==Dt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Dt(e)?e:String(e)}var zt={target:"tree"},qt=function(){function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.actionMap=e,Rt(this,"options",void 0),Rt(this,"sidebar",void 0),Rt(this,"_container",void 0),Rt(this,"_target",void 0),Rt(this,"ngwLayers",void 0),this.options=Ht(Ht({},zt),n),"string"==typeof this.options.target){var r=document.getElementById(this.options.target);if(!r)throw new Error("No element with ID #".concat(this.options.target," in document for webmap tree"));this._target=r}else{if(!(this.options.target instanceof HTMLElement))throw new Error("`target` option is not set");this._target=this.options.target}this.sidebar=new(M())(this._target,{closeButton:!1,position:"left",autoPan:!1}),this.sidebar.addTo(this.actionMap.ngwMap.mapAdapter.map),this.ngwLayers=this.options.ngwLayers,this._container=this._createContainer(),this.options.status||this.hide(),this._target&&this._target.appendChild(this._container)}var e,n,r,o;return e=t,n=[{key:"show",value:function(){this._container.classList.remove("hidden"),this.sidebar.show()}},{key:"hide",value:function(){this.sidebar.hide(),this._container.classList.add("hidden")}},{key:"_createContainer",value:function(){var t=this,e=document.createElement("div");return e.className="tree-container",void 0!==this.options.width&&(e.style.width=this.options.width+"px"),(this.options.userFires||this.options.firms)&&new H({title:"Пожары",content:function(){return t._createFiresContainer()},parent:e}),this.options.sensors&&new H({title:"Датчики",content:function(){return t._createSensorContainer()},parent:e}),new H({title:"Базовые слои",content:function(){return t._createNgwLayers()},open:!1,parent:e}),new H({title:"Подложки",content:function(){return t._createBasemapsContainer()},open:!1,parent:e}),new H({title:"Закладки",content:function(){return t._createBookmarksContainer()},open:!1,parent:e}),e}},{key:"_createNgwLayers",value:function(){var t=document.createElement("div");for(var e in t.className="webmap-tree-container",this.ngwLayers){var n=this.ngwLayers[e],r=new q(n.layer.layer).getContainer();r&&t.appendChild(r)}return t}},{key:"_createBookmarksContainer",value:function(){var t=document.createElement("div"),e=this.options.bookmarks;if(e){var n=new et({bookmarks:e,ngwMap:this.options.ngwMap});t.appendChild(n.getContainer())}return t}},{key:"_createFiresContainer",value:(o=Ft(It().mark((function t(){var e,n,r,o,i,a,c,u,s,l=this;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=document.createElement("div"),n=this.options,r=n.firms,o=n.userFires,i=[void 0,void 0],!r&&!o){t.next=15;break}if(a=[],!o||!o.id){t.next=10;break}return a.push(o),t.next=9,Nt({layer:o,connector:this.options.ngwMap.connector});case 9:i=t.sent;case 10:r&&r.forEach((function(t){return a.push(t)})),c=this.actionMap.options.timedelta||24,u=it(c,p.Kp),s=new Lt({layers:a,ngwMap:this.options.ngwMap,dateRange:i,defaultDateRange:u,timedelta:this.actionMap.options.timedelta||72,onDateChange:function(){l.options.onDateChange&&l.options.onDateChange()}}),e.appendChild(s.getContainer());case 15:return t.abrupt("return",e);case 16:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_createSensorContainer",value:(r=Ft(It().mark((function t(){var e,n,r;return It().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.createElement("div"),(n=this.options.sensors)&&(r=new vt({layers:[n],ngwMap:this.options.ngwMap}),e.appendChild(r.getContainer())),t.abrupt("return",e);case 4:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_createBasemapsContainer",value:function(){var t=document.createElement("div");if(this.options.firms){var e=new V({ngwMap:this.options.ngwMap});t.appendChild(e.getContainer())}return t}}],n&&Gt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Yt=n(14705),Zt=n(17187);function $t(t){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(t)}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Vt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Qt(r.key),r)}}function Jt(t,e,n){return(e=Qt(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qt(t){var e=function(t,e){if("object"!==$t(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==$t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===$t(e)?e:String(e)}var Wt=function(){function t(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.actionMap=e,Jt(this,"html",'<i class="fas fa-map-pin btn-control-icon "></i>'),Jt(this,"title",{off:"Полученить координаты с карты",on:"Выключить режим получения координат с карты"}),Jt(this,"addClass","toggle-control webmap-tree-control"),Jt(this,"addClassOn","active"),Jt(this,"status",!1),Jt(this,"emitter",new Zt.EventEmitter),Jt(this,"_toggle",void 0),Jt(this,"__onMapClick",void 0),Jt(this,"_layer",void 0),this._toggle=r.toggle,this.actionMap.ngwMap.addFeatureLayer({id:"show-coordinate-click",visibility:!0,paint:{radius:6},popup:!0,popupOptions:{createPopupContent:function(t){if(t.feature)return n._createPopupContent(t.feature.geometry.coordinates.map((function(t){return t.toFixed(5)})))}}}).then((function(t){t&&(n._layer=t)}))}var e,n;return e=t,(n=[{key:"onClick",value:function(t){this.toggleControl(t)}},{key:"show",value:function(){var t=this;this.actionMap.ngwMap.setCursor("crosshair"),this._removeClickListener(),this.__onMapClick=function(e){return t._onMapClick(e)},this.actionMap.ngwMap.emitter.on("click",this.__onMapClick)}},{key:"hide",value:function(){this.actionMap.ngwMap.setCursor("default"),this._removeClickListener(),this.actionMap.ngwMap.clearLayerData(this._layer)}},{key:"_removeClickListener",value:function(){this.__onMapClick&&(this.actionMap.ngwMap.emitter.off("click",this.__onMapClick),this.__onMapClick=void 0)}},{key:"_onMapClick",value:function(t){var e={type:"Feature",properties:{},geometry:{type:"Point",coordinates:t.lngLat}};this.actionMap.ngwMap.setLayerData(this._layer,e)}},{key:"toggleControl",value:function(t){(t=void 0!==t?t:!this.status)?this.show():this.hide(),this.status=t,this._toggle&&this._toggle(t),this.emitter.emit("status",this.status)}},{key:"_createPopupContent",value:function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(e,n)||function(t,e){if(t){if("string"==typeof t)return Kt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kt(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],a=document.createElement("div"),c="".concat(i,", ").concat(o);return a.innerHTML='\n    <span>Широта/Долгота:</span>\n    <span class="lat-lng-coord"> '.concat(c,'</span>\n    <a href="#" class="copy-to-clipboard">\n    <i class="far fa-clipboard"></i>\n    </a>'),a.getElementsByClassName("copy-to-clipboard")[0].onclick=function(){Yt.T.copy(c)},a}}])&&Vt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Xt={en:{linearMeasurement:"Distance measurement",areaMeasurement:"Area measurement",start:"Start",meter:"m",kilometer:"km",squareMeter:"m²",squareKilometers:"km²"},ru:{linearMeasurement:"Измерение расстояния",areaMeasurement:"Измерение площади",start:"Старт",meter:"м",kilometer:"км",squareMeter:"м²",squareKilometers:"км²"}};function te(t){return t*(Math.PI/180)}function ee(t){return Math.pow(t,2)}function ne(t,e){return t<1e3?re(t,0)+" "+e.meter:re(t/1e3,2)+" "+e.kilometer}function re(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t<0?"-":"",r=Math.abs(+t||0),o=parseInt(r.toFixed(e),10)+"",i=o.length>3?o.length%3:0;return[n,i?o.substr(0,i)+",":"",o.substr(i).replace(/(\d{3})(?=\d)/g,"$1,"),e?"."+Math.abs(r-Number(o)).toFixed(e).slice(2):""].join("")}function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ie(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,le(r.key),r)}}function ae(t,e){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ae(t,e)}function ce(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(t)}function se(t,e,n){return(e=le(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function le(t){var e=function(t,e){if("object"!==oe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===oe(e)?e:String(e)}n(91058);var fe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ae(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ue(r);if(o){var n=ue(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ce(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),se(ce(e=i.call(this,t)),"options",{latlng:null,content:"",className:""}),se(ce(e),"_map",void 0),se(ce(e),"_offset",new J.Point(0,30)),se(ce(e),"_container",void 0),se(ce(e),"_contentNode",void 0),se(ce(e),"_closeButton",void 0),se(ce(e),"_containerBottom",void 0),se(ce(e),"_containerLeft",void 0),J.Util.setOptions(ce(e),t),e.options.offset&&(e._offset=e.options.offset),e}return e=a,(n=[{key:"onAdd",value:function(t){return this._map=t,this._container||this._initLayout(),this._container&&t.getPanes().popupPane.appendChild(this._container),t.on("viewreset",this._updatePosition,this),J.Browser.any3d&&t.on("zoomanim",this._zoomAnimation,this),this._update(),this}},{key:"addTo",value:function(t){return t.addLayer(this),this}},{key:"onRemove",value:function(t){return this._container&&t.getPanes().popupPane.removeChild(this._container),t.off("viewreset",this._updatePosition,this),t.off("zoomanim",this._zoomAnimation,this),this._map=null,this}},{key:"setLatLng",value:function(t){return this.options.latlng=(0,J.latLng)(t),this._updatePosition(),this}},{key:"setContent",value:function(t){return this.options.content=t,this._updateContent(),this}},{key:"enableClose",value:function(){return this._closeButton=J.DomUtil.create("span","close",this._container),this._closeButton.innerHTML='<svg class="icon" viewBox="0 0 40 40"><path stroke="#FF0000" stroke-width="3" d="M 10,10 L 30,30 M 30,10 L 10,30" /></svg>',this._closeButton}},{key:"_initLayout",value:function(){this._container=J.DomUtil.create("div",this.options.className),this._contentNode=J.DomUtil.create("div","content",this._container)}},{key:"_update",value:function(){this._map&&(this._updateContent(),this._updatePosition())}},{key:"_updateContent",value:function(){this._contentNode&&this.options.content&&("string"==typeof this.options.content?this._contentNode.innerHTML=this.options.content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this.options.content)))}},{key:"_updatePosition",value:function(){if(this.options.latlng&&this._container){var t=this._map.latLngToLayerPoint(this.options.latlng),e=J.Browser.any3d,n=this._offset;e&&J.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}}},{key:"_zoomAnimation",value:function(t){if(this._container){var e=this._map._latLngToNewLayerPoint(this.options.latlng,t.zoom,t.center);J.DomUtil.setPosition(this._container,e)}}}])&&ie(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(J.Layer);function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function he(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,be(r.key),r)}}function de(t,e){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},de(t,e)}function ye(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ve(t){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ve(t)}function me(t,e,n){return(e=be(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function be(t){var e=function(t,e){if("object"!==pe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===pe(e)?e:String(e)}var ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&de(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ve(r);if(o){var n=ve(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return ye(t)}(this,t)});function a(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),me(ye(n=i.call(this,t)),"options",{color:"#FF0080",model:"distance",messages:Xt.en}),me(ye(n),"_map",void 0),me(ye(n),"_measureHandler",void 0),me(ye(n),"_finished",void 0),me(ye(n),"_startMove",void 0),me(ye(n),"_measurementStarted",void 0),me(ye(n),"_lastPoint",void 0),me(ye(n),"_totalDistance",0),me(ye(n),"_trail",{overlays:[],points:[]}),me(ye(n),"_directPath",void 0),me(ye(n),"_measurePath",void 0),n._map=t,n._measureHandler=ye(n),n._finished=!1,J.Util.setOptions(ye(n),e),n}return e=a,(n=[{key:"setModel",value:function(t){return this.options.model=t,this}},{key:"addHooks",value:function(){this._activeMeasure()}},{key:"removeHooks",value:function(){this._disableMeasure()}},{key:"_activeMeasure",value:function(){this._measureHandler._measurementStarted&&this._measureHandler._finishMeasure(),this._measurementStarted?this._finishMeasure():this._enableMeasure()}},{key:"_onMouseClick",value:function(t){var e=t.latlng||this._map.mouseEventToLatLng(t);if(!this._lastPoint||!e.equals(this._lastPoint)){if(this._trail.points.length>0){var n=this._trail.points;n.push(e);var r=n.length;this._totalDistance+=(o=n[r-2],i=n[r-1],a=te(o.lat),u=(c=te(i.lat))-a,s=te(i.lng-o.lng),l=ee(Math.sin(u/2))+Math.cos(a)*Math.cos(c)*ee(Math.sin(s/2)),12756274*Math.asin(Math.sqrt(l))),this._addMeasurePoint(e),this._addMarker(e),"area"!==this.options.model&&this._addLable(e,ne(this._totalDistance,this.options.messages),"leaflet-measure-label")}else this._totalDistance=0,this._addMeasurePoint(e),this._addMarker(e),"area"!==this.options.model&&this._addLable(e,this.options.messages.start,"leaflet-measure-label"),this._trail.points.push(e);var o,i,a,c,u,s,l;this._lastPoint=e,this._startMove=!1}}},{key:"_onMouseMove",value:function(t){var e=t.latlng;this._directPath&&this._trail.points.length>0&&(this._startMove?this._directPath.setLatLngs(this._trail.points.concat(e)):(this._directPath.setLatLngs([e]),this._startMove=!0))}},{key:"_enableMeasure",value:function(){this._trail={overlays:[],points:[]};var t=this._map;J.DomUtil.addClass(t.getContainer(),"leaflet-measure-map"),t.contextMenu&&t.contextMenu.disable(),this._measurementStarted=!0,t.on("click",this._onMouseClick,this),t.on("dblclick",this._finishMeasure,this),t.on("contextmenu",this._finishMeasure,this),t.doubleClickZoom.disable(),t.on("mousemove",this._onMouseMove,this),t.fire("measure:start")}},{key:"_disableMeasure",value:function(){var t=this._map;J.DomUtil.removeClass(t.getContainer(),"leaflet-measure-map"),t.contextMenu&&t.contextMenu.enable(),t.off("click",this._onMouseClick,this),t.off("dblclick",this._finishMeasure,this),t.off("contextmenu",this._finishMeasure,this),t.off("mousemove",this._onMouseMove,this),t.doubleClickZoom.enable(),this._measurementStarted=this._startMove=!1,this._finished||this._clearOverlay.call(this),t.fire("measure:stop")}},{key:"_finishMeasure",value:function(t){var e,n,r;this._trail.points.length>0&&(this._trail.points.length>1?(!this._directPath||t&&"contextmenu"!==t.type||this._directPath.setLatLngs(this._trail.points),this._lastPoint&&("area"===this.options.model?this._addLable(this._lastPoint,(e=this._trail.points,n=this.options.messages,r=Math.round(function(t){for(var e=6378137,n=0,r=t.length,o=t[r-1].lng,i=t[r-1].lat,a=0;a<r;a++){var c=t[a].lng,u=t[a].lat;n+=te(c-o)*(2+Math.sin(te(i))+Math.sin(te(u))),o=c,i=u}return Math.abs(n*e*e/2)}(e)),r<1e6?re(r,0)+" "+n.squareMeter:re(r/1e6,2)+" "+n.squareKilometers),"leaflet-measure-label",!0):this._addLable(this._lastPoint,ne(this._totalDistance,this.options.messages),"leaflet-measure-label",!0)),this._directPath&&this._map.removeLayer(this._directPath),this._finished=!0):this._clearOverlay.call(this)),this.disable()}},{key:"_resetDirectPath",value:function(t){var e;this._directPath?this._directPath.addLatLng(t):(e="area"===this.options.model?new J.Polygon([t],{weight:2,color:this.options.color,dashArray:[5,5],fillOpacity:0,interactive:!1}):new J.Polyline([t],{weight:2,color:this.options.color,dashArray:[5,5],interactive:!1}),this._map.addLayer(e),this._trail.overlays.push(e),this._directPath=e)}},{key:"_addMeasurePoint",value:function(t){var e;this._measurePath?this._measurePath.addLatLng(t):(e="area"===this.options.model?new J.Polygon([t],{weight:2,color:this.options.color,fillColor:this.options.color,fillOpacity:.5,interactive:!1}):new J.Polyline([t],{weight:2,color:this.options.color,interactive:!1}),this._map.addLayer(e),this._trail.overlays.push(e),this._measurePath=e),this._resetDirectPath(t)}},{key:"_addMarker",value:function(t){var e=new J.CircleMarker(t,{color:this.options.color,opacity:1,weight:1,fillColor:"#FFFFFF",fill:!0,fillOpacity:1,radius:3,interactive:!1});this._map.addLayer(e),this._trail.overlays.push(e)}},{key:"_addLable",value:function(t,e,n,r){var o=this,i=new fe({latlng:t,content:e,className:n});if(this._map.addLayer(i),this._trail.overlays.push(i),r){var a=i.enableClose();J.DomEvent.on(a,"click",(function(t){J.DomEvent.stopPropagation(t),o._clearOverlay()}),this)}}},{key:"_clearOverlay",value:function(){var t,e=this._trail.overlays,n=0;for(t=e.length;n<t;n++)this._map.removeLayer(e[n])}}])&&he(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(J.Handler);function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(n),!0).forEach((function(e){Pe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ke(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ee(r.key),r)}}function je(t,e){return je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},je(t,e)}function Le(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Se(t){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Se(t)}function Pe(t,e,n){return(e=Ee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ee(t){var e=function(t,e){if("object"!==we(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===we(e)?e:String(e)}var xe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&je(t,e)}(a,t);var e,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Se(r);if(o){var n=Se(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===we(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return Le(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),Pe(Le(e=i.call(this,t)),"options",{position:"topright",title:"Measurement",collapsed:!0,color:"#FF0080",locale:"en",messages:Xt.en}),Pe(Le(e),"_map",void 0),Pe(Le(e),"_container",void 0),Pe(Le(e),"_link",void 0),Pe(Le(e),"_contents",void 0),Pe(Le(e),"_measureHandler",void 0),J.Util.setOptions(Le(e),t);var n=t.locale;if(n&&"en"!==n){var r=Xt[n];r?e.options.messages=Oe(Oe({},Xt),r):console.error("Measure control has no messages for "+e.options.locale+" locale")}return e}return e=a,(n=[{key:"onAdd",value:function(t){return this._map=t,this._container||this._initLayout()}},{key:"disableMeasure",value:function(){this._measureHandler&&(this._measureHandler.disable(),this._measureHandler=void 0)}},{key:"_buildContainer",value:function(){return this._container=J.DomUtil.create("div","leaflet-control-measure leaflet-bar leaflet-control"),this._contents=J.DomUtil.create("div","leaflet-measure-contents",this._container),this._link=J.DomUtil.create("a","leaflet-measure-toggle",this._container),this._link.title=this.options.title||"Measurement",this._link.href="#",this._buildItems(),this._container}},{key:"_buildItems",value:function(){var t=J.DomUtil.create("ul","leaflet-measure-actions",this._contents),e=J.DomUtil.create("li","leaflet-measure-action",t),n=J.DomUtil.create("a","start",e);n.innerText=this.options.messages.linearMeasurement,n.href="#",J.DomEvent.disableClickPropagation(n),J.DomEvent.on(n,"click",this._enableMeasureLine,this),e=J.DomUtil.create("li","leaflet-measure-action",t);var r=J.DomUtil.create("a","leaflet-measure-action start",e);r.innerText=this.options.messages.areaMeasurement,r.href="#",J.DomEvent.disableClickPropagation(r),J.DomEvent.on(r,"click",this._enableMeasureArea,this)}},{key:"_initLayout",value:function(){var t=this._buildContainer();return J.DomEvent.disableClickPropagation(t),J.DomEvent.disableScrollPropagation(t),this.options.collapsed?J.DomEvent.on(t,{mouseenter:this._expand,mouseleave:this._collapse},this):this._expand(),t}},{key:"_enableMeasureLine",value:function(t){J.DomEvent.stopPropagation(t),this.disableMeasure(),this._map&&(this._measureHandler=new ge(this._map,{model:"distance",color:this.options.color,messages:this.options.messages}),this._measureHandler.enable())}},{key:"_enableMeasureArea",value:function(t){J.DomEvent.stopPropagation(t),this.disableMeasure(),this._map&&(this._measureHandler=new ge(this._map,{model:"area",color:this.options.color,messages:this.options.messages}),this._measureHandler.enable())}},{key:"_expand",value:function(){return this._link&&this._container&&(this._link.style.display="none",J.DomUtil.addClass(this._container,"leaflet-measure-expanded")),this}},{key:"_collapse",value:function(){return this._link&&this._container&&(this._link.style.display="block",J.DomUtil.removeClass(this._container,"leaflet-measure-expanded")),this}}])&&ke(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),a}(J.Control),Ce=[];function Me(t,e){Ce.push({name:t,stop:e})}function Te(t){Ce.forEach((function(e){e.name!==t&&e.stop()}))}function Ne(t){var e=new xe({locale:"ru"});t.addControl(e,"top-left"),t.onLoad().then((function(){var n=t.mapAdapter.map;n&&(n.on("measure:start",(function(){Te("measure"),t.disableSelection()})),n.on("measure:stop",(function(){t.setCursor("default"),t.enableSelection()}))),Me("measure",(function(){e.disableMeasure()}))}))}function De(t){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},De(t)}function Ie(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return Ae(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function Ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Fe(){Fe=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function s(t,e,n,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new L(o||[]);return r(a,"_invoke",{value:_(t,n,c)}),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var f={};function p(){}function h(){}function d(){}var y={};u(y,i,(function(){return this}));var v=Object.getPrototypeOf,m=v&&v(v(S([])));m&&m!==e&&n.call(m,i)&&(y=m);var b=d.prototype=p.prototype=Object.create(y);function g(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(r,i,a,c){var u=l(t[r],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==De(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return o("throw",t,a,c)}))}c(u.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function _(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=O(a,n);if(c){if(c===f)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=l(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===f)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function O(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var o=l(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:P}}function P(){return{value:void 0,done:!0}}return h.prototype=d,r(b,"constructor",{value:d,configurable:!0}),r(d,"constructor",{value:h,configurable:!0}),h.displayName=u(d,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},g(w.prototype),u(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(s(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},g(b),u(b,c,"Generator"),u(b,i,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=S,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(j),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;j(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},t}function Be(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function He(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Be(Object(n),!0).forEach((function(e){ze(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ge(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function Re(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ge(i,r,o,a,c,"next",t)}function c(t){Ge(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Ue(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,qe(r.key),r)}}function ze(t,e,n){return(e=qe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qe(t){var e=function(t,e){if("object"!==De(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===De(e)?e:String(e)}var Ye=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,ze(this,"ngwMap",void 0),ze(this,"tree",void 0),ze(this,"treeControl",void 0),ze(this,"authControl",void 0),ze(this,"popup",void 0),ze(this,"_promises",{}),this.popup=new x}var e,n,r,l,f,h,d,y;return e=t,n=[{key:"create",value:(y=Re(Fe().mark((function t(e){var n,r,o,s,l,f,p,h;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=He({},e.mapOptions),r=e.basemaps,o=e.firms,s=e.userFires,l=e.sensors,f=new i.Z8(He({mapAdapter:new c.Z,controls:[],minZoom:4,runtimeParams:[new u.Z]},n)),this.ngwMap=f,f.setCursor("default"),this.popup.setNgwMap(f),r&&f.onLoad().then((function(){return r.forEach((function(t,e){f.addBaseLayer("QMS",He(He({},t),{},{visibility:0===e}))}))})),f.getPaintFunctions={base:a.q},f.addControl("ZOOM","top-left"),this._createLocateControl(),f.addControl("ATTRIBUTION","bottom-right",{customAttribution:['<a href="https://nextgis.com" target="_blank">©NextGIS</a>']}),Ne(f),this._createShareControl(),t.next=15,f.getNgwLayers();case 15:return p=t.sent,h=[],Object.values(p).forEach((function(t){var e=t.layer.item&&t.layer.item.webmap&&t.layer.item.webmap.bookmark_resource;e&&h.push(e)})),t.next=20,this._addFireLayer(e.userFires);case 20:return t.next=22,this._addFirms(e.firms);case 22:return t.next=24,this._addSensors(e.sensors);case 24:this._createGetCoordinateControl(),this._addTreeControl({ngwLayers:p,firms:o,sensors:l,userFires:s,bookmarks:h}),this._addEventsListeners();case 27:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"_locate",value:function(){var t=this;this.ngwMap.locate({setView:!1},{locationfound:function(e){var n,r=e.lngLat;t.ngwMap.setView(r,Math.max.apply(Math,[null!==(n=t.ngwMap.getZoom())&&void 0!==n?n:0,16]))}})}},{key:"_createShareControl",value:function(){var t=this,e=document.getElementsByClassName("js-modal")[0],n=document.getElementsByClassName("js-modal-close")[0],r=document.getElementsByClassName("js-share-modal-content")[0],i=document.getElementsByClassName("js-share-input")[0];n.addEventListener("click",(function(){r.innerHTML="",e.classList.remove("is-active")}));var a=this.ngwMap.createButtonControl({html:'<i class="fas fa-share-alt btn-control-icon "></i>',onClick:function(){var n,a;n=location.href,a=t._createShareModalContent(n),i.value=n,r.innerHTML=a,o().update(),e.classList.add("is-active")}});this.ngwMap.addControl(a,"bottom-right")}},{key:"_createGetCoordinateControl",value:(d=Re(Fe().mark((function t(){var e,n,r=this;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new Wt(this,{toggle:function(t){t?(Te("coordinate"),r.ngwMap.disableSelection()):r.ngwMap.enableSelection()}}),t.next=3,this.ngwMap.createToggleControl(e);case 3:n=t.sent,this.ngwMap.addControl(n,"top-left"),Me("coordinate",(function(){return n.onClick(!1)}));case 6:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"_createLocateControl",value:function(){var t=this,e=this.ngwMap.createButtonControl({html:'<i class="fas fa-location-arrow btn-control-icon"></i>',title:"Найти меня на карте",onClick:function(){return t._locate()}});this.ngwMap.addControl(e,"top-left")}},{key:"_createShareModalContent",value:function(t){return'<div class="buttons share-btn js-share-btn" data-url="'.concat(t,'" data-title="" data-desc="">\n      ').concat([{id:"tw",name:"Twitter",icon:"fab fa-twitter"},{id:"vk",name:"VK",icon:"fab fa-vk"},{id:"fb",name:"Facebook",icon:"fab fa-facebook-square"}].map((function(t){return'<a class="button is-primary" data-id="'.concat(t.id,'">\n                    <span class="icon">\n                        <i class="').concat(t.icon,'"></i>\n                    </span>\n                    <span>').concat(t.name,"</span>\n                </a>")})).join(""),"\n    </div>")}},{key:"_addFireLayer",value:(h=Re(Fe().mark((function t(e,n){var r;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=3;break}return r=e.adapterOptions&&e.adapterOptions.paint?e.adapterOptions.paint:{},t.abrupt("return",this.ngwMap.addNgwLayer({resource:e.resource,id:e.id,adapterOptions:He(He(He({},e.adapterOptions),{},{paint:He(He({},r),{},{radius:5}),selectable:!0,selectedPaint:He(He({},r),{},{radius:7})},n),{},{propertiesFilter:at(this.options.timedelta||24,e.adapterOptions,p.Kp)})}));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"_addFirms",value:(f=Re(Fe().mark((function t(e){var n,r,o;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=18;break}n=Ie(e),t.prev=2,n.s();case 4:if((r=n.n()).done){t.next=10;break}return o=r.value,t.next=8,this._addFireLayer(o);case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,this,[[2,12,15,18]])}))),function(t){return f.apply(this,arguments)})},{key:"_addSensors",value:(l=Re(Fe().mark((function t(e){return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e&&this.ngwMap.addNgwLayer(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})},{key:"_addTreeControl",value:(r=Re(Fe().mark((function t(e){var n,r,o,i,a,c=this;return Fe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.getElementsByClassName("js-sidebar")[0],r=function(){return n.classList.contains("is-active")},o=function(){return n.classList.add("is-active")},i=function(){return n.classList.remove("is-active")},t.next=6,this.ngwMap.onLoad();case 6:this.tree=new qt(this,He(He({},e),{},{onDateChange:function(){c._cleanSelection()},ngwMap:this.ngwMap})),a=function(t){(t=void 0!==t?t:r())?(Te("tree"),c.tree&&c.tree.show(),o()):(c.tree&&c.tree.hide(),i())},n.addEventListener("click",(function(){a()})),setTimeout((function(){a()}),500),Me("tree",(function(){return a(!1)}));case 11:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"_cleanSelection",value:function(){this._promises.getFeaturePromise instanceof s.Z&&this._promises.getFeaturePromise.cancel(),this.ngwMap.removeLayer("highlight")}},{key:"_highlighNgwLayer",value:function(t){var e=this;this._cleanSelection();var n=t.getIdentifyItems(),r=n[n.length-1];if(r){var o=this.options.sensors&&r.layerId===this.options.sensors.resource;r.identify().then((function(t){t&&t.toGeojson().then((function(n){e.ngwMap.addLayer("GEOJSON",{id:"highlight",data:n,paint:{color:"green",stroke:!0,fillOpacity:"0.8"},popup:!0,popupOptions:{maxWidth:300,createPopupContent:function(i){if(i.onClose((function(){e._cleanSelection(),e.ngwMap.unSelectLayers()})),i.feature)return o?e.popup.createSensorPopupContent({feature:n}):e.popup.createPopupContent(n,r.layerId,t.extensions.attachment)}}})}))}))}}},{key:"_addEventsListeners",value:function(){var t=this;this.ngwMap.emitter.on("click",(function(){t.ngwMap.cancelPromises("identify","select")})),this.ngwMap.emitter.on("ngw:select",(function(e){return e&&t._highlighNgwLayer(e)}))}}],n&&Ue(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},9588:function(t,e,n){n.d(e,{DT:function(){return c},Kp:function(){return s},Ly:function(){return r},Oh:function(){return a},U3:function(){return i},lX:function(){return u},uo:function(){return o}});var r=[[24,"1 день"],[48,"2 дня"],[72,"3 дня"],[96,"4 дня"],[120,"5 дней"],[144,"6 дней"],[168,"неделя"]],o="USERFIRE",i="MODIS",a="VIIRS",c="SENSOR",u="http://217.25.95.157:8000/",s=new Date;setInterval((function(){s=new Date}),36e5)},77690:function(t,e,n){n(35666);var r=n(67653),o=(n(96649),n(96078),n(82526),n(41817),n(41539),n(9653),n(69070),n(47941),n(57327),n(38880),n(54747),n(49337),n(33321),n(32165),n(66992),n(78783),n(33948),n(9588));function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===i(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s={limit:2e3,props:{dateField:"timestamp",timeUnit:"s"}},l={stroke:!0,strokeColor:"#ffffff",strokeOpacity:1,opacity:1},f={mapOptions:{target:"map",bounds:[36.59,43.385,49.374,50.214],baseUrl:"https://clear-horizon.nextgis.com",resources:[{resource:1,fit:!0,adapterOptions:{selectable:!0}}]},timedelta:72,basemaps:[{qmsId:1135}],userFires:{resource:"userfirepoints",id:o.uo,adapterOptions:{paint:c({color:"rgb(100,20,40)"},l),props:{dateField:"field_9",timeUnit:"ISO"}}},sensors:{resource:446,id:o.DT,adapterOptions:{selectable:!0,paint:c({color:"#0000ff",radius:5},l)}},firms:[{resource:103,id:o.U3,adapterOptions:c({paint:c({color:"red"},l)},s)},{resource:105,id:o.Oh,adapterOptions:c({paint:c({color:"orange"},l)},s)}]};new r.g(f).create()}},function(t){t.O(0,[426,956,117,587,80,12,243,385,185,1,778,17,971,784,712,365,471,189,252,467],(function(){return 77690,t(t.s=77690)})),t.O()}]);
//# sourceMappingURL=main-d91a90496c97bab.js.map