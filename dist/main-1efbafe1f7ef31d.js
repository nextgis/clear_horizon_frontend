"use strict";(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[252],{9256:function(e,t,r){r.d(t,{y9:function(){return Se}}),r(5666),r(1539),r(8674),r(8304),r(489),r(2419),r(7941),r(2772),r(2526),r(1817),r(2443),r(2165),r(6992),r(8783),r(3948),r(8309),r(4747),r(2222),r(561),r(2707),r(2479),r(1249),r(7327),r(9826),r(6699),r(2023),r(6755),r(4916),r(5306),r(5003),r(9337);var n=r(9443),o=r(8133);function i(e){for(var t,r={},n=0;n<e.length;n++)r[e[n]]=1+(r[e[n]]||0);for(var o in r){var i=void 0!==t?r[t]:0;r[o]>(i||0)&&(t=o)}return t}var a={polygon:"path",line:"path",point:"circle"},s={Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon"};function u(e){if(e.data){var t=s[(o=e.data,"FeatureCollection"===o.type?i(o.features.map((function(e){return e.geometry.type}))):"GeometryCollection"===o.type?i(o.geometries.map((function(e){return e.type}))):"Feature"===o.type?o.geometry.type:o.type)],r=e.paint;r&&(0,n.GY)(r)&&(r.type=r.type?r.type:"polygon"===t||"line"===t?"path":"html"in r||"className"in r?"icon":a[t]),e.type=e.type||t}var o;return e}r(9714),r(9720),r(7042),r(1038);var c=r(7187),l=r(1344),f=r(1521);function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var y=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),p(this,"backspace",8),p(this,"tab",9),p(this,"enter",13),p(this,"shift",16),p(this,"ctrl",17),p(this,"alt",18),p(this,"pause/break",19),p(this,"caps_lock",20),p(this,"escape",27),p(this,"page_up",33),p(this,"page_down",34),p(this,"end",35),p(this,"home",36),p(this,"left_arrow",37),p(this,"up_arrow",38),p(this,"right_arrow",39),p(this,"down_arrow",40),p(this,"insert",45),p(this,"delete",46),p(this,"left_window_key",91),p(this,"right_window_key",92),p(this,"select_key",93),p(this,"numpad_0",96),p(this,"numpad_1",97),p(this,"numpad_2",98),p(this,"numpad_3",99),p(this,"numpad_4",100),p(this,"numpad_5",101),p(this,"numpad_6",102),p(this,"numpad_7",103),p(this,"numpad_8",104),p(this,"numpad_9",105),p(this,"multiply",106),p(this,"add",107),p(this,"subtract",109),p(this,"decimal_point",110),p(this,"divide",111),p(this,"f1",112),p(this,"f2",113),p(this,"f3",114),p(this,"f4",115),p(this,"f5",116),p(this,"f6",117),p(this,"f7",118),p(this,"f8",119),p(this,"f9",120),p(this,"f10",121),p(this,"f11",122),p(this,"f12",123),p(this,"num_lock",144),p(this,"scroll_lock",145),p(this,"semi-colon",186),p(this,"equal_sign",187),p(this,",",188),p(this,"-",189),p(this,".",190),p(this,"/",191),p(this,"`",192),p(this,"[",219),p(this,"\\",220),p(this,"]",221),p(this,"'",222)};function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),d(this,"keyCodeAlias",new y),d(this,"keys",{}),d(this,"_windowOnFocus",void 0),d(this,"_keysPressed",void 0),d(this,"_keysReleased",void 0),this._windowOnFocus=this.windowOnFocus.bind(this),this._keysPressed=this.keysPressed.bind(this),this._keysReleased=this.keysReleased.bind(this),this.addKeyboardEventsListener()}var t,r;return t=e,(r=[{key:"pressed",value:function(e){var t=this.keyCodeAlias[e];return!!t&&this.keys[t]}},{key:"addKeyboardEventsListener",value:function(){"undefined"!=typeof window&&(window.addEventListener("focus",this._windowOnFocus,!1),window.addEventListener("keydown",this._keysPressed,!1),window.addEventListener("keyup",this._keysReleased,!1))}},{key:"removeKeyboardEventsListener",value:function(){"undefined"!=typeof window&&(window.removeEventListener("focus",this._windowOnFocus,!1),window.removeEventListener("keydown",this._keysPressed,!1),window.removeEventListener("keyup",this._keysReleased,!1))}},{key:"keysPressed",value:function(e){e.stopPropagation(),this.keys[e.keyCode]||(this.keys[e.keyCode]=!0)}},{key:"keysReleased",value:function(e){e.stopPropagation(),this.keys[e.keyCode]=!1}},{key:"windowOnFocus",value:function(){this.keys={}}}])&&h(t.prototype,r),e}();function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(6977),r(3123),r(941);var g=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webMap=t,b(this,"name",void 0),b(this,"event",void 0),b(this,"value",void 0),r&&(r.value&&this.setValue(r.value),r.name&&(this.name=r.name),r.event&&(this.event=r.event))}var t,r;return t=e,(r=[{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(e){this.value=e}}])&&m(t.prototype,r),e}();function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(n);if(o){var r=C(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return O(this,e)});function a(){var e;w(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return P(x(e=i.call.apply(i,[this].concat(r))),"name","center"),P(x(e),"event","moveend"),e}return t=a,(r=[{key:"getValue",value:function(){return this.webMap.getCenter()}},{key:"setValue",value:function(e){this.webMap.setCenter(e)}},{key:"toString",value:function(e){var t=e.map((function(e){return e.toFixed(5)}));return t[0]+"_"+t[1]}},{key:"parse",value:function(e){return e.split("_").map(Number)}}])&&_(t.prototype,r),a}(g);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e,t){if(t&&("object"===A(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return M(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(a,e);var t,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=B(n);if(o){var r=B(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return T(this,e)});function a(){var e;E(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return F(M(e=i.call.apply(i,[this].concat(r))),"name","zoom"),F(M(e),"event","zoomend"),e}return t=a,(r=[{key:"getValue",value:function(){var e=this.webMap.getZoom();return void 0!==e?Math.round(e):void 0}},{key:"setValue",value:function(e){this.webMap.setZoom(e)}},{key:"toString",value:function(e){return String(e)}},{key:"parse",value:function(e){return Number(e)}}])&&j(t.prototype,r),a}(g);function I(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Z(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Z(e,t){if(e){if("string"==typeof e)return V(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(e,t):void 0}}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function D(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function J(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){D(i,n,o,a,s,"next",e)}function s(e){D(i,n,o,a,s,"throw",e)}a(void 0)}))}}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var K=0,Q={minZoom:0,maxZoom:21,paint:{color:"blue",opacity:.4,strokeOpacity:1,stroke:!0,radius:8,weight:1},selectedPaint:{color:"darkblue",opacity:.4,strokeOpacity:1,stroke:!0,radius:12,weight:1},create:!0},H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),N(this,"options",Q),N(this,"emitter",new c.EventEmitter),N(this,"keys",e.keys),N(this,"mapAdapter",void 0),N(this,"runtimeParams",[]),N(this,"getPaintFunctions",e.getPaintFunctions),N(this,"mapState",[S,z]),N(this,"id",K++),N(this,"_initMapState",{}),N(this,"_starterKits",void 0),N(this,"_mapState",[]),N(this,"_extent",void 0),N(this,"_eventsStatus",{}),N(this,"_coordFromMapClickPromise",void 0),N(this,"_mapEvents",{}),this.mapAdapter=t.mapAdapter,this._starterKits=t.starterKits||[],t&&(this.options=(0,l.vb)(Q||{},t)),this.options.runtimeParams&&(this.runtimeParams=this.options.runtimeParams),this._addEventsListeners(),this.options.tileJson&&this._setTileJsonOptions(this.options.tileJson),this.options.create&&this.create()}var t,r,n,o,i,a;return t=e,(r=[{key:"getId",value:function(){return this.id}},{key:"create",value:(a=J(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.getEventStatus("create")){e.next=6;break}return e.next=3,this._setInitMapState(this.mapState);case 3:return e.next=5,this._setupMap();case 5:this._emitStatusEvent("create",this);case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"setRuntimeParams",value:function(e){this.runtimeParams.push(e)}},{key:"destroy",value:function(){this._removeEventListeners(),function(e){for(var t in e)delete e[t]}(this._emitStatusEvent),this.mapAdapter.destroy&&this.mapAdapter.destroy()}},{key:"getState",value:function(){var e={};return this._mapState.forEach((function(t){e[t.name]=t.getValue()})),e}},{key:"getRuntimeParams",value:function(){var e=this,t={};return this._mapState.forEach((function(r){var n,o=I(e.runtimeParams);try{for(o.s();!(n=o.n()).done;){var i=n.value.get(r.name);if(void 0!==i){t[r.name]=r.parse(i);break}}}catch(e){o.e(e)}finally{o.f()}})),t}},{key:"getContainer",value:function(){if(this.mapAdapter.getContainer)return this.mapAdapter.getContainer();if(this.options.target){if(this.options.target instanceof HTMLElement)return this.options.target;if("string"==typeof this.options.target){var e=document.getElementById(this.options.target);if(e)return e}}}},{key:"setCursor",value:function(e){this.mapAdapter.setCursor&&this.mapAdapter.setCursor(e)}},{key:"getCursor",value:function(){if(this.mapAdapter.getCursor)return this.mapAdapter.getCursor();var e=this.getContainer();return e?e.style.cursor:void 0}},{key:"setCenter",value:function(e){return this.mapAdapter.setCenter(e),this}},{key:"getCenter",value:function(){return this.mapAdapter.getCenter()}},{key:"getBounds",value:function(){if(this.mapAdapter.getBounds)return this.mapAdapter.getBounds()}},{key:"getBoundsPolygon",value:function(){var e=this.getBounds();if(e)return(0,l.pv)(e)}},{key:"setZoom",value:function(e){return this.mapAdapter.setZoom(e),this}},{key:"getZoom",value:function(){return this.mapAdapter.getZoom()}},{key:"zoomIn",value:function(){if(this.mapAdapter.zoomIn)this.mapAdapter.zoomIn();else{var e=this.getZoom();if(e){var t=e+1;this.setZoom(t)}}}},{key:"zoomOut",value:function(){if(this.mapAdapter.zoomOut)this.mapAdapter.zoomOut();else{var e=this.getZoom();if(e){var t=e-1;this.setZoom(t)}}}},{key:"setView",value:function(e,t){this.mapAdapter.setView&&e&&(0,l.ri)(t)?this.mapAdapter.setView(e,t):(e&&this.mapAdapter.setCenter(e),(0,l.ri)(t)&&this.mapAdapter.setZoom(t))}},{key:"fitBounds",value:function(e,t){return e.every((function(e){return(0,l.ri)(e)}))&&(e[1]<-85.06&&(e[1]=-85.06),e[3]>85.06&&(e[3]=85.06),this.mapAdapter.fitBounds(e,t)),this}},{key:"getEventStatus",value:function(e){var t=e,r=this._eventsStatus[t];return null!=r&&r}},{key:"onLoad",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"create";return new Promise((function(r){e.getEventStatus(t)?r(e):e.emitter.once(t,(function(){r(e)}))}))}},{key:"onMapLoad",value:function(e){var t=this;return new Promise((function(r){var n,o=function(){var n=t.mapAdapter;e&&e(n),n&&r(n)},i=null===(n=t.mapAdapter.isLoaded)||void 0===n||n;t.mapAdapter.map&&i?o():t.mapAdapter.emitter.once("create",(function(){o()}))}))}},{key:"getLayerAdapters",value:function(){return this.mapAdapter.layerAdapters}},{key:"getLayerAdapter",value:function(e){return this.mapAdapter.layerAdapters[e]}},{key:"locate",value:function(e,t){return this.mapAdapter&&this.mapAdapter.locate?this.mapAdapter.locate(e,t):{stop:function(){return{}}}}},{key:"stopGetCoordFromMapClick",value:function(){this._coordFromMapClickPromise&&this._coordFromMapClickPromise.cancel()}},{key:"getCoordFromMapClick",value:function(){var e=this;return this._coordFromMapClickPromise?this.getCoordFromMapClick():(this._coordFromMapClickPromise=new f.Z((function(t,r,n){var o=e.getCursor()||"grab";e._removeEventListeners({include:["click"]}),e.setCursor("crosshair");var i=function(){e.setCursor(o),e._addEventsListeners({include:["click"]}),e.mapAdapter.emitter.off("click",a),e._coordFromMapClickPromise=void 0},a=function(e){i(),(0,l.Vc)(e),t(e.lngLat)};e.mapAdapter.emitter.once("click",a),n(i)})),this._coordFromMapClickPromise)}},{key:"_emitStatusEvent",value:function(e,t){var r=e;this._eventsStatus[r]=!0,this.emitter.emit(r,t)}},{key:"_addLayerProviders",value:(i=J(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"_onLoadSync",value:(o=J(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return o.apply(this,arguments)})},{key:"_setupMap",value:(n=J(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mapAdapter){e.next=2;break}throw new Error("WebMap `mapAdapter` option is not set");case 2:return e.next=4,this.mapAdapter.create(this.options);case 4:return this._zoomToInitialExtent(),e.next=7,this._addLayerProviders();case 7:return e.next=9,this._onLoadSync();case 9:return this._emitStatusEvent("build-map",this.mapAdapter),e.abrupt("return",this);case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_setTileJsonOptions",value:function(e){e.center&&(this.options.center=e.center),e.bounds&&(this.options.bounds=e.bounds),(0,l.ri)(e.maxzoom)&&(this.options.maxZoom=e.maxzoom,this.options.zoom=e.maxzoom),(0,l.ri)(e.minzoom)&&(this.options.minZoom=e.minzoom,this.options.zoom=e.minzoom),(0,l.ri)(e.maxzoom)&&(0,l.ri)(e.minzoom)&&(this.options.zoom=(e.maxzoom+e.minzoom)/2)}},{key:"_zoomToInitialExtent",value:function(){var e=this.options,t=e.center,r=e.zoom,n=e.bounds;this._extent?this.fitBounds(this._extent):t&&r?this.setView(t,r):n&&this.fitBounds(n)}},{key:"_setInitMapState",value:function(e){var t,r=I(e);try{for(r.s();!(t=r.n()).done;){var n=new(0,t.value)(this);this._mapState.push(n);var o,i=I(this.runtimeParams);try{for(i.s();!(o=i.n()).done;){var a=o.value.get(n.name);if(void 0!==a){var s=n.parse(a);this._initMapState[n.name]=s,Object.defineProperty(this.options,n.name,{value:s,configurable:!0,enumerable:!0});break}}}catch(e){i.e(e)}finally{i.f()}}}catch(e){r.e(e)}finally{r.f()}}},{key:"_addEventsListeners",value:function(e){var t=this,r=["preclick","click","zoomstart","zoom","zoomend","movestart","move","moveend"];e&&e.include&&(r=r.filter((function(t){return e.include.includes(t)}))),r.forEach((function(e){t._mapEvents[e]=function(r){if(t.runtimeParams.length){var n=t._mapState.find((function(t){return t.event===e}));if(n){var o=n.toString(n.getValue());t.runtimeParams.forEach((function(e){e.set(n.name,o)}))}}t._eventsStatus&&t.emitter.emit(e,r)};var r=t._mapEvents[e];r&&t.mapAdapter.emitter.on(e,r)}))}},{key:"_removeEventListeners",value:function(e){var t=this,r=Object.entries(this._mapEvents);e&&e.include&&(r=r.filter((function(t){return e.include.includes(t[0])}))),r.forEach((function(e){var r,n,o=(n=2,function(e){if(Array.isArray(e))return e}(r=e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(s)throw o}}return i}}(r,n)||Z(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];a&&t.mapAdapter.emitter.removeListener(i,a)}))}}])&&G(t.prototype,r),e}();function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){oe(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function q(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function $(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){q(i,n,o,a,s,"next",e)}function s(e){q(i,n,o,a,s,"throw",e)}a(void 0)}))}}function X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function te(e,t){if(t&&("object"===Y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return re(e)}function re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ie(e,t){var r=document.createElement("div"),n=!1;t.getStatus?n=t.getStatus():t.status&&(n=t.status);var o=t.title||"",i=t.html;function a(){o&&(r.title="string"==typeof o?o:n?o.on:o.off,r.setAttribute("aria-label",r.title))}function s(e){e instanceof HTMLElement?(r.innerHTML="",r.appendChild(e)):"string"==typeof e&&(r.innerHTML=e)}function u(){i&&("string"==typeof i||i instanceof HTMLElement?s(i):s(n?i.on:i.off),r.setAttribute("aria-label",r.title))}function c(e,t){e.split(" ").forEach((function(e){t?r.classList.add(e):r.classList.remove(e)}))}function l(){t.addClassOn&&c(t.addClassOn,n),t.addClassOff&&c(t.addClassOff,!n)}a(),u(),t.addClass&&c(t.addClass,!0),l();var f=function(e){void 0!==e&&(n=e),u(),a(),l()},p=function(e){if(n=void 0!==e?e:!n,t.onClick){var r=t.onClick(n);Promise.resolve(r).then((function(){return f()})).catch((function(){return n=!n}))}else f()},y=e({html:r,onClick:p});return y.onClick=p,y.changeStatus=f,y}function ae(e){return(ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function ue(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){se(i,n,o,a,s,"next",e)}function s(e){se(i,n,o,a,s,"throw",e)}a(void 0)}))}}function ce(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pe(e,t){if(t&&("object"===ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ye(e)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}N(H,"keys",new v),N(H,"getPaintFunctions",void 0);var ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(f,e);var t,r,n,o,i,a,s,u,c,l=(u=f,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=he(u);if(c){var r=he(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return pe(this,e)});function f(){var e;ce(this,f);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return de(ye(e=l.call.apply(l,[this].concat(r))),"_loadControlQueue",{"top-right":[],"bottom-right":[],"top-left":[],"bottom-left":[]}),de(ye(e),"_isControlLoading",{"top-right":!1,"bottom-right":!1,"top-left":!1,"bottom-left":!1}),e}return t=f,(r=[{key:"addControl",value:(s=ue(regeneratorRuntime.mark((function e(t,r,n){var o,i,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null!==(o=r)&&void 0!==o?o:"top-left",!(i="string"==typeof t?this.getControl(t,n):t)){e.next=4;break}return e.abrupt("return",new Promise((function(e){var t=function(){var t=ue(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i;case 2:n=t.sent,o=a.mapAdapter.addControl(n,r),e(o);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();a._setControlQueue(r,t)})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"createControl",value:(a=ue(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onLoad("build-map");case 2:if(!this.mapAdapter.createControl){e.next=4;break}return e.abrupt("return",this.mapAdapter.createControl(t,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"createButtonControl",value:(i=ue(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onLoad("build-map");case 2:if(!this.mapAdapter.createButtonControl){e.next=4;break}return e.abrupt("return",this.mapAdapter.createButtonControl(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"createToggleControl",value:(o=ue(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onLoad("build-map");case 2:if(!this.mapAdapter.createToggleControl){e.next=6;break}return e.abrupt("return",this.mapAdapter.createToggleControl(t));case 6:if(!this.mapAdapter.createButtonControl){e.next=8;break}return e.abrupt("return",ie(this.mapAdapter.createButtonControl,t));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"removeControl",value:function(e){var t=this;"remove"in e?e.remove():this.mapAdapter.removeControl&&Promise.resolve(e).then((function(e){t.mapAdapter.removeControl(e)}))}},{key:"getControl",value:function(e,t){var r=this.mapAdapter.controlAdapters[e];if(r)return new r(t);var n=f.controls[e];return n?n(this,t):void 0}},{key:"getControlContainer",value:function(){if(this.mapAdapter.getControlContainer)return this.mapAdapter.getControlContainer()}},{key:"_setControlQueue",value:function(e,t){this._loadControlQueue[e].push(t),this._isControlLoading[e]||this._applyControls(e)}},{key:"_applyControls",value:(n=ue(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._loadControlQueue[t].length){e.next=9;break}return this._isControlLoading[t]=!0,r=this._loadControlQueue[t][0],e.next=5,r();case 5:this._loadControlQueue[t].splice(0,1),this._applyControls(t),e.next=10;break;case 9:this._isControlLoading[t]=!1;case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}])&&le(t.prototype,r),f}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(v,e);var t,r,i,a,s,c,f,p,y,h,d=(y=v,h=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ne(y);if(h){var r=ne(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return te(this,e)});function v(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),oe(re(t=d.call(this,e)),"_layersIdCounter",1),oe(re(t),"_layersOrderCounter",1),oe(re(t),"_baselayers",[]),oe(re(t),"_layers",{}),oe(re(t),"_selectedLayers",[]);var r=t.options.tileJson;return r&&t.emitter.once("build-map",(function(){return t.addTileJsonLayer(r)})),t}return t=v,(r=[{key:"fitLayer",value:(p=$(regeneratorRuntime.mark((function e(t,r){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getLayer(t))||!n.getExtent){e.next=6;break}return e.next=4,n.getExtent();case 4:(o=e.sent)&&this.fitBounds(o,r);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"isBaseLayer",value:function(e){var t=this.getLayer(e);if(t&&t.id)return-1!==this._baselayers.indexOf(t.id)}},{key:"getBaseLayers",value:function(){var e=this,t=[];return this._baselayers.forEach((function(r){var n=e._layers[r];n&&t.push(n)})),t}},{key:"getBaseLayersIds",value:function(){return this._baselayers}},{key:"getLayer",value:function(e){return"string"==typeof e?this._layers[e]:e}},{key:"getLayerId",value:function(e){var t=this.getLayer(e);if(t&&t.options)return t.options.id;throw new Error("No id for layer")}},{key:"getLayers",value:function(){return Object.keys(this._layers)}},{key:"allLayers",value:function(){return this._layers}},{key:"orderedLayers",value:function(){return Object.values(this._layers).sort((function(e,t){return e.order&&t.order?e.order-t.order:0}))}},{key:"findLayer",value:function(e){for(var t in this._layers){var r=this._layers[t];if(e(r))return r}}},{key:"isLayerVisible",value:function(e){var t=this.getLayer(e);return!(!t||void 0===t.options.visibility)&&t.options.visibility}},{key:"addBaseLayer",value:(f=$(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.addLayer(t,W(W({},r),{},{baselayer:!0}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return f.apply(this,arguments)})},{key:"addLayer",value:(c=$(regeneratorRuntime.mark((function e(t){var r,n,o,i,a,s,u,c,l,f,p,y,h,d,v,m,b,g,k=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=k.length>1&&void 0!==k[1]?k[1]:{},o=k.length>2?k[2]:void 0,i=this._layersIdCounter++,a=void 0!==o?o:void 0!==n.order?n.order:this.reserveOrder(),"string"!=typeof t){e.next=8;break}s=this.getLayerAdapter(t),e.next=16;break;case 8:if("function"!=typeof t){e.next=12;break}s=t,e.next=16;break;case 12:if(!("then"in t)){e.next=16;break}return e.next=15,t;case 15:s=e.sent;case 16:if(u=n,this._updateGeoJsonOptions(u),c=this.options,l=c.maxZoom,f=c.minZoom,n=W({id:String(i),order:a,maxZoom:l,minZoom:f},n),p=null===(r=n.visibility)||void 0===r||r,n.visibility=!1,n.baselayer&&(n.order=0),this.options.onBeforeAddLayer&&(y=this.options.onBeforeAddLayer({options:n,adapter:s}))&&(y.options&&(n=y.options),y.adapter&&(s=y.adapter)),void 0===s){e.next=63;break}return(d=new s(this.mapAdapter.map,n)).options=W(W({},n),d.options),d.options.baselayer&&(n.baselayer=!0,n.order=0,d.options.order=0),d.options.id&&(v=String(d.options.id),this._layers[v]=d),this._emitLayerEvent("layer:preadd",v||"",d),e.next=32,this.onMapLoad();case 32:return d.map=this.mapAdapter.map,e.next=35,d.addLayer(d.options);case 35:if(m=e.sent,d.layer=m,d.id=d.options.id||String(i),d.options.id=d.id,n.baselayer&&(d.options.order=0),d.order=null!==(h=d.options.order)&&void 0!==h?h:a,v&&delete this._layers[v],v=String(d.id),!this._layers[v]){e.next=45;break}throw Error("layer with id '".concat(v,"' already exist"));case 45:if(!v){e.next=52;break}if(this._layers[v]=d,u.filter&&this.filterLayer(d,u.filter),n.baselayer&&this._baselayers.push(v),!p){e.next=52;break}return e.next=52,this.showLayer(v);case 52:if(void 0!==(b=n.opacity)&&b<=1&&this.setLayerOpacity(d,b),!n.fit||!d.getExtent){e.next=61;break}return e.next=57,d.getExtent();case 57:if(!(g=e.sent)){e.next=61;break}return e.next=61,this.fitBounds(g);case 61:return this._emitLayerEvent("layer:add",v,d),e.abrupt("return",d);case 63:return e.abrupt("return",Promise.reject("No adapter"));case 64:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"addLayerFromAsyncAdapter",value:(s=$(regeneratorRuntime.mark((function e(t,r,n){var o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n||void 0!==r.order?r.order:this.reserveOrder(),i=t(),e.next=5,i;case 5:if(!(a=e.sent)){e.next=8;break}return e.abrupt("return",this.addLayer(a,r,o));case 8:return e.abrupt("return",Promise.reject("No adapter"));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return s.apply(this,arguments)})},{key:"removeLayers",value:function(e){for(var t in this._layers){var r=!0;e&&(r=e(t,this._layers[t])),r&&(this.removeLayer(t),delete this._layers[t])}}},{key:"reserveOrder",value:function(){return this._layersOrderCounter++}},{key:"removeOverlays",value:function(){this.removeLayers((function(e,t){return!(t&&t.options&&t.options.baselayer)}))}},{key:"removeLayer",value:function(e){var t=this.getLayer(e),r=t&&this.getLayerId(t);if(t&&r){if(this.emitter.emit("layer:preremove",t),t.beforeRemove&&t.beforeRemove(),t.removeLayer?t.removeLayer():this.mapAdapter.removeLayer(t.layer),t.options&&t.options.baselayer){var n=this._baselayers.indexOf(r);n&&this._baselayers.splice(n,1)}delete this._layers[r],this.emitter.emit("layer:remove",t)}}},{key:"addGeoJsonLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(e=e||{}).multiselect=void 0!==e.multiselect&&e.multiselect,e.unselectOnSecondClick=void 0===e.unselectOnSecondClick||e.unselectOnSecondClick,t||(e=u(e)),e.paint=e.paint||{},this.addLayer(t||"GEOJSON",e)}},{key:"addFeatureLayer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.addGeoJsonLayer(e)}},{key:"showLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toggleLayer(e,!0,t)}},{key:"hideLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.toggleLayer(e,!1,t)}},{key:"toggleLayer",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.getLayer(e),i=o&&o.options.visibility,a=void 0!==t?t:!i,s=void 0!==n.silent&&n.silent,u=function(e){var t=String(e.id),n=a?"layer:preshow":"layer:prehide",o=a?"layer:show":"layer:hide";if(s||(r._emitLayerEvent(n,t,e),r._emitLayerEvent("layer:pretoggle",t,e)),a&&r.mapAdapter){var i=e.options.baselayer?0:e.options.order;if(e.options.baselayer&&r._baselayers.length){var u=r._baselayers.find((function(t){return t!==e.id&&r.isLayerVisible(t)}));u&&r.hideLayer(u)}e.showLayer?e.showLayer.call(e,e.layer):void 0!==e.layer&&r.mapAdapter.showLayer(e.layer),void 0!==i&&r.mapAdapter.setLayerOrder(e.layer,i,r._layers)}else e.hideLayer?e.hideLayer.call(e,e.layer):void 0!==e.layer&&r.mapAdapter.hideLayer(e.layer);s||(r._emitLayerEvent(o,t,e),r._emitLayerEvent("layer:toggle",t,e)),e.options.visibility=a};return o&&o.options.visibility!==a?this.onMapLoad().then((function(){return u(o)})):Promise.resolve()}},{key:"updateLayer",value:function(e){var t=this.getLayer(e);t&&(t.updateLayer?t.updateLayer():this.isLayerVisible(t)&&(this.hideLayer(t,{silent:!0}),this.showLayer(t,{silent:!0})))}},{key:"setLayerOpacity",value:function(e,t){var r=this.getLayer(e);r&&(r.setOpacity?r.setOpacity(t):this.mapAdapter.setLayerOpacity&&this.mapAdapter.setLayerOpacity(r.layer,t))}},{key:"selectLayer",value:function(e,t){var r=this.getLayer(e);if(r){var n=r;n&&n.select&&n.select(t);var o=this.getLayerId(r);o&&this._selectedLayers.push(o)}}},{key:"unSelectLayer",value:function(e,t){var r=this.getLayer(e);if(r){var n=r&&r;n.unselect&&n.unselect(t);var o=this.getLayerId(r);if(o){var i=this._selectedLayers.indexOf(o);-1!==i&&this._selectedLayers.splice(i,1)}}}},{key:"unSelectLayers",value:function(){for(var e,t=0,r=Object.values(this.allLayers());t<r.length;t++)(e=r[t]).unselect&&e.unselect()}},{key:"filterLayer",value:function(e,t){var r=this.getLayer(e);return r.filter?r.filter(t):[]}},{key:"propertiesFilter",value:function(e,t,r){var n=this.getLayer(e);if(n){var i=n;i.propertiesFilter?i.propertiesFilter(t,r):i.filter&&this.filterLayer(i,(function(e){return!e.feature||!e.feature.properties||(0,o.Ml)(e.feature.properties,t)}))}}},{key:"removeLayerFilter",value:function(e){var t=this.getLayer(e);t.removeFilter?t.removeFilter():t.filter&&t.filter((function(){return!0}))}},{key:"setLayerData",value:function(e,t){var r=this.getLayer(e);if(r){if(r.setData)return r.setData(t);if(r.clearLayer&&r.addData)return r.clearLayer(),r.addData(t)}return Promise.resolve()}},{key:"addLayerData",value:function(e,t){var r=this.getLayer(e);r.addData&&r.addData(t)}},{key:"clearLayerData",value:function(e,t){var r=this.getLayer(e);r&&r.clearLayer&&r.clearLayer(t)}},{key:"getAttributions",value:function(e){var t=[];for(var r in this._layers){var n=this._layers[r],o=!(void 0===e.onlyVisible||e.onlyVisible)||n.options.visibility;if(o&&e.onlyBaselayer&&(o=this._baselayers.includes(r)),o){var i=n.options&&n.options.attribution;i&&t.push(i)}}return t}},{key:"getActiveBaseLayer",value:function(){var e=this,t=this.getBaseLayers().find((function(t){return e.isLayerVisible(t)}));if(t)return this.getLayer(t)}},{key:"addTileJsonLayer",value:function(e){var t=e.tiles[0];return this.addLayer("TILE",{url:t,maxZoom:e.maxzoom,minZoom:e.minzoom,subdomains:e.scheme,attribution:e.attribution})}},{key:"_onLayerClick",value:(a=$(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.layer.id,this._emitLayerEvent("layer:click",r||"",t),e.abrupt("return",Promise.resolve(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_onLayerSelect",value:(i=$(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._emitLayerEvent("layer:select",t.layer.id||"",t),e.abrupt("return",Promise.resolve(t));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"_updateGeoJsonOptions",value:function(e){var t=this,r=e.onSelect,o=e.onLayerSelect,i=e.onClick,a=e.onLayerClick,s=e.onMouseOut,u=e.onMouseOver,c=i||a;e.onClick=function(e){return c&&c(e),t._onLayerClick(e)},e.onMouseOut=function(e){var r=e.layer.id;s&&s(e),(0,l.ri)(r)&&t._emitLayerEvent("layer:mouseout",r,e)},e.onMouseOver=function(e){var r=e.layer.id;u&&u(e),(0,l.ri)(r)&&t._emitLayerEvent("layer:mouseover",r,e)};var f=r||o;e.onSelect=function(e){return f&&f(e),t._onLayerSelect(e)},e.nativePaint||(this.options.paint&&(e.paint=(0,n.Yx)(e.paint||{},this.options.paint,this.getPaintFunctions)),e.selectedPaint&&this.options.selectedPaint&&(e.selectedPaint=(0,n.Yx)(e.selectedPaint,this.options.selectedPaint,this.getPaintFunctions)))}},{key:"_emitLayerEvent",value:function(e,t,r){if((0,l.ri)(t)&&e.startsWith("layer:")){var n=e.replace("layer:","layer-"+t+":");this.emitter.emit(n,r)}this.emitter.emit(e,r)}}])&&X(t.prototype,r),v}(H));de(ve,"controls",{CONTROL:function(e,t){return e.createControl(t.control,t.options)},BUTTON:function(e,t){return e.createButtonControl(t)},TOGGLE:function(e,t){return e.createToggleControl(t)}});var me={};function be(e){return(be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ge=["position"];function ke(e,t,r,n,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function we(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ke(i,n,o,a,s,"next",e)}function s(e){ke(i,n,o,a,s,"throw",e)}a(void 0)}))}}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oe(e,t){if(t&&("object"===be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return xe(e)}function xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pe(e){var t;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)}var Se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(c,e);var t,r,n,o,i,a,s,u=(a=c,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ce(a);if(s){var r=Ce(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Oe(this,e)});function c(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this,e))._addControls(),r=t.id,n=xe(t),me[r]=n,t}return t=c,n=[{key:"get",value:function(e){return function(e){return me[e]}(e)}}],(r=[{key:"_addLayerProviders",value:(i=we(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a,s,u,c,l,f,p,y,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!1,r=!1,e.prev=3,o=Pe(this._starterKits);case 5:return e.next=7,o.next();case 7:if(!(t=!(i=e.sent).done)){e.next=48;break}if(!(a=i.value).getLayerAdapters){e.next=45;break}return e.next=12,a.getLayerAdapters.call(a);case 12:if(!(s=e.sent)){e.next=45;break}u=!1,c=!1,e.prev=16,f=Pe(s);case 18:return e.next=20,f.next();case 20:if(!(u=!(p=e.sent).done)){e.next=29;break}return y=p.value,e.next=24,y.createAdapter(this);case 24:(h=e.sent)&&(this.mapAdapter.layerAdapters[y.name]=h);case 26:u=!1,e.next=18;break;case 29:e.next=35;break;case 31:e.prev=31,e.t0=e.catch(16),c=!0,l=e.t0;case 35:if(e.prev=35,e.prev=36,!u||null==f.return){e.next=40;break}return e.next=40,f.return();case 40:if(e.prev=40,!c){e.next=43;break}throw l;case 43:return e.finish(40);case 44:return e.finish(35);case 45:t=!1,e.next=5;break;case 48:e.next=54;break;case 50:e.prev=50,e.t1=e.catch(3),r=!0,n=e.t1;case 54:if(e.prev=54,e.prev=55,!t||null==o.return){e.next=59;break}return e.next=59,o.return();case 59:if(e.prev=59,!r){e.next=62;break}throw n;case 62:return e.finish(59);case 63:return e.finish(54);case 64:e.next=69;break;case 66:throw e.prev=66,e.t2=e.catch(0),new Error(e.t2);case 69:case"end":return e.stop()}}),e,this,[[0,66],[3,50,54,64],[16,31,35,45],[36,,40,44],[55,,59,63]])}))),function(){return i.apply(this,arguments)})},{key:"_onLoadSync",value:(o=we(regeneratorRuntime.mark((function e(){var t,r,n,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,r=!1,e.prev=2,o=Pe(this._starterKits);case 4:return e.next=6,o.next();case 6:if(!(t=!(i=e.sent).done)){e.next=20;break}if(!(a=i.value).onLoadSync){e.next=17;break}return e.prev=9,e.next=12,a.onLoadSync.call(a,this);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),console.error(e.t0);case 17:t=!1,e.next=4;break;case 20:e.next=26;break;case 22:e.prev=22,e.t1=e.catch(2),r=!0,n=e.t1;case 26:if(e.prev=26,e.prev=27,!t||null==o.return){e.next=31;break}return e.next=31,o.return();case 31:if(e.prev=31,!r){e.next=34;break}throw n;case 34:return e.finish(31);case 35:return e.finish(26);case 36:case"end":return e.stop()}}),e,this,[[2,22,26,36],[9,14],[27,,31,35]])}))),function(){return o.apply(this,arguments)})},{key:"_addControls",value:function(){var e=this;this.options.controls&&this.options.controls.forEach((function(t){var r=t,n={};"string"==typeof t&&e.options.controlsOptions&&e.options.controlsOptions[t]&&void 0!==(n=e.options.controlsOptions[t]).control&&(r=n.control);var o=n,i=o.position,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(o,ge);e.addControl(r,i||"top-left",a)})),this._emitStatusEvent("controls:create")}}])&&_e(t.prototype,r),n&&_e(t,n),c}(ve)}}]);
//# sourceMappingURL=main-1efbafe1f7ef31d.js.map