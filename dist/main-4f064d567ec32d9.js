"use strict";(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[42],{7036:function(e,t,n){n(5666),n(1539),n(8674),n(7941),n(2526),n(7327),n(5003),n(4747),n(9337),n(2479),n(2222),n(9600),n(1249),n(8309),n(7042),n(1038),n(8783),n(1817),n(2165),n(6992),n(3948);var r=n(2010),o=n.n(r),i=n(9653),a=n(757),s=n(8907),c=n(5020),u=n(5502),l=(n(941),n(8956)),f=n.n(l);function p(e){return"string"==typeof e&&(t=e,new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t))?'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>"):e;var t}function h(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,s,"next",e)}function s(e){h(i,r,o,a,s,"throw",e)}a(void 0)}))}}function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(4916),n(5306),n(4603),n(9714);var g=function(){function e(){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=void 0,(t="ngwMap")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n}var t,n,r,o;return t=e,(n=[{key:"setNgwMap",value:function(e){this.ngwMap=e}},{key:"createPopupContent",value:function(e,t,n){var r=document.createElement("div");r.className="columns",r.style.minWidth="300px",r.style.maxWidth="700px";var o=document.createElement("div");return o.style.maxHeight="300px",o.style.maxWidth="350px",o.style.overflow="auto",o.className="column properties",t&&(r.innerHTML="Загрузка",this.getPropertiesContent(t,e).then((function(e){r.innerHTML="",e&&(o.innerHTML=e),r.appendChild(o)})),n&&n.length&&this._addPhotos(r,n,t,Number(e.id))),r}},{key:"createPropertiesHtml",value:function(e){var t,n='<table class="table"><tbody>',r=v(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,i=o.key,a=o.value,s=String(a);"object"===m(a)&&a&&("year"in a?s=[a.day,a.month,a.year].join("."):"hour"in a&&(s=[a.hour,a.minute].join(":"))),n+="\n      <tr>\n        <th>".concat(i,"</th>\n        <td>").concat(p(s),"</td>\n      </tr>\n      ")}}catch(e){r.e(e)}finally{r.f()}return n+"</tbody></table>"}},{key:"getPropertiesContent",value:(o=d(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ngwMap.connector.getResource(t);case 2:if(!(r=e.sent)||!r.feature_layer){e.next=7;break}return o=[],r.feature_layer.fields.forEach((function(e){if(e.grid_visibility){var t=n.properties[e.keyname];t&&o.push({key:e.display_name,value:t})}})),e.abrupt("return",this.createPropertiesHtml(o));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_addPhotos",value:(r=d(regeneratorRuntime.mark((function e(t,n,r,o){var i,a,s,c,u,l,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(i=document.createElement("div")).style.width="300px",i.className="column carousel attachment",a=v(n),e.prev=4,a.s();case 6:if((s=a.n()).done){e.next=21;break}return c=s.value,(u=document.createElement("figure")).className="image",e.next=14,this._loadImage(c,{width:350,height:350,id:r,fid:o});case 14:l=e.sent,(p=document.createElement("img")).src=l,u.appendChild(p),i.appendChild(u);case 19:e.next=6;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(4),a.e(e.t0);case 26:return e.prev=26,a.f(),e.finish(26);case 29:t.appendChild(i),f().attach(i,{slidesToShow:1});case 31:case"end":return e.stop()}}),e,this,[[4,23,26,29]])}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"_loadImage",value:function(e,t){var n=this;return new Promise((function(r,o){var i=t.width,a=t.height,s="/api/resource/"+t.id+"/feature/"+t.fid+"/attachment/".concat(e.id,"/image")+(i&&a?"?size=".concat(i,"x").concat(a):"");n.ngwMap.connector.makeQuery(s,{},{responseType:"blob"}).then((function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){r(t.result)}})).catch((function(e){o(e)}))}))}}])&&b(t.prototype,n),e}(),_=n(6273),w=n.n(_);function k(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C="Загрузка данных...",P=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,M(this,"_container",document.createElement("div")),M(this,"_content",void 0),M(this,"_toggle",void 0),M(this,"status",void 0),this.status=void 0===this.options.open||this.options.open,this._updateContainer(),this.options.parent&&this.options.parent.appendChild(this.getContainer())}var t,n,r,o;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"open",value:function(){!this._content||this._content.innerHTML&&this._content.innerHTML!==C||this._updateContent(),this._toggle&&(this._toggle.innerHTML=this._getToggleButtonHtml("fas fa-chevron-up")),this.status=!0}},{key:"close",value:function(){this._cleanContent(),this._toggle&&(this._toggle.innerHTML=this._getToggleButtonHtml("fas fa-chevron-down")),this.status=!1}},{key:"toggle",value:function(){this.status?this.close():this.open()}},{key:"_getToggleButtonHtml",value:function(e){return'\n    <a class="button is-small">\n    <span class="icon is-small">\n      <i class="'.concat(e,'"></i>\n    </span>\n    </a>\n    ')}},{key:"_updateContainer",value:function(){if(this._container.innerHTML="",this.options.title){var e=this._createHeader();this._container.appendChild(e)}var t=document.createElement("div");t.innerHTML=C,t.className="panel-content",this._content=t,this._container.appendChild(t),this.status?this.open():this.close()}},{key:"_createHeader",value:function(){var e=this,t=document.createElement("div");t.className="level is-mobile panel-header";var n=document.createElement("div");n.className="level-left";var r=document.createElement("div");r.className="level-item panel-header__title",r.innerHTML=this.options.title||"",n.appendChild(r);var o=document.createElement("div");o.className="level-right";var i=document.createElement("div");return i.className="level-item panel-header__toggle",o.appendChild(i),i.onclick=function(){e.toggle()},this._toggle=i,t.appendChild(n),t.appendChild(o),t}},{key:"_cleanContent",value:function(){this._content&&(this._content.innerHTML="")}},{key:"_updateContent",value:(r=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cleanContent(),!this._content){e.next=11;break}if("function"!=typeof this.options.content){e.next=8;break}return e.next=5,this.options.content();case 5:e.t0=e.sent,e.next=9;break;case 8:e.t0=this.options.content;case 9:t=e.t0,this._content.appendChild(t);case 11:return e.abrupt("return",this._content);case 12:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){k(i,n,o,a,s,"next",e)}function s(e){k(i,n,o,a,s,"throw",e)}a(void 0)}))},function(){return o.apply(this,arguments)})}])&&O(t.prototype,n),e}(),j=n(9256);function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=function(){function e(t){var n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=void 0,(n="_container")in this?Object.defineProperty(this,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):this[n]=r;var o=this._createTreeItem(t);o&&(this._container=o)}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createTreeBranch",value:function(e){var t=this,n=document.createElement("div");return n.className="tree-container__item-children",e.forEach((function(e){if(e.item){var r=t._createTreeItem(e);r&&n.appendChild(r)}})),n}},{key:"_createTreeItem",value:function(e){var t=e.item;if(!t)return!1;var n=document.createElement("div");if(n.className="tree-container__item",t.display_name){var r=document.createElement("input");r.setAttribute("type","checkbox");var o=e.properties.property("visibility");r.checked=!!o.get(),o&&(o.emitter.on("change",(function(e){r.checked=e.value})),r.onclick=function(){o.set(r.checked,{propagation:j.y9.keys.pressed("ctrl")})});var i=document.createElement("span");i.innerHTML=t.display_name,n.appendChild(r),n.appendChild(i)}if("group"===t.item_type||"root"===t.item_type&&t.children.length){var a=e.tree.getChildren(),s=this._createTreeBranch(a.reverse());n.appendChild(s)}return n}}])&&E(t.prototype,n),e}();function S(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,x(this,"ngwMap",void 0),x(this,"_container",void 0),x(this,"_baseMapsContainer",void 0),this.ngwMap=t.ngwMap,this._container=this._createContainer(),this.ngwMap.emitter.on("layer:add",(function(e){n.ngwMap.isBaseLayer(e)&&n._updateBaseMapContainer()}))}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var e=document.createElement("div");e.className="basemaps-contentainer panel-content-padding control";var t=document.createElement("div");return t.className="basemaps-contentainer__layers",this._baseMapsContainer=t,e.appendChild(t),this._updateBaseMapContainer(),e}},{key:"_updateBaseMapContainer",value:function(){var e=this;this._baseMapsContainer&&(this._baseMapsContainer.innerHTML=""),this._createBaseMapItem(),this.ngwMap.getBaseLayers().forEach((function(t){var n=e.ngwMap.getLayer(t);n&&e._createBaseMapItem(n)}))}},{key:"_createBaseMapItem",value:function(e){var t=this,n=document.createElement("div");n.className="control";var r=document.createElement("label");r.className="radio basemap-container__item";var o=document.createElement("input");o.setAttribute("type","radio"),o.setAttribute("name","basemap"),o.checked=!!e&&this.ngwMap.isLayerVisible(e),o.onclick=function(){if(e&&e.id)t.ngwMap.toggleLayer(e.id,o.checked);else{var n=t.ngwMap.getActiveBaseLayer();n&&t.ngwMap.hideLayer(n)}};var i=e&&(e.name||e.options.name)||"Blank",a=document.createTextNode(i);r.appendChild(o),r.appendChild(a),n.appendChild(r),this._baseMapsContainer&&this._baseMapsContainer.appendChild(n)}}])&&S(t.prototype,n),e}(),T=(n(9826),n(5243));function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,R(this,"ngwMap",void 0),R(this,"_container",void 0),this.ngwMap=t.ngwMap,this._container=this._createContainer()}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var e=this,t=document.createElement("div");t.className="bookmarks-contentainer panel-content-padding ";var n=document.createElement("div");return n.className="bookmarks-contentainer__layers",this.options.bookmarks.forEach((function(n){e.ngwMap.connector.get("resource.item",null,{id:n.id}).then((function(r){if(r.feature_layer){var o=r.feature_layer.fields.find((function(e){return e.label_field}));o&&e.ngwMap.fetchNgwLayerItems({resourceId:n.id}).then((function(n){n.forEach((function(n){var r=e._createBookmarkItem(n,o.keyname);t.appendChild(r)}))}))}}))})),t.appendChild(n),t}},{key:"_createBookmarkItem",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"name",r=document.createElement("div");r.className="tree-container__item bookmark";var o=document.createElement("div"),i=e.fields[n];return o.innerHTML=String(i),o.onclick=function(){var n=new T.GeoJSON(e.geom),r=t.ngwMap.mapAdapter.map;r&&r.fitBounds(n.getBounds())},r.appendChild(o),r}}])&&A(t.prototype,n),e}();function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ms",n=e.getTime();return"s"===t?n/1e3:e.toISOString()}n(8304),n(489),n(2419),n(4819);var B=n(8527),F=n(8809),H=[[24,"1 день"],[48,"2 дня"],[72,"3 дня"],[96,"4 дня"],[120,"5 дней"],[144,"6 дней"],[168,"неделя"]],U=new Date;function z(e,t){var n=t?t.getTime():Date.now();return[n-1e3*Number(e)*60*60,n].map((function(e){return new Date(e)}))}function q(e,t,n){var r=t.props,o=r.timeUnit,i=r.dateField;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"s";return z(e,arguments.length>2?arguments[2]:void 0).map((function(e){return"ISO"===t?new Date(e).toISOString():"s"===t?Math.ceil(e.getTime())/1e3:e.getTime()}))}(e,o,n).map((function(e,t){return[i,t?"le":"ge",e]}))}setInterval((function(){U=new Date}),36e5);var $=n(1344);function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(3123),n(3210);var J=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,W(this,"ngwMap",void 0),W(this,"_container",void 0),this.ngwMap=t.ngwMap,this._container=this._createContainer()}var t,n;return t=e,(n=[{key:"getContainer",value:function(){return this._container}},{key:"_createContainer",value:function(){var e=document.createElement("div");e.className="fires-contentainer panel-content-padding ";var t=document.createElement("div");t.className="fires-contentainer__layers";var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.options.layers);try{for(r.s();!(n=r.n()).done;){var o=n.value;this._createFireItem(o,t)}}catch(e){r.e(e)}finally{r.f()}return e.appendChild(t),e}},{key:"onLayerAdd",value:function(e,t){var n=this,r=this.options.ngwMap,o=r&&r.getLayer(e);if(o)t(o);else{this.ngwMap.emitter.on("layer:add",(function r(o){o.id===e&&(t(o),n.ngwMap.emitter.off("layer:add",r))}))}}},{key:"_createFireItem",value:function(e,t){var n=this,r=document.createElement("div");r.className="tree-container__item";var o=e.id;if((0,$.ri)(o)){var i=document.createElement("div");i.innerHTML="загрузка...",t.appendChild(i),this.onLayerAdd(o,(function(t){return function(t){var a=t.item;if(i.innerHTML="",a){var s=document.createElement("input");s.setAttribute("type","checkbox"),s.checked=!0,s.onclick=function(){n.ngwMap.toggleLayer(o,s.checked)};var c=document.createElement("span"),u=a.resource.display_name.split("__")[0];c.innerHTML=u.replace("fires","").trim();var l=n._createSymbol(e);r.appendChild(s),r.appendChild(l),r.appendChild(c),i.appendChild(r)}}(t)}))}}},{key:"_createSymbol",value:function(e){var t,n=document.createElement("span");n.className="item-symbol";var r=null===(t=e.adapterOptions)||void 0===t?void 0:t.paint,o=r.color,i=r.stroke,a=r.strokeColor;return"string"==typeof o&&(n.style.color=o,n.style.backgroundColor=o),i&&"string"==typeof a&&(n.style.borderColor=a),n}}])&&V(t.prototype,n),e}();function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e,t,n){return(re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ae(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ae(r);if(o){var n=ae(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ie(this,e)});function a(){return te(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"_createContainer",value:function(){var e=re(ae(a.prototype),"_createContainer",this).call(this),t=this._createCalendar();return e.insertBefore(t,e.firstChild),e}},{key:"_createCalendar",value:function(){var e=this,t=document.createElement("div"),n=this.options.layers,r=[];return n.forEach((function(t){var n=t.id;if(n){var o=new Promise((function(t){e.onLayerAdd(n,t)}));r.push(o)}})),Promise.all(r).then((function(n){var r=e._buildCalendarBlock(n,e.options.dateRange,e.options.defaultDateRange);t.appendChild(r)})),t}},{key:"_buildCalendarBlock",value:function(e,t,n){var r=this,o=X(t,2),i=o[0],a=o[1],s=X(n,2),c=s[0],u=s[1],l={timedelta:this.options.timedelta,onChange:function(t){var n,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Y(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=i.options.props||{},s=a.dateField,c=a.timeUnit;if(s){var u=[];t.start&&u.push([s,"ge",N(t.start,c)]),t.end&&u.push([s,"le",N(t.end,c)]),i.propertiesFilter&&i.propertiesFilter(u)}}}catch(e){o.e(e)}finally{o.f()}r.options.onDateChange&&r.options.onDateChange()}};return i&&(l.minDate=i),c&&(l.startDate=c),a&&(l.maxDate=a),u&&(l.endDate=u),function(e){var t=document.createElement("div");t.className="field is-horizontal",t.innerHTML='\n    <div class="field">\n        <input class="input input-from is-small" type="text" >\n    </div>\n\n    <div class="select is-small">\n      <select class="select-input">\n        '.concat(H.map((function(t){return"<option ".concat(e.timedelta===t[0]?"selected":""," value=").concat(t[0],">").concat(t[1],"</option>")})),"\n      </select>\n    </div>\n    ");var n=t.querySelector(".select-input"),r=t.querySelector(".input.input-from"),o=e.onChange,i=e.maxDate,a=e.minDate,s=e.startDate,c=e.endDate,u=new Date,l=(0,$.Ds)((function(e){e.start&&e.end&&o(e)})),f=s&&c?[s,c]:void 0,p=(0,B.Z)(r,{mode:"range",locale:F.Russian,allowInput:!0,maxDate:i||u,minDate:a,defaultDate:f,onChange:function(e){var t=Z(e,2),r=t[0],o=t[1];n.value="",l({start:r,end:o})}});return n.onchange=function(){var e=Z(z(Number(n.value),c),2),t=e[0],r=e[1];p.setDate([t,r]),l({start:t,end:r})},t}(l)}}])&&ne(t.prototype,n),a}(J);function ce(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ue(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ue(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ue(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e){var t=e.connector,n=e.layer,r=n.resource;if(n&&r&&t){var o,i,s=(null===(o=n.adapterOptions)||void 0===o||null===(i=o.props)||void 0===i?void 0:i.dateField)||"field_9";return t.getResourceIdOrFail(r).then((function(e){var n={resourceId:e,fields:[s],geom:!1,connector:t,limit:1},r=[(0,a.nm)(fe(fe({},n),{},{orderBy:[s]}))];return Promise.all(r).then((function(e){var t=ce(e,2);return[ce([t[0],t[1]].map((function(e){var t,n=e&&e[0];if(n){var r=n.fields[s];if(r)return t=r,new Date(t.year,t.month-1,t.day)}})),1)[0],U]}))}))}return Promise.resolve([void 0,void 0])}function de(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function me(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){de(i,r,o,a,s,"next",e)}function s(e){de(i,r,o,a,s,"throw",e)}a(void 0)}))}}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _e={target:"tree"},we=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.actionMap=t,ge(this,"options",void 0),ge(this,"sidebar",void 0),ge(this,"_container",void 0),ge(this,"_target",void 0),ge(this,"ngwLayers",void 0),this.options=ye(ye({},_e),n),"string"==typeof this.options.target){var r=document.getElementById(this.options.target);if(!r)throw new Error("No element with ID #".concat(this.options.target," in document for webmap tree"));this._target=r}else{if(!(this.options.target instanceof HTMLElement))throw new Error("`target` option is not set");this._target=this.options.target}this.sidebar=new(w())(this._target,{closeButton:!1,position:"left",autoPan:!1}),this.sidebar.addTo(this.actionMap.ngwMap.mapAdapter.map),this.ngwLayers=this.options.ngwLayers,this._container=this._createContainer(),this.options.status||this.hide(),this._target&&this._target.appendChild(this._container)}var t,n,r,o;return t=e,(n=[{key:"show",value:function(){this._container.classList.remove("hidden"),this.sidebar.show()}},{key:"hide",value:function(){this.sidebar.hide(),this._container.classList.add("hidden")}},{key:"_createContainer",value:function(){var e=this,t=document.createElement("div");return t.className="tree-container",void 0!==this.options.width&&(t.style.width=this.options.width+"px"),(this.options.userFires||this.options.firms)&&new P({title:"Пожары",content:function(){return e._createFiresContainer()},parent:t}),this.options.sensors&&new P({title:"Датчики",content:function(){return e._createSensorContainer()},parent:t}),new P({title:"Базовые слои",content:function(){return e._createNgwLayers()},open:!1,parent:t}),new P({title:"Подложки",content:function(){return e._createBasemapsContainer()},open:!1,parent:t}),new P({title:"Закладки",content:function(){return e._createBookmarksContainer()},open:!1,parent:t}),t}},{key:"_createNgwLayers",value:function(){var e=document.createElement("div");for(var t in e.className="webmap-tree-container",this.ngwLayers){var n=this.ngwLayers[t],r=new L(n.layer.layer).getContainer();r&&e.appendChild(r)}return e}},{key:"_createBookmarksContainer",value:function(){var e=document.createElement("div"),t=this.options.bookmarks;if(t){var n=new I({bookmarks:t,ngwMap:this.options.ngwMap});e.appendChild(n.getContainer())}return e}},{key:"_createFiresContainer",value:(o=me(regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,s,c,u,l=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=document.createElement("div"),n=this.options,r=n.firms,o=n.userFires,i=[void 0,void 0],!r&&!o){e.next=15;break}if(a=[],!o||!o.id){e.next=10;break}return a.push(o),e.next=9,he({layer:o,connector:this.options.ngwMap.connector});case 9:i=e.sent;case 10:r&&r.forEach((function(e){return a.push(e)})),s=this.actionMap.options.timedelta||24,c=z(s,U),u=new se({layers:a,ngwMap:this.options.ngwMap,dateRange:i,defaultDateRange:c,timedelta:this.actionMap.options.timedelta||72,onDateChange:function(){l.options.onDateChange&&l.options.onDateChange()}}),t.appendChild(u.getContainer());case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_createSensorContainer",value:(r=me(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.createElement("div"),(n=this.options.sensors)&&(r=new J({layers:[n],ngwMap:this.options.ngwMap}),t.appendChild(r.getContainer())),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_createBasemapsContainer",value:function(){var e=document.createElement("div");if(this.options.firms){var t=new D({ngwMap:this.options.ngwMap});e.appendChild(t.getContainer())}return e}}])&&be(t.prototype,n),e}(),ke=(n(6977),n(7187));function Oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var je=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Me(this,e),this.actionMap=t,Pe(this,"html",'<i class="fas fa-map-pin btn-control-icon "></i>'),Pe(this,"title",{off:"Полученить координаты с карты",on:"Выключить режим получения координат с карты"}),Pe(this,"addClass","toggle-control webmap-tree-control"),Pe(this,"addClassOn","active"),Pe(this,"status",!1),Pe(this,"emitter",new ke.EventEmitter),Pe(this,"_toggle",void 0),Pe(this,"__onMapClick",void 0),Pe(this,"_layer",void 0),this._toggle=r.toggle,this.actionMap.ngwMap.addFeatureLayer({id:"show-coordinate-click",visibility:!0,paint:{radius:6},popup:!0,popupOptions:{createPopupContent:function(e){if(e.feature)return n._createPopupContent(e.feature.geometry.coordinates.map((function(e){return e.toFixed(5)})))}}}).then((function(e){e&&(n._layer=e)}))}var t,n;return t=e,(n=[{key:"onClick",value:function(e){this.toggleControl(e)}},{key:"show",value:function(){var e=this;this.actionMap.ngwMap.setCursor("crosshair"),this._removeClickListener(),this.__onMapClick=function(t){return e._onMapClick(t)},this.actionMap.ngwMap.emitter.on("click",this.__onMapClick)}},{key:"hide",value:function(){this.actionMap.ngwMap.setCursor("default"),this._removeClickListener(),this.actionMap.ngwMap.clearLayerData(this._layer)}},{key:"_removeClickListener",value:function(){this.__onMapClick&&(this.actionMap.ngwMap.emitter.off("click",this.__onMapClick),this.__onMapClick=void 0)}},{key:"_onMapClick",value:function(e){var t={type:"Feature",properties:{},geometry:{type:"Point",coordinates:e.lngLat}};this.actionMap.ngwMap.setLayerData(this._layer,t)}},{key:"toggleControl",value:function(e){(e=void 0!==e?e:!this.status)?this.show():this.hide(),this.status=e,this._toggle&&this._toggle(e),this.emitter.emit("status",this.status)}},{key:"_createPopupContent",value:function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(t,n)||function(e,t){if(e){if("string"==typeof e)return Oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oe(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=r[0],i=r[1],a=document.createElement("div"),s="".concat(i,", ").concat(o);return a.innerHTML='\n    <span>Широта/Долгота:</span>\n    <span class="lat-lng-coord"> '.concat(s,'</span>\n    <a href="#" class="copy-to-clipboard">\n    <i class="far fa-clipboard"></i>\n    </a>'),a.getElementsByClassName("copy-to-clipboard")[0].onclick=function(){$.TU.copy(s)},a}}])&&Ce(t.prototype,n),e}(),Ee={en:{linearMeasurement:"Distance measurement",areaMeasurement:"Area measurement",start:"Start",meter:"m",kilometer:"km",squareMeter:"m²",squareKilometers:"km²"},ru:{linearMeasurement:"Измерение расстояния",areaMeasurement:"Измерение площади",start:"Старт",meter:"м",kilometer:"км",squareMeter:"м²",squareKilometers:"км²"}};function Le(e){return e*(Math.PI/180)}function Se(e){return Math.pow(e,2)}function xe(e,t){return e<1e3?De(e,0)+" "+t.meter:De(e/1e3,2)+" "+t.kilometer}function De(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=",",r=e<0?"-":"",o=Math.abs(+e||0),i=parseInt(o.toFixed(t),10)+"",a=i.length>3?i.length%3:0;return[r,a?i.substr(0,a)+n:"",i.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+n),t?"."+Math.abs(o-Number(i)).toFixed(t).slice(2):""].join("")}function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ie(e,t){if(t&&("object"===Te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ne(e)}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Be(e){return(Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(1058);var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Be(r);if(o){var n=Be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ie(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Fe(Ne(t=i.call(this,e)),"options",{latlng:null,content:"",className:""}),Fe(Ne(t),"_map",void 0),Fe(Ne(t),"_offset",new T.Point(0,30)),Fe(Ne(t),"_container",void 0),Fe(Ne(t),"_contentNode",void 0),Fe(Ne(t),"_closeButton",void 0),Fe(Ne(t),"_containerBottom",void 0),Fe(Ne(t),"_containerLeft",void 0),T.Util.setOptions(Ne(t),e),t.options.offset&&(t._offset=t.options.offset),t}return t=a,(n=[{key:"onAdd",value:function(e){return this._map=e,this._container||this._initLayout(),this._container&&e.getPanes().popupPane.appendChild(this._container),e.on("viewreset",this._updatePosition,this),T.Browser.any3d&&e.on("zoomanim",this._zoomAnimation,this),this._update(),this}},{key:"addTo",value:function(e){return e.addLayer(this),this}},{key:"onRemove",value:function(e){return this._container&&e.getPanes().popupPane.removeChild(this._container),e.off("viewreset",this._updatePosition,this),e.off("zoomanim",this._zoomAnimation,this),this._map=null,this}},{key:"setLatLng",value:function(e){return this.options.latlng=(0,T.latLng)(e),this._updatePosition(),this}},{key:"setContent",value:function(e){return this.options.content=e,this._updateContent(),this}},{key:"enableClose",value:function(){return this._closeButton=T.DomUtil.create("span","close",this._container),this._closeButton.innerHTML='<svg class="icon" viewBox="0 0 40 40"><path stroke="#FF0000" stroke-width="3" d="M 10,10 L 30,30 M 30,10 L 10,30" /></svg>',this._closeButton}},{key:"_initLayout",value:function(){this._container=T.DomUtil.create("div",this.options.className),this._contentNode=T.DomUtil.create("div","content",this._container)}},{key:"_update",value:function(){this._map&&(this._updateContent(),this._updatePosition())}},{key:"_updateContent",value:function(){this._contentNode&&this.options.content&&("string"==typeof this.options.content?this._contentNode.innerHTML=this.options.content:(this._contentNode.innerHTML="",this._contentNode.appendChild(this.options.content)))}},{key:"_updatePosition",value:function(){if(this.options.latlng&&this._container){var e=this._map.latLngToLayerPoint(this.options.latlng),t=T.Browser.any3d,n=this._offset;t&&T.DomUtil.setPosition(this._container,e),this._containerBottom=-n.y-(t?0:e.y),this._containerLeft=n.x+(t?0:e.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}}},{key:"_zoomAnimation",value:function(e){if(this._container){var t=this._map._latLngToNewLayerPoint(this.options.latlng,e.zoom,e.center);T.DomUtil.setPosition(this._container,t)}}}])&&Ae(t.prototype,n),a}(T.Layer);function Ue(e){return(Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ze(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e,t){return(qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $e(e,t){if(t&&("object"===Ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ze(e)}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ge(r);if(o){var n=Ge(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return $e(this,e)});function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ke(Ze(n=i.call(this,e)),"options",{color:"#FF0080",model:"distance",messages:Ee.en}),Ke(Ze(n),"_map",void 0),Ke(Ze(n),"_measureHandler",void 0),Ke(Ze(n),"_finished",void 0),Ke(Ze(n),"_startMove",void 0),Ke(Ze(n),"_measurementStarted",void 0),Ke(Ze(n),"_lastPoint",void 0),Ke(Ze(n),"_totalDistance",0),Ke(Ze(n),"_trail",{overlays:[],points:[]}),Ke(Ze(n),"_directPath",void 0),Ke(Ze(n),"_measurePath",void 0),n._map=e,n._measureHandler=Ze(n),n._finished=!1,T.Util.setOptions(Ze(n),t),n}return t=a,(n=[{key:"setModel",value:function(e){return this.options.model=e,this}},{key:"addHooks",value:function(){this._activeMeasure()}},{key:"removeHooks",value:function(){this._disableMeasure()}},{key:"_activeMeasure",value:function(){this._measureHandler._measurementStarted&&this._measureHandler._finishMeasure(),this._measurementStarted?this._finishMeasure():this._enableMeasure()}},{key:"_onMouseClick",value:function(e){var t=e.latlng||this._map.mouseEventToLatLng(e);if(!this._lastPoint||!t.equals(this._lastPoint)){if(this._trail.points.length>0){var n=this._trail.points;n.push(t);var r=n.length;this._totalDistance+=(o=n[r-2],i=n[r-1],a=Le(o.lat),c=(s=Le(i.lat))-a,u=Le(i.lng-o.lng),l=Se(Math.sin(c/2))+Math.cos(a)*Math.cos(s)*Se(Math.sin(u/2)),12756274*Math.asin(Math.sqrt(l))),this._addMeasurePoint(t),this._addMarker(t),"area"!==this.options.model&&this._addLable(t,xe(this._totalDistance,this.options.messages),"leaflet-measure-label")}else this._totalDistance=0,this._addMeasurePoint(t),this._addMarker(t),"area"!==this.options.model&&this._addLable(t,this.options.messages.start,"leaflet-measure-label"),this._trail.points.push(t);var o,i,a,s,c,u,l;this._lastPoint=t,this._startMove=!1}}},{key:"_onMouseMove",value:function(e){var t=e.latlng;this._directPath&&this._trail.points.length>0&&(this._startMove?this._directPath.setLatLngs(this._trail.points.concat(t)):(this._directPath.setLatLngs([t]),this._startMove=!0))}},{key:"_enableMeasure",value:function(){this._trail={overlays:[],points:[]};var e=this._map;T.DomUtil.addClass(e.getContainer(),"leaflet-measure-map"),e.contextMenu&&e.contextMenu.disable(),this._measurementStarted=!0,e.on("click",this._onMouseClick,this),e.on("dblclick",this._finishMeasure,this),e.on("contextmenu",this._finishMeasure,this),e.doubleClickZoom.disable(),e.on("mousemove",this._onMouseMove,this),e.fire("measure:start")}},{key:"_disableMeasure",value:function(){var e=this._map;T.DomUtil.removeClass(e.getContainer(),"leaflet-measure-map"),e.contextMenu&&e.contextMenu.enable(),e.off("click",this._onMouseClick,this),e.off("dblclick",this._finishMeasure,this),e.off("contextmenu",this._finishMeasure,this),e.off("mousemove",this._onMouseMove,this),e.doubleClickZoom.enable(),this._measurementStarted=this._startMove=!1,this._finished||this._clearOverlay.call(this),e.fire("measure:stop")}},{key:"_finishMeasure",value:function(e){var t,n,r;this._trail.points.length>0&&(this._trail.points.length>1?(!this._directPath||e&&"contextmenu"!==e.type||this._directPath.setLatLngs(this._trail.points),this._lastPoint&&("area"===this.options.model?this._addLable(this._lastPoint,(t=this._trail.points,n=this.options.messages,(r=Math.round(function(e){for(var t=6378137,n=0,r=e.length,o=e[r-1].lng,i=e[r-1].lat,a=0;a<r;a++){var s=e[a].lng,c=e[a].lat;n+=Le(s-o)*(2+Math.sin(Le(i))+Math.sin(Le(c))),o=s,i=c}return Math.abs(n*t*t/2)}(t)))<1e6?De(r,0)+" "+n.squareMeter:De(r/1e6,2)+" "+n.squareKilometers),"leaflet-measure-label",!0):this._addLable(this._lastPoint,xe(this._totalDistance,this.options.messages),"leaflet-measure-label",!0)),this._directPath&&this._map.removeLayer(this._directPath),this._finished=!0):this._clearOverlay.call(this)),this.disable()}},{key:"_resetDirectPath",value:function(e){var t;this._directPath?this._directPath.addLatLng(e):(t="area"===this.options.model?new T.Polygon([e],{weight:2,color:this.options.color,dashArray:[5,5],fillOpacity:0,interactive:!1}):new T.Polyline([e],{weight:2,color:this.options.color,dashArray:[5,5],interactive:!1}),this._map.addLayer(t),this._trail.overlays.push(t),this._directPath=t)}},{key:"_addMeasurePoint",value:function(e){var t;this._measurePath?this._measurePath.addLatLng(e):(t="area"===this.options.model?new T.Polygon([e],{weight:2,color:this.options.color,fillColor:this.options.color,fillOpacity:.5,interactive:!1}):new T.Polyline([e],{weight:2,color:this.options.color,interactive:!1}),this._map.addLayer(t),this._trail.overlays.push(t),this._measurePath=t),this._resetDirectPath(e)}},{key:"_addMarker",value:function(e){var t=new T.CircleMarker(e,{color:this.options.color,opacity:1,weight:1,fillColor:"#FFFFFF",fill:!0,fillOpacity:1,radius:3,interactive:!1});this._map.addLayer(t),this._trail.overlays.push(t)}},{key:"_addLable",value:function(e,t,n,r){var o=this,i=new He({latlng:e,content:t,className:n});if(this._map.addLayer(i),this._trail.overlays.push(i),r){var a=i.enableClose();T.DomEvent.on(a,"click",(function(e){T.DomEvent.stopPropagation(e),o._clearOverlay()}),this)}}},{key:"_clearOverlay",value:function(){var e,t=this._trail.overlays,n=0;for(e=t.length;n<e;n++)this._map.removeLayer(t[n])}}])&&ze(t.prototype,n),a}(T.Handler);function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){rt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function et(e,t){if(t&&("object"===We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return tt(e)}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nt(e){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=nt(r);if(o){var n=nt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return et(this,e)});function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),rt(tt(t=i.call(this,e)),"options",{position:"topright",title:"Measurement",collapsed:!0,color:"#FF0080",locale:"en",messages:Ee.en}),rt(tt(t),"_map",void 0),rt(tt(t),"_container",void 0),rt(tt(t),"_link",void 0),rt(tt(t),"_contents",void 0),rt(tt(t),"_measureHandler",void 0),T.Util.setOptions(tt(t),e);var n=e.locale;if(n&&"en"!==n){var r=Ee[n];r?t.options.messages=Qe(Qe({},Ee),r):console.error("Measure control has no messages for "+t.options.locale+" locale")}return t}return t=a,(n=[{key:"onAdd",value:function(e){return this._map=e,this._container||this._initLayout()}},{key:"disableMeasure",value:function(){this._measureHandler&&(this._measureHandler.disable(),this._measureHandler=void 0)}},{key:"_buildContainer",value:function(){return this._container=T.DomUtil.create("div","leaflet-control-measure leaflet-bar leaflet-control"),this._contents=T.DomUtil.create("div","leaflet-measure-contents",this._container),this._link=T.DomUtil.create("a","leaflet-measure-toggle",this._container),this._link.title=this.options.title||"Measurement",this._link.href="#",this._buildItems(),this._container}},{key:"_buildItems",value:function(){var e=T.DomUtil.create("ul","leaflet-measure-actions",this._contents),t=T.DomUtil.create("li","leaflet-measure-action",e),n=T.DomUtil.create("a","start",t);n.innerText=this.options.messages.linearMeasurement,n.href="#",T.DomEvent.disableClickPropagation(n),T.DomEvent.on(n,"click",this._enableMeasureLine,this),t=T.DomUtil.create("li","leaflet-measure-action",e);var r=T.DomUtil.create("a","leaflet-measure-action start",t);r.innerText=this.options.messages.areaMeasurement,r.href="#",T.DomEvent.disableClickPropagation(r),T.DomEvent.on(r,"click",this._enableMeasureArea,this)}},{key:"_initLayout",value:function(){var e=this._buildContainer();return T.DomEvent.disableClickPropagation(e),T.DomEvent.disableScrollPropagation(e),this.options.collapsed?T.DomEvent.on(e,{mouseenter:this._expand,mouseleave:this._collapse},this):this._expand(),e}},{key:"_enableMeasureLine",value:function(e){T.DomEvent.stopPropagation(e),this.disableMeasure(),this._map&&(this._measureHandler=new Ve(this._map,{model:"distance",color:this.options.color,messages:this.options.messages}),this._measureHandler.enable())}},{key:"_enableMeasureArea",value:function(e){T.DomEvent.stopPropagation(e),this.disableMeasure(),this._map&&(this._measureHandler=new Ve(this._map,{model:"area",color:this.options.color,messages:this.options.messages}),this._measureHandler.enable())}},{key:"_expand",value:function(){return this._link&&this._container&&(this._link.style.display="none",T.DomUtil.addClass(this._container,"leaflet-measure-expanded")),this}},{key:"_collapse",value:function(){return this._link&&this._container&&(this._link.style.display="block",T.DomUtil.removeClass(this._container,"leaflet-measure-expanded")),this}}])&&Xe(t.prototype,n),a}(T.Control),it=[];function at(e,t){it.push({name:e,stop:t})}function st(e){it.forEach((function(t){t.name!==e&&t.stop()}))}function ct(e){var t=new ot({locale:"ru"});e.addControl(t,"top-left"),e.onLoad().then((function(){var n=e.mapAdapter.map;n&&(n.on("measure:start",(function(){st("measure"),e.disableSelection()})),n.on("measure:stop",(function(){e.setCursor("default"),e.enableSelection()}))),at("measure",(function(){t.disableMeasure()}))}))}function ut(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return lt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function dt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ht(i,r,o,a,s,"next",e)}function s(e){ht(i,r,o,a,s,"throw",e)}a(void 0)}))}}function mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yt=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,vt(this,"ngwMap",void 0),vt(this,"tree",void 0),vt(this,"treeControl",void 0),vt(this,"authControl",void 0),vt(this,"popup",void 0),vt(this,"_promises",{}),this.popup=new g}var t,n,r,l,f,p,h,d;return t=e,(n=[{key:"create",value:(d=dt(regeneratorRuntime.mark((function e(t){var n,r,o,a,l,f,p,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=pt({},t.mapOptions),r=t.basemaps,o=t.firms,a=t.userFires,l=t.sensors,f=new i.Z8(pt({mapAdapter:new c.Z,controls:[],minZoom:4,runtimeParams:[new u.Z]},n)),this.ngwMap=f,f.setCursor("default"),this.popup.setNgwMap(f),r&&f.onLoad().then((function(){return r.forEach((function(e,t){f.addBaseLayer("QMS",pt(pt({},e),{},{visibility:0===t}))}))})),f.getPaintFunctions={base:s.q},f.addControl("ZOOM","top-left"),this._createLocateControl(),f.addControl("ATTRIBUTION","bottom-right",{customAttribution:['<a href="https://nextgis.com" target="_blank">©NextGIS</a>']}),ct(f),this._createShareControl(),e.next=15,f.getNgwLayers();case 15:return p=e.sent,h=[],Object.values(p).forEach((function(e){var t=e.layer.item&&e.layer.item.webmap&&e.layer.item.webmap.bookmark_resource;t&&h.push(t)})),e.next=20,this._addFireLayer(t.userFires);case 20:return e.next=22,this._addFirms(t.firms);case 22:return e.next=24,this._addSensors(t.sensors);case 24:this._createGetCoordinateControl(),this._addTreeControl({ngwLayers:p,firms:o,sensors:l,userFires:a,bookmarks:h}),this._addEventsListeners();case 27:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"_locate",value:function(){var e=this;this.ngwMap.locate({setView:!1},{locationfound:function(t){var n=t.lngLat;e.ngwMap.setCenter(n)}})}},{key:"_createShareControl",value:function(){var e=this,t=document.getElementsByClassName("js-modal")[0],n=document.getElementsByClassName("js-modal-close")[0],r=document.getElementsByClassName("js-share-modal-content")[0],i=document.getElementsByClassName("js-share-input")[0];n.addEventListener("click",(function(){r.innerHTML="",t.classList.remove("is-active")}));var a=this.ngwMap.createButtonControl({html:'<i class="fas fa-share-alt btn-control-icon "></i>',onClick:function(){var n,a;n=location.href,a=e._createShareModalContent(n),i.value=n,r.innerHTML=a,o().update(),t.classList.add("is-active")}});this.ngwMap.addControl(a,"bottom-right")}},{key:"_createGetCoordinateControl",value:(h=dt(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new je(this,{toggle:function(e){e?(st("coordinate"),r.ngwMap.disableSelection()):r.ngwMap.enableSelection()}}),e.next=3,this.ngwMap.createToggleControl(t);case 3:n=e.sent,this.ngwMap.addControl(n,"top-left"),at("coordinate",(function(){return n.onClick(!1)}));case 6:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"_createLocateControl",value:function(){var e=this,t=this.ngwMap.createButtonControl({html:'<i class="fas fa-location-arrow btn-control-icon"></i>',title:"Найти меня на карте",onClick:function(){return e._locate()}});this.ngwMap.addControl(t,"top-left")}},{key:"_createShareModalContent",value:function(e){return'<div class="buttons share-btn js-share-btn" data-url="'.concat(e,'" data-title="" data-desc="">\n      ').concat([{id:"tw",name:"Twitter",icon:"fab fa-twitter"},{id:"vk",name:"VK",icon:"fab fa-vk"},{id:"fb",name:"Facebook",icon:"fab fa-facebook-square"}].map((function(e){return'<a class="button is-primary" data-id="'.concat(e.id,'">\n                    <span class="icon">\n                        <i class="').concat(e.icon,'"></i>\n                    </span>\n                    <span>').concat(e.name,"</span>\n                </a>")})).join(""),"\n    </div>")}},{key:"_addFireLayer",value:(p=dt(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=3;break}return r=t.adapterOptions&&t.adapterOptions.paint?t.adapterOptions.paint:{},e.abrupt("return",this.ngwMap.addNgwLayer({resource:t.resource,id:t.id,adapterOptions:pt(pt(pt({},t.adapterOptions),{},{paint:pt(pt({},r),{},{radius:5}),selectable:!0,selectedPaint:pt(pt({},r),{},{radius:7})},n),{},{propertiesFilter:q(this.options.timedelta||24,t.adapterOptions,U)})}));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"_addFirms",value:(f=dt(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=18;break}n=ut(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return o=r.value,e.next=8,this._addFireLayer(o);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return f.apply(this,arguments)})},{key:"_addSensors",value:(l=dt(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t&&this.ngwMap.addNgwLayer(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"_addTreeControl",value:(r=dt(regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementsByClassName("js-sidebar")[0],r=function(){return n.classList.contains("is-active")},o=function(){return n.classList.add("is-active")},i=function(){return n.classList.remove("is-active")},e.next=6,this.ngwMap.onLoad();case 6:this.tree=new we(this,pt(pt({},t),{},{onDateChange:function(){s._cleanSelection()},ngwMap:this.ngwMap})),a=function(e){(e=void 0!==e?e:r())?(st("tree"),s.tree&&s.tree.show(),o()):(s.tree&&s.tree.hide(),i())},n.addEventListener("click",(function(){a()})),setTimeout((function(){a()}),500),at("tree",(function(){return a(!1)}));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"_cleanSelection",value:function(){this._promises.getFeaturePromise&&this._promises.getFeaturePromise.cancel&&this._promises.getFeaturePromise.cancel(),this.ngwMap.removeLayer("highlight")}},{key:"_highlighNgwLayer",value:function(e){var t=this;this._cleanSelection();var n=(0,a.RP)(e)[0];if(n){var r=n.resourceId;this.ngwMap.fetchIdentifyItem(e,{extensions:["attachment"]}).then((function(e){e&&e.toGeojson().then((function(n){t.ngwMap.addLayer("GEOJSON",{id:"highlight",data:n,visibility:!0,paint:{color:"green",stroke:!0,fillOpacity:"0.8"},popup:!0,popupOptions:{createPopupContent:function(n){if(n.feature)return t.popup.createPopupContent(n.feature,r,e.extensions.attachment)}}})}))}))}}},{key:"_addEventsListeners",value:function(){var e=this;this.ngwMap.emitter.on("click",(function(){e.ngwMap.cancelPromises("identify","select")})),this.ngwMap.emitter.on("ngw:select",(function(t){return t&&e._highlighNgwLayer(t)}))}}])&&mt(t.prototype,n),e}();function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _t(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function wt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){Pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}document.addEventListener("DOMContentLoaded",(function(){var e=Array.prototype.slice.call(document.querySelectorAll(".navbar-burger"),0);e.length>0&&e.forEach((function(e){e.addEventListener("click",(function(){var t=e.dataset.target,n=document.getElementById(t);e.classList.toggle("is-active"),n&&n.classList.toggle("is-active")}))}))}));var jt={limit:2e3,props:{dateField:"timestamp",timeUnit:"s"}},Et={stroke:!0,strokeColor:"#ffffff",strokeOpacity:1,opacity:1};new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};wt(this,e),this.options=t,Ot(this,"actionMap",void 0),this.actionMap=new yt(t)}var t,n,r,o;return t=e,(n=[{key:"create",value:(r=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.options=gt(gt({},this.options),t),this.showContent(),e.next=4,this.actionMap.create(this.options);case 4:case"end":return e.stop()}}),e,this)})),o=function(){var e=this,t=arguments;return new Promise((function(n,o){var i=r.apply(e,t);function a(e){_t(i,n,o,a,s,"next",e)}function s(e){_t(i,n,o,a,s,"throw",e)}a(void 0)}))},function(e){return o.apply(this,arguments)})},{key:"showContent",value:function(){var e=document.getElementById("app"),t=document.getElementById("app-loading");t&&(t.style.display="none"),e&&(e.style.display="block")}}])&&kt(t.prototype,n),e}())({mapOptions:{target:"map",bounds:[36.59,43.385,49.374,50.214],baseUrl:"https://clear-horizon.nextgis.com",resources:[{resource:1,fit:!0,adapterOptions:{selectable:!0}}]},timedelta:72,basemaps:[{qmsId:1135},{qmsId:487}],userFires:{resource:"userfirepoints",id:"USERFIRE",adapterOptions:{paint:Ct({color:"rgb(100,20,40)"},Et),props:{dateField:"field_9",timeUnit:"ISO"}}},sensors:{resource:359,id:"SENSOR",adapterOptions:{selectable:!0,paint:Ct({color:"#0000ff",radius:5},Et)}},firms:[{resource:103,id:"MODIS",adapterOptions:Ct({paint:Ct({color:"red"},Et)},jt)},{resource:105,id:"VIIRS",adapterOptions:Ct({paint:Ct({color:"orange"},Et)},jt)}]}).create()}},function(e){e.O(0,[426,956,256,373,80,12,243,385,185,888,365,471,189,252],(function(){return 7036,e(e.s=7036)})),e.O()}]);
//# sourceMappingURL=main-4f064d567ec32d9.js.map