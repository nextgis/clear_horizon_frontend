(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[185],{81129:function(t,e,r){"use strict";r.d(e,{q:function(){return n}});var o={brill:'<path d="m6 0-5 6 5 6 5-6z"/>',circle:'<circle cx="6" cy="6" r="6"/>',rect:'<rect width="12" height="12"/>',marker:'<path d="m6 0c-1.85 0-4 1.19-4 4.22 0 2.05 3.08 6.59 4 7.78 0.821-1.19 4-5.62 4-7.78 0-3.03-2.15-4.22-4-4.22z"/>',cross:'<path d="M 2.4,12 6,8.4 9.6,12 12,9.6 8.4,6 12,2.4 9.6,0 6,3.6 2.4,0 0,2.4 3.6,6 0,9.6 Z"/>',star:'<path d="m6 0.25 1.71 4.18 4.29-1.04e-4 -3.43 3.14 0.857 4.18-3.43-3.14-3.43 3.14 0.857-4.18-3.43-3.14 4.29-0.209z"/>',triangle:'<path d="m12 11.7h-12l6-11.2z"/>',plus:'<path d="m7.5 12v-4.5h4.5v-3h-4.5v-4.5h-3v4.5h-4.5v3h4.5v4.5z"/>',minus:'<path d="m12 7.5v-3h-12v3z"/>',asterisk:'<path d="m7.59 12v-3.27l2.83 1.64 1.58-2.74-2.85-1.64 2.83-1.64-1.56-2.74-2.83 1.64v-3.24h-3.17v3.24l-2.85-1.64-1.57 2.74 2.84 1.64-2.84 1.64 1.57 2.74 2.85-1.64v3.27z"/>'};function n(t){void 0===t&&(t={});var e=t.shape||"circle",r=t.color||"blue",n=t.strokeColor||"white",i=t.size||12,s=i/2,a="number"==typeof t.stroke?t.stroke:.8,p=i/12,u=o[e]||"circle",c=function(t,e,r,o){void 0===r&&(r=0);var n=r/2,i='<svg\n    version="1.1"\n    xmlns="http://www.w3.org/2000/svg"\n    width="'+t+'"\n    height="'+e+'"\n    viewBox="-'+n+" -"+n+" "+(t+r)+" "+(e+r)+'"\n  >'+o+"</svg>";return(new DOMParser).parseFromString(i,"image/svg+xml").documentElement}(i,i,a*p,"string"==typeof u?u:u(t)),l=c.firstChild,f="scale("+p+")";return l.setAttribute("fill",r),a&&(l.setAttribute("stroke",n),l.setAttribute("stroke-width",String(a))),l.setAttribute("transform",f),{type:"icon",iconSize:[i,i],iconAnchor:[s,s],html:(new XMLSerializer).serializeToString(c),svg:c}}},87187:function(t,e,r){"use strict";r.d(e,{ck:function(){return d}});var o,n=r(14949),i=function(){function t(t){this._children=[],this.item=t}return t.prototype.setParent=function(t){this._parent=t},t.prototype.addChild=function(t){this._children.push(t)},t.prototype.getParent=function(){return this._parent},t.prototype.getParents=function(t){var e=this.getParent();return e?(0,n.Zm)(e,t,(function(t){return t.tree.getParent()})):[]},t.prototype.getRoot=function(){for(var t=this.getParent(),e=t;t;)(t=t.tree.getParent())&&(e=t);return e},t.prototype.find=function(t){return(0,n.Ql)(this._children,t,(function(t){return t.tree.getChildren()}))},t.prototype.every=function(t){return(0,n.qL)(this._children,t,(function(t){return t.tree.getChildren()}))},t.prototype.some=function(t){return(0,n.cC)(this._children,t,(function(t){return t.tree.getChildren()}))},t.prototype.all=function(t){return this.getDescendants(t)},t.prototype.getDescendants=function(t){return(0,n.Zm)(this._children,t,(function(t){return t.tree.getChildren()}))},t.prototype.getChildren=function(){return this._children},t}(),s=r(17187),a=function(){function t(t,e,r){this.emitter=new s.EventEmitter,this._blocked=!1,this.item=e,this.options=Object.assign({},r),this.name=t,this._value=this.getProperty()}return t.prototype.getProperty=function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this,this.item):this.options.value},t.prototype.getParents=function(){return this.item.tree.getParents()||[]},t.prototype.getParent=function(){return this.item.tree.getParent()},t.prototype.isGroup=function(){return this.item.tree.getDescendants().length},t.prototype.isBlocked=function(){var t=this;if(void 0===this._blocked){var e=this.item.tree.getParents();if(e){var r=e.find((function(e){var r=e.properties&&e.properties.property(t.name);return!!r&&!r.get()}));this._blocked=!!r}else this._blocked=!1}return this._blocked},t.prototype.set=function(t,e){this._value=this._prepareValue(t),this.update(this._value,e),this._fireChangeEvent(this._value,e)},t.prototype.get=function(){return this.getValue()},t.prototype.update=function(t,e){this._callOnSet(t,e)},t.prototype.getContainer=function(){return this._container},t.prototype.destroy=function(){if(this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}this._removeEventsListener&&this._removeEventsListener()},t.prototype.getValue=function(){return void 0!==this._value?this._value:this.getProperty()},t.prototype._prepareValue=function(t){return t},t.prototype._callOnSet=function(t,e){this.options.onSet&&this.options.onSet.call(this,t,e,this.item)},t.prototype._fireChangeEvent=function(t,e){var r=this;this.emitter&&(t=void 0!==t?t:this.getValue(),this.emitter.emit("change",{value:t,options:e}),this.item.tree.getParents().forEach((function(o){var n=o.properties&&o.properties.property(r.name);n&&n.emitter.emit("change-tree",{value:t,options:e,item:r.item})})))},t}(),p=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(){return(u=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},c=function(t){function e(r,o,n){var i=t.call(this,r,o,u(u({},e.options),n))||this;return i.set(i.get()),i}return p(e,t),e.prototype.update=function(t,e){if(t){if(e&&e.bubble||this.options.bubble){this.unBlock(e);var r=this.getParent(),o=r&&r.properties&&r.properties.property(this.name);o&&o.set(t,Object.assign({},e,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(e)}else this._turnOff(e);(e&&e.propagation||this.options.propagation)&&this._propagation(t,e)},e.prototype.getHierarchyValue=function(){var t=this;return this.get()&&this.getParents().every((function(e){var r=e.properties&&e.properties.get(t.name);return r&&r.get()}))},e.prototype._prepareValue=function(t){return t},e.prototype._turnOff=function(t){this.options.turnOff&&this.options.turnOff.call(this,t),this._callOnSet(!1,t),this.options.hierarchy&&this.isGroup()&&this.blockChild(t)},e.prototype._turnOn=function(t){this.options.turnOn&&this.options.turnOn.call(this,t),this._callOnSet(!0,t),this.options.hierarchy&&this.isGroup()&&this.unblockChild(t)},e.prototype.block=function(t){this._blocked=!0,this._block(t)},e.prototype._block=function(t){this._turnOff(t)},e.prototype.unBlock=function(t){this._blocked=!1,this.getValue()&&this._unBlock(t)},e.prototype._unBlock=function(t){this._turnOn(t)},e.prototype.blockChild=function(t){var e=this;this.item.tree.getDescendants().forEach((function(r){return e._blockChild(r,t)}))},e.prototype.unblockChild=function(t){var e=this;this.item.tree.getChildren().forEach((function(r){return e._unBlockChild(r,t)}))},e.prototype._blockChild=function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.block&&r.block(e)},e.prototype._unBlockChild=function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.unBlock&&r.unBlock(e)},e.prototype._propagation=function(t,e){if(this.isGroup())for(var r=this.item.tree.getChildren(),o=0;o<r.length;o++){var n=r[o],i=n.properties&&n.properties.property(this.name);i&&i.set(t,u(u({},e),{propagation:!0,bubble:!1}))}},e.options={hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"},e}(a),l=function(){return(l=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},f=function(){function t(t,e){this.item=t,this.options={},this._properties={},this._propertiesList=[],e&&e.forEach(this._setPropertyHandler.bind(this))}return t.prototype.add=function(t){this._setPropertyHandler(t)},t.prototype._setPropertyHandler=function(e){var r=t.handlers,o=e.handler;if(!o&&e.type)switch(e.type){case"boolean":o=r.CheckProperty;break;case"string":o=r.BaseProperty;break;default:o=r.BaseProperty}if(o&&e.name){var n=l({},e||{});this._properties[e.name]=new o(e.name,this.item,n),this._propertiesList.push(e.name)}},t.prototype.update=function(){this.list().forEach((function(t){t.update()}))},t.prototype.get=function(t){var e=this.property(t);if(e)return e.get()},t.prototype.set=function(t,e,r){var o=this.property(t);if(o)return o.set(e,r)},t.prototype.property=function(t){return this._properties[t]},t.prototype.list=function(){var t=this;return this._propertiesList.map((function(e){return t._properties[e]}))},t.prototype.destroy=function(){for(var t in this._properties){var e=this.property(t);e&&e.destroy&&e.destroy()}this._properties={},this._propertiesList=[]},t.handlers={CheckProperty:c},t}(),h=function(){return(h=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},y=0,d=function(){function t(t){this.options={},this.id=y,y+=1,this.options=h({},t),this.tree=new i(this)}return t.prototype.initProperties=function(){this.properties=new f(this,this.options.properties)},t}()},26964:function(t,e,r){"use strict";r.d(e,{Z:function(){return Q}});var o=r(17187),n=r(45243),i=r(69261),s=function(){function t(t,e){if(this.map=t,this.options=e,this.pane="order-0",void 0!==e.order){var r="order-"+e.order,o=t.getPane(r);o||(o=t.createPane(r)),o.style.zIndex=String(Math.round(100*e.order)),this.pane=r}}return t.prototype.addLayer=function(t){},t}(),a={Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon",GeometryCollection:"polygon"},p={stroke:!1,opacity:1},u={};for(var c in a){var l=a[c],f=u[l]||[];f.push(c),u[l]=f}function h(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=1+(e[t[r]]||0);var o="";for(var n in e){var i=o?e[o]:0;e[n]>i&&(o=n)}return o}function y(t,e){return-1!==(u[e]||[]).indexOf(t)}function d(t){var e=t.containerPoint,r=t.latlng,o=r.lat;return{latLng:r,lngLat:[r.lng,o],pixel:{left:e.x,top:e.y},source:t}}var v,m=(v=function(t,e){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}v(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),g=function(){return(g=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},_=function(t){function e(e,r){var o=t.call(this,e,r)||this;return o.selected=!1,o._layers=[],o._selectedLayers=[],o._filteredLayers=[],o.layer=new n.FeatureGroup([],{pane:o.pane}),o}return m(e,t),e.prototype.addLayer=function(t){if(t)return this.options=t,this.paint=t.paint,this.selectedPaint=t.selectedPaint,t.paint=this.paint,t.data&&this.addData(t.data),this.layer},e.prototype.select=function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._selectLayer(t.layer)})):this.selected||(this.selected=!0,this.selectedPaint&&this.setPaintEachLayer(this.selectedPaint))},e.prototype.unselect=function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._unSelectLayer(t.layer)})):this.selected&&(this.selected=!1,this.paint&&this.setPaintEachLayer(this.paint))},e.prototype.getSelected=function(){return this._selectedLayers.map((function(t){return{feature:t.feature,layer:t}}))},e.prototype.getFiltered=function(){return this._filteredLayers},e.prototype.filter=function(t){var e=this;this._filterFun=t;var r=this.layer._map;r&&this.layer.remove();var o=[];return this._layers.forEach((function(r){var n=r.feature,i=r.layer;i&&(!t||t({feature:n,layer:i})?(e.layer.addLayer(i),o.push({feature:n,layer:i})):e.layer.removeLayer(i))})),this._filteredLayers=o,r&&this.layer.addTo(r),this._filteredLayers},e.prototype.cleanFilter=function(){this.filter()},e.prototype.getLayers=function(){return this._layers.map((function(t){var e=t.layer;return{feature:t.feature,layer:e,visible:e&&e._map}}))},e.prototype.clearLayer=function(t){if(t)for(var e=this._layers.length;e--;){var r=this._layers[e];r.feature&&t(r.feature)&&(this.layer.removeLayer(r.layer),this._layers.splice(e,1))}else this.layer.clearLayers(),this._layers=[]},e.prototype.setData=function(t){this.clearLayer(),this.addData(t)},e.prototype.addData=function(t){var e,r,o=this.options;if(o){if(t){var i=void 0;if(o.type)i=o.type;else{var s="FeatureCollection"===(r=t).type?h(r.features.map((function(t){return t.geometry.type}))):"GeometryCollection"===r.type?h(r.geometries.map((function(t){return t.type}))):"Feature"===r.type?r.geometry.type:r.type;i=a[s]}if(this.type&&this.type!==i)return void console.warn("no other data type than layer can be added");this.type=i,(t=function(t,e){if("FeatureCollection"===t.type)(r=t).features=r.features.filter((function(t){return y(t.geometry.type,e)}));else if("Feature"===t.type){if(!y(t.geometry.type,e))return!1}else if("GeometryCollection"===t.type){var r;(r=t).geometries=r.geometries.filter((function(t){return y(t.type,e)}))}return t}(t,i))&&(e=this.getGeoJsonOptions(o,i))}new n.GeoJSON(t||void 0,e)}},e.prototype.openPopup=function(t,e){var r=this;t&&this._layers.filter(t).forEach((function(t){r._openPopup(t.layer,e)}))},e.prototype.closePopup=function(t){var e=this;(t?this._layers.filter(t):this._layers).forEach((function(t){e._closePopup(t.layer)}))},e.prototype.updateTooltip=function(t){var e=this;t?this._updateTooltip(t):this.getLayers().forEach((function(t){return e._updateTooltip(t)}))},e.prototype.getExtent=function(){var t=this.layer.getBounds(),e=t.getNorthEast(),r=t.getSouthWest();if(e&&r)return[r.lng,r.lat,e.lng,e.lat]},e.prototype._updateTooltip=function(t){var e=t.feature,r=t.layer;if(this.options.labelField&&e&&e.properties){r.unbindTooltip();var o=e.properties[this.options.labelField];void 0!==o&&r.bindTooltip(String(o),{permanent:!0}).openTooltip()}},e.prototype._openPopup=function(t,e){return r=this,o=void 0,i=function(){var r,o,n,i,s,a,p;return function(t,e){var r,o,n,i,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(this,(function(u){switch(u.label){case 0:return r=t.feature,o=g({minWidth:300},e=e||{}),n=o.minWidth,i=o.autoPan,e&&e.createPopupContent?[4,e.createPopupContent({layer:t,feature:r,target:this})]:[3,2];case 1:return a=u.sent(),[3,3];case 2:a="",u.label=3;case 3:return(s=a)&&(p=t.bindPopup(s,{minWidth:n,autoPan:i}),setTimeout((function(){p.openPopup()}),0)),[2]}}))},new((n=void 0)||(n=Promise))((function(t,e){function s(t){try{p(i.next(t))}catch(t){e(t)}}function a(t){try{p(i.throw(t))}catch(t){e(t)}}function p(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n((function(t){t(r)}))).then(s,a)}p((i=i.apply(r,o||[])).next())}));var r,o,n,i},e.prototype._closePopup=function(t){t.closePopup().unbindPopup()},e.prototype.setPaintEachLayer=function(t){var e=this;this.layer.eachLayer((function(r){e.setPaint(r,t)}))},e.prototype.setPaint=function(t,e){var r=void 0;if((0,i.UY)(e)?r=e(t.feature):(0,i.GY)(e)&&(r=e),r)if("point"===this.type&&"icon"===r.type){var o=t,n=this.createDivIcon(r);o.setIcon(n)}else"setStyle"in t&&t.setStyle(this.preparePaint(r))},e.prototype.preparePaint=function(t){if("get-paint"!==t.type){var e="line"===this.type?[["color","strokeColor"],["opacity","strokeOpacity"],["weight","weight"]]:[["color","strokeColor"],["opacity","strokeOpacity"],["stroke","stroke"],["fillColor","fillColor"],["fillOpacity","fillOpacity"],["fill","fill"],["weight","weight"]],r={};return"radius"in t&&"number"==typeof t.radius&&(r.radius=t.radius),e.forEach((function(e){var o=e[0],n=e[1],i=t[n];void 0!==i&&Object.defineProperty(r,o,{enumerable:!0,value:i})})),r}return p},e.prototype.getGeoJsonOptions=function(t,e){var r=this,o=t.paint,n={};return"function"==typeof o?"point"===e?n.pointToLayer=function(t,e){var n=o(t);return r.createPaintToLayer(n)(t,e)}:n={style:function(t){return t?r.preparePaint(g(g({},p),o(t))):r.preparePaint(g(g({},p),{type:"path"}))}}:n=this.createPaintOptions(o,e),n.onEachFeature=function(e,o){o.options.pane=r.pane,r._layers.push({feature:e,layer:o});var n=!0;r._filterFun&&(n=r._filterFun({feature:e,layer:o})),n&&(o.options.interactive=r.options.selectable||r.options.interactive,r.layer.addLayer(o),t.selectable&&(t.selectOnHover?(o.on("mouseover",(function(){r._selectLayer(o)})),o.on("mouseout",(function(){r._unSelectLayer(o)}))):o.on("click",(function(t){return r._onLayerClick(t)}),r)),r.options.popup&&r._openPopup(o,r.options.popupOptions),r._updateTooltip({layer:o,feature:e}))},n},e.prototype._onLayerClick=function(t){n.DomEvent.stopPropagation(t);var e=t.target,r=-1!==this._selectedLayers.indexOf(e);r?this.options&&this.options.unselectOnSecondClick&&(this._unSelectLayer(e),r=!1):(this._selectLayer(e),r=!0),this.options.onLayerClick&&this.options.onLayerClick({layer:this,feature:e.feature,selected:r,event:d(t),source:t})},e.prototype._selectLayer=function(t){var e=this;this.options&&!this.options.multiselect&&this._selectedLayers.forEach((function(t){return e._unSelectLayer(t)})),this._selectedLayers.push(t),this.selected=!0,this.options&&(this.options.selectedPaint&&this.setPaint(t,this.options.selectedPaint),this.options.popupOnSelect&&this._openPopup(t,this.options.popupOptions))},e.prototype._unSelectLayer=function(t){var e=this._selectedLayers.indexOf(t);-1!==e&&this._selectedLayers.splice(e,1),this.selected=this._selectedLayers.length>0,this.options&&(this.options.paint&&this.setPaint(t,this.options.paint),this.options.popupOnSelect&&this._closePopup(t))},e.prototype.createDivIcon=function(t){var e=function(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(r[o[n]]=t[o[n]])}return r}(t,[]);return new n.DivIcon(g({className:""},e))},e.prototype.createPaintToLayer=function(t){var e=this;if(t&&t.type)if("icon"===t.type){var r=t.className,o=t.html;if(r||o)return function(r,o){var i=e.createDivIcon(t);return new n.Marker(o,{icon:i})}}else if("pin"===t.type)return function(t,e){return new n.Marker(e)};return function(r,o){var i=p;return new n.CircleMarker(o,e.preparePaint(g(g({},i),t)))}},e.prototype.createPaintOptions=function(t,e){var r={},o=t&&this.preparePaint(t)||{};return t&&(r.style=function(){return o}),"point"===e?r.pointToLayer=this.createPaintToLayer(t):"line"===e&&(o.stroke=!0),r},e}(s),O=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),b=function(t){function e(e){var r=t.call(this,e)||this,o=e&&e.customAttribution;if(o){var n=[];Array.isArray(o)?n=o:o&&(n=[o]),n.forEach((function(t){return r.addAttribution(t)}))}return r}return O(e,t),e}(n.Control.Attribution);function w(t,e){return void 0===e&&(e={}),new(n.Control.extend({onAdd:function(){var r=document.createElement("div"),o=t.onAdd();return r.classList.add("leaflet-control"),e.bar&&r.classList.add("leaflet-bar"),e.margin||e.bar||(r.style.marginBottom="0px",r.style.marginTop="0px",r.style.marginLeft="0px",r.style.marginRight="0px"),o&&r.appendChild(o),n.DomEvent.disableClickPropagation(r),r},onRemove:function(){t.onRemove()}}))}var P=r(39871);function C(t,e,r){var o=new XMLHttpRequest;for(var n in o.open("GET",t),o.responseType="arraybuffer",r)o.setRequestHeader(n,r[n]);return o.onload=function(){var t=new Uint8Array(this.response),r=new Blob([t],{type:"image/png"}),o=(window.URL||window.webkitURL).createObjectURL(r);e(o)},o.send(),function(){o.abort()}}var j=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),k=function(t){function e(e,r,o){var n=t.call(this,e,r,o)||this;return n._abort=[],n}return j(e,t),e.prototype.cancelLoad=function(){this._abort&&(this._abort.forEach((function(t){return t()})),this._abort=[])},e.prototype._initImage=function(){t.prototype._initImage.call(this);var e=this.options.headers;if(e){var r=this._image,o=r.src;r.src="",this._abort.push(C(o,(function(t){r.src=t}),e))}},e}(n.ImageOverlay),L=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),E=function(t){function e(e,r){var o=t.call(this,r)||this;o.defaultWmsParams={service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},o.options={crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18,pane:"tilePane",headers:null,viewPortBuffer:0,setViewDelay:100},o._url=e;var i,s={},a={};for(i in r)i in o.options?a[i]=r[i]:s[i]=r[i];return n.Util.setOptions(o,a),o.wmsParams=n.Util.extend({},o.defaultWmsParams,s),o}return L(e,t),e.prototype.setParams=function(t){n.Util.extend(this.wmsParams,t),this.update()},e.prototype.getAttribution=function(){return this.options.attribution||""},e.prototype.onAdd=function(){return this.update(),this},e.prototype.onRemove=function(t){return this._currentOverlay&&(this._currentOverlay.cancelLoad(),t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl,this},e.prototype.getEvents=function(){return{moveend:(0,P.Ds)(this.update,this.options.setViewDelay)}},e.prototype.update=function(){var t=this;if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!==e){this._currentUrl=e;var r=this.options.viewPortBuffer||0,o=this._map.getBounds().pad(r),n=new k(e,o,{opacity:0,pane:this.options.pane,headers:this.options.headers});n.addTo(this._map),this._currentOverlay&&this._currentOverlay.cancelLoad(),n.once("load",(function(){t._map&&(n._url===t._currentUrl?(t._currentOverlay&&t._map.removeLayer(t._currentOverlay),t._currentOverlay=n,n.setOpacity(void 0!==t.options.opacity?t.options.opacity:1),!0===t.options.isBack&&n.bringToBack(),!1===t.options.isBack&&n.bringToFront(),void 0!==t.options.zIndex&&n.setZIndex(t.options.zIndex)):t._map.removeLayer(n))}),this);var i=this.options,s=i.minZoom,a=i.maxZoom;(s&&this._map.getZoom()<s||a&&this._map.getZoom()>a)&&this._map.removeLayer(n)}}},e.prototype.setOpacity=function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)},e.prototype.bringToBack=function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()},e.prototype.bringToFront=function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()},e.prototype.setZIndex=function(t){this.options.zIndex=t,this._currentOverlay&&this._currentOverlay.setZIndex(t)},e.prototype.updateWmsParams=function(t){t||(t=this._map);var e=this.options.viewPortBuffer||0,r=t.getBounds().pad(e),o=t.getSize();if(0!==this.options.viewPortBuffer){var i=e+1;o.x=Math.ceil(o.x*i),o.y=Math.ceil(o.y*i)}var s=parseFloat(this.wmsParams.version),a=this.options.crs||t.options.crs,p=s>=1.3?"crs":"srs";if(a){var u=a.project(r.getNorthWest()),c=a.project(r.getSouthEast()),l={width:o.x,height:o.y};l[p]=a.code,l.bbox=(s>=1.3&&a===n.CRS.EPSG4326?[c.y,u.x,u.y,c.x]:[u.x,c.y,c.x,u.y]).join(","),n.Util.extend(this.wmsParams,l)}},e.prototype.getImageUrl=function(){var t=this.options.uppercase||!1,e=n.Util.getParamString(this.wmsParams,this._url,t);return this._url+e},e}(n.Layer),x=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),S=function(){return(S=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return x(e,t),e.prototype.addLayer=function(t){var e=t&&t.url;if(e){var r=(t=S({transparent:!0},t)).updateWmsParams;if(this.layer=new E(e,S(S({pane:this.pane,headers:t.headers,setViewDelay:t.setViewDelay},t),t.params)),r){var o=this.layer.updateWmsParams;this.layer.updateWmsParams=function(t){o.call(this,t),this.wmsParams=r(this.wmsParams)}}return this.layer}},e}(s),A=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),I=function(t,e){for(var r=0,o=e.length,n=t.length;r<o;r++,n++)t[n]=e[r];return t};function B(t){return function(t){function e(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var o=t.apply(this,e)||this;return o.options.setViewDelay&&(o._update=(0,P.Ds)((function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];(t=n.GridLayer.prototype._update).call.apply(t,I([o],e))}),o.options.setViewDelay)),o}return A(e,t),e.prototype.createTile=function(t,e){var r=this.getTileUrl(t),o=document.createElement("img");return o.abort=C(r,(function(t){o.src=t,e(null,o)}),this.options.headers),(this.options.crossOrigin||""===this.options.crossOrigin)&&(o.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),o.alt="",o.setAttribute("role","presentation"),o},e.prototype._abortLoading=function(){var t=this._tiles,e=this._tileZoom;for(var r in t)if(t[r].coords.z!==e){var o=t[r].el;o.onload=n.Util.falseFn,o.onerror=n.Util.falseFn,o.complete||(o.abort&&o.abort(),o.src=n.Util.emptyImageUrl,n.DomUtil.remove(o),delete t[r])}},e}(t)}var R=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Z=B(function(t){function e(e,r){var o=t.call(this,e,r)||this;return Object.assign(o.options,r),o}return R(e,t),e}(n.TileLayer)),U=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),M=function(){return(M=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return U(e,t),e.prototype.addLayer=function(t){if(t){var e=t.url,r=function(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(r[o[n]]=t[o[n]])}return r}(t,["url"]);if(e){var o=M({pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom},r.nativeOptions);return r.subdomains&&(o.subdomains=r.subdomains),r.headers?new Z(e,M(M({},o),{headers:r.headers,setViewDelay:r.setViewDelay})):new n.TileLayer(e,o)}}},e}(s),D=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),z=B(function(t){function e(e,r){return t.call(this,e,r)||this}return D(e,t),e}(n.TileLayer.WMS)),N=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),G=function(){return(G=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},H=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.prototype.addLayer=function(t){if(t){var e=t.url,r=function(t,e){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(r[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(t,o[n])&&(r[o[n]]=t[o[n]])}return r}(t,["url"]);if(e){var o={pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom,layers:t.layers,format:t.format};return r.headers?new z(e,G(G({},o),{headers:r.headers})):new n.TileLayer.WMS(e,o)}}},e}(s),V=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),W=function(){return(W=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return V(e,t),e.prototype.addLayer=function(e){return t.prototype.addLayer.call(this,W(W({},e),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}))},e}(F),J=function(){return(J=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},Q=function(){function t(){this.options={target:"map"},this.layerAdapters=t.layerAdapters,this.controlAdapters=t.controlAdapters,this.emitter=new o.EventEmitter,this._universalEvents=["zoomstart","zoom","zoomend","movestart","move","moveend"]}return t.prototype.create=function(t){if(this.options=J({},t),this.options.target){var e=this.options,r=e.maxZoom,o=e.minZoom,i=e.zoom,s=e.center,a=e.maxBounds,p=e.mapAdapterOptions;this.map=new n.Map(this.options.target,J({zoomControl:!1,attributionControl:!1,maxZoom:r,minZoom:o,zoom:i,maxBounds:a&&[[a[1],a[0]],[a[3],a[2]]],center:s&&[s[1],s[0]]},p)),this.map.createPane("order-0").style.zIndex=String(0),this.emitter.emit("create",this),this._addMapListeners()}},t.prototype.destroy=function(){this.map&&this.map.remove()},t.prototype.getContainer=function(){return this.map&&this.map.getContainer()},t.prototype.setCursor=function(t){this.map&&(this.map.getContainer().style.cursor=t)},t.prototype.setView=function(t,e){var r=t[0],o=t[1];this.map&&("number"==typeof e?this.map.setView([o,r],e,{animate:!1}):this.setCenter([r,o]))},t.prototype.setCenter=function(t){var e=t[0],r=t[1];this.map&&this.map.panTo([r,e])},t.prototype.getCenter=function(){var t=this.map;if(t){var e=t.getBounds().getCenter();return[e.lng,e.lat]}},t.prototype.setZoom=function(t){this.map&&this.map.setZoom(t)},t.prototype.getZoom=function(){return this.map&&this.map.getZoom()||void 0},t.prototype.getBounds=function(){if(this.map){var t=this.map.getBounds(),e=t.getSouthWest(),r=t.getNorthEast();return[e.lng,e.lat,r.lng,r.lat]}},t.prototype.fitBounds=function(t){this.map&&this.map.fitBounds([[t[3],t[0]],[t[1],t[2]]])},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype.createControl=function(t,e){return w(t,e)},t.prototype.createButtonControl=function(t){return function(t){var e=document.createElement("a"),r=t.title||"";e.href="#",e.title=r,e.setAttribute("role","button"),e.setAttribute("aria-label",r),n.DomEvent.disableClickPropagation(e),n.DomEvent.on(e,"click",n.DomEvent.stop),t.html instanceof HTMLElement?e.appendChild(t.html):"string"==typeof t.html&&(e.innerHTML=t.html);var o=function(e){e.stopPropagation(),t.onClick()};return w({onAdd:function(){return void 0!==t.onClick&&e.addEventListener("click",o),e},onRemove:function(){var r=e.parentNode;r&&r.removeChild(e),void 0!==t.onClick&&e.removeEventListener("click",o)}},{bar:!0})}(t)},t.prototype.addControl=function(t,e){if(t.options.position=e.replace("-",""),this.map)return this.map.addControl(t),t},t.prototype.removeControl=function(t){this.map&&this.map.removeControl(t)},t.prototype.removeLayer=function(t){t&&t.remove&&t.remove()},t.prototype.showLayer=function(t){this.map&&t.addTo(this.map)},t.prototype.hideLayer=function(t){t.remove()},t.prototype.setLayerOpacity=function(t,e){"setOpacity"in t&&t.setOpacity(e)},t.prototype.setLayerOrder=function(t,e,r){},t.prototype.onMapClick=function(t){var e=d(t);this.emitter.emit("preclick",e),this.emitter.emit("click",e)},t.prototype.locate=function(t,e){var r=this.map;if(r&&(r.locate(t),e)){var o=e.locationfound,n=e.locationerror,i=function(t){var e=t,r=[e.latlng.lng,e.latlng.lat];o({lngLat:r})};return void 0!==o&&r.on("locationfound",i,this),n&&r.on("locationerror",n,this),{stop:function(){void 0!==o&&r.off("locationfound",i),n&&r.off("locationerror",n)}}}return{stop:function(){}}},t.prototype._addMapListeners=function(){var t=this,e=this.map;e&&(e.on("click",(function(e){t.onMapClick(e)})),this._universalEvents.forEach((function(r){e.on(r,(function(){return t.emitter.emit(r,t)}),e)})))},t.layerAdapters={IMAGE:T,TILE:F,GEOJSON:_,WMS:H,OSM:q},t.controlAdapters={ZOOM:n.Control.Zoom,ATTRIBUTION:b},t.Map=n.Map,t}()},56018:function(t,e,r){"use strict";r.d(e,{Z:function(){return x}});var o,n,i=r(43590),s=r(39871),a=r(17187),p=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),u=function(t){function e(r){var o=t.call(this)||this;return o.name="NgwError",Object.assign(o,r),Object.setPrototypeOf(o,e.prototype),o}return p(e,t),e}(Error),c=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),l=function(t){function e(r){var o=t.call(this)||this;return o.name="NetworkError",Object.setPrototypeOf(o,e.prototype),o.message="Unable to request "+r+".\n    Possibly invalid NGW URL entered or CORS not configured to get request from "+location.origin,o}return c(e,t),e}(Error);n=function(t,e,r,o,n){void 0===r&&(r={}),r.method=r.method||"GET";var i=new XMLHttpRequest;i.open(r.method||"GET",t,!0),"blob"===r.responseType&&(i.responseType=r.responseType);var s=function(){try{return JSON.parse(i.responseText)}catch(t){return i.responseText}};i.onload=function(){-1!==[401,403,404,500].indexOf(i.status)&&o(new u(s())),function(t){void 0===t&&(t=!1);var n=t?o:e;"blob"===r.responseType?n(i.response):i.responseText?n(s()):o({message:""})}()},i.onerror=function(e){0===i.status?o(new l(t)):o(e)},i.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;r.onProgress&&r.onProgress(e,t)}};var a,p=r.headers;if(p)for(var c in p){var f=p[c];"string"==typeof f&&i.setRequestHeader(c,f)}if(void 0!==r.withCredentials&&(i.withCredentials=r.withCredentials),r.file){if((a=new FormData).append("file",r.file),r.data)for(var h in a)a.append(h,a[h])}else a=r.data?"string"==typeof r.data?r.data:JSON.stringify(r.data):null;n&&n((function(){i.abort()})),i.send(a)};var f=/\{ *([\w_-]+) *\}/g;function h(t,e){return t.replace(f,(function(t,r){var o=e[r];if(void 0===o)throw new Error("No value provided for letiable "+t);return"function"==typeof o&&(o=o(e)),o}))}var y=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),d=function(t){function e(r){var o=t.call(this,r)||this;return o.name="ResourceNotFoundError",o.exception="nextgisweb.resource.exception.ResourceNotFound",Object.setPrototypeOf(o,e.prototype),o}return y(e,t),e}(u),v=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),m=function(t){function e(r){var o=t.call(this,r)||this;return o.name="InsufficientPermissionsError",o.exception="nextgisweb.core.exception.InsufficientPermissions",Object.setPrototypeOf(o,e.prototype),o}return v(e,t),e}(u),g=[];function _(t){g.push(t)}function O(t){return"[object Object]"===Object.prototype.toString.call(t)}function b(t,e){void 0===e&&(e=""),e=e?e+"__":"";var r={};return Object.entries(t).forEach((function(t){var o=t[0],n=t[1];if(O(n)){var i=b(n,o);Object.assign(r,i)}else(0,s.ri)(n)&&(r[e+o]=n)})),r}function w(t,e){return C(t,e)}function P(t){return"[object Object]"===Object.prototype.toString.call(t)}function C(t,e){return Object.entries(t).every((function(t){var r=t[0],o=t[1],n=e[r];return P(o)?!!P(n)&&C(o,n):void 0===n||o===n}))}var j=function(){return(j=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},k=new i.Z.PromiseControl,L=function(){function t(t){this.connector=t,this._resourcesCache={}}return t.prototype.getOne=function(t,e){var r=this;return k.waitFunc((function(){return"string"==typeof t?r._fetchResourceBy({keyname:t},e):"number"==typeof t?r._fetchResourceById(t,e):O(t)?r._fetchResourceBy(t,e):i.Z.resolve(void 0)}),String(t))},t.prototype.getOneOrFail=function(t){return this.getOne(t).then((function(t){if(t)return t;throw new d}))},t.prototype.getId=function(t){return"number"==typeof t?i.Z.resolve(t):"string"==typeof t||O(t)?this.getOne(t).then((function(t){if(t)return t.resource.id})):i.Z.resolve(void 0)},t.prototype.getIdOrFail=function(t){return this.getId(t).then((function(t){if(void 0===t)throw new Error;return t}))},t.prototype.getMany=function(t,e){var r=this,o=[];if(t.id){var n=this._resourcesCache[t.id];n&&o.push(n)}else o=this._resourceCacheFilter(t);if(!o.length){var s={};return t.keyname?s.keyname=t.keyname:Object.assign(s,b(t)),this.connector.get("resource.search",e,j({serialization:"full"},s)).then((function(t){return t&&t.forEach((function(t){r._resourcesCache[t.resource.id]=t})),t}))}return i.Z.resolve(o)},t.prototype.getChildrenOf=function(t){var e=this,r={};"string"==typeof t?r.keyname=t:"number"==typeof t?r.resourceId=t:r=t;var o=r.resourceId,n=r.keyname;if(!r.keyname&&!(0,s.ri)(r.resourceId)&&!r.resource)throw new Error("No keyname or resourceId is set");r.resource&&("string"==typeof r.resource?n=r.resource:"number"==typeof r.resource&&(o=r.resource));var i=function(){return e.connector.get("resource.collection",null,{parent:o})};return n?this._fetchResourceBy({keyname:n}).then((function(t){return t&&(o=t.resource.id),i()})):i()},t.prototype.update=function(t,e){var r=this;return this.getId(t).then((function(t){if(void 0!==t)return r.connector.put("resource.item",{data:e},{id:t}).then((function(e){return r._resourcesCache[t]=e,e}))}))},t.prototype.delete=function(t){var e=this;return this.getId(t).then((function(t){if(void 0!==t)return e.connector.delete("resource.item",null,{id:t}).then((function(){delete e._resourcesCache[t]}))}))},t.prototype._fetchResourceById=function(t,e){var r=this,o=this._resourcesCache[t];return o?i.Z.resolve(o):this.connector.get("resource.item",e,{id:t}).then((function(e){return e&&(r._resourcesCache[t]=e),e})).catch((function(t){if(!(t instanceof d))throw t}))},t.prototype._fetchResourceBy=function(t,e){return this.getMany(t,e).then((function(t){return t[0]}))},t.prototype._resourceCacheFilter=function(t){return Object.values(this._resourcesCache).filter((function(e){return t.keyname&&e.resource.keyname?t.keyname===e.resource.keyname:(0,s.ri)(t.id)&&(0,s.ri)(e.resource.id)?t.id===e.resource.id:w(t,e.resource)}))},t}(),E=function(){return(E=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},x=function(){function t(t){this.options=t,this.emitter=new a.EventEmitter,this.routeStr="/api/component/pyramid/route",this.options.route&&(this.routeStr=this.options.route),this.resources=new L(this),_(this)}return t.create=function(t){return function(t){return g.find((function(e){if(e.options.baseUrl===t.baseUrl)if(t.auth){if(e.options.auth)return(0,s.vr)(e.options.auth,t.auth)}else e.options.auth}))}(t)||new this(t)},t.prototype.setNgw=function(t){this.logout(),this.options.baseUrl=t,_(this)},t.prototype.connect=function(){var t=this;return new i.Z((function(e,r){var o=function(){return t.makeQuery(t.routeStr,{},{}).then((function(r){t.route=r,e(r)})).catch((function(t){r(t)}))};if(t.route)return e(t.route);if(t.options.auth){var n=t.options.auth,i=n.login,s=n.password;if(i&&s)return t.getUserInfo({login:i,password:s}).then((function(){return o()})).catch((function(t){return r(t)}))}return o()}))},t.prototype.login=function(t){return this.logout(),_(this),this.getUserInfo(t)},t.prototype.logout=function(){var t,e;t=this,-1!==(e=g.indexOf(t))&&g.splice(e,1),this.options.auth=void 0,this.route=void 0,this.user=void 0,this.emitter.emit("logout")},t.prototype.getUserInfo=function(t){var e=this;if(this.user&&this.user.id)return i.Z.resolve(this.user);t&&(this.options.auth=t);var r={headers:this.getAuthorizationHeaders(t)};return this.makeQuery("/api/component/auth/current_user",{},r).then((function(t){return e.user=t,e.emitter.emit("login",t),t})).catch((function(t){throw e.emitter.emit("login:error",t),t}))},t.prototype.getAuthorizationHeaders=function(t){var e=this.makeClientId(t);if(e)return{Authorization:"Basic "+e}},t.prototype.makeClientId=function(t){if(t=t||this.options.auth){var e=t.login,r=t.password,o=unescape(encodeURIComponent(e+":"+r));return window.btoa(o)}},t.prototype.apiRequest=function(t,e,r){var o=this;return void 0===e&&(e={}),new i.Z((function(n,i){o.connect().then((function(s){var a=s&&s[t];if(a){var p=(a=function(t,e){for(var r=0,o=e.length,n=t.length;r<o;r++,n++)t[n]=e[r];return t}([],a)).shift();if(a.length){for(var u={},c=0;c<a.length;c++){var l=a[c];if(u[c]="{"+l+"}",void 0===e[l])throw new Error("`"+l+"` url api argument is not specified")}p&&(p=h(p,u))}if(e){var f=[],y=e.paramList;for(var d in Array.isArray(y)&&(delete e.paramList,y.forEach((function(t){f.push(t[0]+"="+t[1])}))),e)-1===a.indexOf(d)&&f.push(d+"="+e[d]);f.length&&(p=p+"?"+f.join("&"))}p?n(o.makeQuery(p,e,r)):i(new Error("request url is not set"))}else n(void 0)})).catch((function(t){i(t)}))}))},t.prototype.post=function(t,e,r){return(e=e||{}).method="POST",this.apiRequest(t,r,e)},t.prototype.get=function(t,e,r){return(e=e||{}).method="GET",this.apiRequest(t,r,e)},t.prototype.patch=function(t,e,r){return(e=e||{}).method="PATCH",this.apiRequest(t,r,e)},t.prototype.put=function(t,e,r){return(e=e||{}).method="PUT",this.apiRequest(t,r,e)},t.prototype.delete=function(t,e,r){return(e=e||{}).method="DELETE",this.apiRequest(t,r,e)},t.prototype.makeQuery=function(t,e,r){if(void 0===r&&(r={}),t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=h(t,e)),t=(0,s.nH)(t),this._loadData(t,r);throw new Error("No `url` parameter set for option "+name)},t.prototype.getResource=function(t){return this.resources.getOne(t)},t.prototype.getResourceOrFail=function(t){return this.resources.getOneOrFail(t)},t.prototype.getResourceBy=function(t){return this.resources.getOne(t)},t.prototype.getResourceByKeyname=function(t){return this.resources.getOne(t)},t.prototype.getResourceById=function(t){return this.resources.getOne(t)},t.prototype.getResourceId=function(t){return this.resources.getId(t)},t.prototype.getResourceIdOrFail=function(t){return this.resources.getIdOrFail(t)},t.prototype.getResourcesBy=function(t){return this.resources.getMany(t)},t.prototype.getResourceChildren=function(t){return this.resources.getChildrenOf(t)},t.prototype.updateResource=function(t,e){return this.resources.update(t,e)},t.prototype.deleteResource=function(t){return this.resources.delete(t)},t.prototype._loadData=function(t,e){var r=this;return e.responseType=e.responseType||"json",new i.Z((function(o,i,s){r.user&&((e=e||{}).headers=E(E({},r.getAuthorizationHeaders()),e.headers)),n(t,o,e,i,s)})).catch((function(t){if(t instanceof i.Z.CancelError);else{console.log(t);var e=r._handleHttpError(t);if(e)throw e}}))},t.prototype._handleHttpError=function(t){if(t&&t instanceof u){if("nextgisweb.resource.exception.ResourceNotFound"===t.exception)throw new d(t);if("nextgisweb.core.exception.InsufficientPermissions"===t.exception)throw new m(t)}return t},t.errors={NgwError:u,ResourceNotFoundError:d},t}()}}]);
//# sourceMappingURL=main-4aa8b69da224d2b.js.map