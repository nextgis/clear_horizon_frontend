(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(t,e,n){"use strict";var r,o=n(75),i=n(11),a=n(17),s=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},p=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function l(t,e,n){return c(this,void 0,void 0,function(){var r,o,l,f;return p(this,function(h){return r=e.mapAdapter.layerAdapters.GEOJSON,o=!1,l=function(e){if(e){var r=[];return e.forEach(function(t){var e=t[0],n=t[1],o=t[2];r.push("fld_"+e+"__"+n+"="+o)}),n.makeQuery("/api/resource/{id}/feature/?"+r.join("&"),{id:t.resourceId}).then(function(t){return{type:"FeatureCollection",features:t.map(function(t){var e=a.default.utils.wktToGeoJson(t.geom);return{type:"Feature",properties:t.fields,geometry:e}})}})}return n.makeQuery("/api/resource/{id}/geojson",{id:t.resourceId}).then(function(t){return o=!0,G(t)})},f=function(e){var n={data:e};return t.id&&(n.id=t.id),i.default.utils.updateGeoJsonAdapterOptions(n)},[2,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.addLayer=function(e){return c(this,void 0,void 0,function(){var n,r,o;return p(this,function(i){switch(i.label){case 0:return r=this,[4,l(e.propertiesFilter)];case 1:return n=r._dataPromise=i.sent(),this._dataPromise=void 0,o=f(n),[2,t.prototype.addLayer.call(this,u({},e,o))]}})})},e.prototype.beforeRemove=function(){this._dataPromise&&this._dataPromise.cancel()},e.prototype.propertiesFilter=function(t){return c(this,void 0,void 0,function(){var e,n;return p(this,function(r){switch(r.label){case 0:return this.filter&&o?(this.filter(function(e){return!e.feature||!e.feature.properties||i.default.utils.propertiesFilter(e.feature.properties,t)}),[3,3]):[3,1];case 1:return this.setData?(n=this,[4,l(t)]):[3,3];case 2:e=n._dataPromise=r.sent(),this._dataPromise=void 0,this.setData(e),r.label=3;case 3:return[2]}})})},e.prototype.removeFilter=function(){this.propertiesFilter([]),this.filter&&this.filter(function(){return!0})},e}(r)]})})}var f=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},y=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},d=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function v(t,e,n){return y(this,void 0,Promise,function(){var r,o;return d(this,function(i){if("IMAGE"===(r=t.adapter||"IMAGE")&&(o=e.getLayerAdapters(),!o||o.IMAGE||(r="TILE")),"IMAGE"===r||"TILE"===r||"MVT"===r)return[2,function(r){function o(o,i){var a=r.call(this,o,i)||this;a.map=o,a.resourceId=t.resourceId;var s=U(t,e,n);if(s)if(s.resourceId){var u=h({},s,{resourceId:s.resourceId});a.options=h({},a.options,u)}else{var c=s;a.options=h({},a.options,c)}return a}return f(o,r),o.prototype.addLayer=function(t){return r.prototype.addLayer.call(this,h({},this.options,t))},o.prototype.getIdentificationIds=function(){return y(this,void 0,void 0,function(){var t;return d(this,function(e){return(t=this.item&&this.item.resource.parent.id)?[2,[t]]:[2]})})},o}(e.mapAdapter.layerAdapters[r])];throw new Error(r+" not supported yet. Only TILE")})})}var m=n(33),g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},w=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var _=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},L=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},O=function(){function t(){}return t.prototype.getExtent=function(){return _(this,void 0,void 0,function(){return L(this,function(t){return this.item?[2,q(this.item,this.connector)]:[2]})})},t}(),P=function(){return(P=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},C=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},k=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},E=["mapserver_style","qgis_vector_style","raster_style"];function x(t,e,n,r){return C(this,void 0,Promise,function(){var i,a,s;return k(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,r.get("resource.item",null,{id:t.resourceId})];case 1:if((a=u.sent()).webmap)i=function(t,e,n,r){return b(this,void 0,Promise,function(){return w(this,function(o){return[2,function(o){function i(i){return o.call(this,i,{webMap:e,resourceId:t.resourceId,baseUrl:n,connector:r})||this}return g(i,o),i}(m.a)]})})}(t,e,n,r);else if(-1!==E.indexOf(a.resource.cls))"GEOJSON"===t.adapter?(s=P({},t,{resourceId:a.resource.parent.id}),i=l(s,e,r)):i=v(t,e,n);else if("vector_layer"===a.resource.cls)if(t.adapter&&"GEOJSON"!==t.adapter){if("MVT"!==t.adapter)return[2,M(a.resource.id,t,e,n,r)];i=v(t,e,n)}else i=l(t,e,r);else{if("raster_layer"===a.resource.cls)return[2,M(a.resource.id,t,e,n,r)];a.basemap_layer&&a.basemap_layer.qms&&(i=Promise.resolve(o.default.utils.createQmsAdapter(e))).then(function(t){if(t&&a.basemap_layer&&a.basemap_layer.qms){var e=JSON.parse(a.basemap_layer.qms);t.prototype.qms=e,t.prototype.baseLayer=!0}})}return[3,3];case 2:return u.sent(),i="GEOJSON"===t.adapter?l(t,e,r):v(t,e,n),[3,3];case 3:return i?[2,i.then(function(t){if(t){var e=t;return e.prototype.item=a,e.prototype.connector=r,Y(e,[O]),e}})]:[2]}})})}function M(t,e,n,r,o){return C(this,void 0,void 0,function(){var i,a;return k(this,function(s){switch(s.label){case 0:return[4,o.get("resource.collection",null,{parent:t})];case 1:return i=s.sent(),(a=i&&i[0])?[2,x(P({},e,{resourceId:a.resource.id}),n,r,o)]:[2]}})})}var I=n(165),A=n(166);n.d(e,"k",function(){return G}),n.d(e,"m",function(){return F}),n.d(e,"d",function(){return D}),n.d(e,"l",function(){return R}),n.d(e,"e",function(){return U}),n.d(e,"a",function(){return Z}),n.d(e,"g",function(){return z}),n.d(e,"f",function(){return q}),n.d(e,"i",function(){return J}),n.d(e,"c",function(){return K}),n.d(e,"h",function(){return X}),n.d(e,"b",function(){return Y}),n.d(e,"j",function(){return tt});var S=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(){return(j=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},T=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},N=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},B={"EPSG:3857":"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs"};function G(t){return Object(I.toWgs84)(t,B["EPSG:3857"],B)}function F(t){return G(Object(A.parse)(t))}function D(t){return t.replace(/([^:]\/)\/+/g,"$1")}function R(t,e){return{resource:e,extent:t.bbox,size:t.width+","+t.height,timestamp:Date.now()}}function U(t,e,n){var r=t.adapter||"IMAGE",o=e.getLayerAdapters(),i=!o||o.IMAGE;if("IMAGE"===r){if(i)return{url:n+"/api/component/render/image",resourceId:t.resourceId,headers:t.headers,updateWmsParams:function(e){return R(e,t.resourceId)}};r="TILE"}return"MVT"===r?{url:n+"/api/component/feature_layer/mvt?x={x}&y={y}&z={z}&resource="+t.resourceId+"&simplification="+(t.simplification||0)}:"TILE"===r?{url:n+"/api/component/render/tile?z={z}&x={x}&y={y}&resource="+t.resourceId,adapter:r}:void 0}function Z(t,e,n,r){var o=r.getAuthorizationHeaders();return o&&(t.headers=o),x(t,e,n,r)}function z(t){var e=t.extent_bottom,n=t.extent_left,r=t.extent_top,o=t.extent_right;if(e&&n&&r&&o){var i=[n,e,o,r];return i[3]>82&&(i[3]=82),i[1]<-82&&(i[1]=-82),i}}function H(t,e){return e.get("layer.extent",name,{id:t}).then(function(t){if(t){var e=t.extent,n=e.maxLat,r=e.maxLon,o=e.minLat;return[e.minLon,o,r,n]}})}function q(t,e){return T(this,void 0,Promise,function(){var n;return N(this,function(r){return t.webmap?[2,z(t.webmap)]:-1!==(n=t.resource).cls.indexOf("style")?[2,e.get("resource.item",null,{id:n.parent.id}).then(function(t){return H(t.resource.id,e)})]:[2,H(n.id,e)]})})}function J(t,e){var n=function(t,e,n,r){void 0===n&&(n=10);void 0===r&&(r=6);for(var o=n/$*Q,i=o/Math.cos(e*V),a=[],s=0;s<r+1;s++){var u=Math.PI*(s/(r/2)),c=t+i*Math.cos(u),p=e+o*Math.sin(u);a.push([c,p])}return a}(t.latLng.lng,t.latLng.lat,e.radius),r=[];n.forEach(function(t){var e=function(t,e){var n=20037508.34*t/180,r=Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180);return[n,r=20037508.34*r/180]}(t[0],t[1]),n=e[0],o=e[1];r.push(n+" "+o)});var o={geom:"POLYGON(("+r.join(", ")+"))",srs:3857,layers:e.layers};return e.connector.post("feature_layer.identify",{data:o})}var W,V=Math.PI/180,Q=180/Math.PI,$=3963;function K(t){return function(e){function n(n,r){return r=j({},t,r),e.call(this,n,r)||this}return S(n,e),n}(m.a)}function X(){if(void 0===W){var t=document.createElement("div");t.style.cssText="position: absolute;  left: -100%;  top: -100%;  width: 100cm;",document.body.appendChild(t);var e=t.offsetWidth;document.body.removeChild(t),W=e}return W}function Y(t,e){e.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e.prototype,n);r&&Object.defineProperty(t.prototype,n,r)})})}function tt(t){var e,n=[104,45];if(n){var r=n[1];return function(t){return Math.log(t/256)/Math.LN2}(X()*(e=r,12756274*Math.PI*Math.cos(e*Math.PI/180))/t)}return Math.round(Math.log(591657550.5/(t/2))/Math.log(2))}},108:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(51),o=n(10),i=n(33),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},u=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=function(){function t(t){if(this.options=t,!this.options.baseUrl)throw new Error("url is not defined");this.url=this.options.baseUrl,this.connector=new r.default({baseUrl:this.url,auth:this.options.auth})}return t.prototype.onLoadSync=function(t){return s(this,void 0,void 0,function(){var e,n,r,o,s;return u(this,function(u){switch(u.label){case 0:if(!this.options.resourceId||!this.options.baseUrl)return[3,4];if(!(e=[this.options.resourceId]).length)return[3,4];n=0,r=e,u.label=1;case 1:return n<r.length?(o=r[n],s={resourceId:o,connector:this.connector,baseUrl:this.options.baseUrl,webMap:t},[4,t.addLayer(i.a,a({visibility:!0,fit:!0,identification:this.options.identification,pixelRadius:this.options.pixelRadius},s))]):[3,4];case 2:u.sent(),u.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},t.prototype.getLayerAdapters=function(){return Promise.resolve([this._getLayerAdapter()])},t.prototype._getLayerAdapter=function(){var t=this;return{name:"WEBMAP",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}},t.prototype._createAdapter=function(t){var e=this.connector,n=this.options.baseUrl;return Object(o.c)({webMap:t,connector:e,baseUrl:n})},t.utils={toWgs84:o.k,wktToGeoJson:o.m,addNgwLayer:o.a,getNgwResourceExtent:o.f,sendIdentifyRequest:o.i,pixelsInMeterWidth:o.h},t.updateWmsParams=o.l,t.getLayerAdapterOptions=o.e,t.addNgwLayer=o.a,t}()},109:function(t,e,n){"use strict";var r=n(14),o=n(11),i=n(51),a=n(75),s=n(17),u=n(76);function c(){return o.default.decorators.onLoad("build-map")}var p=function(){return(p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function l(t){return t.replace(/([^:]\/)\/+/g,"$1")}function f(t,e,n){void 0===n&&(n=!1);var r=Array.isArray(e),o=r&&[]||{};return r?n?(t=t||[],o=o.concat(t),e.forEach(function(e,r){void 0===o[r]?o[r]=e:"object"==typeof e?o[r]=f(t[r],e,n):-1===t.indexOf(e)&&o.push(e)})):o=e:(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),Object.keys(e).forEach(function(r){"object"==typeof e[r]&&e[r]&&"object"==typeof t[r]&&"object"==typeof e[r]?o[r]=f(t[r],e[r],n):o[r]=e[r]})),o}function h(t,e,n){if("number"==typeof e)t.push(p({},n,{resourceId:e}));else if(Array.isArray(e)){var r=e[0],o=e[1];t.push(p({},n,{resourceId:r,id:o}))}else"object"==typeof e&&t.push(p({},n,e))}n.d(e,"a",function(){return O});var y,d=(y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),v=function(){return(v=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},m=function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},g=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},b=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},w=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},L={target:"map",baseUrl:"http://dev.nextgis.com/sandbox",controls:["ZOOM","ATTRIBUTION"],controlsOptions:{ZOOM:{position:"top-left"},ATTRIBUTION:{position:"bottom-right",customAttribution:['<a href="http://nextgis.ru" target="_blank">©NextGIS</a>']}},pixelRadius:10};var O=function(t){function e(e,n){var o=t.call(this,function(t,e){var n=f(L,e),r=[new a.default];return r.push(new s.default({baseUrl:n.baseUrl,auth:n.auth,identification:n.identification})),{mapAdapter:t,starterKits:r}}(e,n))||this;return o.emitter=new r.EventEmitter,o.options={},o._ngwLayers={},o.options=f(L,n),o.connector=n.connector||new i.default({baseUrl:o.options.baseUrl,auth:o.options.auth}),o._createWebMap().then(function(){var t=o.getContainer();t&&t.classList.add("ngw-map-container"),o._addControls()}),o}var n,p,y;return d(e,t),e.prototype.fit=function(){var t=this.options,e=t.center,n=t.zoom,r=t.bounds;e?(this.setCenter(e),n&&this.setZoom(n)):r&&this.fitBounds(r)},e.prototype.addControl=function(e,n,r){return b(this,void 0,void 0,function(){return w(this,function(o){return[2,t.prototype.addControl.call(this,e,n,r)]})})},e.prototype.addNgwLayer=function(t){return b(this,void 0,Promise,function(){var e,n,r,o,i;return w(this,function(a){switch(a.label){case 0:if(!t.resourceId)throw new Error("resourceId is required parameter to add NGW layer");if(!this.options.baseUrl)return[3,6];a.label=1;case 1:return a.trys.push([1,5,,6]),e=s.default.utils.addNgwLayer(t,this,this.options.baseUrl,this.connector),[4,this.addLayer(e,v({},t,t.adapterOptions))];case 2:return n=a.sent(),r=n&&this.getLayerId(n),n&&r?(this._ngwLayers[r]={layer:n,resourceId:t.resourceId},n.options.baseLayer&&this.getActiveBaseLayer()?[2,n]:(this.showLayer(n),t.fit&&n.getExtent?[4,n.getExtent()]:[3,4])):[3,4];case 3:(o=a.sent())&&this.fitBounds(o),a.label=4;case 4:return[2,n];case 5:return i=a.sent(),console.error("can't add ngw layer",i),[3,6];case 6:return[2]}})})},e.prototype.getNgwLayers=function(){return b(this,void 0,Promise,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.onLoad()];case 1:return t.sent(),[2,this._ngwLayers]}})})},e.prototype.getNgwLayerByResourceId=function(t){return b(this,void 0,Promise,function(){var e,n,r,o,i,a,s,u;return w(this,function(c){switch(c.label){case 0:for(n in e=[],this._ngwLayers)e.push(n);r=0,c.label=1;case 1:return r<e.length?(o=e[r],this._ngwLayers.hasOwnProperty(o)?(i=this._ngwLayers[o]).resourceId!==t?[3,2]:[2,i&&i.layer]:[3,5]):[3,6];case 2:return i.layer.getIdentificationIds?[4,i.layer.getIdentificationIds()]:[3,4];case 3:if((a=c.sent())&&a.some(function(e){return e===t}))return[2,i.layer];c.label=4;case 4:if(i.layer.getDependLayers&&(s=i.layer.getDependLayers(),u=s.find(function(e){return e.item&&e.item.parentId===t})))return[2,u.layer];c.label=5;case 5:return r++,[3,1];case 6:return[2]}})})},e.prototype.zoomToLayer=function(t){return b(this,void 0,void 0,function(){var e,n,r,o,i,a=this;return w(this,function(u){switch(u.label){case 0:return e="string"==typeof t||"number"==typeof t?String(e):t.id,(n=e&&this._ngwLayers[e])?n.layer.getExtent?[4,n.layer.getExtent()]:[3,2]:[3,6];case 1:return(r=u.sent())&&this.fitBounds(r),[3,6];case 2:return o=void 0,n.layer.item?(o=n.layer.item,[3,5]):[3,3];case 3:return i=n.resourceId,[4,this.connector.get("resource.item",null,{id:i})];case 4:o=u.sent(),u.label=5;case 5:s.default.utils.getNgwResourceExtent(o,this.connector).then(function(t){t&&a.fitBounds(t)}),u.label=6;case 6:return[2]}})})},e.prototype.onLoad=function(e){return void 0===e&&(e="ngw-map:create"),t.prototype.onLoad.call(this,e)},e.prototype.removeLayer=function(e){var n=this.getLayer(e);if(n){var r=this.getLayerId(n);r&&delete this._ngwLayers[r],t.prototype.removeLayer.call(this,n)}},e.prototype._createWebMap=function(){return b(this,void 0,void 0,function(){var t,e,n,r,o,i,a,s=this;return w(this,function(u){switch(u.label){case 0:return[4,this.create(v({},this.options))];case 1:return u.sent(),this.options.qmsId?(t=void 0,e=void 0,Array.isArray(this.options.qmsId)?(t=this.options.qmsId[0],e=this.options.qmsId[1]):t=this.options.qmsId,n={qmsId:t},e&&(n.id=e),[4,this.addBaseLayer("QMS",n).then(function(t){s.showLayer(t)})]):[3,3];case 2:u.sent(),u.label=3;case 3:h(r=[],this.options.webmapId,{fit:!0}),this.options.resources&&Array.isArray(this.options.resources)&&this.options.resources.forEach(function(t){h(r,t)}),o=0,i=r,u.label=4;case 4:return o<i.length?(a=i[o],[4,this.addNgwLayer(a)]):[3,7];case 5:u.sent(),u.label=6;case 6:return o++,[3,4];case 7:return this._emitStatusEvent("ngw-map:create",this),this.emitter.on("click",function(t){return s._selectFromNgw(t)}),[2]}})})},e.prototype._addControls=function(){var t=this;this.options.controls&&this.options.controls.forEach(function(e){var n=e,r={};"string"==typeof e&&t.options.controlsOptions&&t.options.controlsOptions[e]&&void 0!==(r=t.options.controlsOptions[e]).control&&(n=r.control);var o=r.position,i=_(r,["position"]);t.addControl(n,o||"top-left",i)}),this._emitStatusEvent("controls:create")},e.prototype._selectFromNgw=function(t){return b(this,void 0,void 0,function(){var e,n,r,o,i,a,u,c,p,l,f=this;return w(this,function(h){switch(h.label){case 0:for(n in e=[],this._ngwLayers)this._ngwLayers.hasOwnProperty(n)&&(r=this._ngwLayers[n].layer).getIdentificationIds&&r.options.selectable&&e.push(r.getIdentificationIds());return[4,Promise.all(e)];case 1:return o=h.sent(),i=[],o.forEach(function(t){t&&t.forEach(function(t){return i.push(t)})}),i.length&&(a=this.options.pixelRadius||10,u=this.getCenter(),c=this.getZoom(),u&&c)?(p=40075016.686*Math.abs(Math.cos(180*u[1]/Math.PI))/Math.pow(2,c+8),l=a*p*5e-4,[2,s.default.utils.sendIdentifyRequest(t,{layers:i,connector:this.connector,radius:l}).then(function(t){return f._emitStatusEvent("ngw:select",t),t})]):[2]}})})},e.utils=v({},o.default.utils,{fixUrlStr:l,deepmerge:f}),e.decorators=v({onMapLoad:c},o.default.decorators),e.getIcon=u.a,e.toWgs84=s.default.utils.toWgs84,e.wktToGeoJson=s.default.utils.wktToGeoJson,m([o.default.decorators.onLoad("controls:create"),g("design:type",Function),g("design:paramtypes",[Object,"function"==typeof(n=void 0!==o.ControlPositions&&o.ControlPositions)?n:Object,Object]),g("design:returntype",Promise)],e.prototype,"addControl",null),m([c(),g("design:type",Function),g("design:paramtypes",["function"==typeof(p=void 0!==s.NgwLayerOptions&&s.NgwLayerOptions)?p:Object]),g("design:returntype","function"==typeof(y="undefined"!=typeof Promise&&Promise)?y:Object)],e.prototype,"addNgwLayer",null),e}(o.default)},11:function(t,e,n){"use strict";var r=n(56),o=n(146);n.o(o,"ControlPositions")&&n.d(e,"ControlPositions",function(){return o.ControlPositions});var i=n(147);n.o(i,"ControlPositions")&&n.d(e,"ControlPositions",function(){return i.ControlPositions});var a=n(148);n.o(a,"ControlPositions")&&n.d(e,"ControlPositions",function(){return a.ControlPositions});var s=n(149);n.o(s,"ControlPositions")&&n.d(e,"ControlPositions",function(){return s.ControlPositions});var u=n(150);n.o(u,"ControlPositions")&&n.d(e,"ControlPositions",function(){return u.ControlPositions});var c=n(151);n.o(c,"ControlPositions")&&n.d(e,"ControlPositions",function(){return c.ControlPositions});var p=n(152);n.o(p,"ControlPositions")&&n.d(e,"ControlPositions",function(){return p.ControlPositions});var l=n(153);n.o(l,"ControlPositions")&&n.d(e,"ControlPositions",function(){return l.ControlPositions});var f=n(154);n.o(f,"ControlPositions")&&n.d(e,"ControlPositions",function(){return f.ControlPositions}),e.default=r.a},110:function(t,e,n){"use strict";function r(t,e,n,o){void 0===e&&(e=function(t){return!!t}),void 0===o&&(o=[]);var i=[];if(Array.isArray(t))i=t;else{e(t)&&o.push(t);var a=n(t);a&&(Array.isArray(a)?i=a:i.push(a))}for(var s=0;s<i.length;s++)i[s]&&r(i[s],e,n,o);return o}var o=function(){function t(t){this._children=[],this.item=t}return t.prototype.setParent=function(t){this._parent=t},t.prototype.addChild=function(t){this._children.push(t)},t.prototype.getParent=function(){return this._parent},t.prototype.getParents=function(t){var e=this.getParent();return e?r(e,t,function(t){return t.tree.getParent()}):[]},t.prototype.find=function(t){return r(this._children,t,function(t){return t.tree.getChildren()})[0]},t.prototype.all=function(t){return this.getDescendants(t)},t.prototype.getDescendants=function(t){return r(this._children,t,function(t){return t.tree.getChildren()})},t.prototype.getChildren=function(){return this._children},t}(),i=n(71);n.d(e,"a",function(){return c});var a,s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};try{a=n(14)}catch(t){}var u=a&&a.EventEmitter,c=function(){function t(t){this.options={},this.emitter=u&&new u,this.options=s({},t),this.tree=new o(this)}return t.prototype.initProperties=function(){this.properties=new i.a(this,this.options.properties)},t}()},111:function(t,e,n){"use strict";n(356);var r=n(44);var o=/\{ *([\w_-]+) *\}/g;function i(t,e){return t.replace(o,function(t,n){var r=e[n];if(void 0===r)throw new Error("No value provided for letiable "+t);return"function"==typeof r&&(r=r(e)),r})}var a=n(14);n.d(e,"a",function(){return c});var s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},u=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=function(){function t(t){void 0===t&&(t={}),this.options=t,this.emitter=new a.EventEmitter,this.routeStr="/api/component/pyramid/route",this._loadingQueue={},this._loadingStatus={},this.options.route&&(this.routeStr=this.options.route)}return t.prototype.connect=function(){return s(this,void 0,r.a,function(){var t,e,n,r=this;return u(this,function(o){switch(o.label){case 0:return this.route?[2,Promise.resolve(this.route)]:[3,1];case 1:return this.options.auth?(t=this.options.auth,e=t.login,n=t.password,e&&n?[4,this.getUserInfo({login:e,password:n})]:[3,3]):[3,3];case 2:o.sent(),o.label=3;case 3:return[4,this.makeQuery(this.routeStr,{},{}).then(function(t){return r.route=t,t})];case 4:return[2,o.sent()]}})})},t.prototype.login=function(t){return s(this,void 0,void 0,function(){return u(this,function(e){return this.logout(),[2,this.getUserInfo(t)]})})},t.prototype.logout=function(){this._rejectLoadingQueue(),this._loadingStatus={},this.options.auth=void 0,this.route=void 0,this.user=void 0},t.prototype.getUserInfo=function(t){var e=this;t&&(this.options.auth=t);var n={headers:this.getAuthorizationHeaders(t)};return this.makeQuery("/api/component/auth/current_user",{},n).then(function(t){return e.user=t,e.emitter.emit("login",t),t}).catch(function(t){throw e.emitter.emit("login:error",t),t})},t.prototype.getAuthorizationHeaders=function(t){var e=this.makeClientId(t);if(e)return{Authorization:"Basic "+e}},t.prototype.makeClientId=function(t){if(t=t||this.options.auth){var e=t.login,n=t.password;return window.btoa(unescape(encodeURIComponent(e+":"+n)))}},t.prototype.request=function(t,e,n){return void 0===e&&(e={}),s(this,void 0,r.a,function(){var r,o,a,s,c,p,l,f;return u(this,function(u){switch(u.label){case 0:return[4,this.connect()];case 1:if(r=u.sent(),o=r&&r[t]){if(o=o.slice(),a=o.shift(),o.length){for(s={},c=0;c<o.length;c++)if(p=o[c],s[c]="{"+p+"}",void 0===e[p])throw new Error("`"+p+"` url api argument is not specified");a&&(a=i(a,s))}if(e){for(f in l=[],e)e.hasOwnProperty(f)&&-1===o.indexOf(f)&&l.push(f+"="+e[f]);l.length&&(a=a+"/?"+l.join("&"))}if(a)return[2,this.makeQuery(a,e,n)];throw new Error("request url is not set")}return[2]}})})},t.prototype.post=function(t,e,n){return(e=e||{}).method="POST",e.nocache=!0,this.request(t,n,e)},t.prototype.get=function(t,e,n){return(e=e||{}).method="GET",e.nocache=!0,this.request(t,n,e)},t.prototype.makeQuery=function(t,e,n){var o=this;if(void 0===n&&(n={}),t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=i(t,e)),t=t.replace(/([^:]\/)\/+/g,"$1"),!this._loadingStatus[t]||n.nocache?(this._loadingStatus[t]=!0,this._getJson(t,n).then(function(e){return o._loadingStatus[t]=!1,o._executeLoadingQueue(t,e),e}).catch(function(e){throw o._loadingStatus[t]=!1,o._executeLoadingQueue(t,e,!0),o.emitter.emit("error",e),e})):(this._loadingStatus[t]=!1,new r.a(function(e,n){o._setLoadingQueue(t,e,n)}));throw new Error("No `url` parameter set for option "+name)},t.prototype._setLoadingQueue=function(t,e,n){this._loadingQueue[t]=this._loadingQueue[t]||{name:t,waiting:[]},this._loadingQueue[t].waiting.push({resolve:e,reject:n,timestamp:new Date})},t.prototype._rejectLoadingQueue=function(){for(var t in this._loadingQueue){if(this._loadingQueue.hasOwnProperty(t))this._loadingQueue[t].waiting.forEach(function(t){t.reject()}),delete this._loadingQueue[t]}},t.prototype._executeLoadingQueue=function(t,e,n){var r=this._loadingQueue[t];if(r){for(var o=0;o<r.waiting.length;o++){var i=r.waiting[o];n?i.reject&&i.reject():i.resolve(e)}r.waiting=[]}},t.prototype._getJson=function(t,e){var n=this,o=[];return new r.a(function(r,i){n.user&&((e=e||{}).headers=n.getAuthorizationHeaders()),function(t,e,n,r,o){var i;void 0===n&&(n={}),n.method=n.method||"GET",(i=new XMLHttpRequest).open(n.method||"GET",t,!0);var a=function(t){void 0===t&&(t=!1);var n=t?r:e;if(i.responseText)try{n(JSON.parse(i.responseText))}catch(t){r({message:""})}else r({message:""})};i.onreadystatechange=function(){4===i.readyState&&200===i.status||3===i.readyState&&201===i.status?a():3===i.readyState&&400===i.status?a():4===i.readyState&&500===i.status?a():4===i.readyState&&401===i.status?r(i.statusText):4===i.readyState&&r("request error")},i.onerror=function(t){r(t)},i.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;n.onProgress&&n.onProgress(e)}};var s,u=n.headers;if(u)for(var c in u)if(u.hasOwnProperty(c)){var p=u[c];"string"==typeof p&&i.setRequestHeader(c,p)}if(void 0!==n.withCredentials&&(i.withCredentials=n.withCredentials),n.file){if((s=new FormData).append("file",n.file),n.data)for(var l in s)s.hasOwnProperty(l)&&s.append(l,s[l])}else s=n.data?JSON.stringify(n.data):null;o&&o.push(function(){i.abort()}),i.send(s)}(t,r,e,i,o)},function(){o.forEach(function(t){return t()})})},t}()},112:function(t,e,n){"use strict";var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},i=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a={tms:"TILE"};function s(t,e){return void 0===e&&(e="https://qms.nextgis.com"),function(){function n(t,e){this.map=t,this.options=e,this.options=e,this.options.baseLayer=!0}return n.prototype.addLayer=function(n){return o(this,void 0,void 0,function(){var o,s,c,p;return i(this,function(i){switch(i.label){case 0:return this.qms||!n.qmsId?[3,2]:(o=this,[4,u(e+"/api/v1/geoservices/"+n.qmsId)]);case 1:o.qms=i.sent(),i.label=2;case 2:return(s=this.qms)&&(c=a[s.type||"tms"],(p=t.mapAdapter.layerAdapters[c])&&"TILE"===c)?(n=r({maxZoom:t.options.maxZoom,minZoom:t.options.minZoom},this.options,function(t){var e=("https:"===location.protocol?"https":"http")+"://";return{url:t.url.replace(/^(https?|ftp):\/\//,e),name:t.name,attribution:t.copyright_text,maxZoom:t.z_max,minZoom:t.z_min}}(s)),this.options=n,[2,new p(this.map,n).addLayer(n)]):[2]}})})},n}()}function u(t){return new Promise(function(e,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState&&200===r.status&&r.responseText)try{e(JSON.parse(r.responseText))}catch(t){n(t)}},r.open("GET",function(t){return t.replace(/([^:]\/)\/+/g,"$1")}(t),!0),r.send()})}n.d(e,"a",function(){return p});var c=function(){return(c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},p=function(){function t(t){this.options={url:"https://qms.nextgis.com"},this.options=c({},this.options,t),this.url=this.options.url}return t.prototype.getLayerAdapters=function(){var t=this;return Promise.resolve([{name:"QMS",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}])},t.prototype._createAdapter=function(t){return s(t,this.url)},t.utils={createQmsAdapter:s},t}()},146:function(t,e){},147:function(t,e){},148:function(t,e){},149:function(t,e){},150:function(t,e){},151:function(t,e){},152:function(t,e){},153:function(t,e){},154:function(t,e){},155:function(t,e){},156:function(t,e){},157:function(t,e){},158:function(t,e){},159:function(t,e){},160:function(t,e){},162:function(t,e){},163:function(t,e,n){"use strict";n(17)},164:function(t,e,n){"use strict";var r=n(110);n(160),n(73),n(72),n(71);e.default=r.a},168:function(t,e,n){n(169),t.exports=n(369)},17:function(t,e,n){"use strict";var r=n(108),o=n(162);n.o(o,"NgwLayerOptions")&&n.d(e,"NgwLayerOptions",function(){return o.NgwLayerOptions});n(33),n(70);e.default=r.a},33:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(10),o=n(70),i=n(14),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},u=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},c=function(){function t(t,e){this.map=t,this.options=e,this.pixelRadius=10,this.emitter=new i.EventEmitter;var n=e.resourceId;if(Array.isArray(n)?(this.resourceId=n[0],this.options.id=n[1]):this.resourceId=n,!this.resourceId)throw new Error("NGW `resourceId` is not defined")}return t.prototype.addLayer=function(t){return s(this,void 0,Promise,function(){var e,n,r=this;return u(this,function(o){switch(o.label){case 0:return this.options=a({},this.options,t),e=this,[4,this._getWebMapLayerItem()];case 1:return e.layer=o.sent(),this.options.identification?[4,this._getWebmapIds()]:[3,3];case 2:(n=o.sent())&&(this._webmapLayersIds=n,this.$$onMapClick=function(t){return r._onMapClick(t)},this.options.webMap.emitter.on("click",this.$$onMapClick)),o.label=3;case 3:return[2,this.layer]}})})},t.prototype.removeLayer=function(){var t=this.options.webMap.mapAdapter;this.$$onMapClick&&this.options.webMap.emitter.off("click",this.$$onMapClick),this.getDependLayers().forEach(function(e){t.removeLayer(e.layer.layer)}),this.$$onMapClick=void 0,delete this.options,delete this.layer,delete this.response,delete this._webmapLayersIds},t.prototype.showLayer=function(){this.layer&&this.layer.properties&&this.layer.properties.property("visibility").set(!0)},t.prototype.hideLayer=function(){this.layer&&this.layer.properties&&this.layer.properties.property("visibility").set(!1)},t.prototype.getExtent=function(){var t=this.response&&this.response.webmap;if(t)return Object(r.g)(t)},t.prototype.getDependLayers=function(){return this.layer&&this.layer.tree.getDescendants()||[]},t.prototype.getIdentificationIds=function(){return s(this,void 0,void 0,function(){return u(this,function(t){switch(t.label){case 0:return this._webmapLayersIds?[2,this._webmapLayersIds]:[3,1];case 1:return[4,this._getWebmapIds()];case 2:return[2,t.sent()]}})})},t.prototype._getWebMapLayerItem=function(){return s(this,void 0,Promise,function(){var t,e=this;return u(this,function(n){switch(n.label){case 0:return this.resourceId?[4,this.getWebMapConfig(this.resourceId)]:[3,2];case 1:if((t=n.sent())&&t.root_item)return[2,new Promise(function(n){var r={};if(e.options.connector&&e.options.connector.options.auth){var i=e.options.connector.getAuthorizationHeaders();i&&(r.headers=i)}var a=new o.a(e.options.webMap,t.root_item,r);a.emitter.on("init",function(){return n(a)})})];n.label=2;case 2:return[2]}})})},t.prototype.getWebMapConfig=function(t){return s(this,void 0,void 0,function(){var e,n;return u(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.options.connector.get("resource.item",null,{id:t})];case 1:return e=r.sent(),this.response=e,(n=e.webmap)?(this._updateItemsParams(n.root_item,this.options.webMap),[2,n]):[3,3];case 2:throw r.sent();case 3:return[2]}})})},t.prototype._updateItemsParams=function(t,e){var n=this;if(t)if("group"===t.item_type||"root"===t.item_type)t.children&&(t.children=t.children.map(function(t){return n._updateItemsParams(t,e)}));else if("layer"===t.item_type){var o=Object(r.d)(this.options.baseUrl+"/api/component/render/image"),i=t.layer_style_id;t.url=o,t.resourceId=i,t.updateWmsParams=function(t){return Object(r.l)(t,i)},t=a({},t,Object(r.e)({adapter:t.layer_adapter.toUpperCase(),resourceId:i},e,this.options.baseUrl))}return t},t.prototype._getWebmapIds=function(){return s(this,void 0,Promise,function(){var t,e,n,r=this;return u(this,function(o){switch(o.label){case 0:return(t=this.layer)&&"root"===t.item.item_type?(e=t.item.children,n=[],e.forEach(function(t){if("layer"===t.item_type){var e=t.layer_style_id,o=r.options.connector.get("resource.item",{},{id:e}).then(function(e){if(e){var n=Number(e.resource.parent.id);return t.parentId=n,n}});n.push(o)}}),[4,Promise.all(n)]):[3,2];case 1:return[2,o.sent().filter(function(t){return void 0!==t})];case 2:return[2]}})})},t.prototype._sendIdentifyRequest=function(t,e){var n=this;if(void 0===e&&(e={}),this._webmapLayersIds)return Object(r.i)(t,{layers:this._webmapLayersIds,connector:this.options.connector,radius:this.pixelRadius}).then(function(e){return n.emitter.emit("identify",{ev:t,data:e}),e})},t.prototype._onMapClick=function(t){this._sendIdentifyRequest(t)},t}()},355:function(t,e){},356:function(t,e,n){(function(t,e){!function(){"use strict";function n(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})}function r(){}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(t,this)}function i(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,r)}else(1===t._state?a:s)(e.promise,t._value)})):t._deferreds.push(e)}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void u(t);if("function"==typeof n)return void c(function(t,e){return function(){t.apply(e,arguments)}}(n,e),t)}t._state=1,t._value=e,u(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,u(t)}function u(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;n>e;e++)i(t,t._deferreds[e]);t._deferreds=null}function c(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}var p=setTimeout;o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return i(this,new function(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}(t,e,n)),n},o.prototype.finally=n,o.all=function(t){return new o(function(e,n){function r(t,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(e){r(t,e)},n)}o[t]=a,0==--i&&e(o)}catch(t){n(t)}}if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(t);if(0===o.length)return e([]);for(var i=o.length,a=0;o.length>a;a++)r(a,o[a])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var r=0,o=t.length;o>r;r++)t[r].then(e,n)})},o._immediateFn="function"==typeof t&&function(e){t(e)}||function(t){p(t,0)},o._unhandledRejectionFn=function(t){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var l=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw Error("unable to locate global object")}();"Promise"in l?l.Promise.prototype.finally||(l.Promise.prototype.finally=n):l.Promise=o}()}).call(this,n(357).setImmediate,n(106))},361:function(t,e){},362:function(t,e){},363:function(t,e){},364:function(t,e){},365:function(t,e){},367:function(t,e){},368:function(t){t.exports={mapOptions:{target:"map",qmsId:487,bounds:[45,46,47,49],baseUrl:"http://clear-horizon.nextgis.com",resources:[{resourceId:"1",fit:!0}]},fires:[{resourceId:81,id:"MODIS",color:"red"},{resourceId:83,id:"VIIRS",color:"orange"}]}},369:function(t,e,n){"use strict";n.r(e);n(355);var r=n(74),o=n(76),i=n(1),a=n.n(i),s=n(14);function u(t,e,n){var r=new XMLHttpRequest;for(var o in r.responseType="blob",r.onreadystatechange=function(){4===r.readyState&&200===r.status&&e(r.response)},r.open("GET",t,!0),n)n.hasOwnProperty(o)&&r.setRequestHeader(o,n[o]);r.send()}var c,p=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=function(t){function e(e,n){return t.call(this,e,n)||this}return p(e,t),e.prototype.createTile=function(t,e){var n=this.getTileUrl(t),r=document.createElement("img");return u(n,function(t){r.src=URL.createObjectURL(t),e(null,r)},this.options.headers),(this.options.crossOrigin||""===this.options.crossOrigin)&&(r.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),r.alt="",r.setAttribute("role","presentation"),r},e}(i.TileLayer),f=function(){function t(t,e){if(this.map=t,this.options=e,this.pane="order-0",void 0!==e.order){var n="order-"+e.order,r=t.getPane(n);r||(r=t.createPane(n)),r.style.zIndex=String(e.order),this.pane=n}}return t.prototype.addLayer=function(t){},t}(),h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),y=function(){return(y=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},d=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return h(e,t),e.prototype.addLayer=function(t){if(t){var e=t.url,n=d(t,["url"]);if(e){var r={pane:this.pane,attribution:n.attribution,minZoom:n.minZoom,maxZoom:n.maxZoom};return n.headers?new l(e,y({},r,{headers:n.headers})):new i.TileLayer(e,r)}}},e}(f),m=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),g=function(){return(g=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},b=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},w={Point:"circle",LineString:"line",MultiPoint:"circle",Polygon:"fill",MultiLineString:"line",MultiPolygon:"fill",GeometryCollection:"fill"},_={stroke:!1,opacity:1},L={};for(var O in w)if(w.hasOwnProperty(O)){var P=w[O],C=L[P]||[];C.push(O),L[P]=C}var k=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.selected=!1,r._layers=[],r._selectedLayers=[],r.layer=new i.FeatureGroup([],{pane:r.pane}),r}return m(e,t),e.prototype.addLayer=function(t){if(t)return this.options=t,this.paint=t.paint,this.selectedPaint=t.selectedPaint,t.paint=this.paint,t.data&&this.addData(t.data),this.layer},e.prototype.select=function(t){var e=this;t?this._layers.filter(t).forEach(function(t){e._selectLayer(t.layer)}):this.selected||(this.selected=!0,this.selectedPaint&&this.setPaintEachLayer(this.selectedPaint))},e.prototype.unselect=function(t){var e=this;t?this._layers.filter(t).forEach(function(t){e._unSelectLayer(t.layer)}):this.selected&&(this.selected=!1,this.paint&&this.setPaintEachLayer(this.paint))},e.prototype.getSelected=function(){return this._selectedLayers.map(function(t){return{feature:t.feature,layer:t}})},e.prototype.filter=function(t){var e=this;this._filterFun=t;var n=this.layer._map;n&&this.layer.remove(),this._layers.forEach(function(n){var r=n.feature,o=n.layer;o&&(!t||t({feature:r,layer:o})?e.layer.addLayer(o):e.layer.removeLayer(o))}),n&&this.layer.addTo(n)},e.prototype.cleanFilter=function(){this.filter()},e.prototype.getLayers=function(){return this._layers.map(function(t){var e=t.layer;return{feature:t.feature,layer:e,visible:e&&e._map}})},e.prototype.clearLayer=function(t){if(t)for(var e=this._layers.length;e--;){var n=this._layers[e];n.feature&&t(n.feature)&&(this.layer.removeLayer(n.layer),this._layers.splice(e,1))}else this.layer.clearLayers(),this._layers=[]},e.prototype.setData=function(t){this.clearLayer(),this.addData(t)},e.prototype.addData=function(t){var e,n=this.options;if(n){if(t){var r=void 0;if(n.type)r=n.type;else{var o=function(t){var e;if("FeatureCollection"===t.type){var n=t.features.map(function(t){return t.geometry.type});e=E(n)}else if("GeometryCollection"===t.type){var r=t.geometries.map(function(t){return t.type});e=E(r)}else e="Feature"===t.type?t.geometry.type:t.type;return e}(t);r=w[o]}if(this.type&&this.type!==r)return console.warn("no other data type than layer can be added"),!1;this.type=r,(t=function(t,e){if("FeatureCollection"===t.type)t.features=t.features.filter(function(t){return x(t.geometry.type,e)});else if("Feature"===t.type){var n=x(t.geometry.type,e);if(!n)return!1}else"GeometryCollection"===t.type&&(t.geometries=t.geometries.filter(function(t){return x(t.type,e)}));return t}(t,r))&&(e=this.getGeoJsonOptions(n,r))}new i.GeoJSON(t||void 0,e)}},e.prototype.openPopup=function(t,e){var n=this;t&&this._layers.filter(t).forEach(function(t){n._openPopup(t.layer,e)})},e.prototype.closePopup=function(t){var e=this;(t?this._layers.filter(t):this._layers).forEach(function(t){e._closePopup(t.layer)})},e.prototype._openPopup=function(t,e){var n=t.feature,r=e&&e.createPopupContent?e.createPopupContent({layer:t,feature:n}):"";t.bindPopup(r).openPopup()},e.prototype._closePopup=function(t){t.closePopup().unbindPopup()},e.prototype.setPaintEachLayer=function(t){var e=this;this.layer.eachLayer(function(n){e.setPaint(n,t)})},e.prototype.setPaint=function(t,e){var n;if(n="function"==typeof e?e(t.feature):e,"circle"===this.type&&"icon"===n.type){var r=t,o=this.createDivIcon(n);r.setIcon(o)}else"setStyle"in t&&t.setStyle(this.preparePaint(n))},e.prototype.preparePaint=function(t){if("get-paint"!==t.type){var e="line"===this.type?[["color","strokeColor"],["opacity","strokeOpacity"],["weight","weight"]]:[["color","strokeColor"],["opacity","strokeOpacity"],["stroke","stroke"],["fillColor","fillColor"],["fillOpacity","fillOpacity"],["fill","fill"],["weight","weight"]],n={};return"radius"in t&&(n.radius=t.radius),e.forEach(function(e){var r=e[0],o=e[1],i=t[o];void 0!==i&&Object.defineProperty(n,r,{enumerable:!0,value:i})}),n}return _},e.prototype.getGeoJsonOptions=function(t,e){var n=this,r=t.paint,o={};return(o="function"==typeof r?"circle"===e?{pointToLayer:function(t,e){var o=r(t);return n.createPaintToLayer(o)(t,e)}}:{style:function(t){return t?n.preparePaint(g({},_,r(t))):n.preparePaint(g({},_,{type:"path"}))}}:this.createPaintOptions(r,e)).onEachFeature=function(e,r){r.options.pane=n.pane,n._layers.push({feature:e,layer:r});var o=!0;n._filterFun&&(o=n._filterFun({feature:e,layer:r})),o&&(n.layer.addLayer(r),t.selectable&&(t.selectOnHover?(r.on("mouseover",function(){n._selectLayer(r)}),r.on("mouseout",function(){n._unSelectLayer(r)})):r.on("click",n._onLayerClick,n)))},o},e.prototype._onLayerClick=function(t){i.DomEvent.stopPropagation(t);var e=t.target,n=-1!==this._selectedLayers.indexOf(e);n?this.options&&this.options.unselectOnSecondClick&&(this._unSelectLayer(e),n=!1):(this._selectLayer(e),n=!0),this.options.onLayerClick&&this.options.onLayerClick({layer:this,feature:e.feature,selected:n})},e.prototype._selectLayer=function(t){var e=this;this.options&&!this.options.multiselect&&this._selectedLayers.forEach(function(t){return e._unSelectLayer(t)}),this._selectedLayers.push(t),this.selected=!0,this.options&&(this.options.selectedPaint&&this.setPaint(t,this.options.selectedPaint),this.options.popupOnSelect&&this._openPopup(t,this.options.popupOptions))},e.prototype._unSelectLayer=function(t){var e=this._selectedLayers.indexOf(t);-1!==e&&this._selectedLayers.splice(e,1),this.selected=this._selectedLayers.length>0,this.options&&(this.options.paint&&this.setPaint(t,this.options.paint),this.options.popupOnSelect&&this._closePopup(t))},e.prototype.createDivIcon=function(t){t.type;var e=b(t,["type"]);return new i.DivIcon(g({className:""},e))},e.prototype.createPaintToLayer=function(t){var e=this;if("icon"===t.type){var n=t.className,r=t.html;if(n||r)return function(n,r){var o=e.createDivIcon(t);return new i.Marker(r,{icon:o})}}return function(n,r){var o=_;return new i.CircleMarker(r,e.preparePaint(g({},o,t)))}},e.prototype.createPaintOptions=function(t,e){var n={},r=t&&this.preparePaint(t)||{};return t&&(n.style=function(t){return r}),"circle"===e?n.pointToLayer=this.createPaintToLayer(t):"line"===e&&(r.stroke=!0),n},e}(f);function E(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=1+(e[t[n]]||0);var r="";for(var o in e)if(e.hasOwnProperty(o)){var i=r?e[r]:0;e[o]>i&&(r=o)}return r}function x(t,e){return-1!==(L[e]||[]).indexOf(t)}var M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),I=function(t){function e(e){var n=t.call(this,e)||this,r=e&&e.customAttribution;if(r){var o=[];Array.isArray(r)?o=r:r&&(o=[r]),o.forEach(function(t){return n.addAttribution(t)})}return n}return M(e,t),e}(i.Control.Attribution),A=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return A(e,t),e.prototype._initImage=function(){t.prototype._initImage.call(this);var e=this.options.headers;if(e){var n=this._image,r=n.src;n.src="",u(r,function(t){n.src=URL.createObjectURL(t)},e)}},e}(a.a.ImageOverlay),j=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),T=function(t){function e(e,n){var r=t.call(this,n)||this;r.defaultWmsParams={service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},r.options={crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18,pane:"tilePane",headers:null},r._url=e;var o={},i={};for(var s in n)s in r.options?i[s]=n[s]:o[s]=n[s];return a.a.Util.setOptions(r,i),r.wmsParams=a.a.Util.extend({},r.defaultWmsParams,o),r}return j(e,t),e.prototype.setParams=function(t){a.a.Util.extend(this.wmsParams,t),this.update()},e.prototype.getAttribution=function(){return this.options.attribution||""},e.prototype.onAdd=function(){return this.update(),this},e.prototype.onRemove=function(t){return this._currentOverlay&&(t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl,this},e.prototype.getEvents=function(){return{moveend:this.update}},e.prototype.update=function(){var t=this;if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!==e){this._currentUrl=e;var n=this._map.getBounds(),r=new S(e,n,{opacity:0,pane:this.options.pane,headers:this.options.headers});r.addTo(this._map),r.once("load",function(){t._map&&(r._url===t._currentUrl?(t._currentOverlay&&t._map.removeLayer(t._currentOverlay),t._currentOverlay=r,r.setOpacity(void 0!==t.options.opacity?t.options.opacity:1),!0===t.options.isBack&&r.bringToBack(),!1===t.options.isBack&&r.bringToFront(),void 0!==t.options.zIndex&&r.setZIndex(t.options.zIndex)):t._map.removeLayer(r))},this);var o=this.options,i=o.minZoom,a=o.maxZoom;(i&&this._map.getZoom()<i||a&&this._map.getZoom()>a)&&this._map.removeLayer(r)}}},e.prototype.setOpacity=function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)},e.prototype.bringToBack=function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()},e.prototype.bringToFront=function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()},e.prototype.setZIndex=function(t){this.options.zIndex=t,this._currentOverlay&&this._currentOverlay.setZIndex(t)},e.prototype.updateWmsParams=function(t){t||(t=this._map);var e=t.getBounds(),n=t.getSize(),r=parseFloat(this.wmsParams.version),o=this.options.crs||t.options.crs,i=r>=1.3?"crs":"srs";if(o){var s=o.project(e.getNorthWest()),u=o.project(e.getSouthEast()),c={width:n.x,height:n.y};c[i]=o.code,c.bbox=(r>=1.3&&o===a.a.CRS.EPSG4326?[u.y,s.x,s.y,u.x]:[s.x,u.y,u.x,s.y]).join(","),a.a.Util.extend(this.wmsParams,c)}},e.prototype.getImageUrl=function(){var t=this.options.uppercase||!1,e=a.a.Util.getParamString(this.wmsParams,this._url,t);return this._url+e},e}(a.a.Layer),N=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(){return(B=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.prototype.addLayer=function(t){var e=t&&t.url;if(e){var n=(t=B({transparent:!0},t)).updateWmsParams;if(this.layer=new T(e,B({pane:this.pane,headers:t.headers},t)),n){var r=this.layer.updateWmsParams;this.layer.updateWmsParams=function(t){r.call(this,t),this.wmsParams=n(this.wmsParams)}}return this.layer}},e}(f);function F(t,e){return void 0===e&&(e={}),new(i.Control.extend({onAdd:function(){var n=document.createElement("div"),r=t.onAdd();return n.classList.add("leaflet-control"),e.bar&&n.classList.add("leaflet-bar"),e.margin||e.bar||(n.style.marginBottom="0px",n.style.marginTop="0px",n.style.marginLeft="0px",n.style.marginRight="0px"),n.appendChild(r),i.DomEvent.disableClickPropagation(n),n},onRemove:function(){t.onRemove()}}))}var D=function(){return(D=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},R=function(){function t(){this.options={target:"map"},this.layerAdapters=t.layerAdapters,this.controlAdapters=t.controlAdapters,this.emitter=new s.EventEmitter,this._universalEvents=["zoomstart","zoom","zoomend","movestart","move","moveend"]}return t.prototype.create=function(t){if(void 0===t&&(t={target:"map"}),this.options=D({},t),this.options.target){var e=this.options,n=e.maxZoom,r=e.minZoom;this.map=new i.Map(this.options.target,{zoomControl:!1,attributionControl:!1,maxZoom:n,minZoom:r}),this.emitter.emit("create",this),this.map.createPane("order-0").style.zIndex=String(0),this._addMapListeners()}},t.prototype.getContainer=function(){return this.map&&this.map.getContainer()},t.prototype.setCursor=function(t){this.map&&(this.map.getContainer().style.cursor=t)},t.prototype.setView=function(t,e){var n=t[0],r=t[1];this.map&&this.map.setView([r,n],e)},t.prototype.setCenter=function(t){var e=t[0],n=t[1];this.map&&this.map.setView([n,e],this.map.getZoom())},t.prototype.getCenter=function(){var t=this.map;if(t){var e=t.getBounds().getCenter();return[e.lng,e.lat]}},t.prototype.setZoom=function(t){this.map&&this.map.setZoom(t)},t.prototype.getZoom=function(){return this.map&&this.map.getZoom()},t.prototype.fit=function(t){this.map&&this.map.fitBounds([[t[3],t[0]],[t[1],t[2]]])},t.prototype.getLayerAdapter=function(e){return t.layerAdapters[e]},t.prototype.createControl=function(t,e){return F(t,e)},t.prototype.createButtonControl=function(t){return function(t){var e=document.createElement("a"),n=t.title||"";e.href="#",e.title=n,e.setAttribute("role","button"),e.setAttribute("aria-label",n),i.DomEvent.disableClickPropagation(e),i.DomEvent.on(e,"click",i.DomEvent.stop),t.html instanceof HTMLElement?e.appendChild(t.html):"string"==typeof t.html&&(e.innerHTML=t.html);var r=function(e){e.stopPropagation(),t.onClick()};return t.onClick&&e.addEventListener("click",r),F({onAdd:function(){return e},onRemove:function(){var n=e.parentNode;n&&n.removeChild(e),t.onClick&&e.removeEventListener("click",r)}},{bar:!0})}(t)},t.prototype.addControl=function(t,e){if(t.options.position=e.replace("-",""),this.map)return this.map.addControl(t),t},t.prototype.removeControl=function(t){this.map&&this.map.removeControl(t)},t.prototype.removeLayer=function(t){t.remove()},t.prototype.showLayer=function(t){this.map&&t.addTo(this.map)},t.prototype.hideLayer=function(t){t.remove()},t.prototype.setLayerOpacity=function(t,e){t.setOpacity&&t.setOpacity(e)},t.prototype.setLayerOrder=function(t,e,n){},t.prototype.onMapClick=function(t){var e=t.containerPoint,n=t.latlng;this.emitter.emit("click",{latLng:n,pixel:{left:e.x,top:e.y},source:t})},t.prototype._addMapListeners=function(){var t=this,e=this.map;e&&(e.on("click",function(e){t.onMapClick(e)}),this._universalEvents.forEach(function(n){e.on(n,function(){return t.emitter.emit(n,t)},e)}))},t.layerAdapters={IMAGE:G,TILE:v,GEOJSON:k},t.controlAdapters={ZOOM:i.Control.Zoom,ATTRIBUTION:I},t}(),U=(n(360),n(361),n(362),n(363),function(){function t(t){this.options=t,this._container=document.createElement("div"),this.status=void 0===this.options.open||this.options.open,this._updateContainer(),this.options.parent&&this.options.parent.appendChild(this.getContainer())}return t.prototype.getContainer=function(){return this._container},t.prototype.open=function(){this._content||this._createContent(),this._container.appendChild(this._content),this._toggle&&(this._toggle.innerHTML="&times;"),this.status=!0},t.prototype.close=function(){this._content&&this._content.parentNode.removeChild(this._content),this._toggle&&(this._toggle.innerHTML=">>"),this.status=!1},t.prototype.toggle=function(){this.status?this.close():this.open()},t.prototype._updateContainer=function(){if(this._container.innerHTML="",this.options.title){var t=this._createHeader();this._container.appendChild(t)}this.status?this.open():this.close()},t.prototype._createHeader=function(){var t=this,e=document.createElement("div");e.className="panel-header";var n=document.createElement("div");n.className="panel-header__title",n.innerHTML=this.options.title;var r=document.createElement("div");return r.className="panel-header__toggle",r.onclick=function(){t.toggle()},this._toggle=r,e.appendChild(r),e.appendChild(n),e},t.prototype._createContent=function(){var t=document.createElement("div");t.className="panel-content";var e="function"==typeof this.options.content?this.options.content():this.options.content;return t.appendChild(e),this._content=t,t},t}()),Z=n(11),z=function(){function t(t){var e=this._createTreeItem(t);e&&(this._container=e)}return t.prototype.getContainer=function(){return this._container},t.prototype._createTreeBranch=function(t){var e=this,n=document.createElement("div");return n.className="tree-container__item-children",t.forEach(function(t){if(t.item){var r=e._createTreeItem(t);r&&n.appendChild(r)}}),n},t.prototype._createTreeItem=function(t){var e=t.item;if(!e)return!1;var n=document.createElement("div");if(n.className="tree-container__item",e.display_name){var r=document.createElement("input");r.setAttribute("type","checkbox");var o="layer"!==e.item_type||e.layer_enabled;r.checked=o;var i=t.properties.property("visibility");i&&(i.emitter.on("change",function(t){r.checked=t.value}),r.onclick=function(){i.set(r.checked,{propagation:Z.default.keys.pressed("ctrl")})});var a=document.createElement("span");a.innerHTML=e.display_name,n.appendChild(r),n.appendChild(a)}if("group"===e.item_type||"root"===e.item_type&&e.children.length){var s=t.tree.getChildren(),u=this._createTreeBranch(s.reverse());n.appendChild(u)}return n},t}(),H=(n(364),function(){function t(t){this.options=t,this._select=[["24","24 часа"],["48","48 часов"],["72","72 часа"],["168","неделя"]],this.ngwMap=t.ngwMap,this._container=this._createContainer()}return t.prototype.getContainer=function(){return this._container},t.prototype._createContainer=function(){var t=this,e=document.createElement("div");e.className="fires-contentainer";var n=this._createSelector();e.appendChild(n);var r=document.createElement("div");return r.className="fires-contentainer__layers",this.options.fires.forEach(function(e){t._createFireItem(e,r)}),e.appendChild(r),e},t.prototype._createFireItem=function(t,e){var n=this,r=document.createElement("div");r.className="tree-container__item";var o=this.ngwMap.getLayer(t.id).item,i=document.createElement("input");i.setAttribute("type","checkbox"),i.checked=!0,i.onclick=function(){n.ngwMap.toggleLayer(t.id,i.checked)};var a=document.createElement("span"),s=o.resource.display_name.split("__")[0];a.innerHTML=s.replace("fires","").trim();var u=this._createSymbol(t);r.appendChild(i),r.appendChild(u),r.appendChild(a),e.appendChild(r)},t.prototype._createSymbol=function(t){var e=document.createElement("span");return e.className="item-symbol",e.style.color=t.color,e.style.borderColor=t.color,e.style.backgroundColor=t.color,e},t.prototype._createSelector=function(){var t=this,e=document.createElement("div"),n=document.createElement("label");n.appendChild(document.createTextNode("Просмотр термоточек за: "));var r=document.createElement("select");return this._select.forEach(function(t){var e=document.createElement("option");e.value=t[0],e.text=t[1],r.appendChild(e)}),r.onchange=function(){t.options.fires.forEach(function(e){t.ngwMap.getLayer(e.id).propertiesFilter([["timestamp","ge",(new Date).getTime()-36e5*Number(r.value)]])})},n.appendChild(r),e.appendChild(n),e},t}()),q=function(){return(q=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},J={target:"tree",width:300},W=function(){function t(t){if(this.options=q({},J,t),"string"==typeof this.options.target){var e=document.getElementById(this.options.target);if(!e)throw new Error("No element with ID #"+this.options.target+" in document for webmap tree");this._target=e}else this.options.target instanceof HTMLElement&&(this._target=this.options.target);this.ngwLayers=this.options.ngwLayers,this._container=this._createContainer(),this.options.status||this.hide(),this._target.appendChild(this._container)}return t.prototype.show=function(){this._container.classList.remove("hidden")},t.prototype.hide=function(){this._container.classList.add("hidden")},t.prototype._createContainer=function(){var t=this,e=document.createElement("div");e.className="tree-container",e.style.width=(this.options.width||300)+"px";new U({title:"Базовые слои",content:function(){return t._createNgwLayers()},open:!1,parent:e});if(this.options.fires)new U({title:"Термоточки (FIRMS)",content:function(){return t._createFiresContainer()},parent:e});return e},t.prototype._createNgwLayers=function(){var t=document.createElement("div");for(var e in t.className="",this.ngwLayers)if(this.ngwLayers.hasOwnProperty(e)){var n=this.ngwLayers[e],r=new z(n.layer.layer).getContainer();r&&t.appendChild(r)}return t},t.prototype._createFiresContainer=function(){var t=document.createElement("div"),e=this.options.fires;if(e){var n=new H({fires:e,ngwMap:this.options.ngwMap});t.appendChild(n.getContainer())}return t},t}(),V=function(){function t(t,e){this.actionMap=t,this.options=e,this.html="<span>&#9776;</span>",this.title={off:"Показать дерево слоёв",on:"Скрыть дерево слоёв"},this.addClass="toggle-control webmap-tree-control",this.addClassOn="active",this.status=!1,this.emitter=new s.EventEmitter,this.tree=new W(e)}return t.prototype.onClick=function(t){this.toggleControl(t)},t.prototype.show=function(){this.tree.show(),this.invalidateMapSize()},t.prototype.hide=function(){this.tree.hide(),this.invalidateMapSize()},t.prototype.invalidateMapSize=function(){this.actionMap.ngwMap.mapAdapter.map.invalidateSize&&this.actionMap.ngwMap.mapAdapter.map.invalidateSize()},t.prototype.toggleControl=function(t){(t=void 0!==t?t:!this.status)?this.show():this.hide(),this.status=t,this.emitter.emit("status",this.status)},t}(),Q=(n(365),n(51)),$=n(167),K=(n(366),n(367),function(){return(K=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)}),X='\n  <a href="#">\n    <svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n      <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z">\n      </path>\n      <path d="M0 0h24v24H0z" fill="none"></path>\n    </svg>\n  </a>\n',Y=function(){function t(e){this.options={template:"\n      <p>This is dialog!</p>\n    ",closeBtn:!0,closeBtnTemplate:X},this._dialog=document.createElement("dialog"),t.dialogs.push(this),this._dialog.className="dialog-component",this.options=K({},this.options,e),this._parent=this.options.parent||document.body,this._isNativeDialog=!!this._dialog.showModal,this._isNativeDialog||($.a.registerDialog(this._dialog),this._dialog.classList.add("polyfilled")),this.options.closeBtn&&(this._closeBtn=this._createCloseBtn()),this._content=document.createElement("div"),this._dialog.appendChild(this._content),this.updateContent(),this._parent&&this._parent.appendChild(this._dialog),this._addEventsListeners()}return t.prototype.getContainer=function(){return this._dialog},t.prototype.show=function(){this._dialog.showModal()},t.prototype.close=function(){this._dialog.close()},t.prototype.destroy=function(){this.close(),this._dialog.remove()},t.prototype.updateContent=function(t){!t&&this.options.template&&(t=this.options.template),t&&this._addContent(t,this._content)},t.prototype._createCloseBtn=function(){var t=this,e=this.options.closeBtnTemplate;if(e){var n=document.createElement("div");return n.className="dialog-component__close",this._dialog.appendChild(n),this._addContent(e,n),n.addEventListener("click",function(e){e.stopPropagation(),t.close()}),n}},t.prototype._addContent=function(t,e){"string"==typeof t?e.innerHTML=t:t instanceof HTMLElement&&(e.innerHTML="",e.appendChild(t))},t.prototype._addEventsListeners=function(){var t=this;this._closeBtn&&this._closeBtn.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),t.close()}),this.options.openers&&[].forEach.call(this.options.openers,function(e){e.onclick=function(e){e.preventDefault(),t.show()}}),this._dialog.addEventListener("close",function(){}),this._dialog.addEventListener("cancel",function(){})},t.dialogs=[],t.clean=function(){t.dialogs.forEach(function(t){return t.destroy()})},t}(),tt=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},et=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},nt=function(){function t(t){this.options=t,this._storageKey="auth",this._storage=localStorage,this.connector=new Q.default({baseUrl:t.baseUrl,auth:t.auth});var e=this._storage.getItem(this._storageKey);e&&(this.auth=JSON.parse(e))}return t.prototype.login=function(t){return tt(this,void 0,void 0,function(){var e;return et(this,function(n){switch(n.label){case 0:return this._errorMessage="",t?[3,2]:[4,this.getAuth()];case 1:t=n.sent(),n.label=2;case 2:return n.trys.push([2,4,,7]),[4,this.connector.login(t)];case 3:return n.sent(),[3,7];case 4:return n.sent(),this._errorMessage="Не удаётся войти",[4,this._showLoginDialog(t)];case 5:return e=n.sent(),[4,this.login(e)];case 6:return n.sent(),[3,7];case 7:return this.connector.getUserInfo&&this._storage.setItem(this._storageKey,JSON.stringify(t)),[2]}})})},t.prototype.logout=function(){this.connector.logout(),this._storage.setItem(this._storageKey,""),this._errorMessage=""},t.prototype.getAuth=function(){return tt(this,void 0,void 0,function(){return et(this,function(t){switch(t.label){case 0:return[4,this._showLoginDialog(this.auth)];case 1:return[2,t.sent()]}})})},t.prototype._showLoginDialog=function(t){var e=this;return new Promise(function(n,r){var o=new Y,i=e._createDialogHtml(t,function(t){o.close(),n(t)},function(t){o.close(),r(t)});o.updateContent(i),o.show()})},t.prototype._createDialogHtml=function(t,e,n){void 0===t&&(t={login:"",password:""});var r=t.login,o=t.password,i=document.createElement("div");i.className="dialog--form login";var a='\n      <div><label><div>Имя пользователя:</div>\n        <input value="'+r+'" class="dialog--input name"></input>\n      </label></div>\n      <div><label><div>Пароль:</div>\n        <input value="'+o+'" type="password" class="dialog--input password"></input>\n      </label></div>\n      <div class="dialog-error"></div>\n      <button class="dialog--button accept">Войти</button>\n      <button class="dialog--button cancel">Отмена</button>\n    ';i.innerHTML=a;var s=i.getElementsByClassName("name")[0],u=i.getElementsByClassName("password")[0];if(this._errorMessage){var c=i.getElementsByClassName("dialog-error")[0];c.className="dialog-error",c.innerHTML='<div class="dialog-error--message">'+this._errorMessage+"</div>"}var p=i.getElementsByClassName("accept")[0],l=i.getElementsByClassName("cancel")[0],f=function(){return{login:s.value,password:u.value}},h=function(){y()},y=function(){var t=f();p.disabled=!(t.login&&t.password)},d=function(){[s,u].forEach(function(t){["change","input"].forEach(function(e){return t.removeEventListener(e,h)})})};return p.onclick=function(){d(),e(f())},l.onclick=function(){d(),n("Login cancel")},y(),[s,u].forEach(function(t){["change","input"].forEach(function(e){return t.addEventListener(e,h)})}),i},t}(),rt=function(){return(rt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ot=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},it=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},at=function(){function t(t){this.options=t}return t.prototype.create=function(t,e){return ot(this,void 0,void 0,function(){var n,i,a,s,u,c,p=this;return it(this,function(l){switch(l.label){case 0:return[4,(n=new nt(t)).login()];case 1:return l.sent(),this.ngwMap=new r.default(new R,rt({controls:[],connector:n.connector},t)),this.ngwMap.getPaintFunctions={base:o.a},this.ngwMap.addControl("ZOOM","top-left"),this.ngwMap.addControl("ATTRIBUTION","bottom-right"),i=this,[4,this.ngwMap.createButtonControl({html:"<span>&#10162;</span>",title:"Выйти",onClick:function(){n.logout(),window.location.reload()}})];case 2:return i.authControl=l.sent(),this.ngwMap.addControl(this.authControl,"top-right"),[4,this.ngwMap.getNgwLayers()];case 3:if(a=l.sent(),!e)return[3,7];s=0,u=e,l.label=4;case 4:return s<u.length?(c=u[s],[4,this.ngwMap.addNgwLayer({resourceId:c.resourceId,id:c.id,adapterOptions:{propertiesFilter:[["timestamp","ge",(new Date).getTime()-36e5*this.options.timedelta]],paint:{stroke:!0,color:c.color,fillOpacity:.5},selectable:!0,selectedPaint:{stroke:!0,color:c.color,fillOpacity:.9},selectOnHover:!0,popupOnSelect:!0,popupOptions:{createPopupContent:function(t){if(t.feature){var e=t.feature;return p._createPopupContent(e)}}}}})]):[3,7];case 5:l.sent(),l.label=6;case 6:return s++,[3,4];case 7:return[4,this._addTreeControl(a,e)];case 8:return l.sent(),this._addEventsListeners(),[2]}})})},t.prototype._createPopupContent=function(t){var e=document.createElement("pre");return e.innerHTML=JSON.stringify(t.properties,null,2),e},t.prototype._addTreeControl=function(t,e){return ot(this,void 0,void 0,function(){var n;return it(this,function(r){switch(r.label){case 0:return[4,this.ngwMap.onLoad()];case 1:return r.sent(),this.tree=new V(this,{ngwLayers:t,ngwMap:this.ngwMap,fires:e}),n=this,[4,this.ngwMap.createToggleControl(this.tree)];case 2:return n.treeControl=r.sent(),this.ngwMap.addControl(this.treeControl,"top-left"),[2]}})})},t.prototype._addEventsListeners=function(){var t=[this.tree],e=[this.treeControl];t.forEach(function(t,n){t&&t.emitter.on("status",function(t){t&&e.forEach(function(t,e){t&&n!==e&&t.onClick(!1)})})})},t}(),st=function(){return(st=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},ut=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},ct=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},pt=function(){function t(t){this.options=t,this.actionMap=new at(this.options)}return t.prototype.create=function(t){return ut(this,void 0,void 0,function(){return ct(this,function(e){return this.options=st({},this.options,t),this.actionMap.create(this.options.mapOptions,this.options.fires),[2]})})},t}(),lt={};try{lt=n(368)}catch(t){console.warn("Config file is not funded, run with default settings")}new pt(r.default.utils.deepmerge({mapOptions:{target:"map",qmsId:487,bounds:[36.59,43.385,49.374,50.214]},timedelta:24},lt)).create()},44:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=function(t,e,n,r){try{t(n(r))}catch(t){e(t)}},o=function(){function t(t,e){this.onCancel=e,this._canceled=!1,this._promise=new Promise(t)}return t.prototype.then=function(e,n){var o=this,i=new t(function(t,a){o._promise&&o._promise.then(function(n){o._canceled&&i.cancel(),e&&!o._canceled?r(t,a,e,n):t(n)},function(e){o._canceled&&i.cancel(),n&&!o._canceled?r(t,a,n,e):a(e)})},function(){o.cancel()});return i},t.prototype.catch=function(t){return this.then(void 0,t)},t.prototype.cancel=function(t){return this._canceled=!0,t&&this._promise&&this._promise.catch(t),this.onCancel&&this.onCancel(),this._destroy(),this},t.prototype.finally=function(t){return this._promise?this._promise.finally(t):Promise.reject(t)},t.prototype._destroy=function(){this.onCancel=void 0,this._promise=void 0},t}()},51:function(t,e,n){"use strict";var r=n(111);n(44),n(155),n(156),n(157),n(158);e.default=r.a},56:function(t,e,n){"use strict";function r(t,e){var n=document.createElement("div"),r=!1;e.getStatus?r=e.getStatus():e.status&&(r=e.status);var o=e.title||"",i=e.html;function a(){o&&(n.title="string"==typeof o?o:r?o.on:o.off,n.setAttribute("aria-label",n.title))}function s(t){t instanceof HTMLElement?(n.innerHTML="",n.appendChild(t)):"string"==typeof t&&(n.innerHTML=t)}function u(){i&&("string"==typeof i||i instanceof HTMLElement?s(i):s(r?i.on:i.off),n.setAttribute("aria-label",n.title))}function c(t,e){t.split(" ").forEach(function(t){e?n.classList.add(t):n.classList.remove(t)})}function p(){e.addClassOn&&c(e.addClassOn,r),e.addClassOff&&c(e.addClassOff,!r)}a(),u(),e.addClass&&c(e.addClass,!0),p();var l=function(t){r=void 0!==t?t:!r,u(),a(),p(),e.onClick(r)},f=t({html:n,onClick:l});return f.onClick=l,f}var o=function(){return function(){this.backspace=8,this.tab=9,this.enter=13,this.shift=16,this.ctrl=17,this.alt=18,this["pause/break"]=19,this.caps_lock=20,this.escape=27,this.page_up=33,this.page_down=34,this.end=35,this.home=36,this.left_arrow=37,this.up_arrow=38,this.right_arrow=39,this.down_arrow=40,this.insert=45,this.delete=46,this.left_window_key=91,this.right_window_key=92,this.select_key=93,this.numpad_0=96,this.numpad_1=97,this.numpad_2=98,this.numpad_3=99,this.numpad_4=100,this.numpad_5=101,this.numpad_6=102,this.numpad_7=103,this.numpad_8=104,this.numpad_9=105,this.multiply=106,this.add=107,this.subtract=109,this.decimal_point=110,this.divide=111,this.f1=112,this.f2=113,this.f3=114,this.f4=115,this.f5=116,this.f6=117,this.f7=118,this.f8=119,this.f9=120,this.f10=121,this.f11=122,this.f12=123,this.num_lock=144,this.scroll_lock=145,this["semi-colon"]=186,this.equal_sign=187,this[","]=188,this["-"]=189,this["."]=190,this["/"]=191,this["`"]=192,this["["]=219,this["\\"]=220,this["]"]=221,this["'"]=222}}(),i=function(){function t(){this.keyCodeAlias=new o,this.keys={},this._windowOnFocus=this.windowOnFocus.bind(this),this._keysPressed=this.keysPressed.bind(this),this._keysReleased=this.keysReleased.bind(this),this.addKeyboardEventsListener()}return t.prototype.pressed=function(t){var e=this.keyCodeAlias[t];return!!e&&this.keys[e]},t.prototype.addKeyboardEventsListener=function(){window.addEventListener("focus",this._windowOnFocus,!1),window.addEventListener("keydown",this._keysPressed,!1),window.addEventListener("keyup",this._keysReleased,!1)},t.prototype.removeKeyboardEventsListener=function(){window.removeEventListener("focus",this._windowOnFocus,!1),window.removeEventListener("keydown",this._keysPressed,!1),window.removeEventListener("keyup",this._keysReleased,!1)},t.prototype.keysPressed=function(t){t.stopPropagation(),this.keys[t.keyCode]||(this.keys[t.keyCode]=!0)},t.prototype.keysReleased=function(t){t.stopPropagation(),this.keys[t.keyCode]=!1},t.prototype.windowOnFocus=function(){this.keys={}},t}(),a=n(14);function s(t){return function(e,n,r){var o=r.value;return r.value=function(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return new Promise(function(r,i){var a=function(){var t=o.apply(e,n);t&&t.then?t.then(r).catch(i):r(t)};e.getEventStatus(t)?a():e.emitter.once(t,function(){a()})})},r}}function u(t,e,n){void 0===n&&(n=!1);var r=Array.isArray(e),o=r&&[]||{};return r?n?(t=t||[],o=o.concat(t),e.forEach(function(e,r){void 0===o[r]?o[r]=e:"object"==typeof e?o[r]=u(t[r],e,n):-1===t.indexOf(e)&&o.push(e)})):o=e:(t&&"object"==typeof t&&Object.keys(t).forEach(function(e){o[e]=t[e]}),Object.keys(e).forEach(function(r){"object"==typeof e[r]&&e[r]&&t[r]?o[r]=u(t[r],e[r],n):o[r]=e[r]})),o}function c(t,e,n){var r=("^"+t+"$").replace(/%/g,".*").replace("_",".");return null!==new RegExp(r,n?"i":"").exec(e)}var p={gt:function(t,e){return t>e},lt:function(t,e){return t<e},ge:function(t,e){return t>=e},le:function(t,e){return t<=e},eq:function(t,e){return t===e},ne:function(t,e){return t!==e},like:function(t,e){return c(t,e)},ilike:function(t,e){return c(t,e,!0)}};function l(t,e){return e.every(function(e){var n=e[0],r=e[1],o=e[2],i=p[r],a=t[n];return!i||!a||i(a,o)})}function f(t){var e;if("FeatureCollection"===t.type)e=h(t.features.map(function(t){return t.geometry.type}));else if("GeometryCollection"===t.type){e=h(t.geometries.map(function(t){return t.type}))}else e="Feature"===t.type?t.geometry.type:t.type;return e}function h(t){for(var e,n={},r=0;r<t.length;r++)n[t[r]]=1+(n[t[r]]||0);for(var o in n)if(n.hasOwnProperty(o)){var i=void 0!==e?n[e]:0;n[o]>(i||0)&&(e=o)}return e}var y={Point:"circle",LineString:"line",MultiPoint:"circle",Polygon:"fill",MultiLineString:"line",MultiPolygon:"fill"};function d(t){if(t.data){var e=y[f(t.data)],n=t.paint;"object"==typeof n&&(n.type=n.type?n.type:"fill"===e||"line"===e?"path":"html"in n||"className"in n?"icon":e),t.type=e}return t}var v=function(){return(v=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function m(t,e,n){var r;if("function"==typeof t)return function(r){return m(t(r),e,n)};if("get-paint"===t.type){var o=function(t,e){if("function"==typeof t.from)return t.from(t.options);if("string"==typeof t.from&&e){var n=e[t.from];if(n)return n(t.options)}}(t,n);o&&(r=m(o,e,n))}else{if("icon"===t.type)return t;(r=v({},t)).fill=void 0===r.fill||r.fill,r.stroke=void 0!==r.stroke?r.stroke:!r.fill||!(!r.strokeColor&&!r.strokeOpacity)}if(r){if("function"==typeof r)return r;r=v({},e,r)}else r=v({},e);return"color"in r&&(r.strokeColor||(r.strokeColor=r.color),r.fillColor||(r.fillColor=r.color)),"opacity"in r&&(void 0===r.strokeOpacity&&(r.strokeOpacity=r.opacity),void 0===r.fillOpacity&&(r.fillOpacity=r.opacity)),r}var g=function(){return(g=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},b=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},w=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},_=function(){function t(t){this.webMap=t,this._layersIds=1,this._baseLayers=[],this._layers={},this._selectedLayers=[]}return t.prototype.fitLayer=function(t){return b(this,void 0,void 0,function(){var e,n;return w(this,function(r){switch(r.label){case 0:return(e=this.getLayer(t))&&e.getExtent?[4,e.getExtent()]:[3,2];case 1:(n=r.sent())&&this.webMap.fitBounds(n),r.label=2;case 2:return[2]}})})},t.prototype.isBaseLayer=function(t){var e=this.getLayer(t);if(e&&e.id)return-1!==this._baseLayers.indexOf(e.id)},t.prototype.getBaseLayers=function(){return this._baseLayers},t.prototype.getLayer=function(t){return"string"==typeof t?this._layers[t]:t},t.prototype.getLayerId=function(t){var e=this.getLayer(t);if(e&&e.options)return e.options.id;throw new Error("No id for layer")},t.prototype.getLayers=function(){return Object.keys(this._layers)},t.prototype.findLayer=function(t){for(var e in this._layers)if(this._layers.hasOwnProperty(e)){var n=this._layers[e];if(t(n))return n}},t.prototype.isLayerVisible=function(t){var e=this.getLayer(t);return!(!e||void 0===e.options.visibility)&&e.options.visibility},t.prototype.addBaseLayer=function(t,e){return b(this,void 0,Promise,function(){return w(this,function(n){switch(n.label){case 0:return[4,this.addLayer(t,g({},e,{baseLayer:!0}))];case 1:return[2,n.sent()]}})})},t.prototype.addLayer=function(t,e,n){return b(this,void 0,Promise,function(){var r,o,i,a,s,u,c,p,l,f,h,y;return w(this,function(d){switch(d.label){case 0:return r=n||this._layersIds++,"string"!=typeof t?[3,1]:(o=this.webMap.getLayerAdapter(t),[3,4]);case 1:return"function"!=typeof t?[3,2]:(o=t,[3,4]);case 2:return t.then?[4,t]:[3,4];case 3:o=d.sent(),d.label=4;case 4:return void 0===o?[3,9]:(i=e,e.strongOptions||this._updateGeoJsonOptions(i),a=this.webMap.options,s=a.maxZoom,u=a.minZoom,e=g({id:String(r),order:r,maxZoom:s,minZoom:u},e),c=e.visibility,e.visibility=!1,e.baseLayer&&(e.order=0),(p=new o(this.webMap.mapAdapter.map,e)).options.baseLayer&&(e.baseLayer=!0,e.order=0),(l=p.options.id)&&(this._layers[l]=p),this.webMap.emitter.emit("layer:preadd",p),[4,this.webMap.onMapLoad()]);case 5:return d.sent(),[4,p.addLayer(e)];case 6:return f=d.sent(),p.layer=f,p.id=p.options.id,(l=p.options.id)&&(i.filter&&this.filterLayer(p,i.filter),e.baseLayer&&this._baseLayers.push(l),this._layers[l]=p,c&&this.showLayer(l)),e.fit&&p.getExtent?[4,p.getExtent()]:[3,8];case 7:(h=d.sent())&&this.webMap.fitBounds(h),d.label=8;case 8:return void 0!==(y=e.opacity)&&y<=1&&this.setLayerOpacity(p,y),this.webMap.emitter.emit("layer:add",p),[2,p];case 9:return[2,Promise.reject("No adapter")]}})})},t.prototype.addLayerFromAsyncAdapter=function(t,e,n){return b(this,void 0,Promise,function(){var r,o;return w(this,function(i){switch(i.label){case 0:return r=n||this._layersIds++,[4,t()];case 1:return(o=i.sent())?[2,this.addLayer(o,e,r)]:[2,Promise.reject("No adapter")]}})})},t.prototype.removeLayers=function(t){for(var e in this._layers)if(this._layers.hasOwnProperty(e)){var n=!0;t&&(n=t(e,this._layers[e])),n&&(this.removeLayer(e),delete this._layers[e])}},t.prototype.removeOverlays=function(){this.removeLayers(function(t,e){return!e.options.baseLayer})},t.prototype.removeLayer=function(t){var e=this.getLayer(t),n=e&&this.getLayerId(e);if(e&&n){if(this.webMap.emitter.emit("layer:preremove",e),e.beforeRemove&&e.beforeRemove(),e.beforeRemove&&e.beforeRemove(),e.removeLayer?e.removeLayer():this.webMap.mapAdapter.removeLayer(e.layer),e.options&&e.options.baseLayer){var r=this._baseLayers.indexOf(n);r&&this._baseLayers.splice(r,1)}delete this._layers[n],this.webMap.emitter.emit("layer:remove",e)}},t.prototype.addGeoJsonLayer=function(t,e){return b(this,void 0,void 0,function(){var n;return w(this,function(r){switch(r.label){case 0:return(t=t||{}).multiselect=void 0!==t.multiselect&&t.multiselect,t.unselectOnSecondClick=void 0===t.unselectOnSecondClick||t.unselectOnSecondClick,e||(t=d(t)),t.paint=t.paint||{},[4,this.addLayer(e||"GEOJSON",t)];case 1:return n=r.sent(),this.showLayer(n),[2,n]}})})},t.prototype.showLayer=function(t,e){void 0===e&&(e={}),this.toggleLayer(t,!0,e)},t.prototype.hideLayer=function(t,e){void 0===e&&(e={}),this.toggleLayer(t,!1,e)},t.prototype.toggleLayer=function(t,e,n){var r=this;void 0===n&&(n={});var o=this.getLayer(t),i=o&&o.options.visibility,a=void 0!==e?e:!i,s=void 0!==n.silent&&n.silent,u=function(t,e){e.options.visibility=a;var n=a?"layer:preshow":"layer:prehide",o=a?"layer:show":"layer:hide";if(s||r.webMap.emitter.emit(n,e),a&&t){var i=e.options.baseLayer?0:e.options.order;if(0===i&&r._baseLayers.length){var u=r._baseLayers.find(function(t){return t!==e.id&&r.isLayerVisible(t)});u&&r.hideLayer(u)}e.showLayer?e.showLayer.call(e,e.layer):r.webMap.mapAdapter.showLayer(e.layer),void 0!==i&&r.webMap.mapAdapter.setLayerOrder(e.layer,i,r._layers)}else e.hideLayer?e.hideLayer.call(e,e.layer):r.webMap.mapAdapter.hideLayer(e.layer);s||r.webMap.emitter.emit(o,e)};o&&o.options.visibility!==a&&(this.webMap.mapAdapter.map?u(this.webMap.mapAdapter,o):this.webMap.mapAdapter.emitter.once("create",function(t){u(t.map,o)}))},t.prototype.updateLayer=function(t){var e=this.getLayer(t);e&&this.isLayerVisible(e)&&(this.hideLayer(e,{silent:!0}),this.showLayer(e,{silent:!0}))},t.prototype.setLayerOpacity=function(t,e){var n=this.getLayer(t);n&&this.webMap.mapAdapter.setLayerOpacity&&n&&this.webMap.mapAdapter.setLayerOpacity(n.layer,e)},t.prototype.selectLayer=function(t,e){var n=this.getLayer(t);if(n){var r=n;r&&r.select&&r.select(e);var o=this.getLayerId(n);o&&this._selectedLayers.push(o)}},t.prototype.unSelectLayer=function(t,e){var n=this.getLayer(t);if(n){var r=n&&n;r.unselect&&r.unselect(e);var o=this.getLayerId(n);if(o){var i=this._selectedLayers.indexOf(o);-1!==i&&this._selectedLayers.splice(i,1)}}},t.prototype.filterLayer=function(t,e){var n=this.getLayer(t);n.filter&&n.filter(e)},t.prototype.propertiesFilter=function(t,e){var n=this.getLayer(t);n.propertiesFilter?n.propertiesFilter(e):n.filter&&this.filterLayer(n,function(t){return!t.feature||!t.feature.properties||l(t.feature.properties,e)})},t.prototype.removeLayerFilter=function(t){var e=this.getLayer(t);e.removeFilter?e.removeFilter():e.filter&&e.filter(function(){return!0})},t.prototype.setLayerData=function(t,e){var n=this.getLayer(t);n.setData?n.setData(e):n.clearLayer&&n.addData&&(n.clearLayer(),n.addData(e))},t.prototype.addLayerData=function(t,e){var n=this.getLayer(t);n.addData&&n.addData(e)},t.prototype.clearLayerData=function(t,e){var n=this.getLayer(t);n.clearLayer&&n.clearLayer(e)},t.prototype.getAttributions=function(t){var e=[];for(var n in this._layers)if(this._layers.hasOwnProperty(n)){var r=this._layers[n];if(!(void 0===t.onlyVisible||t.onlyVisible)||r.options.visibility){var o=r.options&&r.options.attribution;o&&e.push(o)}}return e},t.prototype._onLayerClick=function(t){return b(this,void 0,void 0,function(){return w(this,function(e){return this.webMap.emitter.emit("layer:click",t),[2,Promise.resolve(t)]})})},t.prototype._updateGeoJsonOptions=function(t){var e=this,n=t.onLayerClick;t.onLayerClick=function(t){return n&&n(t),e._onLayerClick(t)},this.webMap.options.paint&&(t.paint=m(t.paint||{},this.webMap.options.paint,this.webMap.getPaintFunctions)),t.selectedPaint&&this.webMap.options.selectedPaint&&(t.selectedPaint=m(t.selectedPaint,this.webMap.options.selectedPaint,this.webMap.getPaintFunctions))},t}(),L=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},O=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},P=function(){function t(t){this.webMap=t}return t.prototype.addControl=function(t,e,n){return L(this,void 0,void 0,function(){var r,o;return O(this,function(i){switch(i.label){case 0:return(r="string"==typeof t?this.getControl(t,n):t)?[4,r]:[3,2];case 1:return o=i.sent(),[2,this.webMap.mapAdapter.addControl(o,e)];case 2:return[2]}})})},t.prototype.createControl=function(t,e){return L(this,void 0,Promise,function(){return O(this,function(n){switch(n.label){case 0:return[4,this.webMap.onLoad("build-map")];case 1:return n.sent(),this.webMap.mapAdapter.createControl?[2,this.webMap.mapAdapter.createControl(t,e)]:[2]}})})},t.prototype.createButtonControl=function(t){return L(this,void 0,Promise,function(){return O(this,function(e){switch(e.label){case 0:return[4,this.webMap.onLoad("build-map")];case 1:return e.sent(),this.webMap.mapAdapter.createButtonControl?[2,this.webMap.mapAdapter.createButtonControl(t)]:[2]}})})},t.prototype.createToggleControl=function(t){return L(this,void 0,Promise,function(){return O(this,function(e){switch(e.label){case 0:return[4,this.webMap.onLoad("build-map")];case 1:return e.sent(),this.webMap.mapAdapter.createToggleControl?[2,this.webMap.mapAdapter.createToggleControl(t)]:this.webMap.mapAdapter.createButtonControl?[2,M.utils.createToggleControl(this.webMap.mapAdapter.createButtonControl,t)]:[2]}})})},t.prototype.removeControl=function(t){t.remove?t.remove():this.webMap.mapAdapter.removeControl&&this.webMap.mapAdapter.removeControl(t)},t.prototype.getControl=function(e,n){var r=this.webMap.mapAdapter.controlAdapters[e];if(r)return new r(n);var o=t.controls[e];return o?o(this.webMap,n):void 0},t.controls={CONTROL:function(t,e){return t.createControl(e.control,e.options)},BUTTON:function(t,e){return t.createButtonControl(e)},TOGGLE:function(t,e){return t.createToggleControl(e)}},t}();n.d(e,"a",function(){return M});var C=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},k=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},E=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,o){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,o,(e=t[n](e)).done,e.value)})}}},x={minZoom:0,maxZoom:21,paint:{color:"blue",opacity:1,radius:8,weight:1},selectedPaint:{color:"darkblue",opacity:1,radius:12,weight:1}},M=function(){function t(e){this.options=x,this.emitter=new a.EventEmitter,this.keys=t.keys,this.runtimeParams=[],this.getPaintFunctions=t.getPaintFunctions,this._eventsStatus={},this.layers=new _(this),this.controls=new P(this),this.mapAdapter=e.mapAdapter,this._starterKits=e.starterKits||[],e.mapOptions&&(this.options=u(x||{},e.mapOptions)),this._addEventsListeners(),e.create&&this.create(this.options)}return t.prototype.create=function(t){return C(this,void 0,Promise,function(){return k(this,function(e){switch(e.label){case 0:return this.getEventStatus("create")?[3,2]:(this.options=u(x||{},t),[4,this._setupMap()]);case 1:e.sent(),this._emitStatusEvent("create",this),e.label=2;case 2:return[2,this]}})})},t.prototype.getContainer=function(){if(this.mapAdapter.getContainer)return this.mapAdapter.getContainer();if(this.options.target){if(this.options.target instanceof HTMLElement)return this.options.target;if("string"==typeof this.options.target){var t=document.getElementById(this.options.target);if(t)return t}}},t.prototype.setCursor=function(t){this.mapAdapter.setCursor&&this.mapAdapter.setCursor(t)},t.prototype.setCenter=function(t){return this.mapAdapter.setCenter(t),this},t.prototype.getCenter=function(){return this.mapAdapter.getCenter()},t.prototype.setZoom=function(t){return this.mapAdapter.setZoom(t),this},t.prototype.getZoom=function(){return this.mapAdapter.getZoom()},t.prototype.setView=function(t,e){this.mapAdapter.setView&&t&&e?this.mapAdapter.setView(t,e):(t&&this.mapAdapter.setCenter(t),e&&this.mapAdapter.setZoom(e))},t.prototype.fitBounds=function(t,e){return this.mapAdapter.fit(t,e),this},t.prototype.getEventStatus=function(t){var e=t,n=this._eventsStatus[e];return void 0!==n&&n},t.prototype.onLoad=function(t){var e=this;return void 0===t&&(t="create"),new Promise(function(n){e.getEventStatus(t)?n(e):e.emitter.once(t,function(){n(e)})})},t.prototype.onMapLoad=function(t){var e=this;return new Promise(function(n){var r=function(){var r=e.mapAdapter;t&&t(r),r&&n(r)},o=void 0===e.mapAdapter.isLoaded||e.mapAdapter.isLoaded;e.mapAdapter.map&&o?r():e.mapAdapter.emitter.once("create",function(){r()})})},t.prototype.fitLayer=function(t){return C(this,void 0,void 0,function(){return k(this,function(e){return this.layers.fitLayer(t),[2]})})},t.prototype.isBaseLayer=function(t){return this.layers.isBaseLayer(t)},t.prototype.getActiveBaseLayer=function(){var t=this,e=this.getBaseLayers().find(function(e){return t.isLayerVisible(e)});if(e)return this.getLayer(e)},t.prototype.getBaseLayers=function(){return this.layers.getBaseLayers()},t.prototype.getLayerAdapters=function(){return this.mapAdapter.layerAdapters},t.prototype.getLayerAdapter=function(t){return this.mapAdapter.layerAdapters[t]},t.prototype.getLayer=function(t){return this.layers.getLayer(t)},t.prototype.getLayerId=function(t){return this.layers.getLayerId(t)},t.prototype.getLayers=function(){return this.layers.getLayers()},t.prototype.findLayer=function(t){return this.layers.findLayer(t)},t.prototype.isLayerVisible=function(t){return this.layers.isLayerVisible(t)},t.prototype.addBaseLayer=function(t,e){return C(this,void 0,Promise,function(){return k(this,function(n){return[2,this.layers.addBaseLayer(t,e)]})})},t.prototype.addLayer=function(t,e,n){return C(this,void 0,Promise,function(){return k(this,function(r){return[2,this.layers.addLayer(t,e,n)]})})},t.prototype.addLayerFromAsyncAdapter=function(t,e,n){return C(this,void 0,Promise,function(){return k(this,function(r){return[2,this.layers.addLayerFromAsyncAdapter(t,e,n)]})})},t.prototype.removeLayers=function(t){this.layers.removeLayers(t)},t.prototype.removeOverlays=function(){this.layers.removeOverlays()},t.prototype.removeLayer=function(t){this.layers.removeLayer(t)},t.prototype.addGeoJsonLayer=function(t,e){return C(this,void 0,void 0,function(){return k(this,function(n){return[2,this.layers.addGeoJsonLayer(t,e)]})})},t.prototype.showLayer=function(t){return this.layers.showLayer(t)},t.prototype.hideLayer=function(t){this.layers.hideLayer(t)},t.prototype.toggleLayer=function(t,e){this.layers.toggleLayer(t,e)},t.prototype.updateLayer=function(t){this.layers.updateLayer(t)},t.prototype.setLayerOpacity=function(t,e){this.layers.setLayerOpacity(t,e)},t.prototype.selectLayer=function(t,e){this.layers.selectLayer(t,e)},t.prototype.unSelectLayer=function(t,e){this.layers.unSelectLayer(t,e)},t.prototype.filterLayer=function(t,e){this.layers.filterLayer(t,e)},t.prototype.removeLayerFilter=function(t){this.layers.removeLayerFilter(t)},t.prototype.setLayerData=function(t,e){this.layers.setLayerData(t,e)},t.prototype.addLayerData=function(t,e){this.layers.addLayerData(t,e)},t.prototype.clearLayerData=function(t,e){this.layers.clearLayerData(t,e)},t.prototype.getAttributions=function(t){return this.layers.getAttributions(t)},t.prototype.createControl=function(t,e){return C(this,void 0,Promise,function(){return k(this,function(n){return[2,this.controls.createControl(t,e)]})})},t.prototype.createButtonControl=function(t){return C(this,void 0,Promise,function(){return k(this,function(e){return[2,this.controls.createButtonControl(t)]})})},t.prototype.createToggleControl=function(t){return C(this,void 0,Promise,function(){return k(this,function(e){return[2,this.controls.createToggleControl(t)]})})},t.prototype.removeControl=function(t){this.controls.removeControl(t)},t.prototype.getControl=function(t,e){return this.controls.getControl(t,e)},t.prototype.addControl=function(t,e,n){return C(this,void 0,void 0,function(){return k(this,function(r){return[2,this.controls.addControl(t,e,n)]})})},t.prototype._emitStatusEvent=function(t,e){var n=t;this._eventsStatus[n]=!0,this.emitter.emit(n,e)},t.prototype._setupMap=function(){return C(this,void 0,void 0,function(){return k(this,function(t){switch(t.label){case 0:return[4,this.mapAdapter.create(this.options)];case 1:return t.sent(),this._zoomToInitialExtent(),[4,this._addLayerProviders()];case 2:return t.sent(),[4,this._onLoadSync()];case 3:return t.sent(),this._emitStatusEvent("build-map",this.mapAdapter),[2,this]}})})},t.prototype._zoomToInitialExtent=function(){if(this._extent)this.mapAdapter.fit(this._extent);else if(this.options.bounds)this.fitBounds(this.options.bounds);else{var t=this.options,e=t.center,n=t.zoom;this.setView(e,n)}},t.prototype._addLayerProviders=function(){var t,e,n,r;return C(this,void 0,void 0,function(){var o,i,a,s,u,c,p,l,f,h,y;return k(this,function(d){switch(d.label){case 0:d.trys.push([0,26,,27]),d.label=1;case 1:d.trys.push([1,19,20,25]),o=E(this._starterKits),d.label=2;case 2:return[4,o.next()];case 3:return(i=d.sent()).done?[3,18]:(a=i.value).getLayerAdapters?[4,a.getLayerAdapters.call(a)]:[3,17];case 4:if(!(s=d.sent()))return[3,17];d.label=5;case 5:d.trys.push([5,11,12,17]),u=E(s),d.label=6;case 6:return[4,u.next()];case 7:return(c=d.sent()).done?[3,10]:[4,(p=c.value).createAdapter(this)];case 8:(l=d.sent())&&(this.mapAdapter.layerAdapters[p.name]=l),d.label=9;case 9:return[3,6];case 10:return[3,17];case 11:return f=d.sent(),n={error:f},[3,17];case 12:return d.trys.push([12,,15,16]),c&&!c.done&&(r=u.return)?[4,r.call(u)]:[3,14];case 13:d.sent(),d.label=14;case 14:return[3,16];case 15:if(n)throw n.error;return[7];case 16:return[7];case 17:return[3,2];case 18:return[3,25];case 19:return h=d.sent(),t={error:h},[3,25];case 20:return d.trys.push([20,,23,24]),i&&!i.done&&(e=o.return)?[4,e.call(o)]:[3,22];case 21:d.sent(),d.label=22;case 22:return[3,24];case 23:if(t)throw t.error;return[7];case 24:return[7];case 25:return[3,27];case 26:throw y=d.sent(),new Error(y);case 27:return[2]}})})},t.prototype._onLoadSync=function(){var t,e;return C(this,void 0,void 0,function(){var n,r,o,i,a;return k(this,function(s){switch(s.label){case 0:s.trys.push([0,8,9,14]),n=E(this._starterKits),s.label=1;case 1:return[4,n.next()];case 2:if((r=s.sent()).done)return[3,7];if(!(o=r.value).onLoadSync)return[3,6];s.label=3;case 3:return s.trys.push([3,5,,6]),[4,o.onLoadSync.call(o,this)];case 4:return s.sent(),[3,6];case 5:return i=s.sent(),console.error(i),[3,6];case 6:return[3,1];case 7:return[3,14];case 8:return a=s.sent(),t={error:a},[3,14];case 9:return s.trys.push([9,,12,13]),r&&!r.done&&(e=n.return)?[4,e.call(n)]:[3,11];case 10:s.sent(),s.label=11;case 11:return[3,13];case 12:if(t)throw t.error;return[7];case 13:return[7];case 14:return[2]}})})},t.prototype._addEventsListeners=function(){var t=this;["click","zoomstart","zoom","zoomend","movestart","move","moveend"].forEach(function(e){t.mapAdapter.emitter.on(e,function(n){t.emitter.emit(e,n)})}),this.onMapLoad().then(function(){})},t.keys=new i,t.utils={detectGeometryType:f,findMostFrequentGeomType:h,updateGeoJsonAdapterOptions:d,propertiesFilter:l,createToggleControl:r},t.decorators={onLoad:s},t.controls=P.controls,t}()},70:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var r,o=n(164),i=n(10),a=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},u=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})},c=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},p=function(t){function e(n,r,o,i){var a=t.call(this,s({},e.options,o))||this;return a.webMap=n,a.item=r,i&&a.tree.setParent(i),a.initProperties(),a._init(r),a}return a(e,t),e.prototype.initItem=function(t){return u(this,void 0,void 0,function(){var n,r,o,i,a,u,p,l=this;return c(this,function(c){switch(c.label){case 0:return n=t._layer,"group"!==t.item_type&&"root"!==t.item_type?[3,1]:(t.children&&t.children.length&&t.children.reverse().sort(function(t,e){return"layer"===t.item_type&&"layer"===e.item_type?e.draw_order_position-t.draw_order_position:0}).forEach(function(t){var n=new e(l.webMap,t,l.options,l);l.tree.addChild(n)}),[3,3]);case 1:return"layer"!==t.item_type?[3,3]:(r=t.adapter||t.layer_adapter.toUpperCase(),o=t.layer_max_scale_denom?this._mapScaleToZoomLevel(t.layer_max_scale_denom):this.webMap.options.maxZoom,i=t.layer_min_scale_denom?this._mapScaleToZoomLevel(t.layer_min_scale_denom):this.webMap.options.minZoom,a=s({maxZoom:o,minZoom:i},t,{headers:this.options.headers}),[4,this.webMap.addLayer(r,a)]);case 2:n=c.sent(),c.label=3;case 3:return n&&(t._layer=n,this.layer=n,this.properties&&"layer"===t.item_type&&t.layer_enabled&&this.properties.property("visibility").set(!0),void 0!==(u="layer"===t.item_type&&t.layer_transparency)&&(p=(100-u)/100,this.webMap.setLayerOpacity(n,p))),[2]}})})},e.prototype.bringToFront=function(){},e.prototype.fit=function(){"layer"===this.item.item_type&&console.log(this.item)},e.prototype._mapScaleToZoomLevel=function(t){return Object(i.j)(t)},e.prototype._init=function(t){return u(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,this.initItem(t)];case 1:return e.sent(),this.emitter.emit("init"),[2]}})})},e.options={properties:[{type:"boolean",name:"visibility",getProperty:function(t){if(t){if("group"===t.item.item_type)return!0;if("layer"===t.item.item_type)return t.item.layer_enabled;if("root"===t.item.item_type)return!0}return!1},onSet:function(t,e,n){n&&n.layer&&"layer"===n.item.item_type&&(t?n.webMap.showLayer(n.layer):n.webMap.hideLayer(n.layer),n.item.layer_enabled=t)}}]},e}(o.default)},71:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(72),o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=function(){function t(t,e){this.item=t,this.options={},this._properties={},this._propertiesList=[],e&&e.forEach(this._setPropertyHandler.bind(this))}return t.prototype.add=function(t){this._setPropertyHandler(t)},t.prototype._setPropertyHandler=function(e){var n=t.handlers,r=e.handler;if(!r&&e.type)switch(e.type){case"boolean":r=n.CheckProperty;break;case"string":r=n.BaseProperty;break;default:r=n.BaseProperty}if(r&&e.name){var i=o({},e||{});this._properties[e.name]=new r(e.name,this.item,i),this._propertiesList.push(e.name)}},t.prototype.update=function(){this.list().forEach(function(t){t.update()})},t.prototype.get=function(t){var e=this.property(t);if(e)return e.get()},t.prototype.set=function(t,e,n){var r=this.property(t);if(r)return r.set(e,n)},t.prototype.property=function(t){return this._properties[t]},t.prototype.list=function(){var t=this;return this._propertiesList.map(function(e){return t._properties[e]})},t.prototype.destroy=function(){for(var t in this._properties)if(this._properties.hasOwnProperty(t)){var e=this.property(t);e&&e.destroy&&e.destroy()}this._properties={},this._propertiesList=[]},t.handlers={CheckProperty:r.a},t}()},72:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r,o=n(73),i=(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t){function e(n,r,o){var i=t.call(this,n,r,a({},e.options,o))||this;return i.set(i.get()),i}return i(e,t),e.prototype.update=function(t,e){if(t){if(e&&e.bubble||this.options.bubble){this.unBlock(e);var n=this.getParent(),r=n&&n.properties&&n.properties.property(this.name);r&&r.set(t,Object.assign({},e,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(e)}else this._turnOff(e);(e&&e.propagation||this.options.propagation)&&this._propagation(t,e)},e.prototype.getHierarchyValue=function(){var t=this;return this.get()&&this.getParents().every(function(e){var n=e.properties&&e.properties.get(t.name);return n&&n.get()})},e.prototype._prepareValue=function(t){return t},e.prototype._turnOff=function(t){this.options.turnOff&&this.options.turnOff.call(this,t),this._callOnSet(!1,t),this.options.hierarchy&&this.isGroup()&&this.blockChilds(t)},e.prototype._turnOn=function(t){this.options.turnOn&&this.options.turnOn.call(this,t),this._callOnSet(!0,t),this.options.hierarchy&&this.isGroup()&&this.unblockChilds(t)},e.prototype.block=function(t){this._blocked=!0,this._block(t)},e.prototype._block=function(t){this._turnOff(t)},e.prototype.unBlock=function(t){this._blocked=!1,this.getValue()&&this._unBlock(t)},e.prototype._unBlock=function(t){this._turnOn(t)},e.prototype.blockChilds=function(t){var e=this;this.item.tree.getDescendants().forEach(function(n){return e._blockChild(n,t)})},e.prototype.unblockChilds=function(t){var e=this;this.item.tree.getChildren().forEach(function(n){return e._unBlockChild(n,t)})},e.prototype._blockChild=function(t,e){var n=t.properties&&t.properties.property(this.name);n&&n.block&&n.block(e)},e.prototype._unBlockChild=function(t,e){var n=t.properties&&t.properties.property(this.name);n&&n.unBlock&&n.unBlock(e)},e.prototype._propagation=function(t,e){if(this.isGroup())for(var n=this.item.tree.getChildren(),r=0;r<n.length;r++){var o=n[r],i=o.properties&&o.properties.property(this.name);i&&i.set(t,a({},e,{propagation:!0,bubble:!1}))}},e.options={hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"},e}(o.a)},73:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return i});try{r=n(14)}catch(t){}var o=r&&r.EventEmitter,i=function(){function t(t,e,n){this.emitter=o&&new o,this._blocked=!1,this.item=e,this.options=Object.assign({},n),this.name=t,this._value=this.getProperty()}return t.prototype.getProperty=function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this,this.item):this.options.value},t.prototype.getParents=function(){return this.item.tree.getParents()||[]},t.prototype.getParent=function(){return this.item.tree.getParent()},t.prototype.isGroup=function(){return this.item.tree.getDescendants().length},t.prototype.isBlocked=function(){var t=this;if(void 0===this._blocked){var e=this.item.tree.getParents();if(e){var n=e.find(function(e){var n=e.properties&&e.properties.property(t.name);return!!n&&!n.get()});this._blocked=!!n}else this._blocked=!1}return this._blocked},t.prototype.set=function(t,e){this._value=this._prepareValue(t),this.update(this._value,e),this._fireChangeEvent(this._value,e)},t.prototype.get=function(){return this.getValue()},t.prototype.update=function(t,e){this._callOnSet(t,e)},t.prototype.getContainer=function(){return this._container},t.prototype.destroy=function(){if(this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}this._removeEventsListener&&this._removeEventsListener()},t.prototype.getValue=function(){return void 0!==this._value?this._value:this.getProperty()},t.prototype._prepareValue=function(t){return t},t.prototype._callOnSet=function(t,e){this.options.onSet&&this.options.onSet.call(this,t,e,this.item)},t.prototype._fireChangeEvent=function(t,e){var n=this;this.emitter&&(t=void 0!==t?t:this.getValue(),this.emitter.emit("change",{value:t,options:e}),this.item.tree.getParents().forEach(function(r){var o=r.properties&&r.properties.property(n.name);o&&o.emitter.emit("change-tree",{value:t,options:e,item:n.item})}))},t}()},74:function(t,e,n){"use strict";var r=n(109);n(11),n(163);e.default=r.a},75:function(t,e,n){"use strict";var r=n(112);n(159);e.default=r.a},76:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r={brill:'<path d="m6 0-5 6 5 6 5-6z"/>',circle:'<circle cx="6" cy="6" r="6"/>',rect:'<rect width="12" height="12"/>',marker:'<path d="m6 0c-1.85 0-4 1.19-4 4.22 0 2.05 3.08 6.59 4 7.78 0.821-1.19 4-5.62 4-7.78 0-3.03-2.15-4.22-4-4.22z"/>',cross:'<path d="M 2.4,12 6,8.4 9.6,12 12,9.6 8.4,6 12,2.4 9.6,0 6,3.6 2.4,0 0,2.4 3.6,6 0,9.6 Z"/>',star:'<path d="m6 0.25 1.71 4.18 4.29-1.04e-4 -3.43 3.14 0.857 4.18-3.43-3.14-3.43 3.14 0.857-4.18-3.43-3.14 4.29-0.209z"/>',triangle:'<path d="m12 11.7h-12l6-11.2z"/>',plus:'<path d="m7.5 12v-4.5h4.5v-3h-4.5v-4.5h-3v4.5h-4.5v3h4.5v4.5z"/>',minus:'<path d="m12 7.5v-3h-12v3z"/>',asterisk:'<path d="m7.59 12v-3.27l2.83 1.64 1.58-2.74-2.85-1.64 2.83-1.64-1.56-2.74-2.83 1.64v-3.24h-3.17v3.24l-2.85-1.64-1.57 2.74 2.84 1.64-2.84 1.64 1.57 2.74 2.85-1.64v3.27z"/>'},o=.8;function i(t){void 0===t&&(t={});var e=t.shape||"circle",n=t.color||"blue",i=t.strokeColor||"white",a=t.size||12,s=a/2,u="number"==typeof t.stroke?t.stroke:o,c=a/12,p=r[e]||"circle",l=function(t,e,n,r){void 0===n&&(n=0);var o=n/2,i='<svg\n    version="1.1"\n    xmlns="http://www.w3.org/2000/svg"\n    width="'+t+'"\n    height="'+e+'"\n    viewBox="-'+o+" -"+o+" "+(t+n)+" "+(e+n)+'"\n  >'+r+"</svg>";return(new DOMParser).parseFromString(i,"image/svg+xml").documentElement}(a,a,u*c,"string"==typeof p?p:p(t)),f=l.firstChild,h="scale("+c+")";return f.setAttribute("fill",n),u&&(f.setAttribute("stroke",i),f.setAttribute("stroke-width",String(u))),f.setAttribute("transform",h),{type:"icon",iconSize:[a,a],iconAnchor:[s,s],html:(new XMLSerializer).serializeToString(l)}}}},[[168,16,2,8,15,1,3,5,4,6,7,9,10,11,12,13,14]]]);