/*! For license information please see main-4aa8b69d55efd35.js.LICENSE.txt */
(self.webpackChunkclear_horizon=self.webpackChunkclear_horizon||[]).push([[185],{8907:function(t,e,r){"use strict";r.d(e,{q:function(){return i}}),r(2222);var n={brill:'<path d="m6 0-5 6 5 6 5-6z"/>',circle:'<circle cx="6" cy="6" r="6"/>',rect:'<rect width="12" height="12"/>',marker:'<path d="m6 0c-1.85 0-4 1.19-4 4.22 0 2.05 3.08 6.59 4 7.78 0.821-1.19 4-5.62 4-7.78 0-3.03-2.15-4.22-4-4.22z"/>',cross:'<path d="M 2.4,12 6,8.4 9.6,12 12,9.6 8.4,6 12,2.4 9.6,0 6,3.6 2.4,0 0,2.4 3.6,6 0,9.6 Z"/>',star:'<path d="m6 0.25 1.71 4.18 4.29-1.04e-4 -3.43 3.14 0.857 4.18-3.43-3.14-3.43 3.14 0.857-4.18-3.43-3.14 4.29-0.209z"/>',triangle:'<path d="m12 11.7h-12l6-11.2z"/>',plus:'<path d="m7.5 12v-4.5h4.5v-3h-4.5v-4.5h-3v4.5h-4.5v3h4.5v4.5z"/>',minus:'<path d="m12 7.5v-3h-12v3z"/>',asterisk:'<path d="m7.59 12v-3.27l2.83 1.64 1.58-2.74-2.85-1.64 2.83-1.64-1.56-2.74-2.83 1.64v-3.24h-3.17v3.24l-2.85-1.64-1.57 2.74 2.84 1.64-2.84 1.64 1.57 2.74 2.85-1.64v3.27z"/>'};function o(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,o=r/2,i='<svg\n    version="1.1"\n    xmlns="http://www.w3.org/2000/svg"\n    width="'.concat(t,'"\n    height="').concat(e,'"\n    viewBox="-').concat(o," -").concat(o," ").concat(t+r," ").concat(e+r,'"\n  >').concat(n,"</svg>"),u=new DOMParser,a=u.parseFromString(i,"image/svg+xml");return a.documentElement}function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.shape||"circle",r=t.color||"blue",i=t.strokeColor||"white",u=t.size||12,a=u/2,c=12,s="number"==typeof t.stroke?t.stroke:.8,f=u/c,l=n[e]||"circle",p="string"==typeof l?l:l(t),y=o(u,u,s*f,p),h=y.firstChild,v="scale(".concat(f,")");h.setAttribute("fill",r),s&&(h.setAttribute("stroke",i),h.setAttribute("stroke-width",String(s))),h.setAttribute("transform",v);var b=new XMLSerializer;return{type:"icon",iconSize:[u,u],iconAnchor:[a,a],html:b.serializeToString(y),svg:y}}},6952:function(t,e,r){"use strict";r.d(e,{ck:function(){return E}}),r(7941),r(2526),r(7327),r(5003),r(4747),r(9337);var n=r(4034);function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"item",void 0),i(this,"_children",[]),i(this,"_parent",void 0),this.item=e}var e,r;return e=t,(r=[{key:"setParent",value:function(t){this._parent=t}},{key:"addChild",value:function(t){this._children.push(t)}},{key:"getParent",value:function(){return this._parent}},{key:"getParents",value:function(t){var e=this.getParent();return e?(0,n.Zm)(e,t,(function(t){return t.tree.getParent()})):[]}},{key:"getRoot",value:function(){for(var t=this.getParent(),e=t;t;)(t=t.tree.getParent())&&(e=t);return e}},{key:"find",value:function(t){return(0,n.Ql)(this._children,t,(function(t){return t.tree.getChildren()}))}},{key:"every",value:function(t){return(0,n.qL)(this._children,t,(function(t){return t.tree.getChildren()}))}},{key:"some",value:function(t){return(0,n.cC)(this._children,t,(function(t){return t.tree.getChildren()}))}},{key:"all",value:function(t){return this.getDescendants(t)}},{key:"getDescendants",value:function(t){return(0,n.Zm)(this._children,t,(function(t){return t.tree.getChildren()}))}},{key:"getChildren",value:function(){return this._children}}])&&o(e.prototype,r),t}(),a=(r(8309),r(1249),r(9601),r(8304),r(489),r(2419),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(9826),r(7187));function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function v(t,e){return!e||"object"!==f(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=b(n);if(o){var r=b(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return v(this,t)});function u(t,e,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,t,e,p(p({},u.options),r))).set(n.get()),n}return e=u,(r=[{key:"update",value:function(t,e){if(t){if(e&&e.bubble||this.options.bubble){this.unBlock(e);var r=this.getParent(),n=r&&r.properties&&r.properties.property(this.name);n&&n.set(t,Object.assign({},e,{bubble:!0,propagation:!1}))}this.isBlocked()||this._turnOn(e)}else this._turnOff(e);(e&&e.propagation||this.options.propagation)&&this._propagation(t,e)}},{key:"getHierarchyValue",value:function(){var t=this;return this.get()&&this.getParents().every((function(e){var r=e.properties&&e.properties.get(t.name);return r&&r.get()}))}},{key:"_prepareValue",value:function(t){return t}},{key:"_turnOff",value:function(t){this.options.turnOff&&this.options.turnOff.call(this,t),this._callOnSet(!1,t),this.options.hierarchy&&this.isGroup()&&this.blockChild(t)}},{key:"_turnOn",value:function(t){this.options.turnOn&&this.options.turnOn.call(this,t),this._callOnSet(!0,t),this.options.hierarchy&&this.isGroup()&&this.unblockChild(t)}},{key:"block",value:function(t){this._blocked=!0,this._block(t)}},{key:"_block",value:function(t){this._turnOff(t)}},{key:"unBlock",value:function(t){this._blocked=!1,this.getValue()&&this._unBlock(t)}},{key:"_unBlock",value:function(t){this._turnOn(t)}},{key:"blockChild",value:function(t){var e=this;this.item.tree.getDescendants().forEach((function(r){return e._blockChild(r,t)}))}},{key:"unblockChild",value:function(t){var e=this;this.item.tree.getChildren().forEach((function(r){return e._unBlockChild(r,t)}))}},{key:"_blockChild",value:function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.block&&r.block(e)}},{key:"_unBlockChild",value:function(t,e){var r=t.properties&&t.properties.property(this.name);r&&r.unBlock&&r.unBlock(e)}},{key:"_propagation",value:function(t,e){if(this.isGroup())for(var r=this.item.tree.getChildren(),n=0;n<r.length;n++){var o=r[n],i=o.properties&&o.properties.property(this.name);i&&i.set(t,p(p({},e),{propagation:!0,bubble:!1}))}}}])&&y(e.prototype,r),u}(function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,"options",void 0),s(this,"emitter",new a.EventEmitter),s(this,"name",void 0),s(this,"item",void 0),s(this,"_blocked",!1),s(this,"_container",void 0),s(this,"_value",void 0),s(this,"_removeEventsListener",void 0),this.item=r,this.options=Object.assign({},n),this.name=e,this._value=this.getProperty()}var e,r;return e=t,(r=[{key:"getProperty",value:function(){return"function"==typeof this.options.getProperty?this.options.getProperty.call(this,this.item):this.options.value}},{key:"getParents",value:function(){return this.item.tree.getParents()||[]}},{key:"getParent",value:function(){return this.item.tree.getParent()}},{key:"isGroup",value:function(){return this.item.tree.getDescendants().length}},{key:"isBlocked",value:function(){var t=this;if(void 0===this._blocked){var e=this.item.tree.getParents();if(e){var r=e.find((function(e){var r=e.properties&&e.properties.property(t.name);return!!r&&!r.get()}));this._blocked=!!r}else this._blocked=!1}return this._blocked}},{key:"set",value:function(t,e){this._value=this._prepareValue(t),this.update(this._value,e),this._fireChangeEvent(this._value,e)}},{key:"get",value:function(){return this.getValue()}},{key:"update",value:function(t,e){this._callOnSet(t,e)}},{key:"getContainer",value:function(){return this._container}},{key:"destroy",value:function(){if(this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}this._removeEventsListener&&this._removeEventsListener()}},{key:"getValue",value:function(){return void 0!==this._value?this._value:this.getProperty()}},{key:"_prepareValue",value:function(t){return t}},{key:"_callOnSet",value:function(t,e){this.options.onSet&&this.options.onSet.call(this,t,e,this.item)}},{key:"_fireChangeEvent",value:function(t,e){var r=this;this.emitter&&(t=void 0!==t?t:this.getValue(),this.emitter.emit("change",{value:t,options:e}),this.item.tree.getParents().forEach((function(n){var o=n.properties&&n.properties.property(r.name);o&&o.emitter.emit("change-tree",{value:t,options:e,item:r.item})})))}}])&&c(e.prototype,r),t}());function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}d(m,"options",{hierarchy:!0,bubble:!1,propagation:!1,label:"Toggle"});var P=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.item=e,w(this,"options",{}),w(this,"_properties",{}),w(this,"_propertiesList",void 0),this._propertiesList=[],r&&r.forEach(this._setPropertyHandler.bind(this))}var e,r;return e=t,(r=[{key:"add",value:function(t){this._setPropertyHandler(t)}},{key:"_setPropertyHandler",value:function(e){var r=t.handlers,n=e.handler;if(!n&&e.type)switch(e.type){case"boolean":n=r.CheckProperty;break;case"string":n=r.BaseProperty;break;default:n=r.BaseProperty}if(n&&e.name){var o=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){w(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e||{});this._properties[e.name]=new n(e.name,this.item,o),this._propertiesList.push(e.name)}}},{key:"update",value:function(){this.list().forEach((function(t){t.update()}))}},{key:"get",value:function(t){var e=this.property(t);if(e)return e.get()}},{key:"set",value:function(t,e,r){var n=this.property(t);if(n)return n.set(e,r)}},{key:"property",value:function(t){return this._properties[t]}},{key:"list",value:function(){var t=this;return this._propertiesList.map((function(e){return t._properties[e]}))}},{key:"destroy",value:function(){for(var t in this._properties){var e=this.property(t);e&&e.destroy&&e.destroy()}this._properties={},this._propertiesList=[]}}])&&g(e.prototype,r),t}();function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function k(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}w(P,"handlers",{CheckProperty:m});var S=0,E=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),k(this,"options",{}),k(this,"properties",void 0),k(this,"tree",void 0),k(this,"id",S),S+=1,this.options=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){k(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e),this.tree=new u(this)}var e,r;return e=t,(r=[{key:"initProperties",value:function(){this.properties=new P(this,this.options.properties)}}])&&j(e.prototype,r),t}()},5020:function(t,e,r){"use strict";r.d(e,{Z:function(){return ve}}),r(1249),r(4916),r(5306),r(4747),r(7941),r(2526),r(7327),r(5003),r(9337),r(1817),r(1539),r(2165),r(6992),r(8783),r(3948),r(7042),r(8309),r(1038);var n=r(7187),o=r(5243),i=(r(5666),r(561),r(2772),r(9601),r(8304),r(489),r(2419),r(8674),r(2539)),u=r(9443);function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.map=e,this.options=r,c(this,"layer",void 0),c(this,"pane","order-0"),void 0!==r.order){var n="order-"+r.order,o=e.getPane(n);o||(o=e.createPane(n)),o.style.zIndex=String(Math.round(100*r.order)),this.pane=n}}var e,r;return e=t,(r=[{key:"addLayer",value:function(t){}}])&&a(e.prototype,r),t}(),f={Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon",GeometryCollection:"polygon"},l={stroke:!1,opacity:1},p={};for(var y in f){var h=f[y],v=p[h]||[];v.push(y),p[h]=v}function b(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=1+(e[t[r]]||0);var n="";for(var o in e){var i=n?e[n]:0;e[o]>i&&(n=o)}return n}function d(t,e){return-1!==(p[e]||[]).indexOf(t)}function m(t){var e=t.containerPoint,r=t.latlng,n=r.lat;return{latLng:r,lngLat:[r.lng,n],pixel:{left:e.x,top:e.y},source:t}}function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function w(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function P(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?w(Object(r),!0).forEach((function(e){C(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _(t,e,r,n,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,o)}function j(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t,e){return!e||"object"!==O(e)&&"function"!=typeof e?E(t):e}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function R(t){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var x=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(y,t);var e,r,n,a,c,s,p=(c=y,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=R(c);if(s){var r=R(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return S(this,t)});function y(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),C(E(r=p.call(this,t,e)),"layer",void 0),C(E(r),"selected",!1),C(E(r),"paint",void 0),C(E(r),"selectedPaint",void 0),C(E(r),"type",void 0),C(E(r),"_layers",[]),C(E(r),"_selectedLayers",[]),C(E(r),"_filteredLayers",[]),C(E(r),"_filterFun",void 0),C(E(r),"$updateTooltip",(0,i.Ds)((function(){r.updateTooltip()}),300)),r.layer=new o.FeatureGroup([],{pane:r.pane}),r}return e=y,(r=[{key:"addLayer",value:function(t){return this.options=t,this.paint=t.paint,this.selectedPaint=t.selectedPaint,t.paint=this.paint,t.data&&this.addData(t.data),this._addMapMoveListener(),this.layer}},{key:"beforeRemove",value:function(){this._removeMapMoveListener()}},{key:"select",value:function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._selectLayer(t,"api")})):this.selected||(this.selected=!0,this.selectedPaint&&this.setPaintEachLayer(this.selectedPaint))}},{key:"unselect",value:function(t){var e=this;t?this._layers.filter(t).forEach((function(t){e._unSelectLayer(t.layer)})):this.selected&&(this.selected=!1,this.paint&&this.setPaintEachLayer(this.paint))}},{key:"getSelected",value:function(){return this._selectedLayers.map((function(t){return{feature:t.feature,layer:t}}))}},{key:"getFiltered",value:function(){return this._filteredLayers}},{key:"filter",value:function(t){var e=this;this._filterFun=t;var r=this.layer._map;r&&this.layer.remove();var n=[];return this._layers.forEach((function(r){var o=r.feature,i=r.layer;i&&(!t||t({feature:o,layer:i})?(e.layer.addLayer(i),n.push({feature:o,layer:i})):e.layer.removeLayer(i))})),this._filteredLayers=n,r&&this.layer.addTo(r),this._filteredLayers}},{key:"cleanFilter",value:function(){this.filter()}},{key:"getLayers",value:function(){var t=this;return this._layers.map((function(e){var r=e.layer;return{feature:e.feature,layer:r,visible:r&&!!r._map,target:t}}))}},{key:"clearLayer",value:function(t){if(t)for(var e=this._layers.length;e--;){var r=this._layers[e];if(r){var n=r.feature,o=r.layer;n&&o&&t(n)&&(this.layer.removeLayer(o),this._layers.splice(e,1))}}else this.layer.clearLayers(),this._layers=[]}},{key:"setData",value:function(t){this.clearLayer(),this.addData(t)}},{key:"addData",value:function(t){var e,r,n=this.options;if(n){if(t){var i;if(n.type)i=n.type;else{var u="FeatureCollection"===(r=t).type?b(r.features.map((function(t){return t.geometry.type}))):"GeometryCollection"===r.type?b(r.geometries.map((function(t){return t.type}))):"Feature"===r.type?r.geometry.type:r.type;i=f[u]}if(this.type&&this.type!==i)return void console.warn("no other data type than layer can be added");this.type=i,(t=function(t,e){if("FeatureCollection"===t.type){var r=t;r.features=r.features.filter((function(t){return d(t.geometry.type,e)}))}else if("Feature"===t.type){if(!d(t.geometry.type,e))return!1}else if("GeometryCollection"===t.type){var n=t;n.geometries=n.geometries.filter((function(t){return d(t.type,e)}))}return t}(t,i))&&(e=this.getGeoJsonOptions(n,i))}new o.GeoJSON(t||void 0,e)}}},{key:"openPopup",value:function(t,e){var r=this;t&&this._layers.filter(t).forEach((function(t){r._openPopup(t,e,"api")}))}},{key:"closePopup",value:function(t){var e=this;(t?this._layers.filter(t):this._layers).forEach((function(t){e._closePopup(t)}))}},{key:"updateTooltip",value:function(t){var e=this;t?this._updateTooltip(t):this.getLayers().forEach((function(t){return e._updateTooltip({feature:t.feature,layer:t.layer})}))}},{key:"getExtent",value:function(){var t=this.layer.getBounds(),e=t.getNorthEast(),r=t.getSouthWest();if(e&&r)return[r.lng,r.lat,e.lng,e.lat]}},{key:"_updateTooltip",value:function(t){var e=t.feature,r=t.layer;if(e&&r&&e.properties&&this.options.labelField){r.unbindTooltip();var n=e.properties[this.options.labelField];if(void 0!==n){var o=!this.options.labelOnHover;r.bindTooltip(String(n),{permanent:o,sticky:!1})}}}},{key:"_openPopup",value:(n=regeneratorRuntime.mark((function t(e){var r,n,o,i,u,a,c,s,f,l,p=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=p.length>1&&void 0!==p[1]?p[1]:{},n=p.length>2?p[2]:void 0,o=e.feature,i=e.layer,u=P({minWidth:300},r),a=u.minWidth,c=u.autoPan,s=u.maxWidth,!r.createPopupContent){t.next=10;break}return t.next=7,r.createPopupContent({layer:i,feature:o,target:this,type:n});case 7:t.t0=t.sent,t.next=11;break;case 10:t.t0=r.popupContent;case 11:(f=t.t0)&&i&&(l=i.bindPopup(f,{minWidth:a,autoPan:c,maxWidth:s}),setTimeout((function(){l.openPopup()}),0));case 13:case"end":return t.stop()}}),t,this)})),a=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function u(t){_(i,r,o,u,a,"next",t)}function a(t){_(i,r,o,u,a,"throw",t)}u(void 0)}))},function(t){return a.apply(this,arguments)})},{key:"_closePopup",value:function(t){t.layer&&t.layer.closePopup().unbindPopup()}},{key:"setPaintEachLayer",value:function(t){var e=this;this._layers.forEach((function(r){e.setPaint(r,t)}))}},{key:"setPaint",value:function(t,e){var r=void 0,n=t.layer,o=t.feature;if(n&&o&&((0,u.UY)(e)?r=e(o):(0,u.GY)(e)&&(r=e),r))if("point"===this.type&&"icon"===r.type){var i=n,a=this.createDivIcon(r);i.setIcon(a)}else"setStyle"in n&&n.setStyle(this.preparePaint(r))}},{key:"preparePaint",value:function(t){if("get-paint"!==t.type){var e="line"===this.type?[["color","strokeColor"],["opacity","strokeOpacity"],["weight","weight"]]:[["color","strokeColor"],["opacity","strokeOpacity"],["stroke","stroke"],["fillColor","fillColor"],["fillOpacity","fillOpacity"],["fill","fill"],["weight","weight"]],r={};return"radius"in t&&"number"==typeof t.radius&&(r.radius=t.radius),e.forEach((function(e){var n,o,i=(o=2,function(t){if(Array.isArray(t))return t}(n=e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(n,o)||function(t,e){if(t){if("string"==typeof t)return g(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(t,e):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=i[0],a=i[1],c=t[a];void 0!==c&&Object.defineProperty(r,u,{enumerable:!0,value:c})})),r}return l}},{key:"getGeoJsonOptions",value:function(t,e){var r=this,n=t.paint,o={};return"function"==typeof n?"point"===e?o.pointToLayer=function(t,e){var o=n(t);return r.createPaintToLayer(o)(t,e)}:o={style:function(t){return t?r.preparePaint(P(P({},l),n(t))):r.preparePaint(P(P({},l),{},{type:"path"}))}}:o=this.createPaintOptions(n,e),o.onEachFeature=function(t,e){e.options.pane=r.pane,r._layers.push({feature:t,layer:e});var n=!0;if(r._filterFun&&(n=r._filterFun({feature:t,layer:e})),n){var o=r.options,u=o.popup,a=o.popupOptions,c=o.selectable,s=o.interactive,f=o.selectOnHover;e.options.interactive=!(0,i.ri)(s)||s,r.layer.addLayer(e),c&&(f?(e.on("mouseover",(function(){r._selectLayer({feature:t,layer:e},"hover")})),e.on("mouseout",(function(){r._unSelectLayer(e)}))):e.on("click",(function(t){return r._selectOnLayerClick(t)}),r)),r._handleMouseEvents(e),u&&r._openPopup({layer:e,feature:t},a,"api"),r._updateTooltip({layer:e,feature:t})}},o}},{key:"_handleMouseEvents",value:function(t){var e=this,r=function(t){var r=t.target;return{layer:e,feature:r.feature,event:m(t),source:t}},n=this.options,o=n.onClick,i=n.onLayerClick,u=n.onMouseOut,a=n.onMouseOver,c=o||i;c&&t.on("click",(function(t){var n;c(P({selected:(n=t.target,-1!==e._selectedLayers.indexOf(n))},r(t)))}),this),u&&t.on("mouseout",(function(t){u(r(t))}),this),a&&t.on("mouseover",(function(t){a(r(t))}),this)}},{key:"_selectOnLayerClick",value:function(t){o.DomEvent.stopPropagation(t);var e=t.target,r=-1!==this._selectedLayers.indexOf(e);r?this.options&&this.options.unselectOnSecondClick&&(this._unSelectLayer(e),r=!1):(this._selectLayer(e,"click"),r=!0)}},{key:"_selectLayer",value:function(t,e){var r=this;this.options&&!this.options.multiselect&&this._selectedLayers.forEach((function(t){return r._unSelectLayer(t)})),this._selectedLayers.push(t),this.selected=!0,this.options&&(this.options.selectedPaint&&t.layer&&this.setPaint(t,this.options.selectedPaint),this.options.popupOnSelect&&this._openPopup(t,this.options.popupOptions,e),this.options.onSelect&&this.options.onSelect({type:e,layer:this,features:t.feature?[t.feature]:[]}))}},{key:"_unSelectLayer",value:function(t){var e=this._selectedLayers.indexOf(t);-1!==e&&this._selectedLayers.splice(e,1),this.selected=this._selectedLayers.length>0,this.options&&(this.options.paint&&this.setPaint(t,this.options.paint),this.options.popupOnSelect&&this._closePopup(t))}},{key:"createDivIcon",value:function(t){var e=Object.assign({},t);return new o.DivIcon(P({className:""},e))}},{key:"createPaintToLayer",value:function(t){var e=this;if(t&&t.type)if("icon"===t.type){var r=t.className,n=t.html;if(r||n)return function(r,n){var i=e.createDivIcon(t);return new o.Marker(n,{icon:i})}}else if("pin"===t.type)return function(t,e){return new o.Marker(e)};return function(r,n){var i=l;return new o.CircleMarker(n,e.preparePaint(P(P({},i),t)))}}},{key:"createPaintOptions",value:function(t,e){var r={},n=t&&this.preparePaint(t)||{};return t&&(r.style=function(){return n}),"point"===e?r.pointToLayer=this.createPaintToLayer(t):"line"===e&&(n.stroke=!0),r}},{key:"_addMapMoveListener",value:function(){var t=this.map;t&&this.options.labelField&&!this.options.labelOnHover&&(t.on("zoomend",this.$updateTooltip),t.on("moveend",this.$updateTooltip))}},{key:"_removeMapMoveListener",value:function(){this.map.off("zoomend",this.$updateTooltip),this.map.off("moveend",this.$updateTooltip)}}])&&j(e.prototype,r),y}(s);function T(t){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){return(L=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function B(t,e){return!e||"object"!==T(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&L(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=D(e);if(r){var o=D(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return B(this,t)});function o(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),e=n.call(this,t);var r=t&&t.customAttribution;if(r){var i=[];Array.isArray(r)?i=r:r&&(i=[r]),i.forEach((function(t){return e.addAttribution(t)}))}return e}return o}(o.Control.Attribution);function I(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.Control.extend({onAdd:function(){var r=document.createElement("div"),n=t.onAdd();return r.classList.add("leaflet-control"),e.bar&&r.classList.add("leaflet-bar"),e.margin||e.bar||(r.style.marginBottom="0px",r.style.marginTop="0px",r.style.marginLeft="0px",r.style.marginRight="0px"),n&&r.appendChild(n),o.DomEvent.disableClickPropagation(r),r},onRemove:function(){t.onRemove()}});return new r}function M(t,e,r){var n=new XMLHttpRequest;for(var o in n.open("GET",t),n.responseType="arraybuffer",r)n.setRequestHeader(o,r[o]);return n.onload=function(){var t=new Uint8Array(this.response),r=new Blob([t],{type:"image/png"}),n=(window.URL||window.webkitURL).createObjectURL(r);e(n)},n.send(),function(){n.abort()}}function Z(t){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function F(t,e,r){return(F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=H(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function z(t,e){return(z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function G(t,e){return!e||"object"!==Z(e)&&"function"!=typeof e?N(t):e}function N(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H(t){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}r(2222),r(4678),r(9600),r(4819),r(2472),r(2990),r(8927),r(3105),r(5035),r(4345),r(7174),r(2846),r(4731),r(7209),r(6319),r(8867),r(7789),r(3739),r(9368),r(4483),r(2056),r(3462),r(678),r(7462),r(3824),r(5021),r(2974),r(5016),r(285);var W=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&z(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=H(n);if(o){var r=H(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return G(this,t)});function u(t,e,r){var n,o,a,c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),c=[],(a="_abort")in(o=N(n=i.call(this,t,e,r)))?Object.defineProperty(o,a,{value:c,enumerable:!0,configurable:!0,writable:!0}):o[a]=c,n}return e=u,(r=[{key:"cancelLoad",value:function(){this._abort&&(this._abort.forEach((function(t){return t()})),this._abort=[])}},{key:"_initImage",value:function(){F(H(u.prototype),"_initImage",this).call(this);var t=this.options.headers;if(t){var e=this._image,r=e.src;e.src="",this._abort.push(M(r,(function(t){e.src=t}),t))}}}])&&U(e.prototype,r),u}(o.ImageOverlay);function q(t){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function $(t,e){return($=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function J(t,e){return!e||"object"!==q(e)&&"function"!=typeof e?Q(t):e}function Q(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y(t){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function X(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var K=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$(t,e)}(c,t);var e,r,n,u,a=(n=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Y(n);if(u){var r=Y(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return J(this,t)});function c(t,e){var r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),X(Q(r=a.call(this,e)),"defaultWmsParams",{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1}),X(Q(r),"options",{crs:null,uppercase:!1,attribution:"",opacity:1,isBack:!1,minZoom:0,maxZoom:18,pane:"tilePane",headers:null,viewPortBuffer:0,setViewDelay:100}),X(Q(r),"wmsParams",void 0),X(Q(r),"_url",void 0),X(Q(r),"_currentUrl",void 0),X(Q(r),"_currentOverlay",void 0),r._url=t;var n,i={},u={};for(n in e)n in r.options?u[n]=e[n]:i[n]=e[n];return o.Util.setOptions(Q(r),u),r.wmsParams=o.Util.extend({},r.defaultWmsParams,i),r}return e=c,(r=[{key:"setParams",value:function(t){o.Util.extend(this.wmsParams,t),this.update()}},{key:"getAttribution",value:function(){return this.options.attribution||""}},{key:"onAdd",value:function(){return this.update(),this}},{key:"onRemove",value:function(t){return this._currentOverlay&&(this._currentOverlay.cancelLoad(),t.removeLayer(this._currentOverlay),delete this._currentOverlay),this._currentUrl&&delete this._currentUrl,this}},{key:"getEvents",value:function(){return{moveend:(0,i.Ds)(this.update,this.options.setViewDelay)}}},{key:"update",value:function(){var t=this;if(this._map){this.updateWmsParams();var e=this.getImageUrl();if(this._currentUrl!==e){this._currentUrl=e;var r=this.options.viewPortBuffer||0,n=this._map.getBounds().pad(r),o=new W(e,n,{opacity:0,pane:this.options.pane,headers:this.options.headers});o.addTo(this._map),this._currentOverlay&&this._currentOverlay.cancelLoad(),o.once("load",(function(){t._map&&(o._url===t._currentUrl?(t._currentOverlay&&t._map.removeLayer(t._currentOverlay),t._currentOverlay=o,o.setOpacity(void 0!==t.options.opacity?t.options.opacity:1),!0===t.options.isBack&&o.bringToBack(),!1===t.options.isBack&&o.bringToFront(),void 0!==t.options.zIndex&&o.setZIndex(t.options.zIndex)):t._map.removeLayer(o))}),this);var i=this.options,u=i.minZoom,a=i.maxZoom;(u&&this._map.getZoom()<u||a&&this._map.getZoom()>a)&&this._map.removeLayer(o)}}}},{key:"setOpacity",value:function(t){this.options.opacity=t,this._currentOverlay&&this._currentOverlay.setOpacity(t)}},{key:"bringToBack",value:function(){this.options.isBack=!0,this._currentOverlay&&this._currentOverlay.bringToBack()}},{key:"bringToFront",value:function(){this.options.isBack=!1,this._currentOverlay&&this._currentOverlay.bringToFront()}},{key:"setZIndex",value:function(t){this.options.zIndex=t,this._currentOverlay&&this._currentOverlay.setZIndex(t)}},{key:"updateWmsParams",value:function(t){t||(t=this._map);var e=this.options.viewPortBuffer||0,r=t.getBounds().pad(e),n=t.getSize();if(0!==this.options.viewPortBuffer){var i=e+1;n.x=Math.ceil(n.x*i),n.y=Math.ceil(n.y*i)}var u=parseFloat(this.wmsParams.version),a=this.options.crs||t.options.crs,c=u>=1.3?"crs":"srs";if(a){var s=a.project(r.getNorthWest()),f=a.project(r.getSouthEast()),l={width:n.x,height:n.y};l[c]=a.code,l.bbox=(u>=1.3&&a===o.CRS.EPSG4326?[f.y,s.x,s.y,f.x]:[s.x,f.y,f.x,s.y]).join(","),o.Util.extend(this.wmsParams,l)}}},{key:"getImageUrl",value:function(){var t=this.options.uppercase||!1,e=o.Util.getParamString(this.wmsParams,this._url,t);return this._url+e}}])&&V(e.prototype,r),c}(o.Layer);function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function rt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?et(Object(r),!0).forEach((function(e){st(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):et(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ut(t,e){return!e||"object"!==tt(e)&&"function"!=typeof e?at(t):e}function at(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ft=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ct(n);if(o){var r=ct(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ut(this,t)});function u(){var t;nt(this,u);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return st(at(t=i.call.apply(i,[this].concat(r))),"layer",void 0),t}return e=u,(r=[{key:"addLayer",value:function(t){var e=t&&t.url;if(e){var r=(t=rt({transparent:!0},t)).updateWmsParams;if(this.layer=new K(e,rt(rt({pane:this.pane,headers:t.headers,setViewDelay:t.setViewDelay},t),t.params)),r){var n=this.layer.updateWmsParams;this.layer.updateWmsParams=function(t){n.call(this,t),this.wmsParams=r(this.wmsParams)}}return this.layer}}}])&&ot(e.prototype,r),u}(s);function lt(t){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ht(t,e){return(ht=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function vt(t,e){return!e||"object"!==lt(e)&&"function"!=typeof e?bt(t):e}function bt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ht(t,e)}(c,t);var e,r,n,u,a=(n=c,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=dt(n);if(u){var r=dt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return vt(this,t)});function c(){var t;pt(this,c);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=a.call.apply(a,[this].concat(r))).options.setViewDelay&&(t._update=(0,i.Ds)((function(){for(var e,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(e=o.GridLayer.prototype._update).call.apply(e,[bt(t)].concat(n))}),t.options.setViewDelay)),t}return e=c,(r=[{key:"createTile",value:function(t,e){var r=this.getTileUrl(t),n=document.createElement("img");return n.abort=M(r,(function(t){n.src=t,e(null,n)}),this.options.headers),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n}},{key:"_abortLoading",value:function(){var t=this._tiles,e=this._tileZoom;for(var r in t)if(t[r].coords.z!==e){var n=t[r].el;n.onload=o.Util.falseFn,n.onerror=o.Util.falseFn,n.complete||(n.abort&&n.abort(),n.src=o.Util.emptyImageUrl,o.DomUtil.remove(n),delete t[r])}}}])&&yt(e.prototype,r),c}(t)}function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){return(gt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function wt(t,e){return!e||"object"!==Ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pt(t){return(Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _t=mt(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gt(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Pt(e);if(r){var o=Pt(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return wt(this,t)});function o(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),r=n.call(this,t,e),Object.assign(r.options,e),r}return o}(o.TileLayer));function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var kt=["url"];function St(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Et(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?St(Object(r),!0).forEach((function(e){Rt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Rt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ct(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tt(t,e){return(Tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Lt(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Dt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tt(t,e)}(a,t);var e,r,n,i,u=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Bt(n);if(i){var r=Bt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Lt(this,t)});function a(){return Ct(this,a),u.apply(this,arguments)}return e=a,(r=[{key:"addLayer",value:function(t){if(t){var e=t.url,r=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,kt);if(e){var n=Et({pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom},r.nativeOptions);return r.subdomains&&(n.subdomains=r.subdomains),r.headers?new _t(e,Et(Et({},n),{},{headers:r.headers,setViewDelay:r.setViewDelay})):new o.TileLayer(e,n)}}}}])&&xt(e.prototype,r),a}(s);function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Mt(t,e){return!e||"object"!==At(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zt(t){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ut=mt(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Zt(e);if(r){var o=Zt(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Mt(this,t)});function o(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),n.call(this,t,e)}return o}(o.TileLayer.WMS));function Ft(t){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var zt=["url"];function Gt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Gt(Object(r),!0).forEach((function(e){Ht(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ht(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Vt(t,e){return(Vt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function $t(t,e){return!e||"object"!==Ft(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Jt(t){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Qt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vt(t,e)}(a,t);var e,r,n,i,u=(n=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Jt(n);if(i){var r=Jt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return $t(this,t)});function a(){return Wt(this,a),u.apply(this,arguments)}return e=a,(r=[{key:"addLayer",value:function(t){if(t){var e=t.url,r=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,zt);if(e){var n={pane:this.pane,attribution:r.attribution,minZoom:r.minZoom,maxZoom:r.maxZoom,layers:t.layers,format:t.format};return r.headers?new Ut(e,Nt(Nt({},n),{},{headers:r.headers})):new o.TileLayer.WMS(e,n)}}}}])&&qt(e.prototype,r),a}(s);function Yt(t){return(Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Kt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(r),!0).forEach((function(e){te(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function te(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ee(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function re(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ne(t,e,r){return(ne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ue(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function oe(t,e){return(oe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ie(t,e){return!e||"object"!==Yt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ue(t){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ae=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&oe(t,e)}(u,t);var e,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ue(n);if(o){var r=ue(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ie(this,t)});function u(){return ee(this,u),i.apply(this,arguments)}return e=u,(r=[{key:"addLayer",value:function(t){return ne(ue(u.prototype),"addLayer",this).call(this,Kt(Kt({},t),{},{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}))}}])&&re(e.prototype,r),u}(Dt);function ce(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return se(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?se(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function fe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function le(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?fe(Object(r),!0).forEach((function(e){ye(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function pe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ye(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var he=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ye(this,"options",{target:"map"}),ye(this,"layerAdapters",t.layerAdapters),ye(this,"controlAdapters",t.controlAdapters),ye(this,"emitter",new n.EventEmitter),ye(this,"map",void 0),ye(this,"_universalEvents",["zoomstart","zoom","zoomend","movestart","move","moveend"])}var e,r;return e=t,(r=[{key:"create",value:function(t){if(this.options=le({},t),this.options.target){var e=this.options,r=e.maxZoom,n=e.minZoom,i=e.zoom,u=e.center,a=e.maxBounds,c=e.mapAdapterOptions;this.map=new o.Map(this.options.target,le({zoomControl:!1,attributionControl:!1,maxZoom:r,minZoom:n,zoom:i,maxBounds:a&&[[a[1],a[0]],[a[3],a[2]]],center:u&&[u[1],u[0]]},c)),this.map.createPane("order-0").style.zIndex=String(0),this.emitter.emit("create",this),this._addMapListeners()}}},{key:"destroy",value:function(){this.map&&this.map.remove()}},{key:"getContainer",value:function(){return this.map&&this.map.getContainer()}},{key:"setCursor",value:function(t){this.map&&(this.map.getContainer().style.cursor=t)}},{key:"setView",value:function(t,e){var r=ce(t,2),n=r[0],o=r[1];this.map&&("number"==typeof e?this.map.setView([o,n],e,{animate:!1}):this.setCenter([n,o]))}},{key:"setCenter",value:function(t){var e=ce(t,2),r=e[0],n=e[1];this.map&&this.map.panTo([n,r])}},{key:"getCenter",value:function(){var t=this.map;if(t){var e=t.getBounds().getCenter();return[e.lng,e.lat]}}},{key:"setZoom",value:function(t){this.map&&this.map.setZoom(t)}},{key:"getZoom",value:function(){return this.map&&this.map.getZoom()||void 0}},{key:"getBounds",value:function(){if(this.map){var t=this.map.getBounds(),e=t.getSouthWest(),r=t.getNorthEast();return[e.lng,e.lat,r.lng,r.lat]}}},{key:"fitBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.map){var r=e.maxZoom,n=e.offset,o=e.padding,i={};r&&(i.maxZoom=r),o&&(i.padding=[o,o]),n&&(i.padding=n),this.map.fitBounds([[t[3],t[0]],[t[1],t[2]]],i)}}},{key:"getLayerAdapter",value:function(e){return t.layerAdapters[e]}},{key:"createControl",value:function(t,e){return I(t,e)}},{key:"createButtonControl",value:function(t){return function(t){var e=document.createElement("a"),r=t.title||"";e.href="#",e.title=r,e.setAttribute("role","button"),e.setAttribute("aria-label",r),o.DomEvent.disableClickPropagation(e),o.DomEvent.on(e,"click",o.DomEvent.stop),t.html instanceof HTMLElement?e.appendChild(t.html):"string"==typeof t.html&&(e.innerHTML=t.html);var n=function(e){e.stopPropagation(),t.onClick()};return I({onAdd:function(){return void 0!==t.onClick&&e.addEventListener("click",n),e},onRemove:function(){var r=e.parentNode;r&&r.removeChild(e),void 0!==t.onClick&&e.removeEventListener("click",n)}},{bar:!0})}(t)}},{key:"addControl",value:function(t,e){if(t.options.position=e.replace("-",""),this.map)return this.map.addControl(t),t}},{key:"removeControl",value:function(t){this.map&&this.map.removeControl(t)}},{key:"removeLayer",value:function(t){t&&t.remove&&t.remove()}},{key:"showLayer",value:function(t){this.map&&t.addTo(this.map)}},{key:"hideLayer",value:function(t){t.remove()}},{key:"setLayerOpacity",value:function(t,e){"setOpacity"in t&&t.setOpacity(e)}},{key:"setLayerOrder",value:function(t,e,r){}},{key:"onMapClick",value:function(t){var e=m(t);this.emitter.emit("preclick",e),this.emitter.emit("click",e)}},{key:"locate",value:function(t,e){var r=this.map;if(r&&(r.locate(t),e)){var n=e.locationfound,o=e.locationerror,i=function(t){var e=t,r=[e.latlng.lng,e.latlng.lat];n({lngLat:r})};return void 0!==n&&r.on("locationfound",i,this),o&&r.on("locationerror",o,this),{stop:function(){void 0!==n&&r.off("locationfound",i),o&&r.off("locationerror",o)}}}return{stop:function(){}}}},{key:"_addMapListeners",value:function(){var t=this,e=this.map;e&&(e.on("click",(function(e){t.onMapClick(e)})),this._universalEvents.forEach((function(r){e.on(r,(function(){return t.emitter.emit(r,t)}),e)})))}}])&&pe(e.prototype,r),t}();ye(he,"layerAdapters",{IMAGE:ft,TILE:Dt,GEOJSON:x,WMS:Qt,OSM:ae}),ye(he,"controlAdapters",{ZOOM:o.Control.Zoom,ATTRIBUTION:A}),ye(he,"Map",o.Map);var ve=he},7869:function(t,e,r){"use strict";r.d(e,{Z:function(){return ct}}),r(2222),r(1539),r(9714),r(7941),r(2526),r(7327),r(5003),r(4747),r(9337);var n=r(7187),o=r(1521),i=r(2539),u=r(3746);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?s(t):e}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){var e="function"==typeof Map?new Map:void 0;return(f=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return l(t,arguments,h(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,t)})(t)}function l(t,e,r){return(l=p()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&y(o,r.prototype),o}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function y(t,e){return(y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(2772),r(8674),r(9601),r(8304),r(489),r(2419),r(6992),r(1532),r(8783),r(3948),r(1817),r(2165);var b=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e)}(o,t);var e,r,n=(e=o,r=p(),function(){var t,n=h(e);if(r){var o=h(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return c(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),v(s(e=n.call(this)),"name","NgwError"),v(s(e),"title",void 0),v(s(e),"message",void 0),v(s(e),"detail",void 0),v(s(e),"exception",void 0),v(s(e),"status_code",void 0),v(s(e),"data",void 0),v(s(e),"guru_meditation",void 0),Object.assign(s(e),t),Object.setPrototypeOf(s(e),o.prototype),e}return o}(f(Error));function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?O(t):e}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){var e="function"==typeof Map?new Map:void 0;return(g=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return w(t,arguments,j(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_(n,t)})(t)}function w(t,e,r){return(w=P()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_(o,r.prototype),o}).apply(null,arguments)}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function _(t,e){return(_=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var k,S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_(t,e)}(o,t);var e,r,n=(e=o,r=P(),function(){var t,n=j(e);if(r){var o=j(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return m(this,t)});function o(t){var e,r,i,u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),u="NetworkError",(i="name")in(r=O(e=n.call(this)))?Object.defineProperty(r,i,{value:u,enumerable:!0,configurable:!0,writable:!0}):r.name=u,Object.setPrototypeOf(O(e),o.prototype),e.message="Unable to request ".concat(t,".\n    Possibly invalid NGW URL entered or CORS not configured to get request from ").concat(location.origin),e}return o}(g(Error));k=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;r.method=r.method||"GET";var i=new XMLHttpRequest;i.open(r.method||"GET",t,!0),"blob"===r.responseType&&(i.responseType=r.responseType);var u=function(){try{return JSON.parse(i.responseText)}catch(t){return i.responseText}},a=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=t?n:e;"blob"===r.responseType?o(i.response):i.responseText?o(u()):n({message:""})};i.onload=function(){-1!==[401,403,404,500].indexOf(i.status)&&n(new b(u())),a()},i.onerror=function(e){0===i.status?n(new S(t)):n(e)},i.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;r.onProgress&&r.onProgress(e,t)}};var c,s=r.headers;if(s)for(var f in s){var l=s[f];"string"==typeof l&&i.setRequestHeader(f,l)}if(void 0!==r.withCredentials&&(i.withCredentials=r.withCredentials),r.file){if((c=new FormData).append("file",r.file),r.data)for(var p in c)c.append(p,c[p])}else c=r.data?"string"==typeof r.data?r.data:JSON.stringify(r.data):null;o&&o((function(){i.abort()})),i.send(c)},r(4916),r(5306);var E=/\{ *([\w_-]+) *\}/g;function R(t,e){return t.replace(E,(function(t,r){var n=e[r];if(void 0===n)throw new Error("No value provided for letiable "+t);return"function"==typeof n&&(n=n(e)),n}))}function C(t){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){return(x=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t,e){return!e||"object"!==C(e)&&"function"!=typeof e?L(t):e}function L(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B(t){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function D(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var A=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=B(e);if(r){var o=B(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return T(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),D(L(e=n.call(this,t)),"name","ResourceNotFoundError"),D(L(e),"exception","nextgisweb.resource.exception.ResourceNotFound"),Object.setPrototypeOf(L(e),o.prototype),e}return o}(b);function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Z(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?U(t):e}function U(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function F(t){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(o,t);var e,r,n=(e=o,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=F(e);if(r){var o=F(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Z(this,t)});function o(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),z(U(e=n.call(this,t)),"name","InsufficientPermissionsError"),z(U(e),"exception","nextgisweb.core.exception.InsufficientPermissions"),Object.setPrototypeOf(U(e),o.prototype),e}return o}(b),N=(r(9826),r(561),[]);function H(t){N.push(t)}function W(t){return"[object Object]"===Object.prototype.toString.call(t)}function q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],u=!0,a=!1;try{for(r=r.call(t);!(u=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);u=!0);}catch(t){a=!0,o=t}finally{try{u||null==r.return||r.return()}finally{if(a)throw o}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return V(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?V(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function $(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e=e?e+"__":"";var r={};return Object.entries(t).forEach((function(t){var n=q(t,2),o=n[0],u=n[1];if(W(u)){var a=$(u,o);Object.assign(r,a)}else(0,i.ri)(u)&&(r[e+o]=u)})),r}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function X(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(7042),r(8309),r(1038),r(9720);var K=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.connector=e,X(this,"cache",new u.Z)}var e,r;return e=t,(r=[{key:"getOne",value:function(t,e){var r=this;return(new u.Z).add("resource",(function(){return"string"==typeof t?r._fetchResourceBy({keyname:t},e):"number"==typeof t?r._fetchResourceById(t,e):W(t)?r._fetchResourceBy(t,e):o.Z.resolve(void 0)}),{resource:t})}},{key:"getOneOrFail",value:function(t){return this.getOne(t).then((function(t){if(t)return t;throw new A}))}},{key:"getId",value:function(t){return"number"==typeof t?o.Z.resolve(t):"string"==typeof t||W(t)?this.getOne(t).then((function(t){if(t)return t.resource.id})):o.Z.resolve(void 0)}},{key:"getIdOrFail",value:function(t){return this.getId(t).then((function(t){if(void 0===t)throw new Error;return t}))}},{key:"getMany",value:function(t,e){var r=this;return this._resourceCacheFilter(t).then((function(n){if(!n.length){var i={};return t.keyname?i.keyname=t.keyname:Object.assign(i,$(t)),r.connector.get("resource.search",e,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(r),!0).forEach((function(e){X(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({serialization:"full"},i)).then((function(t){return t&&t.forEach((function(t){r.cache.add("resource.item",o.Z.resolve(t),{id:t.resource.id})})),t}))}return n}))}},{key:"getParent",value:function(t){var e=this;return this.connector.getResource(t).then((function(t){return t?e.connector.getResource(t.resource.parent.id):o.Z.resolve(void 0)}))}},{key:"getChildrenOf",value:function(t){var e=this;return this.getId(t).then((function(t){return e.connector.get("resource.collection",{cache:!0},{parent:t}).then((function(t){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return J(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==r.return||r.return()}finally{if(a)throw i}}}}(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.cache.add("resource.item",o.Z.resolve(i),{id:i.resource.id})}}catch(t){n.e(t)}finally{n.f()}return t}))}))}},{key:"update",value:function(t,e){var r=this;return this.getId(t).then((function(t){if(void 0!==t)return r.cache.add("resource.item",(function(){return r.connector.put("resource.item",{data:e},{id:t})}),{id:t})}))}},{key:"delete",value:function(t){var e=this;return this.getId(t).then((function(t){if(void 0!==t)return e.connector.delete("resource.item",null,{id:t}).then((function(){e.cache.delete("resource.item",{id:t})}))}))}},{key:"_fetchResourceById",value:function(t,e){var r=this;return this.cache.add("resource.item",(function(){return r.connector.get("resource.item",e,{id:t})}),{id:t}).catch((function(t){if(!(t instanceof A))throw t}))}},{key:"_fetchResourceBy",value:function(t,e){return this.getMany(t,e).then((function(t){return t[0]}))}},{key:"_resourceCacheFilter",value:function(t){return o.Z.all(this.cache.matchAll("resource.item")).then((function(e){return e.filter((function(e){if(e)return t.keyname&&e.resource.keyname?t.keyname===e.resource.keyname:(0,i.ri)(t.id)&&(0,i.ri)(e.resource.id)?t.id===e.resource.id:(r=t,n=e.resource,(0,i.vr)(r,n));var r,n})),[]}))}}])&&Y(e.prototype,r),t}();function tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function et(t){var e=t.params;return new o.Z((function(r,n){t.connector.connect().then((function(o){var i,u=o&&o[t.name];if(u){var a=(i=u,u=function(t){if(Array.isArray(t))return tt(t)}(i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return tt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?tt(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).shift();if(u.length){for(var c={},s=0;s<u.length;s++){var f=u[s];if(c[s]="{"+f+"}",void 0===e[f])throw new Error("`"+f+"` url api argument is not specified")}a&&(a=R(a,c))}if(e){var l=[],p=e.paramList;for(var y in Array.isArray(p)&&(delete e.paramList,p.forEach((function(t){l.push("".concat(t[0],"=").concat(t[1]))}))),e)-1===u.indexOf(y)&&l.push("".concat(y,"=").concat(e[y]));l.length&&(a=a+"?"+l.join("&"))}a?r(t.connector.makeQuery(a,e,t.requestOptions)):n(new Error("request url is not set"))}else r(void 0)})).catch((function(t){n(t)}))}))}function rt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(r),!0).forEach((function(e){it(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):rt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function it(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r(9600);var ut=0,at=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=e,it(this,"id",ut++),it(this,"emitter",new n.EventEmitter),it(this,"user",void 0),it(this,"resources",void 0),it(this,"routeStr","/api/component/pyramid/route");var r=function(t){return N.find((function(e){if(e.options.baseUrl===t.baseUrl){if(!t.auth)return!0;if(e.options.auth)return(0,i.vr)(e.options.auth,t.auth)}}))}(e);if(r)return r;this.options.route&&(this.routeStr=this.options.route),this.resources=new K(this),H(this)}var e,r,a;return e=t,a=[{key:"create",value:function(t){return new this(t)}}],(r=[{key:"setNgw",value:function(t){this.logout(),this.options.baseUrl=t,H(this)}},{key:"connect",value:function(){var t=this,e=new u.Z,r=this.options.auth;return e.add("route",(function(){return new o.Z((function(e,n){var o=function(){return t.makeQuery(t.routeStr,{},{}).then((function(t){e(t)})).catch((function(t){n(t)}))};if(r){var i=r.login,u=r.password;if(i&&u)return t.getUserInfo({login:i,password:u}).then((function(){o()})).catch((function(t){return n(t)}))}return o()}))}),{id:this.id,auth:r,baseUrl:this.options.baseUrl})}},{key:"login",value:function(t){return this.logout(),H(this),this.getUserInfo(t)}},{key:"logout",value:function(){var t,e;t=this,-1!==(e=N.indexOf(t))&&N.splice(e,1),this.options.auth=void 0,this.user=void 0,this.emitter.emit("logout"),this.resources.cache.clean()}},{key:"getUserInfo",value:function(t){var e=this;if(this.user&&this.user.id)return o.Z.resolve(this.user);t&&(this.options.auth=t);var r={headers:this.getAuthorizationHeaders(t)};return this.makeQuery("/api/component/auth/current_user",{},r).then((function(t){return e.user=t,e.emitter.emit("login",t),t})).catch((function(t){throw e.emitter.emit("login:error",t),t}))}},{key:"getAuthorizationHeaders",value:function(t){var e=this.makeClientId(t);if(e)return{Authorization:"Basic "+e}}},{key:"makeClientId",value:function(t){if(t=t||this.options.auth){var e=t,r=e.login,n=e.password,o=unescape(encodeURIComponent("".concat(r,":").concat(n)));return window.btoa(o)}}},{key:"apiRequest",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.method,a=n.headers,c=n.withCredentials,s=n.responseType,f=(0,i.dY)(r),l=function(){return et({name:t,params:f,requestOptions:n,connector:e})};if(n.cache&&"GET"===o){var p=new u.Z;return p.add(t,l,nt({params:f},(0,i.dY)({headers:a,withCredentials:c,responseType:s,baseUrl:this.options.baseUrl,auth:this.options.auth})))}return l()}},{key:"post",value:function(t,e,r){return(e=e||{}).method="POST",this.apiRequest(t,r,e)}},{key:"get",value:function(t,e,r){return(e=e||{}).method="GET",this.apiRequest(t,r,e)}},{key:"patch",value:function(t,e,r){return(e=e||{}).method="PATCH",this.apiRequest(t,r,e)}},{key:"put",value:function(t,e,r){return(e=e||{}).method="PUT",this.apiRequest(t,r,e)}},{key:"delete",value:function(t,e,r){return(e=e||{}).method="DELETE",this.apiRequest(t,r,e)}},{key:"makeQuery",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=R(t,e)),t=(0,i.nH)(t),this._loadData(t,r);throw new Error("Empty `url` not allowed")}},{key:"getResource",value:function(t){return this.resources.getOne(t)}},{key:"getResourceOrFail",value:function(t){return this.resources.getOneOrFail(t)}},{key:"getResourceBy",value:function(t){return this.resources.getOne(t)}},{key:"getResourceByKeyname",value:function(t){return this.resources.getOne(t)}},{key:"getResourceById",value:function(t){return this.resources.getOne(t)}},{key:"getResourceId",value:function(t){return this.resources.getId(t)}},{key:"getResourceIdOrFail",value:function(t){return this.resources.getIdOrFail(t)}},{key:"getResourcesBy",value:function(t){return this.resources.getMany(t)}},{key:"getResourceParent",value:function(t){return this.resources.getParent(t)}},{key:"getResourceChildren",value:function(t){return this.resources.getChildrenOf(t)}},{key:"updateResource",value:function(t,e){return this.resources.update(t,e)}},{key:"deleteResource",value:function(t){return this.resources.delete(t)}},{key:"_loadData",value:function(t,e){var r=this;return e.responseType=e.responseType||"json",new o.Z((function(n,o,i){r.user&&((e=e||{}).headers=nt(nt({},r.getAuthorizationHeaders()),e.headers)),k(t,n,e,o,i)})).catch((function(t){if(t instanceof o.Z.CancelError);else{var e=r._handleHttpError(t);if(e)throw e}}))}},{key:"_handleHttpError",value:function(t){if(t&&t instanceof b){if("nextgisweb.resource.exception.ResourceNotFound"===t.exception)throw new A(t);if("nextgisweb.core.exception.InsufficientPermissions"===t.exception)throw new G(t)}return t}}])&&ot(e.prototype,r),a&&ot(e,a),t}();it(at,"errors",{NgwError:b,ResourceNotFoundError:A});var ct=at}}]);
//# sourceMappingURL=main-4aa8b69d55efd35.js.map